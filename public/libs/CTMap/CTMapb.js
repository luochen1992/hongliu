!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="/dist/",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var r=n(2),o=i(r),a="undefined"!=typeof window?window:"undefined"!=typeof self?self:{};a.CTMap?Object.assign(a.CTMap,o.default):a.CTMap=o.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),a=r(o),s=n(15),u=i(s),l=n(20),c=i(l),h=n(23),f=i(h),p=n(24),d=i(p),g=n(38),y=i(g),m=n(90),v=i(m),_=n(107),w=i(_),b=n(108),C=i(b),x=n(110),E=i(x),S=n(111),P=i(S),M=n(86),L=i(M),I=n(87),T=i(I),N=n(93),k=i(N),O=n(112),D=i(O),A=n(30),R=i(A),F=n(32),j=i(F),z=n(113),B=(i(z),n(114)),G=(i(B),n(37)),U=i(G),H=n(116),q=i(H),V=n(117),W=i(V),Y=n(118),X=n(121),Z=n(125),J=i(Z),K=n(106),$=i(K),Q=n(126),tt=i(Q),et=n(127),nt=i(et),it=n(128),rt=i(it),ot=Cesium;ot.DrawTool=y.default,ot.PluginManager=u.default,ot.Util=a,ot.Widget=c.default,ot.Tool=f.default,ot.Measure=v.default,ot.EnvEffects=k.default,ot.ViewshedAnalyze=L.default,ot.FloodAnalyze=T.default,ot.transformEditor=D.default,ot.LayerType=R.default,ot.LayerStyle=j.default,ot.TerrainLayerList=U.default,ot.Viewer=d.default,ot.KeyboardNavigation=W.default,ot.BaiDuImageryProvider=q.default,ot.MapVLayer=X.MapVLayer,ot.Clusterpoint=J.default,ot.MapVOpt=X.MapVOpt,ot.HeatMapLayer=Y.HeatMapLayer,ot.HeatMapOpt=Y.HeatMapOpt,ot.LatLonGridLayer=nt.default,ot.WaterFacePrimitive=rt.default,ot.tooltip=w.default,ot.waterEffects=C.default,ot.wasiEffects=E.default,ot.workPolygonEffects=P.default;try{ot=$.default.checkLicense()?ot:{}}catch(t){}tt.default.greeting(),e.default=ot},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.syncGetJson=e.arrayToStr=e.strToArray=e.getLocation=e.aAToa_a=e.a_aToaA=e.formatURLByHost=e.formatURL=e.formatURL2=e.rename=e.formatString=e.indexOf=e.falseFn=e.createGuid=e.json2xmlAndaAToa_a=e.json2xml=e.xmlToJson=e.strToXml=e.jsonSyncPromise=e.isColor=e.xmlPromise=e.filterUnit=e.isAddUnit=e.isArray=e.isStrNumber=e.isNumber=e.isString=e.getJsonLength=e.toBooleanTrueOrFlse=e.isTrueOrFalse=e.isBoolean=e.isObject=e.isJson=e.math=e.array=e.$=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(4),s=r(a),u=n(7),l=r(u),c=n(8),h=r(c),f=n(9),p=(i(f),n(13)),d=(r(p),e.$=s.default);e.array=h.default,e.math=l.default,e.isJson=function(t){if(!d.isPlainObject(t))return!1;try{return JSON.stringify(t),!0}catch(t){return!1}},e.isObject=function(t){return"object"===("undefined"==typeof t?"undefined":o(t))&&null!==t},e.isBoolean=function(t){return"boolean"==typeof t},e.isTrueOrFalse=function(t){return"boolean"==typeof t||"true"===t||"false"===t},e.toBooleanTrueOrFlse=function(t){return t===!0||"true"===t||"TRUE"===t||t!==!1&&"false"!==t&&"FALSE"!==t&&void 0};"debug"in console||(console.debug=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log.apply(void 0,e)});var g=(e.getJsonLength=function(t){var e=0;for(var n in t)e++;return e},e.isString=function(t){return"string"==typeof t&&t.constructor===String}),y=e.isNumber=function(t){return"number"==typeof t&&t.constructor===Number},m=(e.isStrNumber=function(t){return g(t)?!isNaN(parseFloat(t)):"number"==typeof t&&t.constructor===Number},e.isArray=function(t){return t instanceof Array},e.isAddUnit=function(t){var e=new RegExp(/^(\-|\+)?\d+(m|px)?$/);return e.test(t)},e.filterUnit=function(t){return y(t)?t:Number(t.match(/^(\-|\+)?\d+/)[0])},e.xmlPromise=function(t){return d.ajax({url:t,type:"get",dataType:"xml"})},e.isColor=function(t){var e=new RegExp("^#([0-9a-fA-F]{6}|[0-9a-fA-F]{8})$");return e.test(t)},e.jsonSyncPromise=function(t){return d.ajax({url:t,type:"get",dataType:"json",async:!1})},e.strToXml=function(t){return(new DOMParser).parseFromString(t,"text/xml")},e.xmlToJson=function t(e){var n={};if(1===e.nodeType){if(e.attributes.length>0)for(var i=0;i<e.attributes.length;i+=1){var r=e.attributes.item(i);n[r.nodeName]=r.nodeValue}}else 3===e.nodeType&&(n=e.nodeValue);if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o+=1){var a=e.childNodes.item(o),s=a.nodeName;if("undefined"==typeof n[s]){var u=null;"#cdata-section"===s.toLowerCase()?(u=CDATAtoSTR(e.innerHTML),s="value"):u=t(a),"#text"===s&&""===u.replace(/^\s+/g,"")||"#comment"===s||("#text"===s?n=u:n[s]=u)}else{if("undefined"==typeof n[s].length){var l=n[s];n[s]=[],n[s].push(l)}n[s].push(t(a))}}return n},e.json2xml=function t(e,n){var i="";if(e instanceof Array){var r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;i+=t(l,n)}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}else if(e instanceof Object){n&&(i+="<"+n+">");for(var c in e)i+=t(e[c],c);n&&(i+="</"+n+">")}else i+="<"+n+">"+e+"</"+n+">";return i},e.json2xmlAndaAToa_a=function t(e,n){var i="";if(e instanceof Array){var r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;i+=t(l,n)}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}else if(e instanceof Object){n&&(i+="<"+m(n)+">");for(var c in e)i+=t(e[c],c);n&&(i+="</"+m(n)+">")}else i+="<"+m(n)+">"+e+"</"+m(n)+">";return i},e.createGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})},e.falseFn=function(){return!1},e.indexOf=function(t,e,n){for(var i in e)if(e[i][n]===t[n])return i;return-1},e.formatString=function(t,e){if(0!==e.length){var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=new RegExp("{"+s.k+"}","gm");t=t.replace(u,s.v)}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}return t}return t},e.rename=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments[1],n=arguments[2],i=arguments[3],r=0,o=function t(e,n,i,o){for(var a in n){var s=void 0;if(s=i?n[a][i]:n[a],s&&e===s&&n[a]!==o)return t(e+"_"+ ++r,n,i,o)}return e};return o(t,e,n,i)},e.formatURL2=function(t,e){if(e){var n=e.split("/"),i=t;if(!i)return e;i=i.split("/"),i.pop();for(var r="",o=0;o<n.length;o+=1)0===o&&"."===n[o]&&(o+=1),".."===n[o]?i.pop():i.push(n[o]);for(var a=0;a<i.length;a+=1){var s=a===i.length-1?"":"/";r+=i[a]+s}return r}},e.formatURL=function(t){if(t){var e=t.split("/"),n=window.location.href;if(!n)return t;n=n.split("/"),n.pop();for(var i="",r=0;r<e.length;r+=1)0===r&&"."===e[r]&&(r+=1),".."===e[r]?n.pop():n.push(e[r]);for(var o=0;o<n.length;o+=1){var a=o===n.length-1?"":"/";i+=n[o]+a}return i}},e.formatURLByHost=function(t){if(t){var e=window.location.origin;if(!e)return t;for(var n=t.split("/"),i=[e],r="",o=0;o<n.length;o+=1)0===o&&"."===n[o]&&(o+=1),".."===n[o]?o+=1:i.push(n[o]);for(var a=0;a<i.length;a+=1){var s=a===i.length-1?"":"/";r+=i[a]+s}return r}},e.a_aToaA=function(t){return t.replace(/_[a-z]/g,function(t){return t.toUpperCase().charAt(1)})},e.aAToa_a=function(t){return t.replace(/[A-Z]/g,function(t){return"_"+t.toLowerCase()})});e.getLocation=function(t){var e={dir:"",filename:""};new RegExp(/^http:\/\//g).test(t)&&(t=t.substring(6));for(var n=t.split("/"),i=0;i<n.length;i++)i===n.length-1?(e.dir+="/",e.filename=n[i]):null!==n[i]&&""!==n[i]&&(e.dir+="/"+n[i]);return e.dir="http:/"+e.dir,e},e.strToArray=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float",n=[];if("string"!=typeof t)return n;var i=t.split(",");return i?(i instanceof Array||(i=[i]),i.forEach(function(t){if("string"==typeof t){var e=t.split(" ");if(e&&1===e.length)n.push(e[0]);else if(e&&e.length>1){for(var i=[],r=0;r<e.length;r++)i.push(parseFloat(e[r]));n.push(i)}}}),"string"===e||"String"===e||"STRING"===e?n:(n.forEach(function(t,n,i){if(t instanceof Array)t.forEach(function(t,n,i){switch(e){case"float":i[n]=parseFloat(t)}});else switch(e){case"float":i[n]=parseFloat(t)}}),n)):n},e.arrayToStr=function(t){var e="";if(!(t&&t instanceof Array&&0!==t.length))return"";for(var n=0;n<t.length;n++){0!==n&&(e+=",");var i=t[n];if(i instanceof Array)for(var r=0;r<i.length;r++)0!==r&&(e+=" "),e+=""+i[r];else e+=""+i}return e},e.syncGetJson=function(t){var e=d.ajax({async:!1,url:t,dataType:"text"});if(4===e.readyState&&200===e.status)return JSON.parse(e.responseText)}},function(t,e,n){var i,r;(function(t){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(e,n){"object"==o(t)&&"object"==o(t.exports)?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:void 0,function(a,s){function u(t,e){e=e||st;var n=e.createElement("script");n.text=t,e.head.appendChild(n).parentNode.removeChild(n)}function l(t){var e=!!t&&"length"in t&&t.length,n=wt.type(t);return"function"!==n&&!wt.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}function c(t,e,n){return wt.isFunction(e)?wt.grep(t,function(t,i){return!!e.call(t,i,t)!==n}):e.nodeType?wt.grep(t,function(t){return t===e!==n}):"string"!=typeof e?wt.grep(t,function(t){return ft.call(e,t)>-1!==n}):Tt.test(e)?wt.filter(e,t,n):(e=wt.filter(e,t),wt.grep(t,function(t){return ft.call(e,t)>-1!==n&&1===t.nodeType}))}function h(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function f(t){var e={};return wt.each(t.match(Rt)||[],function(t,n){e[n]=!0}),e}function p(t){return t}function d(t){throw t}function g(t,e,n){var i;try{t&&wt.isFunction(i=t.promise)?i.call(t).done(e).fail(n):t&&wt.isFunction(i=t.then)?i.call(t,e,n):e.call(void 0,t)}catch(t){n.call(void 0,t)}}function y(){st.removeEventListener("DOMContentLoaded",y),a.removeEventListener("load",y),wt.ready()}function m(){this.expando=wt.expando+m.uid++}function v(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:Ht.test(t)?JSON.parse(t):t)}function _(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(qt,"-$&").toLowerCase(),n=t.getAttribute(i),"string"==typeof n){try{n=v(n)}catch(t){}Ut.set(t,e,n)}else n=void 0;return n}function w(t,e,n,i){var r,o=1,a=20,s=i?function(){return i.cur()}:function(){return wt.css(t,e,"")},u=s(),l=n&&n[3]||(wt.cssNumber[e]?"":"px"),c=(wt.cssNumber[e]||"px"!==l&&+u)&&Wt.exec(wt.css(t,e));if(c&&c[3]!==l){l=l||c[3],n=n||[],c=+u||1;do o=o||".5",c/=o,wt.style(t,e,c+l);while(o!==(o=s()/u)&&1!==o&&--a)}return n&&(c=+c||+u||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=c,i.end=r)),r}function b(t){var e,n=t.ownerDocument,i=t.nodeName,r=Jt[i];return r?r:(e=n.body.appendChild(n.createElement(i)),r=wt.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),Jt[i]=r,r)}function C(t,e){for(var n,i,r=[],o=0,a=t.length;o<a;o++)i=t[o],i.style&&(n=i.style.display,e?("none"===n&&(r[o]=Gt.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&Xt(i)&&(r[o]=b(i))):"none"!==n&&(r[o]="none",Gt.set(i,"display",n)));for(o=0;o<a;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}function x(t,e){var n;return n="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&wt.nodeName(t,e)?wt.merge([t],n):n}function E(t,e){for(var n=0,i=t.length;n<i;n++)Gt.set(t[n],"globalEval",!e||Gt.get(e[n],"globalEval"))}function S(t,e,n,i,r){for(var o,a,s,u,l,c,h=e.createDocumentFragment(),f=[],p=0,d=t.length;p<d;p++)if(o=t[p],o||0===o)if("object"===wt.type(o))wt.merge(f,o.nodeType?[o]:o);else if(ee.test(o)){for(a=a||h.appendChild(e.createElement("div")),s=($t.exec(o)||["",""])[1].toLowerCase(),u=te[s]||te._default,a.innerHTML=u[1]+wt.htmlPrefilter(o)+u[2],c=u[0];c--;)a=a.lastChild;wt.merge(f,a.childNodes),a=h.firstChild,a.textContent=""}else f.push(e.createTextNode(o));for(h.textContent="",p=0;o=f[p++];)if(i&&wt.inArray(o,i)>-1)r&&r.push(o);else if(l=wt.contains(o.ownerDocument,o),a=x(h.appendChild(o),"script"),l&&E(a),n)for(c=0;o=a[c++];)Qt.test(o.type||"")&&n.push(o);return h}function P(){return!0}function M(){return!1}function L(){try{return st.activeElement}catch(t){}}function I(t,e,n,i,r,a){var s,u;if("object"==("undefined"==typeof e?"undefined":o(e))){"string"!=typeof n&&(i=i||n,n=void 0);for(u in e)I(t,u,n,i,e[u],a);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),r===!1)r=M;else if(!r)return t;return 1===a&&(s=r,r=function(t){return wt().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=wt.guid++)),t.each(function(){wt.event.add(this,e,r,i,n)})}function T(t,e){return wt.nodeName(t,"table")&&wt.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t:t}function N(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function k(t){var e=le.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function O(t,e){var n,i,r,o,a,s,u,l;if(1===e.nodeType){if(Gt.hasData(t)&&(o=Gt.access(t),a=Gt.set(e,o),l=o.events)){delete a.handle,a.events={};for(r in l)for(n=0,i=l[r].length;n<i;n++)wt.event.add(e,r,l[r][n])}Ut.hasData(t)&&(s=Ut.access(t),u=wt.extend({},s),Ut.set(e,u))}}function D(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Kt.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function A(t,e,n,i){e=ct.apply([],e);var r,o,a,s,l,c,h=0,f=t.length,p=f-1,d=e[0],g=wt.isFunction(d);if(g||f>1&&"string"==typeof d&&!vt.checkClone&&ue.test(d))return t.each(function(r){var o=t.eq(r);g&&(e[0]=d.call(this,r,o.html())),A(o,e,n,i)});if(f&&(r=S(e,t[0].ownerDocument,!1,t,i),o=r.firstChild,1===r.childNodes.length&&(r=o),o||i)){for(a=wt.map(x(r,"script"),N),s=a.length;h<f;h++)l=r,h!==p&&(l=wt.clone(l,!0,!0),s&&wt.merge(a,x(l,"script"))),n.call(t[h],l,h);if(s)for(c=a[a.length-1].ownerDocument,wt.map(a,k),h=0;h<s;h++)l=a[h],Qt.test(l.type||"")&&!Gt.access(l,"globalEval")&&wt.contains(c,l)&&(l.src?wt._evalUrl&&wt._evalUrl(l.src):u(l.textContent.replace(ce,""),c))}return t}function R(t,e,n){for(var i,r=e?wt.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||wt.cleanData(x(i)),i.parentNode&&(n&&wt.contains(i.ownerDocument,i)&&E(x(i,"script")),i.parentNode.removeChild(i));return t}function F(t,e,n){var i,r,o,a,s=t.style;return n=n||pe(t),n&&(a=n.getPropertyValue(e)||n[e],""!==a||wt.contains(t.ownerDocument,t)||(a=wt.style(t,e)),!vt.pixelMarginRight()&&fe.test(a)&&he.test(e)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function j(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function z(t){if(t in ve)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=me.length;n--;)if(t=me[n]+e,t in ve)return t}function B(t,e,n){var i=Wt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function G(t,e,n,i,r){var o,a=0;for(o=n===(i?"border":"content")?4:"width"===e?1:0;o<4;o+=2)"margin"===n&&(a+=wt.css(t,n+Yt[o],!0,r)),i?("content"===n&&(a-=wt.css(t,"padding"+Yt[o],!0,r)),"margin"!==n&&(a-=wt.css(t,"border"+Yt[o]+"Width",!0,r))):(a+=wt.css(t,"padding"+Yt[o],!0,r),"padding"!==n&&(a+=wt.css(t,"border"+Yt[o]+"Width",!0,r)));return a}function U(t,e,n){var i,r=!0,o=pe(t),a="border-box"===wt.css(t,"boxSizing",!1,o);if(t.getClientRects().length&&(i=t.getBoundingClientRect()[e]),i<=0||null==i){if(i=F(t,e,o),(i<0||null==i)&&(i=t.style[e]),fe.test(i))return i;r=a&&(vt.boxSizingReliable()||i===t.style[e]),i=parseFloat(i)||0}return i+G(t,e,n||(a?"border":"content"),r,o)+"px"}function H(t,e,n,i,r){return new H.prototype.init(t,e,n,i,r)}function q(){we&&(a.requestAnimationFrame(q),wt.fx.tick())}function V(){return a.setTimeout(function(){_e=void 0}),_e=wt.now()}function W(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)n=Yt[i],r["margin"+n]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function Y(t,e,n){for(var i,r=(J.tweeners[e]||[]).concat(J.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,e,t))return i}function X(t,e,n){var i,r,o,a,s,u,l,c,h="width"in e||"height"in e,f=this,p={},d=t.style,g=t.nodeType&&Xt(t),y=Gt.get(t,"fxshow");n.queue||(a=wt._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,f.always(function(){f.always(function(){a.unqueued--,wt.queue(t,"fx").length||a.empty.fire()})}));for(i in e)if(r=e[i],be.test(r)){if(delete e[i],o=o||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!y||void 0===y[i])continue;g=!0}p[i]=y&&y[i]||wt.style(t,i)}if(u=!wt.isEmptyObject(e),u||!wt.isEmptyObject(p)){h&&1===t.nodeType&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],l=y&&y.display,null==l&&(l=Gt.get(t,"display")),c=wt.css(t,"display"),"none"===c&&(l?c=l:(C([t],!0),l=t.style.display||l,c=wt.css(t,"display"),C([t]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===wt.css(t,"float")&&(u||(f.done(function(){d.display=l}),null==l&&(c=d.display,l="none"===c?"":c)),d.display="inline-block")),n.overflow&&(d.overflow="hidden",f.always(function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]})),u=!1;for(i in p)u||(y?"hidden"in y&&(g=y.hidden):y=Gt.access(t,"fxshow",{display:l}),o&&(y.hidden=!g),g&&C([t],!0),f.done(function(){g||C([t]),Gt.remove(t,"fxshow");for(i in p)wt.style(t,i,p[i])})),u=Y(g?y[i]:0,i,f),i in y||(y[i]=u.start,g&&(u.end=u.start,u.start=0))}}function Z(t,e){var n,i,r,o,a;for(n in t)if(i=wt.camelCase(n),r=e[i],o=t[n],wt.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),a=wt.cssHooks[i],a&&"expand"in a){o=a.expand(o),delete t[i];for(n in o)n in t||(t[n]=o[n],e[n]=r)}else e[i]=r}function J(t,e,n){var i,r,o=0,a=J.prefilters.length,s=wt.Deferred().always(function(){delete u.elem}),u=function e(){if(r)return!1;for(var n=_e||V(),i=Math.max(0,l.startTime+l.duration-n),o=i/l.duration||0,a=1-o,u=0,e=l.tweens.length;u<e;u++)l.tweens[u].run(a);return s.notifyWith(t,[l,a,i]),a<1&&e?i:(s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:wt.extend({},e),opts:wt.extend(!0,{specialEasing:{},easing:wt.easing._default},n),originalProperties:e,originalOptions:n,startTime:_e||V(),duration:n.duration,tweens:[],createTween:function(e,n){var i=wt.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)l.tweens[n].run(1);return e?(s.notifyWith(t,[l,1,0]),s.resolveWith(t,[l,e])):s.rejectWith(t,[l,e]),this}}),c=l.props;for(Z(c,l.opts.specialEasing);o<a;o++)if(i=J.prefilters[o].call(l,t,c,l.opts))return wt.isFunction(i.stop)&&(wt._queueHooks(l.elem,l.opts.queue).stop=wt.proxy(i.stop,i)),i;return wt.map(c,Y,l),wt.isFunction(l.opts.start)&&l.opts.start.call(t,l),wt.fx.timer(wt.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function K(t){var e=t.match(Rt)||[];return e.join(" ")}function $(t){return t.getAttribute&&t.getAttribute("class")||""}function Q(t,e,n,i){var r;if(wt.isArray(e))wt.each(e,function(e,r){n||ke.test(t)?i(t,r):Q(t+"["+("object"==("undefined"==typeof r?"undefined":o(r))&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==wt.type(e))i(t,e);else for(r in e)Q(t+"["+r+"]",e[r],n,i)}function tt(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(Rt)||[];if(wt.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function et(t,e,n,i){function r(s){var u;return o[s]=!0,wt.each(t[s]||[],function(t,s){var l=s(e,n,i);return"string"!=typeof l||a||o[l]?a?!(u=l):void 0:(e.dataTypes.unshift(l),r(l),!1)}),u}var o={},a=t===qe;return r(e.dataTypes[0])||!o["*"]&&r("*")}function nt(t,e){var n,i,r=wt.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&wt.extend(!0,t,i),t}function it(t,e,n){for(var i,r,o,a,s=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){u.unshift(r);break}if(u[0]in n)o=u[0];else{for(r in n){if(!u[0]||t.converters[r+" "+u[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}function rt(t,e,n,i){var r,o,a,s,u,l={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(a=l[u+" "+o]||l["* "+o],!a)for(r in l)if(s=r.split(" "),s[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){a===!0?a=l[r]:l[r]!==!0&&(o=s[0],c.unshift(s[1]));break}if(a!==!0)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}function ot(t){return wt.isWindow(t)?t:9===t.nodeType&&t.defaultView}var at=[],st=a.document,ut=Object.getPrototypeOf,lt=at.slice,ct=at.concat,ht=at.push,ft=at.indexOf,pt={},dt=pt.toString,gt=pt.hasOwnProperty,yt=gt.toString,mt=yt.call(Object),vt={},_t="3.1.1",wt=function t(e,n){return new t.fn.init(e,n)},bt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Ct=/^-ms-/,xt=/-([a-z])/g,Et=function(t,e){return e.toUpperCase()};wt.fn=wt.prototype={jquery:_t,constructor:wt,length:0,toArray:function(){return lt.call(this)},get:function(t){return null==t?lt.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=wt.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return wt.each(this,t)},map:function(t){return this.pushStack(wt.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(lt.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:ht,sort:at.sort,splice:at.splice},wt.extend=wt.fn.extend=function(){var t,e,n,i,r,a,s=arguments[0]||{},u=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[u]||{},u++),"object"==("undefined"==typeof s?"undefined":o(s))||wt.isFunction(s)||(s={}),u===l&&(s=this,u--);u<l;u++)if(null!=(t=arguments[u]))for(e in t)n=s[e],i=t[e],s!==i&&(c&&i&&(wt.isPlainObject(i)||(r=wt.isArray(i)))?(r?(r=!1,a=n&&wt.isArray(n)?n:[]):a=n&&wt.isPlainObject(n)?n:{},s[e]=wt.extend(c,a,i)):void 0!==i&&(s[e]=i));return s},wt.extend({expando:"jQuery"+(_t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===wt.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=wt.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==dt.call(t)||(e=ut(t))&&(n=gt.call(e,"constructor")&&e.constructor,"function"!=typeof n||yt.call(n)!==mt))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==("undefined"==typeof t?"undefined":o(t))||"function"==typeof t?pt[dt.call(t)]||"object":"undefined"==typeof t?"undefined":o(t)},globalEval:function(t){u(t)},camelCase:function(t){return t.replace(Ct,"ms-").replace(xt,Et)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var n,i=0;if(l(t))for(n=t.length;i<n&&e.call(t[i],i,t[i])!==!1;i++);else for(i in t)if(e.call(t[i],i,t[i])===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(bt,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(l(Object(t))?wt.merge(n,"string"==typeof t?[t]:t):ht.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:ft.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i,r=[],o=0,a=t.length,s=!n;o<a;o++)i=!e(t[o],o),i!==s&&r.push(t[o]);return r},map:function(t,e,n){var i,r,o=0,a=[];if(l(t))for(i=t.length;o<i;o++)r=e(t[o],o,n),null!=r&&a.push(r);else for(o in t)r=e(t[o],o,n),null!=r&&a.push(r);return ct.apply([],a)},guid:1,proxy:function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),wt.isFunction(t))return i=lt.call(arguments,2),r=function(){return t.apply(e||this,i.concat(lt.call(arguments)))},r.guid=t.guid=t.guid||wt.guid++,r},now:Date.now,support:vt}),"function"==typeof Symbol&&(wt.fn[Symbol.iterator]=at[Symbol.iterator]),wt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){pt["[object "+e+"]"]=e.toLowerCase()});var St=function(t){function e(t,e,n,i){var r,o,a,s,u,l,c,f=e&&e.ownerDocument,d=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==d&&9!==d&&11!==d)return n;if(!i&&((e?e.ownerDocument||e:G)!==O&&k(e),e=e||O,A)){if(11!==d&&(u=mt.exec(t)))if(r=u[1]){if(9===d){if(!(a=e.getElementById(r)))return n;if(a.id===r)return n.push(a),n}else if(f&&(a=f.getElementById(r))&&z(e,a)&&a.id===r)return n.push(a),n}else{if(u[2])return $.apply(n,e.getElementsByTagName(t)),n;if((r=u[3])&&C.getElementsByClassName&&e.getElementsByClassName)return $.apply(n,e.getElementsByClassName(r)),n}if(C.qsa&&!W[t+" "]&&(!R||!R.test(t))){if(1!==d)f=e,c=t;else if("object"!==e.nodeName.toLowerCase()){for((s=e.getAttribute("id"))?s=s.replace(bt,Ct):e.setAttribute("id",s=B),l=P(t),o=l.length;o--;)l[o]="#"+s+" "+p(l[o]);c=l.join(","),f=vt.test(t)&&h(e.parentNode)||e}if(c)try{return $.apply(n,f.querySelectorAll(c)),n}catch(t){}finally{s===B&&e.removeAttribute("id")}}}return L(t.replace(st,"$1"),e,n,i)}function n(){function t(n,i){return e.push(n+" ")>x.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function i(t){return t[B]=!0,t}function r(t){var e=O.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var n=t.split("|"),i=n.length;i--;)x.attrHandle[n[i]]=e}function a(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function s(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function u(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function l(t){return function(e){return"form"in e?e.parentNode&&e.disabled===!1?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&Et(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function c(t){return i(function(e){return e=+e,i(function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function h(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function f(){}function p(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function d(t,e,n){var i=e.dir,r=e.next,o=r||i,a=n&&"parentNode"===o,s=H++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||a)return t(e,n,r);return!1}:function(e,n,u){var l,c,h,f=[U,s];if(u){for(;e=e[i];)if((1===e.nodeType||a)&&t(e,n,u))return!0}else for(;e=e[i];)if(1===e.nodeType||a)if(h=e[B]||(e[B]={}),c=h[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((l=c[o])&&l[0]===U&&l[1]===s)return f[2]=l[2];if(c[o]=f,f[2]=t(e,n,u))return!0}return!1}}function g(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function y(t,n,i){for(var r=0,o=n.length;r<o;r++)e(t,n[r],i);return i}function m(t,e,n,i,r){for(var o,a=[],s=0,u=t.length,l=null!=e;s<u;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),l&&e.push(s)));return a}function v(t,e,n,r,o,a){return r&&!r[B]&&(r=v(r)),o&&!o[B]&&(o=v(o,a)),i(function(i,a,s,u){var l,c,h,f=[],p=[],d=a.length,g=i||y(e||"*",s.nodeType?[s]:s,[]),v=!t||!i&&e?g:m(g,f,t,s,u),_=n?o||(i?t:d||r)?[]:a:v;if(n&&n(v,_,s,u),r)for(l=m(_,p),r(l,[],s,u),c=l.length;c--;)(h=l[c])&&(_[p[c]]=!(v[p[c]]=h));if(i){if(o||t){if(o){for(l=[],c=_.length;c--;)(h=_[c])&&l.push(v[c]=h);o(null,_=[],l,u)}for(c=_.length;c--;)(h=_[c])&&(l=o?tt(i,h):f[c])>-1&&(i[l]=!(a[l]=h))}}else _=m(_===a?_.splice(d,_.length):_),o?o(null,a,_,u):$.apply(a,_)})}function _(t){for(var e,n,i,r=t.length,o=x.relative[t[0].type],a=o||x.relative[" "],s=o?1:0,u=d(function(t){return t===e},a,!0),l=d(function(t){return tt(e,t)>-1},a,!0),c=[function(t,n,i){var r=!o&&(i||n!==I)||((e=n).nodeType?u(t,n,i):l(t,n,i));return e=null,r}];s<r;s++)if(n=x.relative[t[s].type])c=[d(g(c),n)];else{if(n=x.filter[t[s].type].apply(null,t[s].matches),n[B]){for(i=++s;i<r&&!x.relative[t[i].type];i++);return v(s>1&&g(c),s>1&&p(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(st,"$1"),n,s<i&&_(t.slice(s,i)),i<r&&_(t=t.slice(i)),i<r&&p(t))}c.push(n)}return g(c)}function w(t,n){var r=n.length>0,o=t.length>0,a=function(i,a,s,u,l){var c,h,f,p=0,d="0",g=i&&[],y=[],v=I,_=i||o&&x.find.TAG("*",l),w=U+=null==v?1:Math.random()||.1,b=_.length;for(l&&(I=a===O||a||l);d!==b&&null!=(c=_[d]);d++){if(o&&c){for(h=0,a||c.ownerDocument===O||(k(c),s=!A);f=t[h++];)if(f(c,a||O,s)){u.push(c);break}l&&(U=w)}r&&((c=!f&&c)&&p--,i&&g.push(c))}if(p+=d,r&&d!==p){for(h=0;f=n[h++];)f(g,y,a,s);if(i){if(p>0)for(;d--;)g[d]||y[d]||(y[d]=J.call(u));y=m(y)}$.apply(u,y),l&&!i&&y.length>0&&p+n.length>1&&e.uniqueSort(u)}return l&&(U=w,I=v),g};return r?i(a):a}var b,C,x,E,S,P,M,L,I,T,N,k,O,D,A,R,F,j,z,B="sizzle"+1*new Date,G=t.document,U=0,H=0,q=n(),V=n(),W=n(),Y=function(t,e){return t===e&&(N=!0),0},X={}.hasOwnProperty,Z=[],J=Z.pop,K=Z.push,$=Z.push,Q=Z.slice,tt=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",rt="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+it+"))|)"+nt+"*\\]",ot=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",at=new RegExp(nt+"+","g"),st=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ut=new RegExp("^"+nt+"*,"+nt+"*"),lt=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ct=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ht=new RegExp(ot),ft=new RegExp("^"+it+"$"),pt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it+"|[*])"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+ot),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},dt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,yt=/^[^{]+\{\s*\[native \w/,mt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,vt=/[+~]/,_t=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),wt=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},bt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Ct=function(t,e){
return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},xt=function(){k()},Et=d(function(t){return t.disabled===!0&&("form"in t||"label"in t)},{dir:"parentNode",next:"legend"});try{$.apply(Z=Q.call(G.childNodes),G.childNodes),Z[G.childNodes.length].nodeType}catch(t){$={apply:Z.length?function(t,e){K.apply(t,Q.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}C=e.support={},S=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},k=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:G;return i!==O&&9===i.nodeType&&i.documentElement?(O=i,D=O.documentElement,A=!S(O),G!==O&&(n=O.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",xt,!1):n.attachEvent&&n.attachEvent("onunload",xt)),C.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),C.getElementsByTagName=r(function(t){return t.appendChild(O.createComment("")),!t.getElementsByTagName("*").length}),C.getElementsByClassName=yt.test(O.getElementsByClassName),C.getById=r(function(t){return D.appendChild(t).id=B,!O.getElementsByName||!O.getElementsByName(B).length}),C.getById?(x.filter.ID=function(t){var e=t.replace(_t,wt);return function(t){return t.getAttribute("id")===e}},x.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&A){var n=e.getElementById(t);return n?[n]:[]}}):(x.filter.ID=function(t){var e=t.replace(_t,wt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},x.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&A){var n,i,r,o=e.getElementById(t);if(o){if(n=o.getAttributeNode("id"),n&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if(n=o.getAttributeNode("id"),n&&n.value===t)return[o]}return[]}}),x.find.TAG=C.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):C.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},x.find.CLASS=C.getElementsByClassName&&function(t,e){if("undefined"!=typeof e.getElementsByClassName&&A)return e.getElementsByClassName(t)},F=[],R=[],(C.qsa=yt.test(O.querySelectorAll))&&(r(function(t){D.appendChild(t).innerHTML="<a id='"+B+"'></a><select id='"+B+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&R.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||R.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+B+"-]").length||R.push("~="),t.querySelectorAll(":checked").length||R.push(":checked"),t.querySelectorAll("a#"+B+"+*").length||R.push(".#.+[+~]")}),r(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=O.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&R.push("name"+nt+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&R.push(":enabled",":disabled"),D.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&R.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),R.push(",.*:")})),(C.matchesSelector=yt.test(j=D.matches||D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&r(function(t){C.disconnectedMatch=j.call(t,"*"),j.call(t,"[s!='']:x"),F.push("!=",ot)}),R=R.length&&new RegExp(R.join("|")),F=F.length&&new RegExp(F.join("|")),e=yt.test(D.compareDocumentPosition),z=e||yt.test(D.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},Y=e?function(t,e){if(t===e)return N=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!C.sortDetached&&e.compareDocumentPosition(t)===n?t===O||t.ownerDocument===G&&z(G,t)?-1:e===O||e.ownerDocument===G&&z(G,e)?1:T?tt(T,t)-tt(T,e):0:4&n?-1:1)}:function(t,e){if(t===e)return N=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,s=[t],u=[e];if(!r||!o)return t===O?-1:e===O?1:r?-1:o?1:T?tt(T,t)-tt(T,e):0;if(r===o)return a(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)u.unshift(n);for(;s[i]===u[i];)i++;return i?a(s[i],u[i]):s[i]===G?-1:u[i]===G?1:0},O):O},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==O&&k(t),n=n.replace(ct,"='$1']"),C.matchesSelector&&A&&!W[n+" "]&&(!F||!F.test(n))&&(!R||!R.test(n)))try{var i=j.call(t,n);if(i||C.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return e(n,O,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==O&&k(t),z(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==O&&k(t);var n=x.attrHandle[e.toLowerCase()],i=n&&X.call(x.attrHandle,e.toLowerCase())?n(t,e,!A):void 0;return void 0!==i?i:C.attributes||!A?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.escape=function(t){return(t+"").replace(bt,Ct)},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,r=0;if(N=!C.detectDuplicates,T=!C.sortStable&&t.slice(0),t.sort(Y),N){for(;e=t[r++];)e===t[r]&&(i=n.push(r));for(;i--;)t.splice(n[i],1)}return T=null,t},E=e.getText=function(t){var e,n="",i=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=E(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[i++];)n+=E(e);return n},x=e.selectors={cacheLength:50,createPseudo:i,match:pt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(_t,wt),t[3]=(t[3]||t[4]||t[5]||"").replace(_t,wt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return pt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&ht.test(n)&&(e=P(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(_t,wt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=q[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&q(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(r){var o=e.attr(r,t);return null==o?"!="===n:!n||(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(at," ")+" ").indexOf(i)>-1:"|="===n&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,u){var l,c,h,f,p,d,g=o!==a?"nextSibling":"previousSibling",y=e.parentNode,m=s&&e.nodeName.toLowerCase(),v=!u&&!s,_=!1;if(y){if(o){for(;g;){for(f=e;f=f[g];)if(s?f.nodeName.toLowerCase()===m:1===f.nodeType)return!1;d=g="only"===t&&!d&&"nextSibling"}return!0}if(d=[a?y.firstChild:y.lastChild],a&&v){for(f=y,h=f[B]||(f[B]={}),c=h[f.uniqueID]||(h[f.uniqueID]={}),l=c[t]||[],p=l[0]===U&&l[1],_=p&&l[2],f=p&&y.childNodes[p];f=++p&&f&&f[g]||(_=p=0)||d.pop();)if(1===f.nodeType&&++_&&f===e){c[t]=[U,p,_];break}}else if(v&&(f=e,h=f[B]||(f[B]={}),c=h[f.uniqueID]||(h[f.uniqueID]={}),l=c[t]||[],p=l[0]===U&&l[1],_=p),_===!1)for(;(f=++p&&f&&f[g]||(_=p=0)||d.pop())&&((s?f.nodeName.toLowerCase()!==m:1!==f.nodeType)||!++_||(v&&(h=f[B]||(f[B]={}),c=h[f.uniqueID]||(h[f.uniqueID]={}),c[t]=[U,_]),f!==e)););return _-=r,_===i||_%i===0&&_/i>=0}}},PSEUDO:function(t,n){var r,o=x.pseudos[t]||x.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[B]?o(n):o.length>1?(r=[t,t,"",n],x.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,e){for(var i,r=o(t,n),a=r.length;a--;)i=tt(t,r[a]),t[i]=!(e[i]=r[a])}):function(t){return o(t,0,r)}):o}},pseudos:{not:i(function(t){var e=[],n=[],r=M(t.replace(st,"$1"));return r[B]?i(function(t,e,n,i){for(var o,a=r(t,null,i,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,i,o){return e[0]=t,r(e,null,o,n),e[0]=null,!n.pop()}}),has:i(function(t){return function(n){return e(t,n).length>0}}),contains:i(function(t){return t=t.replace(_t,wt),function(e){return(e.textContent||e.innerText||E(e)).indexOf(t)>-1}}),lang:i(function(t){return ft.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(_t,wt).toLowerCase(),function(e){var n;do if(n=A?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===D},focus:function(t){return t===O.activeElement&&(!O.hasFocus||O.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:l(!1),disabled:l(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!x.pseudos.empty(t)},header:function(t){return gt.test(t.nodeName)},input:function(t){return dt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,n){return[n<0?n+e:n]}),even:c(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:c(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:c(function(t,e,n){for(var i=n<0?n+e:n;--i>=0;)t.push(i);return t}),gt:c(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}},x.pseudos.nth=x.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[b]=s(b);for(b in{submit:!0,reset:!0})x.pseudos[b]=u(b);return f.prototype=x.filters=x.pseudos,x.setFilters=new f,P=e.tokenize=function(t,n){var i,r,o,a,s,u,l,c=V[t+" "];if(c)return n?0:c.slice(0);for(s=t,u=[],l=x.preFilter;s;){i&&!(r=ut.exec(s))||(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),i=!1,(r=lt.exec(s))&&(i=r.shift(),o.push({value:i,type:r[0].replace(st," ")}),s=s.slice(i.length));for(a in x.filter)!(r=pt[a].exec(s))||l[a]&&!(r=l[a](r))||(i=r.shift(),o.push({value:i,type:a,matches:r}),s=s.slice(i.length));if(!i)break}return n?s.length:s?e.error(t):V(t,u).slice(0)},M=e.compile=function(t,e){var n,i=[],r=[],o=W[t+" "];if(!o){for(e||(e=P(t)),n=e.length;n--;)o=_(e[n]),o[B]?i.push(o):r.push(o);o=W(t,w(r,i)),o.selector=t}return o},L=e.select=function(t,e,n,i){var r,o,a,s,u,l="function"==typeof t&&t,c=!i&&P(t=l.selector||t);if(n=n||[],1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&9===e.nodeType&&A&&x.relative[o[1].type]){if(e=(x.find.ID(a.matches[0].replace(_t,wt),e)||[])[0],!e)return n;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(r=pt.needsContext.test(t)?0:o.length;r--&&(a=o[r],!x.relative[s=a.type]);)if((u=x.find[s])&&(i=u(a.matches[0].replace(_t,wt),vt.test(o[0].type)&&h(e.parentNode)||e))){if(o.splice(r,1),t=i.length&&p(o),!t)return $.apply(n,i),n;break}}return(l||M(t,c))(i,e,!A,n,!e||vt.test(t)&&h(e.parentNode)||e),n},C.sortStable=B.split("").sort(Y).join("")===B,C.detectDuplicates=!!N,k(),C.sortDetached=r(function(t){return 1&t.compareDocumentPosition(O.createElement("fieldset"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),C.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(et,function(t,e,n){var i;if(!n)return t[e]===!0?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),e}(a);wt.find=St,wt.expr=St.selectors,wt.expr[":"]=wt.expr.pseudos,wt.uniqueSort=wt.unique=St.uniqueSort,wt.text=St.getText,wt.isXMLDoc=St.isXML,wt.contains=St.contains,wt.escapeSelector=St.escape;var Pt=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&wt(t).is(n))break;i.push(t)}return i},Mt=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},Lt=wt.expr.match.needsContext,It=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,Tt=/^.[^:#\[\.,]*$/;wt.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?wt.find.matchesSelector(i,t)?[i]:[]:wt.find.matches(t,wt.grep(e,function(t){return 1===t.nodeType}))},wt.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(wt(t).filter(function(){for(e=0;e<i;e++)if(wt.contains(r[e],this))return!0}));for(n=this.pushStack([]),e=0;e<i;e++)wt.find(t,r[e],n);return i>1?wt.uniqueSort(n):n},filter:function(t){return this.pushStack(c(this,t||[],!1))},not:function(t){return this.pushStack(c(this,t||[],!0))},is:function(t){return!!c(this,"string"==typeof t&&Lt.test(t)?wt(t):t||[],!1).length}});var Nt,kt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Ot=wt.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||Nt,"string"==typeof t){if(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:kt.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof wt?e[0]:e,wt.merge(this,wt.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:st,!0)),It.test(i[1])&&wt.isPlainObject(e))for(i in e)wt.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return r=st.getElementById(i[2]),r&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):wt.isFunction(t)?void 0!==n.ready?n.ready(t):t(wt):wt.makeArray(t,this)};Ot.prototype=wt.fn,Nt=wt(st);var Dt=/^(?:parents|prev(?:Until|All))/,At={children:!0,contents:!0,next:!0,prev:!0};wt.fn.extend({has:function(t){var e=wt(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(wt.contains(this,e[t]))return!0})},closest:function(t,e){var n,i=0,r=this.length,o=[],a="string"!=typeof t&&wt(t);if(!Lt.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&wt.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?wt.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?ft.call(wt(t),this[0]):ft.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(wt.uniqueSort(wt.merge(this.get(),wt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),wt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return Pt(t,"parentNode")},parentsUntil:function(t,e,n){return Pt(t,"parentNode",n)},next:function(t){return h(t,"nextSibling")},prev:function(t){return h(t,"previousSibling")},nextAll:function(t){return Pt(t,"nextSibling")},prevAll:function(t){return Pt(t,"previousSibling")},nextUntil:function(t,e,n){return Pt(t,"nextSibling",n)},prevUntil:function(t,e,n){return Pt(t,"previousSibling",n)},siblings:function(t){return Mt((t.parentNode||{}).firstChild,t)},children:function(t){return Mt(t.firstChild)},contents:function(t){return t.contentDocument||wt.merge([],t.childNodes)}},function(t,e){wt.fn[t]=function(n,i){var r=wt.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=wt.filter(i,r)),this.length>1&&(At[t]||wt.uniqueSort(r),Dt.test(t)&&r.reverse()),this.pushStack(r)}});var Rt=/[^\x20\t\r\n\f]+/g;wt.Callbacks=function(t){t="string"==typeof t?f(t):wt.extend({},t);var e,n,i,r,o=[],a=[],s=-1,u=function(){for(r=t.once,i=e=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)o[s].apply(n[0],n[1])===!1&&t.stopOnFalse&&(s=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},l={add:function(){return o&&(n&&!e&&(s=o.length-1,a.push(n)),function e(n){wt.each(n,function(n,i){wt.isFunction(i)?t.unique&&l.has(i)||o.push(i):i&&i.length&&"string"!==wt.type(i)&&e(i)})}(arguments),n&&!e&&u()),this},remove:function(){return wt.each(arguments,function(t,e){for(var n;(n=wt.inArray(e,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(t){return t?wt.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=a=[],n||e||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=n||[],n=[t,n.slice?n.slice():n],a.push(n),e||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},wt.extend({Deferred:function(t){var e=[["notify","progress",wt.Callbacks("memory"),wt.Callbacks("memory"),2],["resolve","done",wt.Callbacks("once memory"),wt.Callbacks("once memory"),0,"resolved"],["reject","fail",wt.Callbacks("once memory"),wt.Callbacks("once memory"),1,"rejected"]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(t){return i.then(null,t)},pipe:function(){var t=arguments;return wt.Deferred(function(n){wt.each(e,function(e,i){var o=wt.isFunction(t[i[4]])&&t[i[4]];r[i[1]](function(){var t=o&&o.apply(this,arguments);t&&wt.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,o?[t]:arguments)})}),t=null}).promise()},then:function(t,n,i){function r(t,e,n,i){return function(){var u=this,l=arguments,c=function a(){var c,a;if(!(t<s)){if(c=n.apply(u,l),c===e.promise())throw new TypeError("Thenable self-resolution");a=c&&("object"==("undefined"==typeof c?"undefined":o(c))||"function"==typeof c)&&c.then,wt.isFunction(a)?i?a.call(c,r(s,e,p,i),r(s,e,d,i)):(s++,a.call(c,r(s,e,p,i),r(s,e,d,i),r(s,e,p,e.notifyWith))):(n!==p&&(u=void 0,l=[c]),(i||e.resolveWith)(u,l))}},h=i?c:function(){try{c()}catch(i){wt.Deferred.exceptionHook&&wt.Deferred.exceptionHook(i,h.stackTrace),t+1>=s&&(n!==d&&(u=void 0,l=[i]),e.rejectWith(u,l))}};t?h():(wt.Deferred.getStackHook&&(h.stackTrace=wt.Deferred.getStackHook()),a.setTimeout(h))}}var s=0;return wt.Deferred(function(o){e[0][3].add(r(0,o,wt.isFunction(i)?i:p,o.notifyWith)),e[1][3].add(r(0,o,wt.isFunction(t)?t:p)),e[2][3].add(r(0,o,wt.isFunction(n)?n:d))}).promise()},promise:function(t){return null!=t?wt.extend(t,i):i}},r={};return wt.each(e,function(t,o){var a=o[2],s=o[5];i[o[1]]=a.add,s&&a.add(function(){n=s},e[3-t][2].disable,e[0][2].lock),a.add(o[3].fire),r[o[0]]=function(){return r[o[0]+"With"](this===r?void 0:this,arguments),this},r[o[0]+"With"]=a.fireWith}),i.promise(r),t&&t.call(r,r),r},when:function(t){var e=arguments.length,n=e,i=Array(n),r=lt.call(arguments),o=wt.Deferred(),a=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?lt.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(g(t,o.done(a(n)).resolve,o.reject),"pending"===o.state()||wt.isFunction(r[n]&&r[n].then)))return o.then();for(;n--;)g(r[n],a(n),o.reject);return o.promise()}});var Ft=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;wt.Deferred.exceptionHook=function(t,e){a.console&&a.console.warn&&t&&Ft.test(t.name)&&a.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},wt.readyException=function(t){a.setTimeout(function(){throw t})};var jt=wt.Deferred();wt.fn.ready=function(t){return jt.then(t).catch(function(t){wt.readyException(t)}),this},wt.extend({isReady:!1,readyWait:1,holdReady:function(t){t?wt.readyWait++:wt.ready(!0)},ready:function(t){(t===!0?--wt.readyWait:wt.isReady)||(wt.isReady=!0,t!==!0&&--wt.readyWait>0||jt.resolveWith(st,[wt]))}}),wt.ready.then=jt.then,"complete"===st.readyState||"loading"!==st.readyState&&!st.documentElement.doScroll?a.setTimeout(wt.ready):(st.addEventListener("DOMContentLoaded",y),a.addEventListener("load",y));var zt=function t(e,n,i,r,o,a,s){var u=0,l=e.length,c=null==i;if("object"===wt.type(i)){o=!0;for(u in i)t(e,n,u,i[u],!0,a,s)}else if(void 0!==r&&(o=!0,wt.isFunction(r)||(s=!0),c&&(s?(n.call(e,r),n=null):(c=n,n=function(t,e,n){return c.call(wt(t),n)})),n))for(;u<l;u++)n(e[u],i,s?r:r.call(e[u],u,n(e[u],i)));return o?e:c?n.call(e):l?n(e[0],i):a},Bt=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};m.uid=1,m.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Bt(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[wt.camelCase(e)]=n;else for(i in e)r[wt.camelCase(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][wt.camelCase(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){wt.isArray(e)?e=e.map(wt.camelCase):(e=wt.camelCase(e),e=e in i?[e]:e.match(Rt)||[]),n=e.length;for(;n--;)delete i[e[n]]}(void 0===e||wt.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!wt.isEmptyObject(e)}};var Gt=new m,Ut=new m,Ht=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,qt=/[A-Z]/g;wt.extend({hasData:function(t){return Ut.hasData(t)||Gt.hasData(t)},data:function(t,e,n){return Ut.access(t,e,n)},removeData:function(t,e){Ut.remove(t,e)},_data:function(t,e,n){return Gt.access(t,e,n)},_removeData:function(t,e){Gt.remove(t,e)}}),wt.fn.extend({data:function(t,e){var n,i,r,a=this[0],s=a&&a.attributes;if(void 0===t){if(this.length&&(r=Ut.get(a),1===a.nodeType&&!Gt.get(a,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(i=s[n].name,0===i.indexOf("data-")&&(i=wt.camelCase(i.slice(5)),_(a,i,r[i])));Gt.set(a,"hasDataAttrs",!0)}return r}return"object"==("undefined"==typeof t?"undefined":o(t))?this.each(function(){Ut.set(this,t)}):zt(this,function(e){var n;if(a&&void 0===e){if(n=Ut.get(a,t),void 0!==n)return n;if(n=_(a,t),void 0!==n)return n}else this.each(function(){Ut.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){Ut.remove(this,t)})}}),wt.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=Gt.get(t,e),n&&(!i||wt.isArray(n)?i=Gt.access(t,e,wt.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=wt.queue(t,e),i=n.length,r=n.shift(),o=wt._queueHooks(t,e),a=function(){wt.dequeue(t,e)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,a,o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Gt.get(t,n)||Gt.access(t,n,{empty:wt.Callbacks("once memory").add(function(){Gt.remove(t,[e+"queue",n])})})}}),wt.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?wt.queue(this[0],t):void 0===e?this:this.each(function(){var n=wt.queue(this,t,e);wt._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&wt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){wt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=wt.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)n=Gt.get(o[a],t+"queueHooks"),n&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(e)}});var Vt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Wt=new RegExp("^(?:([+-])=|)("+Vt+")([a-z%]*)$","i"),Yt=["Top","Right","Bottom","Left"],Xt=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&wt.contains(t.ownerDocument,t)&&"none"===wt.css(t,"display")},Zt=function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];r=n.apply(t,i||[]);for(o in e)t.style[o]=a[o];return r},Jt={};wt.fn.extend({show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Xt(this)?wt(this).show():wt(this).hide()})}});var Kt=/^(?:checkbox|radio)$/i,$t=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,Qt=/^$|\/(?:java|ecma)script/i,te={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};te.optgroup=te.option,te.tbody=te.tfoot=te.colgroup=te.caption=te.thead,te.th=te.td;var ee=/<|&#?\w+;/;!function(){var t=st.createDocumentFragment(),e=t.appendChild(st.createElement("div")),n=st.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),vt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",vt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var ne=st.documentElement,ie=/^key/,re=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,oe=/^([^.]*)(?:\.(.+)|)/;wt.event={global:{},add:function(t,e,n,i,r){var o,a,s,u,l,c,h,f,p,d,g,y=Gt.get(t);if(y)for(n.handler&&(o=n,n=o.handler,r=o.selector),r&&wt.find.matchesSelector(ne,r),n.guid||(n.guid=wt.guid++),(u=y.events)||(u=y.events={}),(a=y.handle)||(a=y.handle=function(e){return"undefined"!=typeof wt&&wt.event.triggered!==e.type?wt.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(Rt)||[""],l=e.length;l--;)s=oe.exec(e[l])||[],p=g=s[1],d=(s[2]||"").split(".").sort(),p&&(h=wt.event.special[p]||{},p=(r?h.delegateType:h.bindType)||p,h=wt.event.special[p]||{},c=wt.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&wt.expr.match.needsContext.test(r),namespace:d.join(".")},o),(f=u[p])||(f=u[p]=[],f.delegateCount=0,h.setup&&h.setup.call(t,i,d,a)!==!1||t.addEventListener&&t.addEventListener(p,a)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?f.splice(f.delegateCount++,0,c):f.push(c),wt.event.global[p]=!0)},remove:function(t,e,n,i,r){var o,a,s,u,l,c,h,f,p,d,g,y=Gt.hasData(t)&&Gt.get(t);if(y&&(u=y.events)){for(e=(e||"").match(Rt)||[""],l=e.length;l--;)if(s=oe.exec(e[l])||[],p=g=s[1],d=(s[2]||"").split(".").sort(),p){for(h=wt.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,f=u[p]||[],s=s[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=f.length;o--;)c=f[o],!r&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(f.splice(o,1),c.selector&&f.delegateCount--,h.remove&&h.remove.call(t,c));a&&!f.length&&(h.teardown&&h.teardown.call(t,d,y.handle)!==!1||wt.removeEvent(t,p,y.handle),delete u[p])}else for(p in u)wt.event.remove(t,p+e[l],n,i,!0);wt.isEmptyObject(u)&&Gt.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,a,s=wt.event.fix(t),u=new Array(arguments.length),l=(Gt.get(this,"events")||{})[s.type]||[],c=wt.event.special[s.type]||{};for(u[0]=s,e=1;e<arguments.length;e++)u[e]=arguments[e];if(s.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,s)!==!1){for(a=wt.event.handlers.call(this,s,l),e=0;(r=a[e++])&&!s.isPropagationStopped();)for(s.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(o.namespace)||(s.handleObj=o,s.data=o.data,i=((wt.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,u),void 0!==i&&(s.result=i)===!1&&(s.preventDefault(),s.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,s),s.result}},handlers:function(t,e){var n,i,r,o,a,s=[],u=e.delegateCount,l=t.target;if(u&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||l.disabled!==!0)){for(o=[],a={},n=0;n<u;n++)i=e[n],r=i.selector+" ",void 0===a[r]&&(a[r]=i.needsContext?wt(r,this).index(l)>-1:wt.find(r,this,null,[l]).length),a[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return l=this,u<e.length&&s.push({elem:l,handlers:e.slice(u)}),s},addProp:function(t,e){Object.defineProperty(wt.Event.prototype,t,{enumerable:!0,configurable:!0,get:wt.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[wt.expando]?t:new wt.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==L()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===L()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&wt.nodeName(this,"input"))return this.click(),!1},_default:function(t){return wt.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},wt.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},wt.Event=function(t,e){return this instanceof wt.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?P:M,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&wt.extend(this,e),this.timeStamp=t&&t.timeStamp||wt.now(),void(this[wt.expando]=!0)):new wt.Event(t,e)},wt.Event.prototype={constructor:wt.Event,isDefaultPrevented:M,isPropagationStopped:M,isImmediatePropagationStopped:M,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=P,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=P,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=P,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},wt.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&ie.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&re.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},wt.event.addProp),wt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){wt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,r=t.relatedTarget,o=t.handleObj;return r&&(r===i||wt.contains(i,r))||(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),wt.fn.extend({on:function(t,e,n,i){return I(this,t,e,n,i)},one:function(t,e,n,i){return I(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,
wt(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==("undefined"==typeof t?"undefined":o(t))){for(r in t)this.off(r,e,t[r]);return this}return e!==!1&&"function"!=typeof e||(n=e,e=void 0),n===!1&&(n=M),this.each(function(){wt.event.remove(this,t,n,e)})}});var ae=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,se=/<script|<style|<link/i,ue=/checked\s*(?:[^=]|=\s*.checked.)/i,le=/^true\/(.*)/,ce=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;wt.extend({htmlPrefilter:function(t){return t.replace(ae,"<$1></$2>")},clone:function(t,e,n){var i,r,o,a,s=t.cloneNode(!0),u=wt.contains(t.ownerDocument,t);if(!(vt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||wt.isXMLDoc(t)))for(a=x(s),o=x(t),i=0,r=o.length;i<r;i++)D(o[i],a[i]);if(e)if(n)for(o=o||x(t),a=a||x(s),i=0,r=o.length;i<r;i++)O(o[i],a[i]);else O(t,s);return a=x(s,"script"),a.length>0&&E(a,!u&&x(t,"script")),s},cleanData:function(t){for(var e,n,i,r=wt.event.special,o=0;void 0!==(n=t[o]);o++)if(Bt(n)){if(e=n[Gt.expando]){if(e.events)for(i in e.events)r[i]?wt.event.remove(n,i):wt.removeEvent(n,i,e.handle);n[Gt.expando]=void 0}n[Ut.expando]&&(n[Ut.expando]=void 0)}}}),wt.fn.extend({detach:function(t){return R(this,t,!0)},remove:function(t){return R(this,t)},text:function(t){return zt(this,function(t){return void 0===t?wt.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return A(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=T(this,t);e.appendChild(t)}})},prepend:function(){return A(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=T(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return A(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return A(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(wt.cleanData(x(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return wt.clone(this,t,e)})},html:function(t){return zt(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!se.test(t)&&!te[($t.exec(t)||["",""])[1].toLowerCase()]){t=wt.htmlPrefilter(t);try{for(;n<i;n++)e=this[n]||{},1===e.nodeType&&(wt.cleanData(x(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return A(this,arguments,function(e){var n=this.parentNode;wt.inArray(this,t)<0&&(wt.cleanData(x(this)),n&&n.replaceChild(e,this))},t)}}),wt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){wt.fn[t]=function(t){for(var n,i=[],r=wt(t),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),wt(r[a])[e](n),ht.apply(i,n.get());return this.pushStack(i)}});var he=/^margin/,fe=new RegExp("^("+Vt+")(?!px)[a-z%]+$","i"),pe=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=a),e.getComputedStyle(t)};!function(){function t(){if(s){s.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",s.innerHTML="",ne.appendChild(o);var t=a.getComputedStyle(s);e="1%"!==t.top,r="2px"===t.marginLeft,n="4px"===t.width,s.style.marginRight="50%",i="4px"===t.marginRight,ne.removeChild(o),s=null}}var e,n,i,r,o=st.createElement("div"),s=st.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",vt.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",o.appendChild(s),wt.extend(vt,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return t(),n},pixelMarginRight:function(){return t(),i},reliableMarginLeft:function(){return t(),r}}))}();var de=/^(none|table(?!-c[ea]).+)/,ge={position:"absolute",visibility:"hidden",display:"block"},ye={letterSpacing:"0",fontWeight:"400"},me=["Webkit","Moz","ms"],ve=st.createElement("div").style;wt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=F(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,a,s,u=wt.camelCase(e),l=t.style;return e=wt.cssProps[u]||(wt.cssProps[u]=z(u)||u),s=wt.cssHooks[e]||wt.cssHooks[u],void 0===n?s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:l[e]:(a="undefined"==typeof n?"undefined":o(n),"string"===a&&(r=Wt.exec(n))&&r[1]&&(n=w(t,e,r),a="number"),void(null!=n&&n===n&&("number"===a&&(n+=r&&r[3]||(wt.cssNumber[u]?"":"px")),vt.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l[e]=n))))}},css:function(t,e,n,i){var r,o,a,s=wt.camelCase(e);return e=wt.cssProps[s]||(wt.cssProps[s]=z(s)||s),a=wt.cssHooks[e]||wt.cssHooks[s],a&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=F(t,e,i)),"normal"===r&&e in ye&&(r=ye[e]),""===n||n?(o=parseFloat(r),n===!0||isFinite(o)?o||0:r):r}}),wt.each(["height","width"],function(t,e){wt.cssHooks[e]={get:function(t,n,i){if(n)return!de.test(wt.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?U(t,e,i):Zt(t,ge,function(){return U(t,e,i)})},set:function(t,n,i){var r,o=i&&pe(t),a=i&&G(t,e,i,"border-box"===wt.css(t,"boxSizing",!1,o),o);return a&&(r=Wt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=wt.css(t,e)),B(t,n,a)}}}),wt.cssHooks.marginLeft=j(vt.reliableMarginLeft,function(t,e){if(e)return(parseFloat(F(t,"marginLeft"))||t.getBoundingClientRect().left-Zt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),wt.each({margin:"",padding:"",border:"Width"},function(t,e){wt.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+Yt[i]+e]=o[i]||o[i-2]||o[0];return r}},he.test(t)||(wt.cssHooks[t+e].set=B)}),wt.fn.extend({css:function(t,e){return zt(this,function(t,e,n){var i,r,o={},a=0;if(wt.isArray(e)){for(i=pe(t),r=e.length;a<r;a++)o[e[a]]=wt.css(t,e[a],!1,i);return o}return void 0!==n?wt.style(t,e,n):wt.css(t,e)},t,e,arguments.length>1)}}),wt.Tween=H,H.prototype={constructor:H,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||wt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(wt.cssNumber[n]?"":"px")},cur:function(){var t=H.propHooks[this.prop];return t&&t.get?t.get(this):H.propHooks._default.get(this)},run:function(t){var e,n=H.propHooks[this.prop];return this.options.duration?this.pos=e=wt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=wt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){wt.fx.step[t.prop]?wt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[wt.cssProps[t.prop]]&&!wt.cssHooks[t.prop]?t.elem[t.prop]=t.now:wt.style(t.elem,t.prop,t.now+t.unit)}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},wt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},wt.fx=H.prototype.init,wt.fx.step={};var _e,we,be=/^(?:toggle|show|hide)$/,Ce=/queueHooks$/;wt.Animation=wt.extend(J,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return w(n.elem,t,Wt.exec(e),n),n}]},tweener:function(t,e){wt.isFunction(t)?(e=t,t=["*"]):t=t.match(Rt);for(var n,i=0,r=t.length;i<r;i++)n=t[i],J.tweeners[n]=J.tweeners[n]||[],J.tweeners[n].unshift(e)},prefilters:[X],prefilter:function(t,e){e?J.prefilters.unshift(t):J.prefilters.push(t)}}),wt.speed=function(t,e,n){var i=t&&"object"==("undefined"==typeof t?"undefined":o(t))?wt.extend({},t):{complete:n||!n&&e||wt.isFunction(t)&&t,duration:t,easing:n&&e||e&&!wt.isFunction(e)&&e};return wt.fx.off||st.hidden?i.duration=0:"number"!=typeof i.duration&&(i.duration in wt.fx.speeds?i.duration=wt.fx.speeds[i.duration]:i.duration=wt.fx.speeds._default),null!=i.queue&&i.queue!==!0||(i.queue="fx"),i.old=i.complete,i.complete=function(){wt.isFunction(i.old)&&i.old.call(this),i.queue&&wt.dequeue(this,i.queue)},i},wt.fn.extend({fadeTo:function(t,e,n,i){return this.filter(Xt).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=wt.isEmptyObject(t),o=wt.speed(e,n,i),a=function(){var e=J(this,wt.extend({},t),o);(r||Gt.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=wt.timers,a=Gt.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&Ce.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||wt.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=Gt.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=wt.timers,a=i?i.length:0;for(n.finish=!0,wt.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),wt.each(["toggle","show","hide"],function(t,e){var n=wt.fn[e];wt.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(W(e,!0),t,i,r)}}),wt.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){wt.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),wt.timers=[],wt.fx.tick=function(){var t,e=0,n=wt.timers;for(_e=wt.now();e<n.length;e++)t=n[e],t()||n[e]!==t||n.splice(e--,1);n.length||wt.fx.stop(),_e=void 0},wt.fx.timer=function(t){wt.timers.push(t),t()?wt.fx.start():wt.timers.pop()},wt.fx.interval=13,wt.fx.start=function(){we||(we=a.requestAnimationFrame?a.requestAnimationFrame(q):a.setInterval(wt.fx.tick,wt.fx.interval))},wt.fx.stop=function(){a.cancelAnimationFrame?a.cancelAnimationFrame(we):a.clearInterval(we),we=null},wt.fx.speeds={slow:600,fast:200,_default:400},wt.fn.delay=function(t,e){return t=wt.fx?wt.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var i=a.setTimeout(e,t);n.stop=function(){a.clearTimeout(i)}})},function(){var t=st.createElement("input"),e=st.createElement("select"),n=e.appendChild(st.createElement("option"));t.type="checkbox",vt.checkOn=""!==t.value,vt.optSelected=n.selected,t=st.createElement("input"),t.value="t",t.type="radio",vt.radioValue="t"===t.value}();var xe,Ee=wt.expr.attrHandle;wt.fn.extend({attr:function(t,e){return zt(this,wt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){wt.removeAttr(this,t)})}}),wt.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof t.getAttribute?wt.prop(t,e,n):(1===o&&wt.isXMLDoc(t)||(r=wt.attrHooks[e.toLowerCase()]||(wt.expr.match.bool.test(e)?xe:void 0)),void 0!==n?null===n?void wt.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:(i=wt.find.attr(t,e),null==i?void 0:i))},attrHooks:{type:{set:function(t,e){if(!vt.radioValue&&"radio"===e&&wt.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(Rt);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),xe={set:function(t,e,n){return e===!1?wt.removeAttr(t,n):t.setAttribute(n,n),n}},wt.each(wt.expr.match.bool.source.match(/\w+/g),function(t,e){var n=Ee[e]||wt.find.attr;Ee[e]=function(t,e,i){var r,o,a=e.toLowerCase();return i||(o=Ee[a],Ee[a]=r,r=null!=n(t,e,i)?a:null,Ee[a]=o),r}});var Se=/^(?:input|select|textarea|button)$/i,Pe=/^(?:a|area)$/i;wt.fn.extend({prop:function(t,e){return zt(this,wt.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[wt.propFix[t]||t]})}}),wt.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&wt.isXMLDoc(t)||(e=wt.propFix[e]||e,r=wt.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=wt.find.attr(t,"tabindex");return e?parseInt(e,10):Se.test(t.nodeName)||Pe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),vt.optSelected||(wt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),wt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){wt.propFix[this.toLowerCase()]=this}),wt.fn.extend({addClass:function(t){var e,n,i,r,o,a,s,u=0;if(wt.isFunction(t))return this.each(function(e){wt(this).addClass(t.call(this,e,$(this)))});if("string"==typeof t&&t)for(e=t.match(Rt)||[];n=this[u++];)if(r=$(n),i=1===n.nodeType&&" "+K(r)+" "){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");s=K(i),r!==s&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,i,r,o,a,s,u=0;if(wt.isFunction(t))return this.each(function(e){wt(this).removeClass(t.call(this,e,$(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(Rt)||[];n=this[u++];)if(r=$(n),i=1===n.nodeType&&" "+K(r)+" "){for(a=0;o=e[a++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");s=K(i),r!==s&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n="undefined"==typeof t?"undefined":o(t);return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):wt.isFunction(t)?this.each(function(n){wt(this).toggleClass(t.call(this,n,$(this),e),e)}):this.each(function(){var e,i,r,o;if("string"===n)for(i=0,r=wt(this),o=t.match(Rt)||[];e=o[i++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==n||(e=$(this),e&&Gt.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||t===!1?"":Gt.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+K($(n))+" ").indexOf(e)>-1)return!0;return!1}});var Me=/\r/g;wt.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=wt.isFunction(t),this.each(function(n){var r;1===this.nodeType&&(r=i?t.call(this,n,wt(this).val()):t,null==r?r="":"number"==typeof r?r+="":wt.isArray(r)&&(r=wt.map(r,function(t){return null==t?"":t+""})),e=wt.valHooks[this.type]||wt.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=wt.valHooks[r.type]||wt.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:(n=r.value,"string"==typeof n?n.replace(Me,""):null==n?"":n)):void 0}}),wt.extend({valHooks:{option:{get:function(t){var e=wt.find.attr(t,"value");return null!=e?e:K(wt.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,a="select-one"===t.type,s=a?null:[],u=a?o+1:r.length;for(i=o<0?u:a?o:0;i<u;i++)if(n=r[i],(n.selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!wt.nodeName(n.parentNode,"optgroup"))){if(e=wt(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,i,r=t.options,o=wt.makeArray(e),a=r.length;a--;)i=r[a],(i.selected=wt.inArray(wt.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),wt.each(["radio","checkbox"],function(){wt.valHooks[this]={set:function(t,e){if(wt.isArray(e))return t.checked=wt.inArray(wt(t).val(),e)>-1}},vt.checkOn||(wt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Le=/^(?:focusinfocus|focusoutblur)$/;wt.extend(wt.event,{trigger:function(t,e,n,i){var r,s,u,l,c,h,f,p=[n||st],d=gt.call(t,"type")?t.type:t,g=gt.call(t,"namespace")?t.namespace.split("."):[];if(s=u=n=n||st,3!==n.nodeType&&8!==n.nodeType&&!Le.test(d+wt.event.triggered)&&(d.indexOf(".")>-1&&(g=d.split("."),d=g.shift(),g.sort()),c=d.indexOf(":")<0&&"on"+d,t=t[wt.expando]?t:new wt.Event(d,"object"==("undefined"==typeof t?"undefined":o(t))&&t),t.isTrigger=i?2:3,t.namespace=g.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:wt.makeArray(e,[t]),f=wt.event.special[d]||{},i||!f.trigger||f.trigger.apply(n,e)!==!1)){if(!i&&!f.noBubble&&!wt.isWindow(n)){for(l=f.delegateType||d,Le.test(l+d)||(s=s.parentNode);s;s=s.parentNode)p.push(s),u=s;u===(n.ownerDocument||st)&&p.push(u.defaultView||u.parentWindow||a)}for(r=0;(s=p[r++])&&!t.isPropagationStopped();)t.type=r>1?l:f.bindType||d,h=(Gt.get(s,"events")||{})[t.type]&&Gt.get(s,"handle"),h&&h.apply(s,e),h=c&&s[c],h&&h.apply&&Bt(s)&&(t.result=h.apply(s,e),t.result===!1&&t.preventDefault());return t.type=d,i||t.isDefaultPrevented()||f._default&&f._default.apply(p.pop(),e)!==!1||!Bt(n)||c&&wt.isFunction(n[d])&&!wt.isWindow(n)&&(u=n[c],u&&(n[c]=null),wt.event.triggered=d,n[d](),wt.event.triggered=void 0,u&&(n[c]=u)),t.result}},simulate:function(t,e,n){var i=wt.extend(new wt.Event,n,{type:t,isSimulated:!0});wt.event.trigger(i,null,e)}}),wt.fn.extend({trigger:function(t,e){return this.each(function(){wt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return wt.event.trigger(t,e,n,!0)}}),wt.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){wt.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),wt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),vt.focusin="onfocusin"in a,vt.focusin||wt.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){wt.event.simulate(e,t.target,wt.event.fix(t))};wt.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=Gt.access(i,e);r||i.addEventListener(t,n,!0),Gt.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=Gt.access(i,e)-1;r?Gt.access(i,e,r):(i.removeEventListener(t,n,!0),Gt.remove(i,e))}}});var Ie=a.location,Te=wt.now(),Ne=/\?/;wt.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new a.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||wt.error("Invalid XML: "+t),e};var ke=/\[\]$/,Oe=/\r?\n/g,De=/^(?:submit|button|image|reset|file)$/i,Ae=/^(?:input|select|textarea|keygen)/i;wt.param=function(t,e){var n,i=[],r=function(t,e){var n=wt.isFunction(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(wt.isArray(t)||t.jquery&&!wt.isPlainObject(t))wt.each(t,function(){r(this.name,this.value)});else for(n in t)Q(n,t[n],e,r);return i.join("&")},wt.fn.extend({serialize:function(){return wt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=wt.prop(this,"elements");return t?wt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!wt(this).is(":disabled")&&Ae.test(this.nodeName)&&!De.test(t)&&(this.checked||!Kt.test(t))}).map(function(t,e){var n=wt(this).val();return null==n?null:wt.isArray(n)?wt.map(n,function(t){return{name:e.name,value:t.replace(Oe,"\r\n")}}):{name:e.name,value:n.replace(Oe,"\r\n")}}).get()}});var Re=/%20/g,Fe=/#.*$/,je=/([?&])_=[^&]*/,ze=/^(.*?):[ \t]*([^\r\n]*)$/gm,Be=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ge=/^(?:GET|HEAD)$/,Ue=/^\/\//,He={},qe={},Ve="*/".concat("*"),We=st.createElement("a");We.href=Ie.href,wt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ie.href,type:"GET",isLocal:Be.test(Ie.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ve,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":wt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?nt(nt(t,wt.ajaxSettings),e):nt(wt.ajaxSettings,t)},ajaxPrefilter:tt(He),ajaxTransport:tt(qe),ajax:function(t,e){function n(t,e,n,o){var u,c,p,d,b,C=e;h||(h=!0,l&&a.clearTimeout(l),i=void 0,s=o||"",E.readyState=t>0?4:0,u=t>=200&&t<300||304===t,n&&(d=it(g,E,n)),d=rt(g,d,E,u),u?(g.ifModified&&(b=E.getResponseHeader("Last-Modified"),b&&(wt.lastModified[r]=b),b=E.getResponseHeader("etag"),b&&(wt.etag[r]=b)),204===t||"HEAD"===g.type?C="nocontent":304===t?C="notmodified":(C=d.state,c=d.data,p=d.error,u=!p)):(p=C,!t&&C||(C="error",t<0&&(t=0))),E.status=t,E.statusText=(e||C)+"",u?v.resolveWith(y,[c,C,E]):v.rejectWith(y,[E,C,p]),E.statusCode(w),w=void 0,f&&m.trigger(u?"ajaxSuccess":"ajaxError",[E,g,u?c:p]),_.fireWith(y,[E,C]),f&&(m.trigger("ajaxComplete",[E,g]),--wt.active||wt.event.trigger("ajaxStop")))}"object"==("undefined"==typeof t?"undefined":o(t))&&(e=t,t=void 0),e=e||{};var i,r,s,u,l,c,h,f,p,d,g=wt.ajaxSetup({},e),y=g.context||g,m=g.context&&(y.nodeType||y.jquery)?wt(y):wt.event,v=wt.Deferred(),_=wt.Callbacks("once memory"),w=g.statusCode||{},b={},C={},x="canceled",E={readyState:0,getResponseHeader:function(t){var e;if(h){if(!u)for(u={};e=ze.exec(s);)u[e[1].toLowerCase()]=e[2];e=u[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return h?s:null},setRequestHeader:function(t,e){return null==h&&(t=C[t.toLowerCase()]=C[t.toLowerCase()]||t,b[t]=e),this},overrideMimeType:function(t){return null==h&&(g.mimeType=t),this},statusCode:function(t){var e;if(t)if(h)E.always(t[E.status]);else for(e in t)w[e]=[w[e],t[e]];return this},abort:function(t){var e=t||x;return i&&i.abort(e),n(0,e),this}};if(v.promise(E),g.url=((t||g.url||Ie.href)+"").replace(Ue,Ie.protocol+"//"),g.type=e.method||e.type||g.method||g.type,g.dataTypes=(g.dataType||"*").toLowerCase().match(Rt)||[""],null==g.crossDomain){c=st.createElement("a");try{c.href=g.url,c.href=c.href,g.crossDomain=We.protocol+"//"+We.host!=c.protocol+"//"+c.host}catch(t){g.crossDomain=!0}}if(g.data&&g.processData&&"string"!=typeof g.data&&(g.data=wt.param(g.data,g.traditional)),et(He,g,e,E),h)return E;f=wt.event&&g.global,f&&0===wt.active++&&wt.event.trigger("ajaxStart"),g.type=g.type.toUpperCase(),g.hasContent=!Ge.test(g.type),r=g.url.replace(Fe,""),g.hasContent?g.data&&g.processData&&0===(g.contentType||"").indexOf("application/x-www-form-urlencoded")&&(g.data=g.data.replace(Re,"+")):(d=g.url.slice(r.length),g.data&&(r+=(Ne.test(r)?"&":"?")+g.data,delete g.data),g.cache===!1&&(r=r.replace(je,"$1"),d=(Ne.test(r)?"&":"?")+"_="+Te++ +d),g.url=r+d),g.ifModified&&(wt.lastModified[r]&&E.setRequestHeader("If-Modified-Since",wt.lastModified[r]),wt.etag[r]&&E.setRequestHeader("If-None-Match",wt.etag[r])),(g.data&&g.hasContent&&g.contentType!==!1||e.contentType)&&E.setRequestHeader("Content-Type",g.contentType),E.setRequestHeader("Accept",g.dataTypes[0]&&g.accepts[g.dataTypes[0]]?g.accepts[g.dataTypes[0]]+("*"!==g.dataTypes[0]?", "+Ve+"; q=0.01":""):g.accepts["*"]);for(p in g.headers)E.setRequestHeader(p,g.headers[p]);if(g.beforeSend&&(g.beforeSend.call(y,E,g)===!1||h))return E.abort();if(x="abort",_.add(g.complete),E.done(g.success),E.fail(g.error),i=et(qe,g,e,E)){if(E.readyState=1,f&&m.trigger("ajaxSend",[E,g]),h)return E;g.async&&g.timeout>0&&(l=a.setTimeout(function(){E.abort("timeout")},g.timeout));try{h=!1,i.send(b,n)}catch(t){if(h)throw t;n(-1,t)}}else n(-1,"No Transport");return E},getJSON:function(t,e,n){return wt.get(t,e,n,"json")},getScript:function(t,e){return wt.get(t,void 0,e,"script")}}),wt.each(["get","post"],function(t,e){wt[e]=function(t,n,i,r){return wt.isFunction(n)&&(r=r||i,i=n,n=void 0),wt.ajax(wt.extend({url:t,type:e,dataType:r,data:n,success:i},wt.isPlainObject(t)&&t))}}),wt._evalUrl=function(t){return wt.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},wt.fn.extend({wrapAll:function(t){var e;return this[0]&&(wt.isFunction(t)&&(t=t.call(this[0])),e=wt(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return wt.isFunction(t)?this.each(function(e){wt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=wt(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=wt.isFunction(t);return this.each(function(n){wt(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){wt(this).replaceWith(this.childNodes)}),this}}),wt.expr.pseudos.hidden=function(t){return!wt.expr.pseudos.visible(t)},wt.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},wt.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(t){}};var Ye={0:200,1223:204},Xe=wt.ajaxSettings.xhr();vt.cors=!!Xe&&"withCredentials"in Xe,vt.ajax=Xe=!!Xe,wt.ajaxTransport(function(t){var e,n;if(vt.cors||Xe&&!t.crossDomain)return{send:function(i,r){var o,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)s[o]=t.xhrFields[o];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(o in i)s.setRequestHeader(o,i[o]);e=function(t){return function(){e&&(e=n=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?r(0,"error"):r(s.status,s.statusText):r(Ye[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=e(),n=s.onerror=e("error"),void 0!==s.onabort?s.onabort=n:s.onreadystatechange=function(){4===s.readyState&&a.setTimeout(function(){e&&n()})},e=e("abort");try{s.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),wt.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),wt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return wt.globalEval(t),t}}}),wt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),wt.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(i,r){e=wt("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),st.head.appendChild(e[0])},abort:function(){n&&n()}}}});var Ze=[],Je=/(=)\?(?=&|$)|\?\?/;wt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ze.pop()||wt.expando+"_"+Te++;return this[t]=!0,t}}),wt.ajaxPrefilter("json jsonp",function(t,e,n){var i,r,o,s=t.jsonp!==!1&&(Je.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Je.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=wt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Je,"$1"+i):t.jsonp!==!1&&(t.url+=(Ne.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||wt.error(i+" was not called"),o[0]},t.dataTypes[0]="json",r=a[i],a[i]=function(){o=arguments},n.always(function(){void 0===r?wt(a).removeProp(i):a[i]=r,t[i]&&(t.jsonpCallback=e.jsonpCallback,Ze.push(i)),o&&wt.isFunction(r)&&r(o[0]),o=r=void 0}),"script"}),vt.createHTMLDocument=function(){var t=st.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),wt.parseHTML=function(t,e,n){if("string"!=typeof t)return[];"boolean"==typeof e&&(n=e,e=!1);var i,r,o;return e||(vt.createHTMLDocument?(e=st.implementation.createHTMLDocument(""),i=e.createElement("base"),i.href=st.location.href,e.head.appendChild(i)):e=st),r=It.exec(t),o=!n&&[],r?[e.createElement(r[1])]:(r=S([t],e,o),o&&o.length&&wt(o).remove(),wt.merge([],r.childNodes))},wt.fn.load=function(t,e,n){var i,r,a,s=this,u=t.indexOf(" ");return u>-1&&(i=K(t.slice(u)),t=t.slice(0,u)),wt.isFunction(e)?(n=e,e=void 0):e&&"object"==("undefined"==typeof e?"undefined":o(e))&&(r="POST"),s.length>0&&wt.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){a=arguments,s.html(i?wt("<div>").append(wt.parseHTML(t)).find(i):t)}).always(n&&function(t,e){s.each(function(){n.apply(this,a||[t.responseText,e,t])})}),this},wt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){wt.fn[e]=function(t){return this.on(e,t)}}),wt.expr.pseudos.animated=function(t){return wt.grep(wt.timers,function(e){return t===e.elem}).length},wt.offset={setOffset:function(t,e,n){var i,r,o,a,s,u,l,c=wt.css(t,"position"),h=wt(t),f={};"static"===c&&(t.style.position="relative"),s=h.offset(),o=wt.css(t,"top"),u=wt.css(t,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(i=h.position(),a=i.top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(u)||0),wt.isFunction(e)&&(e=e.call(t,n,wt.extend({},s))),null!=e.top&&(f.top=e.top-s.top+a),null!=e.left&&(f.left=e.left-s.left+r),"using"in e?e.using.call(t,f):h.css(f)}},wt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){wt.offset.setOffset(this,t,e)});var e,n,i,r,o=this[0];return o?o.getClientRects().length?(i=o.getBoundingClientRect(),i.width||i.height?(r=o.ownerDocument,n=ot(r),e=r.documentElement,{top:i.top+n.pageYOffset-e.clientTop,left:i.left+n.pageXOffset-e.clientLeft}):i):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===wt.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),wt.nodeName(t[0],"html")||(i=t.offset()),i={top:i.top+wt.css(t[0],"borderTopWidth",!0),left:i.left+wt.css(t[0],"borderLeftWidth",!0)}),{top:e.top-i.top-wt.css(n,"marginTop",!0),left:e.left-i.left-wt.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===wt.css(t,"position");)t=t.offsetParent;return t||ne})}}),wt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;wt.fn[t]=function(i){return zt(this,function(t,i,r){var o=ot(t);return void 0===r?o?o[e]:t[i]:void(o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r)},t,i,arguments.length)}}),wt.each(["top","left"],function(t,e){wt.cssHooks[e]=j(vt.pixelPosition,function(t,n){if(n)return n=F(t,e),fe.test(n)?wt(t).position()[e]+"px":n})}),wt.each({Height:"height",Width:"width"},function(t,e){wt.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){wt.fn[i]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||o===!0?"margin":"border");return zt(this,function(e,n,r){
var o;return wt.isWindow(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?wt.css(e,n,s):wt.style(e,n,r,s)},e,a?r:void 0,a)}})}),wt.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),wt.parseJSON=JSON.parse,n(6)&&(i=[],r=function(){return wt}.apply(e,i),!(void 0!==r&&(t.exports=r)));var Ke=a.jQuery,$e=a.$;return wt.noConflict=function(t){return a.$===wt&&(a.$=$e),t&&a.jQuery===wt&&(a.jQuery=Ke),wt},s||(a.jQuery=a.$=wt),wt})}).call(e,n(5)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};n.lerp=function(t,e,n){return t+n*(e-t)},e.default=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};n.numberSafeCompareFunction=function(t,e){return t>e?1:t<e?-1:0},n.binarySearch=function(t,e,i){for(var r,o,a=i||n.numberSafeCompareFunction,s=0,u=t.length,l=!1;s<u;)r=s+(u-s>>1),o=+a(t[r],e),o<0?s=r+1:(u=r,l=!o);return l?s:~s},n.extend=function(t,e){var n=void 0,i=Array.isArray(e)?e:[e],r=i.length;for(n=0;n<r;n++)t[t.length]=i[n];return 0},e.default=n},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){for(var n=[],i=void 0,r=void 0,o=0;o<t.length;)if("{"===t.charAt(o))if(i=t.indexOf("}",o+1),i===-1)o++;else if(r=parseInt(t.substring(o+1,i)),!isNaN(r)&&r>=0){var a=t.substring(0,o);""!==a&&n.push(a),n.push(r),o=0,t=t.substring(i+1)}else o=i+1;else o++;if(""!==t&&n.push(t),t=n,1===t.length&&"string"==typeof t[0])return t[0];var s="";if(0===t.length&&e){for(o=0;o<e.length;o++)s+=e[o];return s}for(o=0,i=t.length;o<i;o++)"string"==typeof t[o]?s+=t[o]:e&&t[o]<e.length&&(s+=e[t[o]]);return s}function a(t,e,n){t.type;return t=o(t[l.default.show_language],n),e+":"+t}Object.defineProperty(e,"__esModule",{value:!0}),e.WarnException=void 0;var s=n(10),u=(r(s),n(14)),l=i(u);e.WarnException=function(t){for(var e=void 0,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.length>0&&(e=i.shift()),a(t,e,i)}},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.syncGetJson=e.arrayToStr=e.strToArray=e.getLocation=e.aAToa_a=e.a_aToaA=e.formatURLByHost=e.formatURL=e.formatURL2=e.rename=e.formatString=e.indexOf=e.falseFn=e.createGuid=e.json2xmlAndaAToa_a=e.json2xml=e.xmlToJson=e.strToXml=e.jsonSyncPromise=e.isColor=e.xmlPromise=e.filterUnit=e.isAddUnit=e.isArray=e.isStrNumber=e.isNumber=e.isString=e.getJsonLength=e.toBooleanTrueOrFlse=e.isTrueOrFalse=e.isBoolean=e.isObject=e.isJson=e.math=e.array=e.$=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(4),s=r(a),u=n(11),l=r(u),c=n(12),h=r(c),f=n(9),p=(i(f),n(13)),d=(r(p),e.$=s.default);e.array=h.default,e.math=l.default,e.isJson=function(t){if(!d.isPlainObject(t))return!1;try{return JSON.stringify(t),!0}catch(t){return!1}},e.isObject=function(t){return"object"===("undefined"==typeof t?"undefined":o(t))&&null!==t},e.isBoolean=function(t){return"boolean"==typeof t},e.isTrueOrFalse=function(t){return"boolean"==typeof t||"true"===t||"false"===t},e.toBooleanTrueOrFlse=function(t){return t===!0||"true"===t||"TRUE"===t||t!==!1&&"false"!==t&&"FALSE"!==t&&void 0};"debug"in console||(console.debug=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log.apply(void 0,e)});var g=(e.getJsonLength=function(t){var e=0;for(var n in t)e++;return e},e.isString=function(t){return"string"==typeof t&&t.constructor===String}),y=e.isNumber=function(t){return"number"==typeof t&&t.constructor===Number},m=(e.isStrNumber=function(t){return g(t)?!isNaN(parseFloat(t)):"number"==typeof t&&t.constructor===Number},e.isArray=function(t){return t instanceof Array},e.isAddUnit=function(t){var e=new RegExp(/^(\-|\+)?\d+(m|px)?$/);return e.test(t)},e.filterUnit=function(t){return y(t)?t:Number(t.match(/^(\-|\+)?\d+/)[0])},e.xmlPromise=function(t){return d.ajax({url:t,type:"get",dataType:"xml"})},e.isColor=function(t){var e=new RegExp("^#([0-9a-fA-F]{6}|[0-9a-fA-F]{8})$");return e.test(t)},e.jsonSyncPromise=function(t){return d.ajax({url:t,type:"get",dataType:"json",async:!1})},e.strToXml=function(t){return(new DOMParser).parseFromString(t,"text/xml")},e.xmlToJson=function t(e){var n={};if(1===e.nodeType){if(e.attributes.length>0)for(var i=0;i<e.attributes.length;i+=1){var r=e.attributes.item(i);n[r.nodeName]=r.nodeValue}}else 3===e.nodeType&&(n=e.nodeValue);if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o+=1){var a=e.childNodes.item(o),s=a.nodeName;if("undefined"==typeof n[s]){var u=null;"#cdata-section"===s.toLowerCase()?(u=CDATAtoSTR(e.innerHTML),s="value"):u=t(a),"#text"===s&&""===u.replace(/^\s+/g,"")||"#comment"===s||("#text"===s?n=u:n[s]=u)}else{if("undefined"==typeof n[s].length){var l=n[s];n[s]=[],n[s].push(l)}n[s].push(t(a))}}return n},e.json2xml=function t(e,n){var i="";if(e instanceof Array){var r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;i+=t(l,n)}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}else if(e instanceof Object){n&&(i+="<"+n+">");for(var c in e)i+=t(e[c],c);n&&(i+="</"+n+">")}else i+="<"+n+">"+e+"</"+n+">";return i},e.json2xmlAndaAToa_a=function t(e,n){var i="";if(e instanceof Array){var r=!0,o=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;i+=t(l,n)}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}}else if(e instanceof Object){n&&(i+="<"+m(n)+">");for(var c in e)i+=t(e[c],c);n&&(i+="</"+m(n)+">")}else i+="<"+m(n)+">"+e+"</"+m(n)+">";return i},e.createGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"===t?e:3&e|8;return n.toString(16)})},e.falseFn=function(){return!1},e.indexOf=function(t,e,n){for(var i in e)if(e[i][n]===t[n])return i;return-1},e.formatString=function(t,e){if(0!==e.length){var n=!0,i=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=new RegExp("{"+s.k+"}","gm");t=t.replace(u,s.v)}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}return t}return t},e.rename=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments[1],n=arguments[2],i=arguments[3],r=0,o=function t(e,n,i,o){for(var a in n){var s=void 0;if(s=i?n[a][i]:n[a],s&&e===s&&n[a]!==o)return t(e+"_"+ ++r,n,i,o)}return e};return o(t,e,n,i)},e.formatURL2=function(t,e){if(e){var n=e.split("/"),i=t;if(!i)return e;i=i.split("/"),i.pop();for(var r="",o=0;o<n.length;o+=1)0===o&&"."===n[o]&&(o+=1),".."===n[o]?i.pop():i.push(n[o]);for(var a=0;a<i.length;a+=1){var s=a===i.length-1?"":"/";r+=i[a]+s}return r}},e.formatURL=function(t){if(t){var e=t.split("/"),n=window.location.href;if(!n)return t;n=n.split("/"),n.pop();for(var i="",r=0;r<e.length;r+=1)0===r&&"."===e[r]&&(r+=1),".."===e[r]?n.pop():n.push(e[r]);for(var o=0;o<n.length;o+=1){var a=o===n.length-1?"":"/";i+=n[o]+a}return i}},e.formatURLByHost=function(t){if(t){var e=window.location.origin;if(!e)return t;for(var n=t.split("/"),i=[e],r="",o=0;o<n.length;o+=1)0===o&&"."===n[o]&&(o+=1),".."===n[o]?o+=1:i.push(n[o]);for(var a=0;a<i.length;a+=1){var s=a===i.length-1?"":"/";r+=i[a]+s}return r}},e.a_aToaA=function(t){return t.replace(/_[a-z]/g,function(t){return t.toUpperCase().charAt(1)})},e.aAToa_a=function(t){return t.replace(/[A-Z]/g,function(t){return"_"+t.toLowerCase()})});e.getLocation=function(t){var e={dir:"",filename:""};new RegExp(/^http:\/\//g).test(t)&&(t=t.substring(6));for(var n=t.split("/"),i=0;i<n.length;i++)i===n.length-1?(e.dir+="/",e.filename=n[i]):null!==n[i]&&""!==n[i]&&(e.dir+="/"+n[i]);return e.dir="http:/"+e.dir,e},e.strToArray=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float",n=[];if("string"!=typeof t)return n;var i=t.split(",");return i?(i instanceof Array||(i=[i]),i.forEach(function(t){if("string"==typeof t){var e=t.split(" ");if(e&&1===e.length)n.push(e[0]);else if(e&&e.length>1){for(var i=[],r=0;r<e.length;r++)i.push(parseFloat(e[r]));n.push(i)}}}),"string"===e||"String"===e||"STRING"===e?n:(n.forEach(function(t,n,i){if(t instanceof Array)t.forEach(function(t,n,i){switch(e){case"float":i[n]=parseFloat(t)}});else switch(e){case"float":i[n]=parseFloat(t)}}),n)):n},e.arrayToStr=function(t){var e="";if(!(t&&t instanceof Array&&0!==t.length))return"";for(var n=0;n<t.length;n++){0!==n&&(e+=",");var i=t[n];if(i instanceof Array)for(var r=0;r<i.length;r++)0!==r&&(e+=" "),e+=""+i[r];else e+=""+i}return e},e.syncGetJson=function(t){var e=d.ajax({async:!1,url:t,dataType:"text"});if(4===e.readyState&&200===e.status)return JSON.parse(e.responseText)}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};n.lerp=function(t,e,n){return t+n*(e-t)},e.default=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};n.numberSafeCompareFunction=function(t,e){return t>e?1:t<e?-1:0},n.binarySearch=function(t,e,i){for(var r,o,a=i||n.numberSafeCompareFunction,s=0,u=t.length,l=!1;s<u;)r=s+(u-s>>1),o=+a(t[r],e),o<0?s=r+1:(u=r,l=!o);return l?s:~s},n.extend=function(t,e){var n=void 0,i=Array.isArray(e)?e:[e],r=i.length;for(n=0;n<r;n++)t[t.length]=i[n];return 0},e.default=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={show_language:"zh",ERROR_PARAMS:{type:"error",zh:"参数错误"},ERRAR_PARAMS_ONLY:{type:"error",zh:"参数错误,只能是:"},ERROR_GVML_FILE_PARSE:{type:"error",zh:"Uninpho文件解析失败，请检查是否拼写错误。"},ERROR_GVML_FILE_READ:{type:"error",zh:"Uninpho文件读取失败，请检查路径是否错误。"},ERROR_PARAMS_BOOLEAN:{type:"error",zh:"参数必须是布尔类型"},ERROR_PARAMS_FUNCTION:{type:"error",zh:"参数不是一个有效的函数类型"},ERROR_ANIMATE_TYPE:{type:"error",zh:"不是一个有效的动画类型"},UNDEFINED_PARENT_CONTAINER:{type:"error",zh:"父容器未定义"},UNDEFINED_DOM:{type:"error",zh:"页面未包含相应元素"},UNDEFINED_PLUGINPANEL:{type:"error",zh:"未定义插件面板"},UNDEFINED_PLUGIN_TYPE:{type:"error",zh:"未定义插件类型,必须指定,类型查看Uninpho.PluginType"},UNDEFINED_EXCEPTION:{type:"error",zh:"未定义(undefined)异常"},UNDEFINED_PLUGIN:{type:"error",zh:"未定义插件，请检查插件参数是否正确，或者提前注册该插件！"},ERROR_PLUGIN_TYPE:{type:"error",zh:"插件类型指定错误,请检查自己的Uninpho数据是否错误"},ERROR_PLUGIN_URL:{type:"error",zh:"错误插件路径，请检查路径是否指向真实插件路径"},ERROR_IMAGE_SOURCE:{type:"error",zh:"未指定图层数据源或者图层数据源指定错误"},ERROR_BASEIMAGE_DEFINITION:{type:"error",zh:"基础图层定义错误"},ERROR_POLYLINE_LENGTH:{type:"error",zh:"Polyline最少需要2个折点"},ERROR_POLYGON_LENGTH:{type:"error",zh:"多边形最少需要3个折点"},centerMessage:{managerService:{error:{zh:"获取所有服务列表失败"}}},UNDEFINED_CACHE_OPTION_PARAM:{type:"error",zh:'CacheOption的driver设置有误，须为"filesystem"或"leveldb"'},WARN_PARAMS_RANGE:{type:"warn",zh:"参数范围错误:{0}  取值范围:{1} 单位或枚举:{2}, 使用默认参数 {3}"},WARN_PARAMS_RANGE_NONE:{type:"warn",zh:"参数范围错误---参数:{0} 取值范围:{1}, 使用默认参数 {2}"},WARN_PARAMS_RANGE_NONEDEFAULT:{type:"warn",zh:"参数范围错误---参数:{0} 取值范围:{1}"},WARN_PARAMS:{type:"warn",zh:"参数:{0}--参数类型错误 参数类型:{1}, 使用默认参数 {2}"},WARN_PARAMS_NONE:{type:"warn",zh:"参数类型错误---参数:{0} 参数类型:{1}"},WARN_CORLOR:{type:"warn",zh:"参数:{0}--参数类型错误,参数应为十六进制颜色#FFFFFFFF或#FFFFFF,使用默认参数:{1}"},WARN_ARRAY_ELEMENT_TYPE:{type:"warn",zh:"参数类型错误---参数:{0} 数组元素参数类型:{1},{2}元素类型为:{3}"},WARN_ARRAY_ELEMENT_PARAMS:{type:"warn",zh:"参数类型错误---参数:{0} 数组元素取值范围错误"},WARN_ARRAY_LENGHT:{type:"warn",zh:"参数类型错误---参数:{0},数组长度应{1}{2},当前数组长度为{3}"},WARN_ARRAY_LAYER_EXTENT:{type:"warn",zh:"获取图层范围失败!",en:"getExtent failed!"},WARN_CUSTOM:{type:"warn",zh:""},ADDED_PLUGIN:{type:"warn",zh:"插件已经添加过了, 请不要重复添加o(>﹏<)o"},USING_WIDGET:{type:"warn",zh:"挂件已经在使用中！"},IS_WIDGET_NOT_TOOL:{type:"warn",zh:"该插件为widget，请使用usingWidget方法添加!"},USING_PLUGIN_FAIL:{type:"warn",zh:"添加插件{0}失败!"}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={show_language:"zh",ERROR_PARAMS:{type:"error",zh:"参数错误"},ERRAR_PARAMS_ONLY:{type:"error",zh:"参数错误,只能是:"},ERROR_GVML_FILE_PARSE:{type:"error",zh:"Uninpho文件解析失败，请检查是否拼写错误。"},ERROR_GVML_FILE_READ:{type:"error",zh:"Uninpho文件读取失败，请检查路径是否错误。"},ERROR_PARAMS_BOOLEAN:{type:"error",zh:"参数必须是布尔类型"},ERROR_PARAMS_FUNCTION:{type:"error",zh:"参数不是一个有效的函数类型"},ERROR_ANIMATE_TYPE:{type:"error",zh:"不是一个有效的动画类型"},UNDEFINED_PARENT_CONTAINER:{type:"error",zh:"父容器未定义"},UNDEFINED_DOM:{type:"error",zh:"页面未包含相应元素"},UNDEFINED_PLUGINPANEL:{type:"error",zh:"未定义插件面板"},UNDEFINED_PLUGIN_TYPE:{type:"error",zh:"未定义插件类型,必须指定,类型查看Uninpho.PluginType"},UNDEFINED_EXCEPTION:{type:"error",zh:"未定义(undefined)异常"},UNDEFINED_PLUGIN:{type:"error",zh:"未定义插件，请检查插件参数是否正确，或者提前注册该插件！"},ERROR_PLUGIN_TYPE:{type:"error",zh:"插件类型指定错误,请检查自己的Uninpho数据是否错误"},ERROR_PLUGIN_URL:{type:"error",zh:"错误插件路径，请检查路径是否指向真实插件路径"},ERROR_IMAGE_SOURCE:{type:"error",zh:"未指定图层数据源或者图层数据源指定错误"},ERROR_BASEIMAGE_DEFINITION:{type:"error",zh:"基础图层定义错误"},ERROR_POLYLINE_LENGTH:{type:"error",zh:"Polyline最少需要2个折点"},ERROR_POLYGON_LENGTH:{type:"error",zh:"多边形最少需要3个折点"},centerMessage:{managerService:{error:{zh:"获取所有服务列表失败"}}},UNDEFINED_CACHE_OPTION_PARAM:{type:"error",zh:'CacheOption的driver设置有误，须为"filesystem"或"leveldb"'},WARN_PARAMS_RANGE:{type:"warn",zh:"参数范围错误:{0}  取值范围:{1} 单位或枚举:{2}, 使用默认参数 {3}"},WARN_PARAMS_RANGE_NONE:{type:"warn",zh:"参数范围错误---参数:{0} 取值范围:{1}, 使用默认参数 {2}"},WARN_PARAMS_RANGE_NONEDEFAULT:{type:"warn",zh:"参数范围错误---参数:{0} 取值范围:{1}"},WARN_PARAMS:{type:"warn",zh:"参数:{0}--参数类型错误 参数类型:{1}, 使用默认参数 {2}"},WARN_PARAMS_NONE:{type:"warn",zh:"参数类型错误---参数:{0} 参数类型:{1}"},WARN_CORLOR:{type:"warn",zh:"参数:{0}--参数类型错误,参数应为十六进制颜色#FFFFFFFF或#FFFFFF,使用默认参数:{1}"},WARN_ARRAY_ELEMENT_TYPE:{type:"warn",zh:"参数类型错误---参数:{0} 数组元素参数类型:{1},{2}元素类型为:{3}"},WARN_ARRAY_ELEMENT_PARAMS:{type:"warn",zh:"参数类型错误---参数:{0} 数组元素取值范围错误"},WARN_ARRAY_LENGHT:{type:"warn",zh:"参数类型错误---参数:{0},数组长度应{1}{2},当前数组长度为{3}"},WARN_ARRAY_LAYER_EXTENT:{type:"warn",zh:"获取图层范围失败!",en:"getExtent failed!"},WARN_CUSTOM:{type:"warn",zh:""},ADDED_PLUGIN:{type:"warn",zh:"插件已经添加过了, 请不要重复添加o(>﹏<)o"},USING_WIDGET:{type:"warn",zh:"挂件已经在使用中！"},IS_WIDGET_NOT_TOOL:{type:"warn",zh:"该插件为widget，请使用usingWidget方法添加!"},USING_PLUGIN_FAIL:{type:"warn",zh:"添加插件{0}失败!"}}},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_Exception=__webpack_require__(16),_Exception2=_interopRequireDefault(_Exception),_ExceptionMessage=__webpack_require__(13),_ExceptionMessage2=_interopRequireDefault(_ExceptionMessage),_WarnException=__webpack_require__(17),warn=_interopRequireWildcard(_WarnException),_Event2=__webpack_require__(18),_Event3=_interopRequireDefault(_Event2),_Util=__webpack_require__(10),PluginManager=function(_Event){function PluginManager(t){_classCallCheck(this,PluginManager);var e=_possibleConstructorReturn(this,(PluginManager.__proto__||Object.getPrototypeOf(PluginManager)).call(this));return e._centerPlugins=new Map,e._widgets=new Map,e._tools=new Map,e._currentTool=void 0,e._customUI=void 0,e._toolChanged=void 0,e._earth=t,t.pluginManager=e,e}return _inherits(PluginManager,_Event),_createClass(PluginManager,[{key:"getPluginByName",value:function(t){var e=void 0;return e=this._widgets.get(t),!e&&(e=this._tools.get(t))?e:e}},{key:"getPluginInfoByName",value:function(t){return this._centerPlugins.get(t)}},{key:"getInstalledPlugins",value:function(){var t=[];return this._widgets.forEach(function(e){t.push(e)}),this._tools.forEach(function(e){t.push(e)}),t}},{key:"getAllPlugins",value:function(){return this._centerPlugins}},{key:"addPlugin",value:function addPlugin(plugin){if(console.log("addPlugin: ",plugin),"string"==typeof plugin&&(plugin=this._centerPlugins.get(plugin)),!plugin)throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGIN,_ExceptionMessage2.default.UNDEFINED_PLUGIN.type);var realPlugin=void 0;switch(plugin.type){case"widget":realPlugin=this._widgets.get(plugin.name);break;case"tool":realPlugin=this._tools.get(plugin.name);break;default:throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGIN_TYPE,_ExceptionMessage2.default.UNDEFINED_PLUGIN_TYPE.type)}if(realPlugin)throw new _Exception2.default(_ExceptionMessage2.default.ADDED_PLUGIN,_ExceptionMessage2.default.ADDED_PLUGIN.type);var pluginClass=this._appendScript(plugin.name,plugin.url,plugin.js);if(!pluginClass)throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGIN_TYPE,_ExceptionMessage2.default.UNDEFINED_PLUGIN_TYPE.type);var panel=this._addRootDOM(plugin);if(panel)return realPlugin=new(eval(pluginClass))({name:plugin.name,container:panel,url:plugin.url,js:plugin.js,type:plugin.type,img:plugin.img,earth:this._earth,language:plugin.language,parms:plugin.parms}),this._add(realPlugin),realPlugin}},{key:"removePlugin",value:function(t){var e=void 0;if(!t)throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGIN,_ExceptionMessage2.default.UNDEFINED_PLUGIN.type);if("string"==typeof t)e=t;else{if(void 0===t.name)throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGIN,_ExceptionMessage2.default.UNDEFINED_PLUGIN.type);e=t.name}var n=this._widgets.get(e);if(n||(n=this._tools.get(e)),!n)throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGIN,_ExceptionMessage2.default.UNDEFINED_PLUGIN.type);console.log("remove: ",n),this._remove(n),this._removeRootDOM(n)}},{key:"openWidget",value:function(t){if(t){var e=void 0;e="string"==typeof t?t:t.name;var n=this._widgets.get(e);return n?n.isUsing===!1?(n._init(),n.isUsing=!0):console.warn(warn.WarnException(_ExceptionMessage2.default.USING_WIDGET)):(n=this.addPlugin(e),n&&(n=this.usingWidget(n))),n}}},{key:"closeWidget",value:function(t){if(t){var e=void 0;e="string"==typeof t?t:t.name;var n=this._widgets.get(e);n&&(n._remove(),n.isUsing=!1)}}},{key:"_setCurrentTool",value:function(t){this.fire("setCurrentTool",t);var e=void 0;if(!t)return this._turnOffTools(),void(this._toolChanged&&this._toolChanged(void 0));e="string"==typeof t?t:t.name;var n=this._tools.get(e);if(n)this._currentTool&&(this._currentTool._remove(),this._currentTool.isCurrentTool=!1),n._init(),this._toolChanged&&this._toolChanged(n);else{if(this._widgets.get(e))return void console.warn(warn.WarnException(_ExceptionMessage2.default.IS_WIDGET_NOT_TOOL));n=this.addPlugin(e),n&&(n=this._setCurrentTool(n))}return n&&(n.isCurrentTool=!0),n}},{key:"_initCenter",value:function(t){if(t){var e=(0,_Util.jsonSyncPromise)(t).responseJSON;if(e){var n=e.results;this._centerPlugins=new Map;for(var i in n)this._centerPlugins.set(n[i].name,n[i]);this._data=n}}}},{key:"_initPlugins",value:function(t){var e=this,n=[],i=this._centerPlugins;t.tool&&t.tool.constructor===Array?t.tool.forEach(function(t){n.push({id:t.id,type:"tool"})}):t.tool&&n.push({id:t.tool.id,type:"tool"}),t.widget&&t.widget.constructor===Array?t.widget.forEach(function(t){n.push({id:t.id,type:"widget"})}):t.widget&&n.push({id:t.widget.id,type:"widget"}),n.forEach(function(t){var n=i.get(t.id);if(!n)throw new _Exception2.default(t.id+" : "+_ExceptionMessage2.default.UNDEFINED_PLUGIN);if(t.type!==n.type)throw new _Exception2.default(_ExceptionMessage2.default.ERROR_PLUGIN_TYPE);e.addPlugin(n),"widget"===n.type&&e.usingWidget(n)})}},{key:"_addRootDOM",value:function(t){var e=t.name,n=null;if(t.customUI){if(!this._customUI)throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGINPANEL);n=this._customUI}else n=this._earth.container;var i=function(t){if(!n.hasChildNodes()){for(var e=n.childNodes,i=0;i<e.length;i+=1)if(e[i].id===t)return!0;return!1}},r=this._earth.container.id+"_of_"+e;if(i(r)!==!0){var o=document.createElement("div");return o.id=r,t.customUI||(o.style.position="relative"),o.style.top="-100%",o.style.height="0",n.appendChild(o),o}}},{key:"_removeRootDOM",value:function(t){var e=t.name,n=null,i=this._earth.container.id;if(t.customUI){if(!this._customUI)throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGINPANEL);n=this._customUI}else n=document.getElementById(i);var r=document.getElementById(i+"_of_"+e);n.removeChild(r)}},{key:"_appendScript",value:function(t,e,n){var i=(this._earth.container,function(t){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n+=1)if(e[n].getAttribute("pluginId")===t)return!0;return!1}),r=document.createElement("script");if(r.setAttribute("pluginId",t),i(t)!==!1)return n;var o=_Util.$.ajax({async:!1,url:""+e+n+".js",dataType:"text"});return 4===o.readyState&&200===o.status?(document.head.appendChild(r),r.innerHTML=o.responseText.replace("<br>","\n"),n):void 0}},{key:"_removeScript",value:function(t){var e=function(t){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n+=1)if(e[n].getAttribute("pluginId")===t)return e[n]},n=e(t);return n&&document.head.removeChild(n),this}},{key:"_turnOffTools",value:function(){this._currentTool&&(this._currentTool._remove(),this._currentTool.isCurrentTool=!1),this._currentTool=void 0}},{key:"_add",value:function(t){if(t){switch(t.type){case"widget":this._addToMap(t,this._widgets);break;case"tool":this._addToMap(t,this._tools);break;default:throw new _Exception2.default(_ExceptionMessage2.default.UNDEFINED_PLUGIN_TYPE,_ExceptionMessage2.default.UNDEFINED_PLUGIN_TYPE.type)}t._manager=this}}},{key:"_remove",value:function(t){if(t){switch(t.type){case"widget":this._removeFormMap(t,this._widgets);break;case"tool":this._removeFormMap(t,this._tools)}t._remove()}}},{key:"_removeFormMap",value:function(t,e){return e.has(t.key)&&e.delete(t.key),this}},{key:"_addToMap",value:function(t,e){if(e.has(t.key))throw new _Exception2.default(_ExceptionMessage2.default.ADDED_PLUGIN,_ExceptionMessage2.default.ADDED_PLUGIN.type);return e.set(t.key,t),this}},{key:"toTags",value:function(){var t="",e="";return this._widgets.forEach(function(e){e&&(t+="<widget><id>"+e.key+"</id></widget>")}),this._tools.forEach(function(t){t&&(e+="<tool><id>"+t.key+"</id></tool>")}),"<plugins>"+t+e+"</plugins>"}},{key:"toJson",value:function(){var t=[];return this._widgets.forEach(function(e){e&&t.push({widget:{id:e.key}})}),this._tools.forEach(function(e){e&&t.push({tool:{id:e.key}})}),t}},{key:"currentTool",set:function(t){this._currentTool=this._setCurrentTool(t)},get:function(){return this._currentTool}},{key:"toolChanged",set:function(t){this._toolChanged=t}},{key:"customUI",set:function(t){var e=void 0;e="string"==typeof t?document.getElementById(t):t,this._customUI=e}}]),PluginManager}(_Event3.default);exports.default=PluginManager},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(10),u=(r(s),n(13)),l=i(u),c=function(){function t(e){o(this,t);for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];i.length>0&&(this.type=i.shift()),this.showMessage(e,i)}return a(t,[{key:"formatMessage",value:function(t,e){for(var n=[],i=void 0,r=void 0,o=0;o<t.length;)if("{"===t.charAt(o))if(i=t.indexOf("}",o+1),i===-1)o++;else if(r=parseInt(t.substring(o+1,i)),!isNaN(r)&&r>=0){var a=t.substring(0,o);""!==a&&n.push(a),n.push(r),o=0,t=t.substring(i+1)}else o=i+1;else o++;if(""!==t&&n.push(t),t=n,0===t.length)return"";if(1===t.length&&"string"==typeof t[0])return t[0];var s="";for(o=0,i=t.length;o<i;o++)"string"==typeof t[o]?s+=t[o]:e&&t[o]<e.length&&(s+=e[t[o]]);return s}},{key:"showMessage",value:function(t,e){var n=t.type;switch(t=this.formatMessage(t[l.default.show_language],e),n){case"error":console.error(this.type+":"+t);break;case"warn":console.warn(this.type+":"+t);break;case"info":console.info(this.type+":"+t)}}},{key:"type",set:function(t){this._type=t||"Exception"},get:function(){return this._type}}]),t}();e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){for(var n=[],i=void 0,r=void 0,o=0;o<t.length;)if("{"===t.charAt(o))if(i=t.indexOf("}",o+1),i===-1)o++;else if(r=parseInt(t.substring(o+1,i)),!isNaN(r)&&r>=0){var a=t.substring(0,o);""!==a&&n.push(a),n.push(r),o=0,t=t.substring(i+1)}else o=i+1;else o++;if(""!==t&&n.push(t),t=n,1===t.length&&"string"==typeof t[0])return t[0];var s="";if(0===t.length&&e){for(o=0;o<e.length;o++)s+=e[o];return s}for(o=0,i=t.length;o<i;o++)"string"==typeof t[o]?s+=t[o]:e&&t[o]<e.length&&(s+=e[t[o]]);return s}function a(t,e,n){t.type;return t=o(t[l.default.show_language],n),e+":"+t}Object.defineProperty(e,"__esModule",{value:!0}),e.WarnException=void 0;var s=n(10),u=(r(s),n(13)),l=i(u);e.WarnException=function(t){for(var e=void 0,n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.length>0&&(e=i.shift()),a(t,e,i)}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),c=n(3),h=r(c),f=n(19),p=i(f),d=function(t){function e(){return o(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),l(e,[{key:"on",value:function(t,e,n){if(h.isJson(t))for(var i in t)this._on(i,t[i],e);else this._on(t,e,n);return this}},{key:"_on",value:function(t,e,n){this._events=this._events||{};var i=this._events[t];i||(i=[],this._events[t]=i),n===this&&(n=void 0);for(var r={fn:e,ctx:n},o=i,a=0,s=o.length;a<s;a++)if(o[a].fn===e&&o[a].ctx===n)return;o.push(r)}},{key:"off",value:function(t,e,n){if(t)if("object"===("undefined"==typeof t?"undefined":u(t)))for(var i in t)this._off(i,t[i],e);else this._off(t,e,n);else delete this._events;return this}},{key:"_off",value:function(t,e,n){if(this._events){var i=this._events[t];if(i){if(e){for(var r=0,o=i.length;r<o;r++)i[r].fn=h.falseFn;return void delete this._events[t]}n===this&&(n=void 0);for(var a=0,s=i.length;a<s;a++){var u=i[a];if(u.ctx===n&&u.fn===e)return u.fn=h.falseFn,this._firingCount&&(this._events[t]=i=i.slice()),void i.splice(a,1)}}}}},{key:"fire",value:function(t,e){if(!this.listens(t))return this;if(this._events){var n=this._events[t];if(n){this._firingCount=this._firingCount+1||1;for(var i=0,r=n.length;i<r;i++){var o=n[i];o.fn.call(o.ctx||this,e)}this._firingCount--}}return this}},{key:"listens",value:function(t){var e=this._events&&this._events[t];return!!(e&&e.length>0)}}]),e}(p.default);e.default=d},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(3),u=i(s),l=function(){function t(e){o(this,t),e&&u.isJson(e)&&(this._uuid=e.uuid,this._parseJson(e)),this._uuid=this._uuid||u.createGuid()}return a(t,[{key:"_parseJson",value:function(t,e){}},{key:"bindCallback",value:function(t){var e=null;this.map?e=this.map._messageManager:this._messageManager&&(e=this._messageManager),null!=e&&e.bindCallback(this.id,t,this)}},{key:"setMap",value:function(t){this.map=t,this._callBack&&u.$.isFunction(this._callBack)&&this.bindCallback(this._callBack)}},{key:"setProps",value:function(t){for(var e in t)this[e]=t[e]}},{key:"postMessage",value:function(t,e,n){var i=null;this.map?(i=this.map._messageManager,i.postMessage(this.id,t,e,n)):this._messageManager&&(i=this._messageManager,i.postMessage(t,e,n))}},{key:"toXml",value:function(){return this._toXml()}},{key:"_toXml",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return u.replaceXmlSpace("<"+this.tag+"><uuid>"+this.id+"</uuid>"+t+"</"+this.tag+">")}},{key:"_toJson",value:function(t){var e={uuid:this.id};if(t)for(var n in t)e[n]=t[n];return r({},this.tag,e)}},{key:"uuid",set:function(t){this._uuid||(this._uuid=t)}},{key:"id",get:function(){return this._uuid}},{key:"tag",get:function(){return"Class"}}]),t}();e.default=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");
}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(21),l=i(u),c=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._type="widget",n._isUsing=!1,n}return a(e,t),s(e,[{key:"type",set:function(t){this._type="widget"},get:function(){return this._type}},{key:"isUsing",set:function(t){this._isUsing=t},get:function(){return this._isUsing}},{key:"registerName",set:function(t){this._registerName=t,this.earth&&this._registerName}}]),e}(l.default);e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(18),l=i(u),c=n(10),h=n(22),f=i(h),p=/\\?\{\{([^{}]+)\}\}/g,d=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));for(var i in t)t[i]&&"uuid"!==i&&(n[i]=t[i]);return n._loadLanguage(),n}return a(e,t),s(e,[{key:"_loadLanguage",value:function(){if(this.language){var t={path:this.url,name:this.language,mode:"map",language:"zh"};f.default.properties(t)}}},{key:"_loadLanguageCallback",value:function(){this._isLoadLanguageOk=!0}},{key:"getValue",value:function(t){return f.default.prop(t)}},{key:"_init",value:function(){if(this.reference){this.reference();var t=!1;this.html&&(this.loadHtml(this.html),t=!0),this.css&&(this.loadCss(this.css),t=!0),this.script?this.synLoadScript(this.script):this.init()}else this.init()}},{key:"init",value:function(){}},{key:"_remove",value:function(){this.remove(),this._removeUI()}},{key:"remove",value:function(){}},{key:"loadCss",value:function(t){var e=this;"string"==typeof t&&(t=[t]);var n=document.getElementsByTagName("head")[0],i=!0,r=!1,o=void 0;try{for(var a,s=function(){var t=a.value,i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e.formatURL(t);var r=c.$.ajax({async:!1,url:i.href});r.done(function(){n.appendChild(i),e.link||(e.link=[]),e.link.push(i)}),r.fail(function(t){console.error(t)})},u=t[Symbol.iterator]();!(i=(a=u.next()).done);i=!0)s()}catch(t){r=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw o}}}},{key:"loadScript",value:function(t){var e=this;"string"==typeof t&&(t=[t]);var n=document.getElementsByTagName("head")[0],i=!0,r=!1,o=void 0;try{for(var a,s=function(){var i=a.value,r=document.createElement("script");r.src=e.formatURL(i),n.appendChild(r),r.onload=function(){e.scripts||(e.scripts=[]),e.scripts.push(r),t.length===e.scripts.length&&e.init()}},u=t[Symbol.iterator]();!(i=(a=u.next()).done);i=!0)s()}catch(t){r=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw o}}}},{key:"synLoadScript",value:function(t){var e=void 0;if("string"==typeof t)e=[t];else{e=[];var n=!0,i=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;e.push(s)}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}}this._synLoadScript(e)}},{key:"_synLoadScript",value:function(t){var e=this,n=document.getElementsByTagName("head")[0],i=document.createElement("script");i.src=this.formatURL(t[0]),n.insertBefore(i,n.childNodes[0]),i.onload=function(){t.splice(0,1),t[0]?(e.scripts||(e.scripts=[]),e.scripts.push(i),e.synLoadScript(t)):e.init()}}},{key:"loadHtml",value:function(t){var e=this;t instanceof Array&&(t=t[0],console.warn("暂不支持一个插件包含多个界面"));var n=c.$.ajax({url:this.formatURL(t),dataType:"html",async:!1}),i=n.responseText.indexOf("<body>")+6,r=n.responseText.indexOf("</body>");if(!(i<6||i>r)){var o=n.responseText.substring(i,r);if(o=o.replace(/src=".\/\S*"/g,function(t){var n=e.formatURL(t.substring(5,t.length-1));return'src="'+n+'"'}),o=o.replace(/url\(('|"){0,1}.\/\S*('|"){0,1}\)/g,function(t){return/^url\(('|")/.test(t)?"url("+e.formatURL(t.substring(5,t.length-2))+")":"url("+e.formatURL(t.substring(4,t.length-1))+")"})){o=this._formatMessage(o);var a=c.$.parseHTML(o,!0),s=!0,u=!1,l=void 0;try{for(var h,f=a[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var p=h.value;(0,c.$)(p).attr("src")?(0,c.$)(p).attr("src",this.formatURL((0,c.$)(p).attr("src"))):(0,c.$)(p).attr("href")&&(0,c.$)(p).attr("href",this.formatURL((0,c.$)(p).attr("href")))}}catch(t){u=!0,l=t}finally{try{!s&&f.return&&f.return()}finally{if(u)throw l}}(0,c.$)(this.container).append(a)}}}},{key:"_formatMessage",value:function(t){var e=this;return t.replace(p,function(t,n){return e.getValue(n.replace(/(^\s*)|(\s*$)/g,""))})}},{key:"_removeUI",value:function(){if(this.container)for(var t=this.container.childNodes;t.length>0;)this.container.removeChild(t[t.length-1]);var e=document.getElementsByTagName("head")[0];if(this.link&&this.link.length>0){for(var n=0;n<this.link.length;n++)this.link[n]&&e.removeChild(this.link[n]);this.link=[]}if(this.scripts&&this.scripts.length>0){for(var i=0;i<this.scripts.length;i++)this.scripts[i]&&e.removeChild(this.scripts[i]);this.scripts=[]}}},{key:"formatURL",value:function(t){if(t.startsWith("https:"))return t;if(!this.url||null===this.url)return t;var e=t.split("/"),n=this.url.split("/");""===n[n.length-1]&&n.pop();for(var i="",r=0;r<e.length;r+=1)0===r&&"."===e[r]&&(r+=1),".."===e[r]?n.pop():n.push(e[r]);for(var o=0;o<n.length;o+=1){var a=o===n.length-1?"":"/";i+=n[o]+a}return i}},{key:"formatHostURL",value:function(t){return window.location.origin?window.location.origin+this.formatURL(t):this.formatURL(t)}},{key:"display",value:function(t){if(t===!1)this.container.style.display="none";else{var e=this.container.id;(0,c.$)("#"+e).attr("style","")}}},{key:"type",get:function(){return this.type}},{key:"key",get:function(){return this.name}},{key:"transition",set:function(t){t===!0&&(this.container.className="transition_left"),this._transition=t},get:function(){return!!this._transition&&this._transition}},{key:"setting",get:function(){var t=this.url+"setting.json",e=c.$.ajax({async:!1,url:t});if(/^Cannot/.test(e.responseText)!==!0&&""!==e.responseText){try{JSON.parse(e.responseText)}catch(t){return}return JSON.parse(e.responseText)[this.name]?JSON.parse(e.responseText)[this.name]:JSON.parse(e.responseText)}}}]),e}(l.default);e.default=d},function(module,exports){"use strict";function callbackIfComplete(t){t.debug&&(debug("callbackIfComplete()"),debug("totalFiles: "+t.totalFiles),debug("filesLoaded: "+t.filesLoaded)),t.async&&t.filesLoaded===t.totalFiles&&t.callback&&t.callback()}function loadAndParseFiles(t,e){e.debug&&debug("loadAndParseFiles"),null!==t&&t.length>0?loadAndParseFile(t[0],e,function(){t.shift(),loadAndParseFiles(t,e)}):callbackIfComplete(e)}function loadAndParseFile(t,e,n){e.debug&&(debug("loadAndParseFile('"+t+"')"),debug("totalFiles: "+e.totalFiles),debug("filesLoaded: "+e.filesLoaded)),null!==t&&"undefined"!=typeof t&&$.ajax({url:t,async:e.async,cache:e.cache,dataType:"text",success:function(i,r){e.debug&&(debug("Succeeded in downloading "+t+"."),debug(i)),parseData(i,e),n()},error:function(i,r,o){e.debug&&debug("Failed to download or parse "+t+". errorThrown: "+o),404===i.status&&(e.totalFiles-=1),n()}})}function parseData(data,settings){var parsed="",lines=data.split(/\n/),regPlaceHolder=/(\{\d+})/g,regRepPlaceHolder=/\{(\d+)}/g,unicodeRE=/(\\u.{4})/gi;lines.forEach(function(t,e){if(t=t.trim(),t.length>0&&"#"!=t.match("^#")){var n=t.split("=");if(n.length>0){for(var i=decodeURI(n[0]).trim(),r=1==n.length?"":n[1];"\\"===r.match(/\\$/);)r=r.substring(0,r.length-1),r+=lines[++e].trimRight();for(var o=2;o<n.length;o++)r+="="+n[o];if(r=r.trim(),"map"==settings.mode||"both"==settings.mode){var a=r.match(unicodeRE);a&&a.forEach(function(t){r=r.replace(t,unescapeUnicode(t))}),i18n.map[i]=r}if("vars"==settings.mode||"both"==settings.mode)if(r=r.replace(/"/g,'\\"'),checkKeyNamespace(i),regPlaceHolder.test(r)){var s=r.split(regPlaceHolder),u=!0,l="",c=[];s.forEach(function(t){!regPlaceHolder.test(t)||0!==c.length&&c.indexOf(t)!=-1||(u||(l+=","),l+=t.replace(regRepPlaceHolder,"v$1"),c.push(t),u=!1)}),parsed+=i+"=function("+l+"){";var h='"'+r.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+="return "+h+";};"}else parsed+=i+'="'+r+'";'}}}),eval(parsed),settings.filesLoaded+=1}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key)){var fullname="",names=key.split(/\./);names.forEach(function(name,i){i>0&&(fullname+="."),fullname+=name,eval("typeof "+fullname+' == "undefined"')&&eval(fullname+"={};")})}}function unescapeUnicode(t){var e=[],n=parseInt(t.substr(2),16);return n>=0&&n<Math.pow(2,16)&&e.push(n),e.reduce(function(t,e){return t+String.fromCharCode(e)},"")}Object.defineProperty(exports,"__esModule",{value:!0});var i18n={};i18n.map={};var debug=function(t){console.log("i18n::"+t)};i18n.properties=function(t){var e={name:"Messages",language:"",path:"",mode:"vars",cache:!1,debug:!1,encoding:"UTF-8",async:!1,callback:null};t=$.extend(e,t),t.path.match(/\/$/)||(t.path+="/"),t.language=this.normaliseLanguageCode(t.language);var n=t.name&&t.name.constructor===Array?t.name:[t.name];t.totalFiles=2*n.length+(t.language.length>=5?n.length:0),t.debug&&debug("totalFiles: "+t.totalFiles),t.filesLoaded=0,n.forEach(function(e){var n,i,r;n=t.path+e+".properties";var o=t.language.substring(0,2);if(i=t.path+e+"_"+o+".properties",t.language.length>=5){var a=t.language.substring(0,5);r=t.path+e+"_"+a+".properties"}loadAndParseFiles([n,i,r],t)}),t.callback&&!t.async&&t.callback()},i18n.prop=function(t){var e=i18n.map[t];if(null===e)return"["+t+"]";if("undefined"==typeof e)return t;var n;2==arguments.length&&$.isArray(arguments[1])&&(n=arguments[1]);var i;if("string"==typeof e){for(i=0;(i=e.indexOf("\\",i))!=-1;)e="t"==e.charAt(i+1)?e.substring(0,i)+"\t"+e.substring(i++ +2):"r"==e.charAt(i+1)?e.substring(0,i)+"\r"+e.substring(i++ +2):"n"==e.charAt(i+1)?e.substring(0,i)+"\n"+e.substring(i++ +2):"f"==e.charAt(i+1)?e.substring(0,i)+"\f"+e.substring(i++ +2):"\\"==e.charAt(i+1)?e.substring(0,i)+"\\"+e.substring(i++ +2):e.substring(0,i)+e.substring(i+1);var r,o,a=[];for(i=0;i<e.length;)if("'"==e.charAt(i))if(i==e.length-1)e=e.substring(0,i);else if("'"==e.charAt(i+1))e=e.substring(0,i)+e.substring(++i);else{for(r=i+2;(r=e.indexOf("'",r))!=-1;){if(r==e.length-1||"'"!=e.charAt(r+1)){e=e.substring(0,i)+e.substring(i+1,r)+e.substring(r+1),i=r-1;break}e=e.substring(0,r)+e.substring(++r)}r==-1&&(e=e.substring(0,i)+e.substring(i+1))}else if("{"==e.charAt(i))if(r=e.indexOf("}",i+1),r==-1)i++;else if(o=parseInt(e.substring(i+1,r)),!isNaN(o)&&o>=0){var s=e.substring(0,i);""!==s&&a.push(s),a.push(o),i=0,e=e.substring(r+1)}else i=r+1;else i++;""!==e&&a.push(e),e=a,i18n.map[t]=a}if(0===e.length)return"";if(1==e.length&&"string"==typeof e[0])return e[0];var u="";for(i=0,r=e.length;i<r;i++)u+="string"==typeof e[i]?e[i]:n&&e[i]<n.length?n[e[i]]:!n&&e[i]+1<arguments.length?arguments[e[i]+1]:"{"+e[i]+"}";return u},i18n.normaliseLanguageCode=function(t){return(!t||t.length<2)&&(t=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage||"en"),t=t.toLowerCase(),t=t.replace(/-/,"_"),t.length>3&&(t=t.substring(0,3)+t.substring(3).toUpperCase()),t},exports.default=i18n},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(21),l=i(u),c=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._type="tool",n._isCurrentTool=!1,n}return a(e,t),s(e,[{key:"type",set:function(t){this._type="tool"},get:function(){return this._type}},{key:"isCurrentTool",set:function(t){this._isCurrentTool=t},get:function(){return this._isCurrentTool}},{key:"active",set:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._active=t,"boolean"==typeof t&&t&&this._manager&&this._manager._activeTool(this)},get:function(){return this._active}}]),e}(l.default);e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(25),l=i(u),c=n(69),h=(i(c),n(70)),f=i(h),p=n(78),d=i(p),g=n(79),y=i(g),m=n(38),v=i(m),_=n(26),w=i(_),b=n(80),C=i(b),x=n(93),E=i(x),S=n(105),P=i(S),M=n(15),L=i(M),I=n(106),T=i(I),N=function(t){function e(t,n){r(this,e);var i={shouldAnimate:!0,animation:!1,baseLayerPicker:!1,fullscreenButton:!1,vrButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,navigation:!0,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,contextOptions:{webgl:{alpha:!0,depth:!1,stencil:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!0},allowTextureFilterAnisotropic:!0}};if(n)for(var a in i)Cesium.defined(n[a])||(n[a]=i[a]);else n=i;1==n.globe&&(n.imageryProvider=new Cesium.SingleTileImageryProvider({url:w.default.baseMapUrl()}),Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(73,13,135,53));var s=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),u=T.default.checkLicense();if(!u)return s.destroy(),o(s);var c={};return c.defaultResetView=Cesium.Rectangle.fromDegrees(80,22,130,50),c.enableCompass=!0,c.enableZoomControls=!0,c.enableDistanceLegend=!0,c.enableCompassOuterRing=!0,s._container=Cesium.getElement(t),s._drawTool=new v.default(s),s._navigation=new f.default(s),s._pluginManager=new L.default(s),s._project=new l.default(s),s._layerManager=s._project._layerManager,s._graphicLayer=new y.default(s),s._analysis=new C.default(s),s._envEffects=new E.default(s),s._recorder=null,s._Config=new w.default(s),s._init(),s}return a(e,t),s(e,[{key:"_init",value:function(){var t=this;this.camera.changed.addEventListener(function(){Cesium.GlobeSurfaceOption&&Cesium.GlobeSurfaceOption.underGround.enabled||t.camera._suspendTerrainAdjustment&&t.scene.mode===Cesium.SceneMode.SCENE3D&&(t.camera._suspendTerrainAdjustment=!1,t.camera._adjustHeightForTerrain())}),document.getElementsByClassName("cesium-viewer-bottom")[0].style.display="none";var e=new d.default(this);e.registHotKey()}},{key:"fullScreen",value:function(){this._navigation.ViewPort.fullScreen()}},{key:"exitFullScreen",value:function(){this._navigation.ViewPort.exitFullScreen()}},{key:"exportImage",value:function(t,e){return this._navigation.ViewPort.exportImage(t,e)}},{key:"trackPolygon",value:function(t,e){return this._graphicLayer.trackPolygon(t,e)}},{key:"trackPolyline",value:function(t,e){return this._graphicLayer.trackPolyline(t,e)}},{key:"clearGraphic",value:function(){return this._graphicLayer.clear()}},{key:"addPlugin",value:function(t){if(this._pluginManager)return this._pluginManager.addPlugin(t)}},{key:"removePlugin",value:function(t){if(this._pluginManager)return this._pluginManager.removePlugin(t)}},{key:"removePlugin",value:function(t){if(this._pluginManager)return this._pluginManager.removePlugin(t)}},{key:"openWidget",value:function(t){if(this._pluginManager)return this._pluginManager.usingWidget(t)}},{key:"closeWidget",value:function(t){if(this._pluginManager)return this._pluginManager.unusingWidget(t)}},{key:"setCurrentTool",value:function(t){if(this._pluginManager)return this._pluginManager.currentTool=t,this._pluginManager.fire("setCurrenTool",t),this._toolChanged&&this._toolChanged(t),this._pluginManager.currentTool}},{key:"getCurrentTool",value:function(){return this._pluginManager?this._pluginManager.currentTool:void 0}},{key:"getInstalledPlugins",value:function(){if(this._pluginManager)return this._pluginManager.getInstalledPlugins()}},{key:"getPluginByName",value:function(t){if(this._pluginManager)return this._pluginManager.getPluginByName(t)}},{key:"goto",value:function(t,e,n,i){return this._navigation.goto(t,e,n,i)}},{key:"loadProject",value:function(t,e){return this.project.load(t,e)}},{key:"saveProject",value:function(){return this.project.save()}},{key:"createProject",value:function(){return this.project.create()}},{key:"setBaseImage",value:function(t){this.project._layerManager.setBaseImage(t)}},{key:"FPS",get:function(){return this.scene.debugShowFramesPerSecond},set:function(t){this.scene.debugShowFramesPerSecond=t}},{key:"wireframe",get:function(){return this.scene.globe._surface.tileProvider._debug.wireframe},set:function(t){this.scene.globe._surface.tileProvider._debug.wireframe=t,this.scene.requestRender()}},{key:"recorder",get:function(){return this._recorder||(this._recorder=new P.default(this.canvas)),this._recorder}},{key:"navigation",get:function(){return this._navigation}},{key:"envEffects",get:function(){return this._envEffects}},{key:"viewPort",get:function(){return this._navigation.ViewPort}},{key:"mousePosition",get:function(){return this._navigation.mousePosition}},{key:"project",get:function(){return this._project}},{key:"analysis",get:function(){return this._analysis}},{key:"drawTool",get:function(){return this._drawTool}},{key:"layerManager",get:function(){return this._layerManager}},{key:"pluginManager",get:function(){return this._pluginManager},set:function(t){return this._pluginManager=t}},{key:"currentToolChanged",set:function(t){this._toolChanged=t}},{key:"container",get:function(){return this._container}}]),e}(Cesium.Viewer);e.default=N},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(26),s=i(a),u=n(28),l=i(u),c=n(38),h=(i(c),n(67)),f=i(h),p=n(68),d=i(p),g=function(){function t(e){r(this,t),this.viewer=e,this._layerManager=new l.default(this.viewer),this._drawTool=this.viewer.drawTool,this._flyManager=new f.default(this.viewer),this._config=new s.default(this.viewer),this._bookmarkManager=new d.default(this.viewer),this._prjData={}}return o(t,[{key:"_getPrjInfo",value:function(t){return{version:"V1.0",id:Cesium.createGuid(),classify:{},name:t,description:"",tags:[],author:"管理员",thumbnail:"缩图路径",date:(new Date).getTime(),view:{},layers:{},bookmarks:{},plottings:{},sceneConfig:{}}}},{key:"load",value:function(t,e){var n=t;("string"==typeof t||t instanceof Cesium.Resource)&&(t=Cesium.Resource.createIfNeeded(t),n=t.fetchJson());var i=this;return Cesium.when(n,function(t){return i._loadPrjData(i,t,e)}).otherwise(function(t){e&&e(t)})}},{key:"_loadPrjData",value:function(t,e,n){t._prjData=e;var i=e;return t._config.fromJSON(i.sceneConfig),t._layerManager.fromJSON(i.layers),t._drawTool.fromJSON(i.plottings,!0),t._bookmarkManager.fromJSON(i.bookmarks),t.viewer.viewPort.fromJSON(i.view),n&&n("ok"),!0}},{key:"save",value:function(t){var e=this._getPrjInfo(t);return e.view=this.viewer.viewPort.toJSON(),e.sceneConfig=this._config.toJSON(),e.layers=this._layerManager.toJSON(),e.bookmarks=this._bookmarkManager.toJSON(),e.plottings=this._drawTool.toJSON(),e.flyPaths={},e}},{key:"create",value:function(){this._layerManager.removeAll(),this._bookmarkManager.removeAll(),this._drawTool.removeAll(),this.viewer.navigation.ViewPort.gotoHome()}},{key:"bookmarkManager",get:function(){return this._bookmarkManager}},{key:"userData",get:function(){return this._prjData.userData},set:function(t){this._prjData.userData=t}},{key:"version",get:function(){return this._prjData.version}},{key:"name",get:function(){return this._prjData.name},set:function(t){this._prjData.name=t}},{key:"description",get:function(){return this._prjData.description},set:function(t){this._prjData.description=t}}]),t}();e.default=g},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(27),s=i(a),u=/((?:.*\/)|^)CTMap[\w-]*\.js(?:\W|$)/i,l=function(){function t(e){r(this,t),this.viewer=e,this.Skybox=new s.default(e)}return o(t,[{key:"fromJSON",value:function(t){if(this.viewer.scene.mode=Cesium.defaultValue(t.sceneMode,Cesium.SceneMode.SCENE3D),this.viewer.scene.debugShowFramesPerSecond=Cesium.defaultValue(t.fps,!1),this.viewer.scene.screenSpaceCameraController.maximumZoomDistance=Cesium.defaultValue(t.maximumZoomDistance,Number.POSITIVE_INFINITY),this.viewer.scene.screenSpaceCameraController.minimumZoomDistance=Cesium.defaultValue(t.minimumZoomDistance,1),this.viewer.mousePosition.show=Cesium.defaultValue(t.mousePosition,!1),t.bloomOpt){var e=this.viewer.scene.postProcessStages.bloom;e.enabled=t.bloomOpt.enabled;var n=t.bloomOpt.uniforms;e.uniforms.glowOnly=Boolean(n.glowOnly),e.uniforms.contrast=Number(n.contrast),e.uniforms.brightness=Number(n.brightness),e.uniforms.delta=Number(n.delta),e.uniforms.sigma=Number(n.sigma),e.uniforms.stepSize=Number(n.stepSize)}this.viewer.scene.postProcessStages.fxaa.enabled=Cesium.defaultValue(t.fxaa,!1),this.viewer.scene.highDynamicRange=Cesium.defaultValue(t.highDynamicRange,!0),this.viewer.scene.globe.depthTestAgainstTerrain=Cesium.defaultValue(t.depthTestAgainstTerrain,!0)}},{key:"toJSON",value:function(){var t={};t.sceneMode=this.viewer.scene.mode,t.fps=this.viewer.scene.debugShowFramesPerSecond,t.maximumZoomDistance=this.viewer.scene.screenSpaceCameraController.maximumZoomDistance,t.minimumZoomDistance=this.viewer.scene.screenSpaceCameraController.minimumZoomDistance,t.mousePosition=this.viewer.mousePosition.show,t.fxaa=this.viewer.scene.postProcessStages.fxaa.enabled,t.highDynamicRange=this.viewer.scene.highDynamicRange;var e=this.viewer.scene.postProcessStages.bloom,n={glowOnly:e.uniforms.glowOnly,contrast:e.uniforms.contrast,brightness:e.uniforms.brightness,delta:e.uniforms.delta,sigma:e.uniforms.sigma,stepSize:e.uniforms.stepSize};return t.bloomOpt={enabled:e.enabled,uniforms:n},t.depthTestAgainstTerrain=this.viewer.scene.globe.depthTestAgainstTerrain,t}}],[{key:"getBaseUrlFromCesiumScript",value:function(){for(var t=document.getElementsByTagName("script"),e=0,n=t.length;e<n;++e){var i=t[e].getAttribute("src"),r=u.exec(i);if(null!==r)return r[1]}}},{key:"baseMapUrl",value:function(){return this.getResource("Assets/Images/baseMap/globe.jpg")}},{key:"getResource",value:function(t){var e=this.getBaseUrlFromCesiumScript();return e+"/"+t}},{key:"zoomDuration",value:function(){return 1}}]),t}();e.default=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(26),s=i(a),u=function(){function t(e){r(this,t),this.viewer=e}return o(t,[{key:"_setSkyBox",value:function(){var t=this,e=this.viewer,n=s.default.getResource("Assets/Images/skybox/lantian/");this.lantianSkybox=new Cesium.SkyBox({nearGround:!0,sources:{positiveX:n+"posx.jpg",negativeX:n+"negx.jpg",positiveY:n+"posy.jpg",negativeY:n+"negy.jpg",positiveZ:n+"posz.jpg",negativeZ:n+"negz.jpg"}}),this.defaultSkybox=e.scene.skyBox,e.scene.postRender.addEventListener(function(){var n=e.camera.position;Cesium.Cartographic.fromCartesian(n).height<23e4?(t.lantianSkybox&&(e.scene.skyBox=t.lantianSkybox),e.scene.skyAtmosphere.show=!1):(t.defaultSkybox&&(e.scene.skyBox=t.defaultSkybox),e.scene.skyAtmosphere.show=!0)})}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(29),u=i(s),l=n(33),c=i(l),h=n(34),f=i(h),p=n(35),d=i(p),g=n(30),y=i(g),m=n(36),v=i(m),_=n(37),w=i(_),b=function(){function t(e){r(this,t),this.earth=e,this._layerDataSet=new Map,this._rootGroup=[{id:"userLayers",name:"用户图层",show:!0,type:y.default.Group,children:[]},{id:"modelLayers",name:"模型图层",show:!0,type:y.default.Group,children:[]},{id:"vectorLayers",name:"矢量图层",show:!0,type:y.default.Group,children:[]},{id:"imageLayers",name:"基础影像",show:!0,type:y.default.Group,children:[]},{id:"terrainLayers",name:"地形图层",show:!0,type:y.default.Group,children:[]}],this._layerList=Cesium.clone(this._rootGroup,!0),this.imageryLayers=this.earth.imageryLayers,this.dataSources=this.earth.dataSources,this.primitives=this.earth.scene.primitives,this._terrainLayerList=null}return a(t,[{key:"addRoot",value:function(t){if(t){var e=new u.default(t).config;return this._layerList.push(e),e}}},{key:"addLayer",value:function(t,e){var n=this._findItem(t);if(n){var i=this._initLayer(e);if(i)return n.children.push(i.config),this._layerDataSet.set(i.id,i),i.config}else console.log("无法找到父节点")}},{key:"getAllLayer",value:function(){var t=[],e=!0,n=!1,i=void 0;try{for(var r,o=this._layerList[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value,s=this._recurrenceLayer(a,[]);t=t.concat(s)}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}return t}},{key:"removeLayer",value:function(t){var e=this._findParent(t);if(e){var n=this._findItem(t);n&&this._removeLayer(e.id,t)}else consloe.log("父节点不存在!")}},{key:"getLayerVisible",value:function(t){var e=this.getLayerDataByID(t);return!!e&&e.show}},{key:"setLayerVisible",value:function(t,e){var n=this.getLayerDataByID(t);n&&(n.show=e);var i=this._layerDataSet.get(t);i.type==y.default.CesiumTerrain&&(this.earth.terrainProvider=n.show?n.dataLayer:new Cesium.EllipsoidTerrainProvider)}},{key:"getLayerName",value:function(t){var e=this._layerDataSet.get(t);if(e)return e.name}},{key:"setLayerName",value:function(t,e){var n=this._layerDataSet.get(t);n&&(n.name=e)}},{key:"layerExist",value:function(t){var e=this.getLayerDataByID(t);return!!e}},{key:"getLayerConfig",value:function(t){return this.getLayerDataByID(t)}},{key:"setLayerStyle",value:function(t,e){var n=this.getLayerDataByID(t);n&&n.update(e)}},{key:"getLayerStyle",value:function(t){var e=this.getLayerDataByID(t);if(e)return e.config.style}},{key:"getLayer",value:function(t){var e=this.getLayerDataByID(t);if(e)return e}},{key:"getParent",value:function(t){var e=this.getLayerDataByID(t);if(e){var n=this._findParent(t);if(n)return n;console.log("父节点为空")}}},{key:"flyToLayer",value:function(t){var e=this.getLayerDataByID(t);e&&this.earth.flyTo(e.dataLayer)}},{key:"addGroup",value:function(t,e){var n=this._findItem(t);if(n){var i=new u.default(e).config;return n.children.push(i),i}}},{key:"removeGroup",value:function(t){var e=this,n=this._findItem(t);if(n.type!==y.default.Group)return void console.log("节点不是图层组");var i=this._findParent(t);if(!i)return void console.log("父节点为空");var r=this._recurrenceLayer(n,[]);return r.map(function(t){return e._removeLayerData(t.id)}),this._removeLayerConfig(i.id,t),i}},{key:"setGroupName",value:function(t,e){var n=this._findItem(t);n&&(n.name=e)}},{key:"getGroupName",value:function(t){var e=this._findItem(t);if(e)return e.name}},{key:"setGroupVisible",value:function(t,e){this._setGroupVisible(t,e)}},{key:"getGroupVisible",value:function(t){var e=this._findItem(t);if(e)return e.show}},{key:"removeAll",value:function(){this.earth.terrainProvider=new Cesium.EllipsoidTerrainProvider;var t=!0,e=!1,n=void 0;try{for(var i,r=this._layerDataSet[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value,a=o[1],s=this._getLayerType(a.type),u=a.dataLayer;switch(s){case"terrian":break;case"image":this.imageryLayers.remove(u);break;case"vector":this.dataSources.remove(u);break;case"model":this.primitives.remove(u)}}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}this._layerDataSet=new Map,this._layerList=Cesium.clone(this._rootGroup,!0)}},{key:"fromJSON",value:function(t){this.removeAll(),this._layerList=Cesium.clone(t,!0),this._addLayers(this._layerList)}},{key:"toJSON",value:function(){return this._layerList;
}},{key:"getLayerDataByID",value:function(t){var e=void 0,n=!0,i=!1,r=void 0;try{for(var a,s=this._layerDataSet[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=o(a.value,2),l=(u[0],u[1]);if(l.id==t){e=l;break}}}catch(t){i=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{if(i)throw r}}return e}},{key:"_setGroupVisible",value:function(t,e){var n=this._findItem(t);if(n.type==y.default.Group){var i=!0,r=!1,o=void 0;try{for(var a,s=n.children[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;this._setGroupVisible(u.id,e)}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}n.show=e}else n.show=e}},{key:"_removeLayerConfig",value:function(t,e){var n=this._findItem(t);if(n)for(var i=0;i<n.children.length;i++){var r=n.children[i];if(e==r.id){n.children.splice(i,1);break}}}},{key:"_removeLayerData",value:function(t){var e=this._layerDataSet.get(t),n=this._getLayerType(e.type);if(e&&n!=y.default.Group){var i=e.dataLayer;switch(n){case"terrian":break;case"image":this.imageryLayers.remove(i);break;case"vector":this.dataSources.remove(i);break;case"model":this.primitives.remove(i)}this._layerDataSet.delete(t)}}},{key:"_removeLayer",value:function(t,e){this._removeLayerData(e),this._removeLayerConfig(t,e)}},{key:"_getAllLayernodes",value:function(){for(var t=[],e=0;e<this._layerList.length;e++){var n=this._recurrenceLayer(this._layerList[e],[]);t=t.concat(n)}return t}},{key:"_recurrenceLayer",value:function(t,e){if(t.type!=y.default.Group)e.push(t);else if(t.children)for(var n=0;n<t.children.length;n++)this._recurrenceLayer(t.children[n],e);return e}},{key:"_recurrenceItem",value:function(t,e){if(t.id==e)return t;if(t.children)for(var n=0;n<t.children.length;n++){var i=this._recurrenceItem(t.children[n],e);if(i)return i}}},{key:"_findItem",value:function(t){for(var e=void 0,n=0;n<this._layerList.length&&!(e=this._recurrenceItem(this._layerList[n],t));n++);return e}},{key:"_findParent",value:function(t){for(var e=[],n=0;n<this._layerList.length;n++)this._recurrenceParent(this._layerList[n],t,e);return e.length>0?e[0]:void 0}},{key:"_recurrenceParent",value:function(t,e,n){if(t.type==y.default.Group){var i=!0,r=!1,o=void 0;try{for(var a,s=t.children[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;if(u.id==e){n.push(t);break}if(u.type==y.default.Group){var l=!0,c=!1,h=void 0;try{for(var f,p=t.children[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var d=f.value;this._recurrenceParent(d,e,n)}}catch(t){c=!0,h=t}finally{try{!l&&p.return&&p.return()}finally{if(c)throw h}}}else if(u.id==e){n.push(t);break}}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}}}},{key:"_getLayerType",value:function(t){var e="";switch(t){case y.default.CesiumTerrain:case y.default.VRWTerrain:case y.default.ArcGISTerrain:e="terrian";break;case y.default.WMS:case y.default.WMTS:case y.default.TMS:case y.default.SingleImage:case y.default.UrlTemplate:case y.default.TileGrid:case y.default.ArcGIS:e="image";break;case y.default.CZML:case y.default.GeoJSON:case y.default.KML:case y.default.VectorTile:case y.default.SHP:e="vector";break;case y.default.Cesium3DTile:case y.default.Custom3DTile:case y.default.GLTF:e="model";break;case y.default.Group:e="group"}return e}},{key:"_addImageLayer",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],new c.default(t)),n=e.initLayer();if(n)return this.imageryLayers.add(n),e}},{key:"_addVectorLayer",value:function(t){var e=new f.default(t),n=e.initLayer();if(n)return this.earth.dataSources.add(n),e}},{key:"_add3DModelLayer",value:function(t){var e=new d.default(t),n=e.initLayer();if(n)return this.primitives.add(n),e}},{key:"_addTerrainLayer",value:function(t){var e=new v.default(t),n=e.initLayer();if(n)return this._terrainLayerList||(this._terrainLayerList=new w.default(this.earth)),this._terrainLayerList.add(e),e}},{key:"_initLayer",value:function(t){var e=this._getLayerType(t.type),n=void 0;switch(e){case y.default.Group:break;case"terrian":n=this._addTerrainLayer(t);break;case"image":n=this._addImageLayer(t);break;case"vector":n=this._addVectorLayer(t);break;case"model":n=this._add3DModelLayer(t)}return n}},{key:"_addLayers",value:function(t){var e=this,n=this._getAllLayernodes(t);n.map(function(t){var n=e._initLayer(t);e._layerDataSet.set(n.id,n)})}},{key:"rootGroup",get:function(){return Cesium.clone(this._rootGroup,!0)},set:function(t){this._rootGroup=t,this.removeAll()}},{key:"layerList",get:function(){return Cesium.clone(this._layerList,!0)}}]),t}();e.default=b},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(30),l=i(u),c=n(31),h=i(c),f=function(t){function e(t){r(this,e);var n={name:t,type:l.default.Group,children:[]};return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n))}return a(e,t),s(e,[{key:"addLayer",value:function(){}}]),e}(h.default);e.default=f},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function t(){n(this,t)};i.Group="Group",i.CesiumTerrain="CesiumTerrain",i.VRWTerrain="VRWTerrain",i.ArcGISTerrain="ArcGISTerrain",i.WMS="WMS",i.WMTS="WMTS",i.TMS="TMS",i.SingleImage="SingleImage",i.UrlTemplate="UrlTemplate",i.TileGrid="TileGrid",i.ArcGIS="ArcGIS",i.CZML="CZML",i.GeoJSON="GeoJSON",i.KML="KML",i.VectorTile="VectorTile",i.SHP="SHP",i.Cesium3DTile="Cesium3DTile",i.Custom3DTile="Custom3DTile",i.GLTF="GLTF",e.default=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(32),s=i(a),u=Cesium.defaultValue,l=function(){function t(e){r(this,t),e.id=u(e.id,Cesium.createGuid()),e.name=u(e.name,"未命名"),e.show=u(e.show,!0),e.style=u(e.style,{}),this._config=e,this.dataLayer=null}return o(t,[{key:"initLayer",value:function(){}},{key:"_checkDefStyles",value:function(t){var e=s.default.getDefStyle(this.type),n=Cesium.clone(e,!0);for(var i in n)Cesium.defined(t[i])||(t[i]=n[i])}},{key:"id",get:function(){return this._config.id}},{key:"name",get:function(){return this._config.name},set:function(t){this._config.name=t}},{key:"show",get:function(){return this._config.show},set:function(t){this.dataLayer.show=t,this._config.show=t}},{key:"type",get:function(){return this._config.type}},{key:"config",get:function(){return this._config}}]),t}();e.default=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(30),s=i(a),u=function(){function t(){r(this,t)}return o(t,null,[{key:"defImageStyle",value:function(){return{alpha:1,brightness:Cesium.ImageryLayer.DEFAULT_BRIGHTNESS,contrast:Cesium.ImageryLayer.DEFAULT_CONTRAST,hue:Cesium.ImageryLayer.DEFAULT_HUE,saturation:Cesium.ImageryLayer.DEFAULT_SATURATION,gamma:Cesium.ImageryLayer.DEFAULT_GAMMA,colorToAlpha:void 0,colorToAlphaThreshold:Cesium.ImageryLayer.DEFAULT_APPLY_COLOR_TO_ALPHA_THRESHOLD}}},{key:"defModelStyle",value:function(){return{maximumScreenSpaceError:16,maximumMemoryUsage:512,debugColorizeTiles:!1,debugWireframe:!1,debugShowBoundingVolume:!1,debugShowUrl:!1}}},{key:"getDefStyle",value:function(e){var n=t._getType(e);return"image"==n?t.defImageStyle():"model"==n?t.defModelStyle():null}},{key:"_getType",value:function(t){var e="";switch(t){case s.default.CesiumTerrain:case s.default.VRWTerrain:case s.default.ArcGISTerrain:e="terrian";break;case s.default.WMS:case s.default.WMTS:case s.default.TMS:case s.default.SingleImage:case s.default.UrlTemplate:case s.default.TileGrid:case s.default.ArcGIS:e="image";break;case s.default.CZML:case s.default.GeoJSON:case s.default.KML:case s.default.VectorTile:case s.default.SHP:e="vector";break;case s.default.Cesium3DTile:case s.default.Custom3DTile:case s.default.GLTF:e="model";break;case s.default.Group:e="group"}return e}}]),t}();e.default=u,u.Image_Dark={}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(30),l=i(u),c=n(31),h=i(c),f=n(16),p=i(f),d=n(13),g=i(d),y=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,t),s(e,[{key:"initLayer",value:function(){var t=this.config.type,e=this.config.options,n=this.config.style;if(this._checkDefStyles(n),!e.url)throw new p.default(g.default.ERROR_PARAMS);switch(t){case l.default.WMS:if(!e.url||!e.layers)throw new p.default(g.default.ERROR_PARAMS);e.parameters=Cesium.defaultValue(e.parameters,{});var i=e.parameters;i.format||(i.format="image/png"),i.transparent||(i.transparent=!0);var r=new Cesium.WebMapServiceImageryProvider(e);this.dataLayer=new Cesium.ImageryLayer(r,n);break;case l.default.WMTS:var o=new Cesium.WebMapTileServiceImageryProvider(e);this.dataLayer=new Cesium.ImageryLayer(o,n);break;case l.default.TMS:var a=new Cesium.WebMapTileServiceImageryProvider(e);this.dataLayer=new Cesium.ImageryLayer(a,n);break;case l.default.SingleImage:var s;e.rectangle&&4==e.rectangle.length&&(s=Cesium.Rectangle.fromDegrees(e.rectangle[0],e.rectangle[1],e.rectangle[2],e.rectangle[3]));var u=new Cesium.SingleTileImageryProvider({url:e.url,rectangle:s});this.dataLayer=new Cesium.ImageryLayer(u,n);break;case l.default.UrlTemplate:var c=new Cesium.UrlTemplateImageryProvider(e);this.dataLayer=new Cesium.ImageryLayer(c,n);break;case l.default.TileGrid:case l.default.ArcGIS:var h=new Cesium.ArcGisMapServerImageryProvider(e);this.dataLayer=new Cesium.ImageryLayer(h,n)}return this.dataLayer}},{key:"update",value:function(t){if(this.dataLayer)for(var e in t)this.config.style[e]=t[e],this.dataLayer[e]=t[e]}}]),e}(h.default);e.default=y},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(30),l=i(u),c=n(31),h=i(c),f=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,t),s(e,[{key:"initLayer",value:function(){var t=void 0,e=this.config.type,n=this.config.params,i=this.config.options;switch(e){case l.default.CZML:var r=new Cesium.CzmlDataSource;t=r.load(n.url,i);break;case l.default.GeoJSON:var o=new Cesium.GeoJsonDataSource;t=o.load(n.url,i);break;case l.default.KML:var a=new Cesium.KmlDataSource;t=a.load(n.url,i);break;case l.default.VectorTile:break;case l.default.SHP:}return t}}]),e}(h.default);e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(30),l=i(u),c=n(31),h=i(c),f=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,t),s(e,[{key:"initLayer",value:function(){var t=this.config.type,e=this.config.style;this._checkDefStyles(e);var n=this.config.options;switch(t){case l.default.Cesium3DTile:this.dataLayer=new Cesium.Cesium3DTileset(n);break;case l.default.Custom3DTile:}return this.update(e),this.dataLayer}},{key:"update",value:function(t){if(this.dataLayer)for(var e in t)"url"!=e&&(this.config.style[e]=t[e],this.dataLayer[e]=t[e])}}]),e}(h.default);e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(30),l=i(u),c=n(31),h=i(c),f=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return a(e,t),s(e,[{key:"initLayer",value:function(){var t=this.config.type,e=this.config.options;switch(t){case l.default.CesiumTerrain:this.dataLayer=new Cesium.CesiumTerrainProvider(e);break;case l.default.VRWTerrain:this.dataLayer=new Cesium.VRTheWorldTerrainProvider(e);break;case l.default.ArcGISTerrain:}return this.dataLayer}}]),e}(h.default);e.default=f},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this._terrainLayers=new Map,this._show=!0,this._baseProvider=new Cesium.EllipsoidTerrainProvider,this.earth=e,this._initBaseTerrain(this._baseProvider),this.earth.terrainProvider=this._baseProvider}return i(t,[{key:"_initBaseTerrain",value:function(t){var e=this;t.requestTileGeometry=function(t,n,i,r){return e._getTerrainData(t,n,i,r)}}},{key:"_getTerrainData",value:function(t,e,n,i){var r=[],o=!0,a=!1,s=void 0;try{for(var u,l=this._terrainLayers[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value,h=c[1].show;if(h){var f=c[1].dataLayer.getTileDataAvailable(t,e,n);f&&r.push(c)}}}catch(t){a=!0,s=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}var p=r.sort(function(t,e){return e[1].index-t[1].index});return p.length>0?p[0][1].dataLayer.requestTileGeometry(t,e,n,i):null}},{key:"_reloadTerain",value:function(){this.earth.terrainProvider=this._baseProvider}},{key:"add",value:function(t){return this._terrainLayers.set(t.id,t),t}},{key:"remove",value:function(t){var e=this._terrainLayers.get(t);return this._terrainLayers.delete(t),e[1]}},{key:"removeAll",value:function(){this._terrainLayers=new Map}},{key:"show",get:function(){return this._show},set:function(t){this._show=t;var e=!0,n=!1,i=void 0;try{for(var r,o=this._terrainLayers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;a[1].show=t}}catch(t){n=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(n)throw i}}}}]),t}();e.default=r},function(t,n,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=i(39),u=r(s),l=i(40),c=r(l),h=i(43),f=r(h),p=i(45),d=(r(p),i(47)),g=r(d),y=i(50),m=r(y),v=i(51),_=r(v),w=i(52),b=r(w),C=i(54),x=r(C),E=i(57),S=r(E),P=i(59),M=r(P),L=i(61),I=r(L),T=i(63),N=r(T),k=i(65),O=r(k),D=i(26),A=r(D),R=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t),this.control={billboard:c.default,label:_.default,ellipse:M.default,polyline:f.default,polylineVolume:S.default,polygon:g.default,ellipsoid:I.default,wall:b.default,point:c.default,rectangle:x.default,model:m.default},this.defDragIcon=Cesium.defaultValue(n.dragIcon,A.default.getResource("Assets/Images/plotIcon/marker/dragIcon.png")),this._onStopDrawing=n.onStopDrawing,this.onStartEditing=n.onStartEditing,this._onStopEditing=n.onStopEditing,this._onChangeEditing=n.onChangeEditing,this._onChangeDrawing=n.onChangeDrawing,this._onMoveDrawing=n.onMoveDrawing,this.options=n,this.viewer=e,this.scene=this.viewer.scene,this.dragIcon=this.defDragIcon,this.dataSource=new Cesium.CustomDataSource,this.viewer.dataSources.add(this.dataSource),this.currentEntity=null,this.arrEntity=[],this.eventCortol=new N.default(this.viewer),this._hasEdit=!1,this.hasEdit(n.hasEdit)}return a(t,[{key:"hasEdit",value:function(t){if(null==this._hasEdit||this._hasEdit!=t){this._onStopEditing;this._hasEdit=t;var e=this,n=this.eventCortol;t?(n.createEditSelectHandler(function(t){e.currentEntity&&e.currentEntity.inProgress||(t!==e.currentEntity?(e.currentEntity&&e.currentEntity.stopEditing&&(e.currentEntity.stopEditing(),e.currentEntity=null),e.currentEntity=t,e.currentEntity&&e.currentEntity.startEditing&&e.currentEntity.startEditing()):e._onStopEditing&&"function"==typeof e._onStopEditing&&e._onStopEditing(t))}),n.createEditDraggerHandler()):(this.stopDraw(),n.destroyEditHandler())}}},{key:"stopDraw",value:function(t){var e=this.currentEntity,n=this.arrEntity,i=this.dataSource;return this.eventCortol.destroyDrawHandler(),e&&e.inProgress&&(e.stopDrawing(t),i.entities.remove(e),this.removeArrayOne(n,e)),e&&e.stopEditing&&(e.stopEditing(t),e=null),this}},{key:"startDraw",value:function(t){if(this.stopDraw(),null==t||null==t.type)throw"请传入需要绘制的类型参数";t.style=t.style||{},t.attr=t.attr||{};var e=t.type,n=this.control,i=this.eventCortol,r=this.dataSource;if(null==n[e])throw"传入的["+e+"]类型参数有误";var o=n[e].startDraw(r,t);switch(o.uid=o.id,e){case"label":case"point":case"billboard":case"model":case"ellipse":case"ellipsoid":i.createDrawPointHandler(o);break;case"polyline":case"polylineEx":case"polylineVolume":i.createDrawPolylineHandler(o,n[e].getPositions(o));break;case"polygon":i.createDrawPolygonHandler(o,n[e].getPositions(o));break;case"rectangle":case"extrudedRectangle":case"measureHeight":i.createTwoPointsModelHandler(o,n[e].getPositions(o));break;case"wall":var a=n[e].getPositions(o),s=n[e].getMinimumHeights(o),u=n[e].getMaximumHeights(o);i.createDrawWallHandler(o,a,s,u)}return this.extendEntity(o),this.arrEntity.push(o),o.startDrawing(),this.currentEntity=o,o}},{key:"fromJSON",value:function(t,e,n){if(t){var i=this.control,r=t;try{O.default.isString(t)&&(r=JSON.parse(t))}catch(t){return void console.error(t.name+": "+t.message+" \n请确认json文件格式正确!!!")}e&&this.removeAll();var o=[],a=r.features;if(a){for(var s=0;s<a.length;s++){var l=a[s];if(!l.properties||!l.properties.type)switch(l.properties=l.properties||{},l.geometry.type){case"MultiPolygon":case"Polygon":l.properties.type="polygon";break;case"MultiLineString":case"LineString":l.properties.type="polyline";break;case"MultiPoint":case"Point":l.properties.type="point"}var c=l.properties.type;if(null==i[c])throw"数据无法识别或者数据的["+c+"]类型参数有误";l.properties.style=l.properties.style||{};var h=i[c].startDraw(this.dataSource,l.properties);h.uid=l.properties.id;var f=u.default.getPositionsFromJson(l.geometry);i[c].setPositions(h,f),this.extendEntity(h),this.arrEntity.push(h),o.push(h)}return n&&this.viewer.flyTo(o),o}}}},{key:"toJSON",value:function(t){var e=this.arrEntity,n=this.control;if(null==t){if(0==e.length)return null;for(var i=[],r=0;r<e.length;r++){var t=e[r],o=t.attribute.type,a=n[o].toGeoJSON(t);a.properties.id=t.uid,i.push(a)}var a={type:"FeatureCollection",features:i};return a}var o=t.attribute.type,a=n[o].toGeoJSON(t);return a.properties.id=t.id,a}},{key:"markersInfoToEntity",value:function(t,n,i){var r=t;try{O.default.isString(t)&&(r=JSON.parse(t))}catch(t){return void console.error(t.name+": "+t.message+" \n请确认json文件格式正确!!!")}if(!(r instanceof Array))return void console.error("请确认json文件格式正确!!!");i&&removeAll();for(var o=0;o<r.length;o++){var a=r[o];if(!a.x||!a.y)return void console.error(e.name+": "+e.message+" \n请确认json文件格式正确!!!");var s={id:a.id||a.ID||"",name:a.name||a.NAME||"",remark:a.remark||a.REMA||""},u={type:n.type||"billboard",attr:s,style:n.style},l=Cesium.Cartesian3.fromDegrees(a.x,a.y,a.z||0),c=this.control[u.type].startDraw(this.dataSource,u);this.control[u.type].setPositions(c,l),this.extendEntity(c),this.arrEntity.push(c)}return this.arrEntity}},{key:"getCurrentEntity",value:function(){return this.currentEntity}},{key:"getEntitys",value:function(){return this.arrEntity}},{key:"getEntityById",value:function(t){for(var e=0;e<this.arrEntity.length;e++){var n=this.arrEntity[e];if(t==n.uid)return n}return null}},{key:"removeAll",value:function(){this.stopDraw(),this.dataSource.entities.removeAll(),this.arrEntity=[]}},{key:"setVisible",value:function(t){var e=this.dataSource,n=this.arrEntity;n.forEach(function(n,i){t?e.entities.contains(i)||e.entities.add(i):e.entities.contains(i)&&e.entities.remove(i)})}},{key:"deleteEntity",value:function(t){null!=t&&(t.stopEditing(!0),this.removeArrayOne(this.arrEntity,t),this.dataSource.entities.remove(t))}},{key:"hasDraw",value:function(){return this.arrEntity.length>0}},{key:"getDataSource",value:function(){return this.dataSource}},{key:"getCoordinates",value:function(t){var e=t.attribute.type,n=this.control[e].getCoordinates(t);return n}},{key:"getPositions",value:function(t){var e=t.attribute.type,n=this.control[e].getPositions(t);return n}},{key:"setPositions",value:function(t,e){var n=t.attribute.type;this.control[n].setPositions(t,e)}},{key:"deleteCurrentEntity",value:function(){var t=this.currentEntity,e=this.dataSource;t&&(t.stopEditing(!0),this.removeArrayOne(this.arrEntity,t),e.entities.remove(t),t=null)}},{key:"updateAttribute",value:function(t,e){var n=this.control,i=this.currentEntity;if(null!=e&&(i=e),null!=i&&null!=t){t.style=t.style||{},t.attr=t.attr||{};var r=i.attribute.type;return n[r].attribute2Entity(t,i[r]),"model"==r&&n[r].attribute2Model(t,i),i.attribute=t,"ellipse"!=r&&"polygon"!=r&&"wall"!=r&&"rectangle"!=r||i.editor.updateDraggers(),i}}},{key:"updateGeometry",value:function(t,e){var n=this.dragIcon,i=this.control;if(null==e&&(e=this.currentEntity),null!=e&&null!=t){var r=e.attribute.type;if(i[r].setPositions(e,t),e.editor&&e.editor.destroy){e.editor.destroy();var o=e.attribute.type;e.editor=i[o].getEditor(dataSource,e,{dragIcon:n})}return e}}},{key:"extendEntity",value:function(t){var e=this.control,n=(this._hasEdit,this.dataSource),i=this,r=this.dragIcon;t.startDrawing=function(){var t=this;i._onStartDrawing&&"function"==typeof i._onStartDrawing&&i._onStartDrawing(t)},t.changeDrawing=function(){var t=this;i._onChangeDrawing&&"function"==typeof i._onChangeDrawing&&i._onChangeDrawing(t)},t.moveDrawing=function(){var t=this;i._onMoveDrawing&&"function"==typeof i._onMoveDrawing&&i._onMoveDrawing(t)},t.stopDrawing=function(){var t=this;i._onStopDrawing&&"function"==typeof i._onStopDrawing&&i._onStopDrawing(t)},t.startEditing=function(){if(i._hasEdit){var t=this;if(i.currentEntity=t,null==t.editor){var o=t.attribute.type;t.editor=e[o].getEditor(n,t,{dragIcon:r})}i._onStartEditing&&"function"==typeof i._onStartEditing&&i._onStartEditing(t)}},t.stopEditing=function(t){var e=this;e.editor&&(e.editor.destroy(),e.editor=null),!t&&i._onStopEditing&&"function"==typeof i._onStopEditing&&i._onStopEditing(e)},t.changeEditing=function(){var t=this;i._onChangeEditing&&"function"==typeof i._onChangeEditing&&i._onChangeEditing(t)},t.updatePositions=function(t){var n=this,r=n.attribute.type;if("ellipse"==r){var o=Cesium.Cartographic.fromCartesian(t).height;if(n.attribute.style.height=Number(o.toFixed(2)),n.ellipse.height?n.ellipse.height._value=n.attribute.style.height:n.ellipse.height=n.attribute.style.height,n.attribute.style.extrudedHeight){var a=Number(o)+Number(n.attribute.style.extrudedHeight);n.ellipse.extrudedHeight._value=Number(a.toFixed(2)),n.attribute.style.extrudedHeight=Number(a.toFixed(2))}}e[r].setPositions(i.currentEntity,t)}}},{key:"removeArrayOne",value:function(t,e){for(var n=0;n<t.length;n++)if(t[n]==e){t.splice(n,1);break}}},{key:"onChangeDrawing",set:function(t){this._onChangeDrawing=t}},{key:"onMoveDrawing",set:function(t){this._onMoveDrawing=t}},{key:"onStopDrawing",set:function(t){this._onStopDrawing=t}},{key:"onStartEditing",set:function(t){this._onStartEditing=t}},{key:"onStopEditing",set:function(t){this._onStopEditing=t}},{key:"onChangeEditing",set:function(t){this._onChangeEditing=t}}]),t}();n.default=R},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t)}return i(t,null,[{key:"createDragger",value:function(t,e){var n;if(e.dragger)n=e.dragger;else{var i=Cesium.defaultValue(e.position,Cesium.Cartesian3.ZERO),r=Cesium.defaultValue(e.dragIcon,"dragIcon.png");n=t.entities.add({position:i,billboard:{scale:1,heightReference:e.heightReference?Cesium.HeightReference.CLAMP_TO_GROUND:Cesium.HeightReference.NONE,image:r}})}return n._isDragger=!0,n.onDrag=Cesium.defaultValue(e.onDrag,null),n.horizontal=Cesium.defaultValue(e.horizontal,!0),n.vertical=Cesium.defaultValue(e.vertical,!1),n.verticalCtrl=Cesium.defaultValue(e.vertical,!1),n}},{key:"getCoordinates",value:function(t){for(var e=[],n=0;n<t.length;n++){var i=Cesium.Cartographic.fromCartesian(t[n]),r=Number(Cesium.Math.toDegrees(i.longitude).toFixed(6)),o=Number(Cesium.Math.toDegrees(i.latitude).toFixed(6)),a=Number(i.height.toFixed(1));e.push([r,o,a])}return e}},{key:"getMaxHeightForPositions",value:function(t,e){null==e&&(e=0);var n=-3e4;if(null==t||0==t.length)return e;for(var i=(t[0],0);i<t.length;i++){var r=Cesium.Cartographic.fromCartesian(t[i]);r.height>n&&(n=r.height)}return n}},{key:"getPositionsWithHeight",value:function(t,e){if(t instanceof Array){for(var n=[],i=0;i<t.length;i++){var r=Cesium.Ellipsoid.WGS84.cartesianToCartographic(t[i]),o={lon:Cesium.Math.toDegrees(r.longitude),lat:Cesium.Math.toDegrees(r.latitude),hgt:Math.ceil(Number(r.height)+Number(e))},a=[o.lon,o.lat,o.hgt];n=n.concat(a)}return Cesium.Cartesian3.fromDegreesArrayHeights(n)}var r=Cesium.Ellipsoid.WGS84.cartesianToCartographic(t),s=Cesium.Math.toDegrees(r.longitude),u=Cesium.Math.toDegrees(r.latitude);return Cesium.Cartesian3.fromDegrees(s,u,Number(r.height)+Number(e))}},{key:"getZHeightPosition",value:function(t,e){var n=Cesium.Cartographic.fromCartesian(t),i=Number(Cesium.Math.toDegrees(n.longitude)),r=Number(Cesium.Math.toDegrees(n.latitude)),o=Number(n.height.toFixed(2)),a=Cesium.Cartographic.fromCartesian(e),s=Number(Cesium.Math.toDegrees(a.longitude)),u=Number(Cesium.Math.toDegrees(a.latitude)),l=Number(a.height.toFixed(2));return o>l?Cesium.Cartesian3.fromDegrees(s,u,o):Cesium.Cartesian3.fromDegrees(i,r,l)}},{key:"getHDistance",value:function(t,e){var n=this.getZHeightPosition(t,e),i=Cesium.Cartographic.fromCartesian(e),r=Cesium.Cartographic.fromCartesian(n),o=Cesium.Cartesian3.distance(t,n);return Math.abs(Number(r.height)-Number(i.height))<.01&&(o=Cesium.Cartesian3.distance(e,n)),o}},{key:"getMidPosition",value:function(t,e){var n=Cesium.Cartographic.fromCartesian(t),i=Number(Cesium.Math.toDegrees(n.longitude)),r=Number(Cesium.Math.toDegrees(n.latitude)),o=Number(n.height.toFixed(2)),a=Cesium.Cartographic.fromCartesian(e),s=Number(Cesium.Math.toDegrees(a.longitude)),u=Number(Cesium.Math.toDegrees(a.latitude)),l=Number(a.height.toFixed(2)),c=(i+s)/2,h=(r+u)/2,f=(o+l)/2;return Cesium.Cartesian3.fromDegrees(c,h,f)}},{key:"getPositionsFromJson",value:function(t){if(!t)return null;switch(t.type){case"Point":return this.lonLatToCartesian(t.coordinates[0]);case"MultiPoint":return this.lonLatsToCartesians(t.coordinates);case"LineString":return this.lonLatsToCartesians(t.coordinates);case"MultiLineString":return this.lonLatsToCartesians(t.coordinates[0]);case"Polygon":return this.lonLatsToCartesians(t.coordinates[0]);case"MultiPolygon":return this.lonLatsToCartesians(t.coordinates[0][0]);default:throw new Error("Invalid GeoJSON object.")}}},{key:"lonLatToCartesian",value:function(t){return Cesium.Cartesian3.fromDegrees(Number(t[0]),Number(t[1]),Number(t[2]||0));
}},{key:"lonLatsToCartesians",value:function(t){for(var e=[],n=0;n<t.length;n++){var i=[Number(t[n][0]),Number(t[n][1]),Number(t[n][2]||0)];e=e.concat(i)}return Cesium.Cartesian3.fromDegreesArrayHeights(e)}},{key:"normalizeJsonData",value:function(t){var e={};e.type="FeatureCollection",e.features=[];var n;if(n="string"==typeof t?JSON.parse(t):t,n instanceof Array){for(var i=0;i<n.length;i++){var r={type:"Feature"};r.properties=n[i].properties||n[i].PROPERTIES,r.geometry=n[i].geometry||n[i].GEOMETRY,e.features.push(r)}return JSON.stringify(e)}if(t.features&&t.features instanceof Array)return t}},{key:"normalizeBusinessData",value:function(t){var e={};try{e=JSON.parse(t)}catch(t){return void haoutil.alert(t.name+": "+t.message+" \n请确认json文件格式正确!!!")}for(var n=e.features,i=[],r=0;r<n.length;r++){var o=n[r],a={dataID:o.properties.attr.id,dataType:o.properties.attr.type,properties:o.properties,geometry:o.geometry};i.push(a)}return JSON.stringify(i)}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(41),s=i(a),u=n(39),l=i(u),c=n(42),h=i(c),f=function(){function t(e){r(this,t),this.typename="billboard"}return o(t,null,[{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({billboard:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={scale:1,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"scaleByDistance_near":case"scaleByDistance_nearValue":case"scaleByDistance_far":case"scaleByDistance_farValue":case"distanceDisplayCondition_far":case"distanceDisplayCondition_near":break;case"opacity":e.color=new Cesium.Color.fromCssColorString("#FFFFFF").withAlpha(Number(i||1));break;case"rotation":e.rotation=Cesium.Math.toRadians(i);break;case"scaleByDistance":i?e.scaleByDistance=new Cesium.NearFarScalar(Number(t.style.scaleByDistance_near||1e3),Number(t.style.scaleByDistance_nearValue||1),Number(t.style.scaleByDistance_far||1e6),Number(t.style.scaleByDistance_farValue||.1)):e.scaleByDistance=null;break;case"distanceDisplayCondition":i?e.distanceDisplayCondition=new Cesium.DistanceDisplayCondition(Number(t.style.distanceDisplayCondition_near||0),Number(t.style.distanceDisplayCondition_far||1e5)):e.distanceDisplayCondition=null}}return e}},{key:"getEditor",value:function(t,e,n){return new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.position=new s.default(e)}},{key:"getPositions",value:function(t){return[t.position._value]}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=l.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"Point",coordinates:e}}}}]),t}();e.default=f},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new Cesium.Event,this._constant=!1,this.setValue(e)}return i(t,[{key:"getValue",value:function(t,e){return this._hasClone?this._value.clone(e):this._value}},{key:"setValue",value:function(t){var e=this._value;if(e!==t){var n=Cesium.defined(t),i=n&&"function"==typeof t.clone,r=n&&"function"==typeof t.equals;this._hasClone=i,this._hasEquals=r;var o=!r||!t.equals(e);o&&(this._value=i?t.clone():t,this._definitionChanged.raiseEvent(this))}}},{key:"equals",value:function(e){return this===e||e instanceof t&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))}},{key:"valueOf",value:function(t){return this._value}},{key:"toString",value:function(t){return String(this._value)}},{key:"isConstant",get:function(){return this._constant},set:function(t){this._constant!==t&&(this._constant=t,this._definitionChanged.raiseEvent(this))}},{key:"definitionChanged",get:function(){return this._definitionChanged}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[];s.default.createDragger(this.dataSource,{dragger:n,onDrag:function(t,e){var i=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(e,n.position._value,i),n.position._value=e,n.changeEditing()}})}return o(t,[{key:"destroy",value:function(){this.draggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(41),s=i(a),u=n(39),l=i(u),c=n(44),h=i(c),f=function(){function t(){r(this,t)}return o(t,null,[{key:"typename",value:function(){return"polyline"}},{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({polyline:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={followSurface:!0,positions:new s.default([])});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"lineType":case"color":case"opacity":case"outline":case"outlineWidth":case"outlineColor":case"outlineOpacity":}}var r=new Cesium.Color.fromCssColorString(t.style.color||"#FFFF00").withAlpha(Number(t.style.opacity||1));switch(t.style.lineType){default:case"solid":t.style.outline?e.material=new Cesium.PolylineOutlineMaterialProperty({color:r,outlineWidth:Number(t.style.outlineWidth||1),outlineColor:new Cesium.Color.fromCssColorString(t.style.outlineColor||"#FFFF00").withAlpha(Number(t.style.outlineOpacity||t.style.opacity||1))}):e.material=r;break;case"dash":e.material=new Cesium.PolylineDashMaterialProperty({color:r})}if(t.style.material){var o=t.style.material,a=o.reverse||!1,u=.001;e.material=new Cesium.StripeMaterialProperty({evenColor:new Cesium.Color.fromCssColorString(o.evenColor||"#000000").withAlpha(Number(t.style.opacity||1)),oddColor:new Cesium.Color.fromCssColorString(o.oddColor||"#FFFFFF").withAlpha(Number(t.style.opacity||1)),repeat:Number(o.repeat||20),orientation:Cesium.StripeOrientation.VERTICAL,offset:new Cesium.CallbackProperty(function(){return a?u+=.001:u-=.001,u},!1)})}return e}},{key:"getEditor",value:function(t,e,n){return new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.polyline.positions.setValue(e)}},{key:"getPositions",value:function(t){return t.polyline.positions._value}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=l.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"LineString",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[];for(var o=n.polyline.positions._value,a=0;a<o.length;a++){var u=o[a],l=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:u,onDrag:function(t,e){o[t.index]=e,n.polyline.positions=o,n.changeEditing()}});l.index=a,this.draggers.push(l)}}return o(t,[{key:"updateDraggers",value:function(){for(var t=this.entity.polyline.positions.getValue(),e=0;e<this.draggers.length;e++){var n=t[e];this.draggers[e].position=n}}},{key:"destroy",value:function(){for(var t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);this.draggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(41),s=i(a),u=n(39),l=i(u),c=n(46),h=i(c),f=function(){function t(){r(this,t)}return o(t,null,[{key:"typename",value:function(){return"polylineEx"}},{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({polyline:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={followSurface:!0,positions:new s.default([])});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"lineType":case"color":case"opacity":case"outline":case"outlineWidth":case"outlineColor":case"outlineOpacity":}}var r=new Cesium.Color.fromCssColorString(t.style.color||"#FFFF00").withAlpha(Number(t.style.opacity||1));if(t.style.material){var o=t.style.material,a=o.reverse||!1,u=.001;e.material=new Cesium.StripeMaterialProperty({evenColor:new Cesium.Color.fromCssColorString(o.evenColor||"#FFFF00").withAlpha(Number(o.evenColorOpacity||1)),oddColor:new Cesium.Color.fromCssColorString(o.oddColor||"#FFFFFF").withAlpha(Number(o.oddColorOpacity||1)),repeat:Number(o.repeat||20),orientation:Cesium.StripeOrientation.VERTICAL,offset:new Cesium.CallbackProperty(function(){return a?u+=.001:u-=.001,u},!1)})}else t.style.outline?e.material=new Cesium.PolylineOutlineMaterialProperty({color:r,outlineWidth:Number(t.style.outlineWidth||1),outlineColor:new Cesium.Color.fromCssColorString(t.style.outlineColor||"#FFFF00").withAlpha(Number(t.style.outlineOpacity||t.style.opacity||1))}):e.material=r;return e}},{key:"getEditor",value:function(t,e,n){return new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.polyline.positions.setValue(e)}},{key:"getPositions",value:function(t){return t.polyline.positions._value}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=l.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"LineString",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[];for(var o=n.polyline.positions._value,a=0;a<o.length;a++){var u=o[a],l=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:u,onDrag:function(t,e){o[t.index]=e,n.polyline.positions=o,n.changeEditing()}});l.index=a,this.draggers.push(l)}}return o(t,[{key:"updateDraggers",value:function(){for(var t=this.entity.polyline.positions.getValue(),e=0;e<this.draggers.length;e++){var n=t[e];this.draggers[e].position=n}}},{key:"destroy",value:function(){for(var t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);this.draggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(39),u=i(s),l=n(48),c=i(l),h=n(49),f=i(h),p=n(41),d=i(p),g=function(){function t(e){r(this,t),this.typename="polygon"}return a(t,null,[{key:"typename",value:function(){return"polygon"}},{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({polygon:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={fill:!0,classificationType:Cesium.ClassificationType.BOTH,hierarchy:Cesium.Cartesian3.fromDegreesArray([])});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(t.style.outlineOpacity||t.style.opacity||1);break;case"color":e.material=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1));break;case"extrudedHeight":var r=u.default.getMaxHeightForPositions(e.hierarchy._value);e.extrudedHeight=Number(i)+r;break;case"clampToGround":e.perPositionHeight=!i}}return null==t.style.color&&(e.material=Cesium.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.style.opacity||1)})),e}},{key:"getEditor",value:function(t,e,n){return e.polygon.extrudedHeight?new c.default(t,e,n):new f.default(t,e,n)}},{key:"setPositions",value:function(t,e){if(t.polygon.hierarchy=new d.default(e),t.attribute.style.extrudedHeight){var n=u.default.getMaxHeightForPositions(e);t.polygon.extrudedHeight=n+Number(t.attribute.style.extrudedHeight)}}},{key:"getPositions",value:function(t){var e=t.polygon.hierarchy._value;return e.positions&&this.isArray(e.positions)?e.positions:e}},{key:"isArray",value:function(t){return"object"==("undefined"==typeof t?"undefined":o(t))&&t.constructor==Array}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=u.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);if(e.length>0){var n=e[0],i=e[e.length-1];n[0]==i[0]&&n[1]==i[1]&&n[2]==i[2]||e.push(n)}return{type:"Feature",properties:t.attribute,geometry:{type:"Polygon",coordinates:[e]}}}}]),t}();e.default=g},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[],this.heightDraggers=[];var o=this,a=0,u=n.polygon.hierarchy._value;for(a=0;a<u.length;a++){var l=u[a];if(void 0!=n.polygon.height){var c=Cesium.Cartographic.fromCartesian(l);c.height+=n.polygon.height._value,l=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,c.height)}var h=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:l,onDrag:function(t,e){t.positions[t.index]=e;for(var i=n.polygon.hierarchy._value,r=i[0],a=1;a<i.length;a++){var s=Cesium.Cartographic.fromCartesian(r),u=Cesium.Cartographic.fromCartesian(i[a]);Number(u.height)>Number(s.height)&&(r=i[a])}var l=Number(n.polygon.extrudedHeight)-Number(Cesium.Cartographic.fromCartesian(r).height);n.attribute.style.extrudedHeight=Number(l).toFixed(2),o.updateDraggers(),n.changeEditing()}});h.index=a,h.positions=u,this.draggers.push(h)}if(n.polygon.extrudedHeight)for(a=0;a<u.length;a++){var f=u[a],p=Cesium.Cartographic.fromCartesian(f);p.height=n.polygon.extrudedHeight._value;var d=Cesium.Cartesian3.fromRadians(p.longitude,p.latitude,p.height),h=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:d,onDrag:function(t,e){for(var i=o.entity.polygon.hierarchy._value,r=i[0],a=1;a<i.length;a++){var s=Cesium.Cartographic.fromCartesian(r),u=Cesium.Cartographic.fromCartesian(i[a]);Number(u.height)>Number(s.height)&&(r=i[a])}var l=Cesium.Cartographic.fromCartesian(e);n.polygon.extrudedHeight=new Cesium.ConstantProperty(Number(l.height));var c=Number(l.height)-Number(Cesium.Cartographic.fromCartesian(r).height);n.attribute.style.extrudedHeight=Number(c).toFixed(2),o.updateDraggers(),n.changeEditing()},vertical:!0,horizontal:!1});h.index=a,this.heightDraggers.push(h)}}return o(t,[{key:"updateDraggers",value:function(){var t=this.entity.polygon.hierarchy._value,e=this.entity.polygon.extrudedHeight._value,n=0;void 0!=this.entity.polygon.height&&(n=this.entity.polygon.height._value);for(var i=0;i<this.heightDraggers.length;i++){var r=t[i],o=this.heightDraggers[i],a=Cesium.Cartographic.fromCartesian(r);a.height=e;var s=Cesium.Cartesian3.fromRadians(a.longitude,a.latitude,a.height);o.position=s;var u=this.draggers[i],l=Cesium.Cartographic.fromCartesian(r);l.height+=n,s=Cesium.Cartesian3.fromRadians(l.longitude,l.latitude,l.height),u.position=s}}},{key:"destroy",value:function(){var t=0;for(t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);for(this.draggers=[],t=0;t<this.heightDraggers.length;t++)this.dataSource.entities.remove(this.heightDraggers[t]);this.heightDraggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[];for(var o=n.polygon.hierarchy._value.positions,a=0;a<o.length;a++){var u=o[a],l=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:u,heightReference:!n.attribute.style.perPositionHeight,onDrag:function(t,e){t.positions[t.index]=e,n.polygon.hierarchy=t.positions,n.changeEditing()}});l.index=a,l.positions=o,this.draggers.push(l)}}return o(t,[{key:"updateDraggers",value:function(){for(var t=this.entity.polygon.hierarchy._value,e=0;e<this.draggers.length;e++){var n=t[e];this.draggers[e].position=n}}},{key:"destroy",value:function(){for(var t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);this.draggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=n(42),l=i(u),c=n(41),h=i(c),f=function(){function t(e){r(this,t),this.typename="model"}return o(t,null,[{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({model:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"silhouette":case"silhouetteColor":case"silhouetteAlpha":case"silhouetteSize":case"fill":case"color":case"opacity":break;case"modelUrl":e.uri=i}}return t.style.silhouette?(e.silhouetteColor=new Cesium.Color.fromCssColorString(t.style.silhouetteColor||"#FFFFFF").withAlpha(Number(t.style.silhouetteAlpha||1)),e.silhouetteSize=Number(t.style.silhouetteSize||1)):e.silhouetteSize=0,t.style.fill?e.color=new Cesium.Color.fromCssColorString(t.style.color||"#FFFFFF").withAlpha(Number(t.style.opacity||1)):e.color=new Cesium.Color.fromCssColorString("#FFFFFF").withAlpha(Number(t.style.opacity||1)),e}},{key:"attribute2Model",value:function(t,e){var n=Cesium.Math.toRadians(Number(e.attribute.style.heading||0)),i=Cesium.Math.toRadians(Number(e.attribute.style.pitch||0)),r=Cesium.Math.toRadians(Number(e.attribute.style.roll||0)),o=new Cesium.HeadingPitchRoll(n,i,r);e.orientation&&(e.orientation=Cesium.Transforms.headingPitchRollQuaternion(e.position._value,o))}},{key:"getEditor",value:function(t,e,n){return new l.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.position=new h.default(e);var n=Cesium.Math.toRadians(Number(t.attribute.style.heading||0)),i=Cesium.Math.toRadians(Number(t.attribute.style.pitch||0)),r=Cesium.Math.toRadians(Number(t.attribute.style.roll||0)),o=new Cesium.HeadingPitchRoll(n,i,r);t.orientation=Cesium.Transforms.headingPitchRollQuaternion(t.position._value,o)}},{key:"getPositions",value:function(t){return[t.position._value]}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=s.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"Point",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=n(42),l=i(u),c=n(41),h=i(c),f=function(){function t(e){r(this,t),this.typename="label"}return o(t,null,[{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({label:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={scale:1,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"font_style":case"font_weight":case"font_size":case"font_family":case"text":case"scaleByDistance_near":case"scaleByDistance_nearValue":case"scaleByDistance_far":case"scaleByDistance_farValue":case"distanceDisplayCondition_far":case"distanceDisplayCondition_near":break;case"color":e.fillColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1));break;case"border":e.style=i?Cesium.LabelStyle.FILL_AND_OUTLINE:Cesium.LabelStyle.FILL;break;case"border_color":e.outlineColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1));break;case"border_width":e.outlineWidth=i;break;case"background":e.showBackground=i;break;case"background_color":e.backgroundColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1));break;case"pixelOffset":e.pixelOffset=new Cesium.Cartesian2(t.style.pixelOffset[0],t.style.pixelOffset[1]);break;case"scaleByDistance":i?e.scaleByDistance=new Cesium.NearFarScalar(Number(t.style.scaleByDistance_near||1e3),Number(t.style.scaleByDistance_nearValue||1),Number(t.style.scaleByDistance_far||1e6),Number(t.style.scaleByDistance_farValue||.1)):e.scaleByDistance=null;break;case"distanceDisplayCondition":i?e.distanceDisplayCondition=new Cesium.DistanceDisplayCondition(Number(t.style.distanceDisplayCondition_near||0),Number(t.style.distanceDisplayCondition_far||1e5)):e.distanceDisplayCondition=null}}e.text=t.style.text||"文字";var r=(t.style.font_style||"normal")+" "+(t.style.font_weight||"normal")+" "+(t.style.font_size||"30")+"px "+(t.style.font_family||"微软雅黑");return e.font=r,e}},{key:"getEditor",value:function(t,e,n){return new l.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.position=new h.default(e)}},{key:"getPositions",value:function(t){return[t.position._value]}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=s.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"Point",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(41),s=i(a),u=n(39),l=i(u),c=n(53),h=i(c),f=function(){function t(){r(this,t)}return o(t,null,[{key:"typename",value:function(){return"wall"}},{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({wall:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},e||(e={fill:!0,minimumHeights:[],maximumHeights:[],positions:new s.default([])});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(t.style.outlineOpacity||t.style.opacity||1);break;case"color":e.material=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1))}}return null==e.material&&(e.material=Cesium.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.style.opacity||1)})),e}},{key:"getEditor",value:function(t,e,n){return new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){if(t.wall.positions=new s.default(e),t.wall.maximumHeights&&t.wall.minimumHeights)for(var n=0;n<e.length;n++){var i=Cesium.Cartographic.fromCartesian(e[n]);t.wall.minimumHeights._value[n]=Number(i.height),t.wall.maximumHeights._value[n]=Number(i.height)+Number(t.attribute.style.extrudedHeight)}}},{key:"getPositions",value:function(t){return t.wall.positions._value}},{key:"setMaximumHeights",value:function(t,e){t.wall.maximumHeights=new s.default(e)}},{key:"getMaximumHeights",value:function(t){return t.wall.maximumHeights._value}},{key:"setMinimumHeights",value:function(t,e){t.wall.minimumHeights=new s.default(e)}},{key:"getMinimumHeights",value:function(t){return t.wall.minimumHeights._value}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=l.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"LineString",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[],this.heightDraggers=[];var o=this,a=0,s=n.wall.positions._value;for(a=0;a<s.length;a++){var u=s[a],l=_drawutils.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:u,onDrag:function(t,e){t.positions[t.index]=e,o.updateDraggers(),n.changeEditing()}});l.index=a,l.positions=s,this.draggers.push(l)}if(n.wall.maximumHeights)for(a=0;a<s.length;a++){var c=s[a],h=Cesium.Cartographic.fromCartesian(c.clone());h.height=n.wall.maximumHeights._value[a];var u=Cesium.Cartesian3.fromRadians(h.longitude,h.latitude,h.height),l=_drawutils.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:u,onDrag:function(t,e){var i=Cesium.Cartographic.fromCartesian(e),r=o.entity.wall.minimumHeights._value,a=Number(i.height)-Number(r[t.index]);n.attribute.style.extrudedHeight=a.toFixed(2),o.updateDraggers(),n.changeEditing()},vertical:!0,horizontal:!1});l.index=a,this.heightDraggers.push(l)}}return o(t,[{key:"updateDraggers",value:function(){for(var t=this.entity.wall.positions._value,e=this.entity.wall.minimumHeights._value,n=this.entity.wall.maximumHeights._value,i=0;i<this.heightDraggers.length;i++){var r=t[i].clone(),o=this.heightDraggers[i],a=Cesium.Cartographic.fromCartesian(r);e[i]=a.height,n[i]=Number(a.height)+Number(this.entity.attribute.style.extrudedHeight),o.position=s.default.getPositionsWithHeight(r,this.entity.attribute.style.extrudedHeight),this.draggers[i].position=r}}},{key:"destroy",value:function(){var t=0;for(t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);for(this.draggers=[],t=0;t<this.heightDraggers.length;t++)this.dataSource.entities.remove(this.heightDraggers[t]);this.heightDraggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=n(55),l=i(u),c=n(56),h=i(c),f=function(){function t(e){r(this,t),this.typename="rectangle"}return o(t,null,[{key:"typename",value:function(){return"rectangle"}},{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({rectangle:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){if(t=t||{},t.style=t.style||{},!e){var n=Cesium.Rectangle.fromDegrees(78.654473,34.878143,78.654673,34.878316);e={fill:!0,closeTop:!0,closeBottom:!0,coordinates:n}}for(var i in t.style){var r=t.style[i];switch(i){default:e[i]=r;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new Cesium.Color.fromCssColorString(r||"#FFFF00").withAlpha(t.style.outlineOpacity||t.style.opacity||1);break;case"height":e.height=Number(r),e.extrudedHeight=Number(t.style.extrudedHeight)+Number(r);break;case"extrudedHeight":e.extrudedHeight=Number(e.height)+Number(r);
break;case"color":e.material=new Cesium.Color.fromCssColorString(r||"#FFFF00").withAlpha(Number(t.style.opacity||1));break;case"image":e.material=t.style.image;break;case"rotation":e.rotation=Cesium.Math.toRadians(r),t.style.stRotation||(e.stRotation=Cesium.Math.toRadians(r));break;case"stRotation":e.stRotation=Cesium.Math.toRadians(r)}}return null==e.material&&(e.material=Cesium.Color.fromRandom({minimumGreen:.75,maximumBlue:.75,alpha:Number(t.style.opacity||1)})),e}},{key:"getEditor",value:function(t,e,n){return e.rectangle.extrudedHeight?new l.default(t,e,n):new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){e instanceof Array&&(e=Cesium.Rectangle.fromCartesianArray(e)),t.rectangle.coordinates.setValue(e)}},{key:"getPositions",value:function(t){return t.rectangle.coordinates}},{key:"getCoordinates",value:function(t){var e=this.getDiagonalPositions(t),n=s.default.getCoordinates(e);return n}},{key:"getDiagonalPositions",value:function(t){var e=t.rectangle.coordinates._value,n=Cesium.Rectangle.northwest(e),i=Cesium.Rectangle.southeast(e);return Cesium.Cartesian3.fromRadiansArray([n.longitude,n.latitude,i.longitude,i.latitude])}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"MultiPoint",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[],this.heightDraggers=[];var o=this,a=0,u=this.getDraggersPositions();for(a=0;a<u.length;a++){var l=u[a];if(void 0!=n.rectangle.height){var c=Cesium.Cartographic.fromCartesian(l);c.height+=n.rectangle.height._value,l=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,c.height)}var h=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:l,onDrag:function(t,e){t.positions[t.index]=e;var i;i=0==t.index?Cesium.Rectangle.fromCartesianArray([e,t.positions[1]]):Cesium.Rectangle.fromCartesianArray([e,t.positions[0]]),n.rectangle.coordinates.setValue(i),o.updateDraggers(),n.changeEditing()}});h.index=a,h.positions=u,this.draggers.push(h)}if(n.rectangle.extrudedHeight)for(a=0;a<u.length;a++){var f=u[a],c=Cesium.Cartographic.fromCartesian(f);c.height+=n.rectangle.extrudedHeight._value;var l=Cesium.Cartesian3.fromRadians(c.longitude,c.latitude,c.height),h=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:l,onDrag:function(t,e){var i=Cesium.Cartographic.fromCartesian(e);n.rectangle.extrudedHeight=new Cesium.ConstantProperty(i.height);var r=Number(i.height)-Number(n.rectangle.height);n.attribute.style.extrudedHeight=Number(r).toFixed(2),o.updateDraggers(),n.changeEditing()},vertical:!0,horizontal:!1});h.index=a,this.heightDraggers.push(h)}}return o(t,[{key:"getDraggersPositions",value:function(){var t=this.entity.rectangle.coordinates._value,e=Cesium.Rectangle.northwest(t),n=Cesium.Rectangle.southeast(t);return Cesium.Cartesian3.fromRadiansArray([e.longitude,e.latitude,n.longitude,n.latitude])}},{key:"updateDraggers",value:function(){var t=this.getDraggersPositions(),e=this.entity.rectangle.extrudedHeight._value,n=0;void 0!=this.entity.rectangle.height&&(n=this.entity.rectangle.height._value);for(var i=0;i<this.heightDraggers.length;i++){var r=t[i],o=this.heightDraggers[i],a=Cesium.Cartographic.fromCartesian(r);a.height+=e;var s=Cesium.Cartesian3.fromRadians(a.longitude,a.latitude,a.height);o.position=s;var u=this.draggers[i],l=Cesium.Cartographic.fromCartesian(r);l.height+=n,s=Cesium.Cartesian3.fromRadians(l.longitude,l.latitude,l.height),u.position=s}}},{key:"destroy",value:function(){var t=0;for(t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);for(this.draggers=[],t=0;t<this.heightDraggers.length;t++)this.dataSource.entities.remove(this.heightDraggers[t]);this.heightDraggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[];for(var o=this.getDraggersPositions(),a=0;a<o.length;a++){var u=o[a],l=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:u,heightReference:!n.attribute.style.perPositionHeight,onDrag:function(t,e){t.positions[t.index]=e;var i;i=0==t.index?Cesium.Rectangle.fromCartesianArray([e,t.positions[1]]):Cesium.Rectangle.fromCartesianArray([e,t.positions[0]]),n.rectangle.coordinates.setValue(i),n.changeEditing()}});l.index=a,l.positions=o,this.draggers.push(l)}}return o(t,[{key:"getDraggersPositions",value:function(){var t=this.entity.rectangle.coordinates._value,e=Cesium.Rectangle.northwest(t),n=Cesium.Rectangle.southeast(t);return Cesium.Cartesian3.fromRadiansArray([e.longitude,e.latitude,n.longitude,n.latitude])}},{key:"updateDraggers",value:function(){for(var t=this.getDraggersPositions(),e=0;e<this.draggers.length;e++){var n=t[e];this.draggers[e].position=n}}},{key:"destroy",value:function(){for(var t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);this.draggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(41),s=i(a),u=n(39),l=i(u),c=n(58),h=i(c),f=function(){function t(){r(this,t)}return o(t,null,[{key:"typename",value:function(){return"polylineVolume"}},{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({polylineVolume:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={positions:new s.default([])});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"opacity":case"outlineOpacity":case"radius":case"shape":break;case"outlineColor":e.outlineColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(t.style.outlineOpacity||t.style.opacity||1);break;case"color":e.material=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1))}}switch(t.style.radius=t.style.radius||10,t.style.shape){default:case"pipeline":e.shape=this._getCorridorShape1(t.style.radius);break;case"circle":e.shape=this._getCorridorShape2(t.style.radius);break;case"star":e.shape=this._getCorridorShape3(t.style.radius)}return e}},{key:"_getCorridorShape1",value:function(t){for(var e=t/3,n=0,i=360,r=[],o=n;o<=i;o++){var a=Cesium.Math.toRadians(o);r.push(new Cesium.Cartesian2(t*Math.cos(a),t*Math.sin(a)))}for(var o=i;o>=n;o--){var a=Cesium.Math.toRadians(o);r.push(new Cesium.Cartesian2((t-e)*Math.cos(a),(t-e)*Math.sin(a)))}return r}},{key:"_getCorridorShape2",value:function(t){for(var e=0,n=360,i=[],r=e;r<=n;r++){var o=Cesium.Math.toRadians(r);i.push(new Cesium.Cartesian2(t*Math.cos(o),t*Math.sin(o)))}return i}},{key:"_getCorridorShape3",value:function(t,e){for(var e=e||6,n=Math.PI/e,i=2*e,r=new Array(i),o=0;o<i;o++){var a=o%2===0?t:t/3;r[o]=new Cesium.Cartesian2(Math.cos(o*n)*a,Math.sin(o*n)*a)}return r}},{key:"getEditor",value:function(t,e,n){return new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.polylineVolume.positions=e}},{key:"getPositions",value:function(t){return t.polylineVolume.positions._value}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=l.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"LineString",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.draggers=[];for(var o=n.polylineVolume.positions.getValue(),a=0;a<o.length;a++){var u=o[a],l=s.default.createDragger(this.dataSource,{dragIcon:i.dragIcon,position:u,onDrag:function(t,e){o[t.index]=e,n.polylineVolume.positions=o,n.changeEditing()}});l.index=a,this.draggers.push(l)}}return o(t,[{key:"updateDraggers",value:function(){for(var t=this.entity.polylineVolume.positions.getValue(),e=0;e<this.draggers.length;e++){var n=t[e];this.draggers[e].position=n}}},{key:"destroy",value:function(){for(var t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);this.draggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(41),s=i(a),u=n(39),l=i(u),c=n(60),h=i(c),f=function(){function t(e){r(this,t),this.typename="ellipse"}return o(t,null,[{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({ellipse:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={fill:!0});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"opacity":case"outlineOpacity":break;case"outlineColor":e.outlineColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(t.style.outlineOpacity||t.style.opacity||1);break;case"color":e.material=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1));break;case"rotation":e.rotation=Cesium.Math.toRadians(i);break;case"radius":e.semiMinorAxis=i,e.semiMajorAxis=i}}return e}},{key:"getEditor",value:function(t,e,n){return new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.position=new s.default(e)}},{key:"getPositions",value:function(t){return[t.position._value]}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=l.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"Point",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.options=i,this.draggers=[],this.heightDraggers=[],this.initDraggers()}return o(t,[{key:"initDraggers",value:function(){var t=this,e=s.default.createDragger(this.dataSource,{dragIcon:this.options.dragIcon,position:this.entity.position._value,onDrag:function(e,n){var i=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(n,t.entity.position._value,i);var r=Cesium.Cartographic.fromCartesian(n),o=Number(r.height).toFixed(2);t.entity.ellipse.height=new Cesium.ConstantProperty(r.height),t.entity.attribute.style.height=o,t.entity.position._value=n;var a=new Cesium.Cartesian3;Cesium.Cartesian3.add(e.majorDragger.position._value,i,a),e.majorDragger.position=new Cesium.ConstantProperty(a),Cesium.Cartesian3.add(e.minorDragger.position._value,i,a),e.minorDragger.position=new Cesium.ConstantProperty(a),void 0!=t.entity.attribute.style.extrudedHeight&&t.updateHeightDraggers(),t.entity.changeEditing()}});this.draggers.push(e);var n=Cesium.EllipseGeometryLibrary.computeEllipsePositions({center:this.entity.position._value,semiMinorAxis:this.entity.ellipse.semiMinorAxis._value,semiMajorAxis:this.entity.ellipse.semiMajorAxis._value,rotation:Cesium.Math.toRadians(Number(this.entity.attribute.style.rotation||0)),granularity:2},!0,!1),i=new Cesium.Cartesian3(n.positions[0],n.positions[1],n.positions[2]),r=s.default.createDragger(this.dataSource,{dragIcon:this.options.dragIcon,position:i,onDrag:function(e,n){var i=Cesium.Cartesian3.distance(t.entity.position._value,n),r=Number(i.toFixed(2));t.entity.ellipse.semiMajorAxis=new Cesium.ConstantProperty(r),t.entity.attribute.style.radius?(t.entity.attribute.style.radius=r,t.entity.ellipse.semiMinorAxis=new Cesium.ConstantProperty(r)):t.entity.attribute.style.semiMajorAxis=r,void 0!=t.entity.attribute.style.extrudedHeight&&t.updateHeightDraggers(),t.entity.changeEditing()}});e.majorDragger=r,this.draggers.push(r);var o=new Cesium.Cartesian3(n.positions[3],n.positions[4],n.positions[5]),a=s.default.createDragger(this.dataSource,{dragIcon:this.options.dragIcon,position:o,onDrag:function(e,n){var i=Cesium.Cartesian3.distance(t.entity.position._value,n),r=Number(i.toFixed(2));t.entity.ellipse.semiMinorAxis=new Cesium.ConstantProperty(r),t.entity.attribute.style.radius?(t.entity.attribute.style.radius=r,t.entity.ellipse.semiMajorAxis=new Cesium.ConstantProperty(r)):t.entity.attribute.style.semiMinorAxis=r,void 0!=t.entity.attribute.style.extrudedHeight&&t.updateHeightDraggers(),t.entity.changeEditing()}});e.minorDragger=a,this.draggers.push(a),void 0!=this.entity.attribute.style.extrudedHeight&&this.initHeightDraggers()}},{key:"initHeightDraggers",value:function(){var t=this,e=Number(this.entity.attribute.style.extrudedHeight)-Number(this.entity.attribute.style.height),n=s.default.createDragger(this.dataSource,{dragIcon:this.options.dragIcon,position:s.default.getPositionsWithHeight(this.entity.position._value,e),onDrag:function(n,i){var r=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(i,t.entity.position._value,r);var o=Cesium.Cartographic.fromCartesian(i),a=Number(o.height).toFixed(2);t.entity.position._value=i,t.entity.ellipse.extrudedHeight=new Cesium.ConstantProperty(Number(a)+Number(e)),t.entity.ellipse.height=new Cesium.ConstantProperty(o.height),t.entity.attribute.style.extrudedHeight=Number(a)+Number(e),t.entity.attribute.style.height=a,t.updateDraggers(),t.entity.changeEditing()}});this.heightDraggers.push(n);var i=Cesium.EllipseGeometryLibrary.computeEllipsePositions({center:this.entity.position._value,semiMinorAxis:this.entity.ellipse.semiMinorAxis._value,semiMajorAxis:this.entity.ellipse.semiMajorAxis._value,rotation:Cesium.Math.toRadians(Number(this.entity.attribute.style.rotation||0)),granularity:2},!0,!1),r=new Cesium.Cartesian3(i.positions[0],i.positions[1],i.positions[2]),o=s.default.createDragger(this.dataSource,{dragIcon:this.options.dragIcon,position:s.default.getPositionsWithHeight(r,e),onDrag:function(e,n){var i=Cesium.Cartographic.fromCartesian(n);t.entity.ellipse.extrudedHeight=new Cesium.ConstantProperty(i.height),t.entity.attribute.style.extrudedHeight=Number(i.height).toFixed(2),t.updateHeightDraggers(),t.entity.changeEditing()},vertical:!0,horizontal:!1});this.heightDraggers.push(o);var a=new Cesium.Cartesian3(i.positions[3],i.positions[4],i.positions[5]),u=s.default.createDragger(this.dataSource,{dragIcon:this.options.dragIcon,position:s.default.getPositionsWithHeight(a,e),onDrag:function(e,n){var i=Cesium.Cartographic.fromCartesian(n);t.entity.ellipse.extrudedHeight=new Cesium.ConstantProperty(i.height),t.entity.attribute.style.extrudedHeight=Number(i.height).toFixed(2),t.updateHeightDraggers(),t.entity.changeEditing()},vertical:!0,horizontal:!1});this.heightDraggers.push(u)}},{key:"updateDraggers",value:function(){this.destroy(),this.initDraggers()}},{key:"updateHeightDraggers",value:function(){for(var t=0;t<this.heightDraggers.length;t++)this.dataSource.entities.remove(this.heightDraggers[t]);this.heightDraggers=[],this.initHeightDraggers()}},{key:"destroy",value:function(){var t=0;for(t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);if(this.draggers=[],void 0!=this.entity.attribute.style.extrudedHeight){for(t=0;t<this.heightDraggers.length;t++)this.dataSource.entities.remove(this.heightDraggers[t]);this.heightDraggers=[]}}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(41),s=i(a),u=n(39),l=i(u),c=n(62),h=i(c),f=function(){function t(){r(this,t)}return o(t,null,[{key:"typename",value:function(){return"ellipsoid"}},{key:"startDraw",value:function(t,e){var n=this.attribute2Entity(e),i=t.entities.add({ellipsoid:n,attribute:e});return i}},{key:"attribute2Entity",value:function(t,e){t=t||{},t.style=t.style||{},null==e&&(e={fill:!0});for(var n in t.style){var i=t.style[n];switch(n){default:e[n]=i;break;case"opacity":case"outlineOpacity":case"widthRadii":case"heightRadii":break;case"outlineColor":e.outlineColor=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(t.style.outlineOpacity||t.style.opacity||1);break;case"color":e.material=new Cesium.Color.fromCssColorString(i||"#FFFF00").withAlpha(Number(t.style.opacity||1));break;case"extentRadii":var r=t.style.extentRadii||100,o=t.style.widthRadii||100,a=t.style.heightRadii||100;e.radii=new Cesium.Cartesian3(r,o,a)}}return e}},{key:"getEditor",value:function(t,e,n){return new h.default(t,e,n)}},{key:"setPositions",value:function(t,e){t.position=new s.default(e)}},{key:"getPositions",value:function(t){return[t.position._value]}},{key:"getCoordinates",value:function(t){var e=this.getPositions(t),n=l.default.getCoordinates(e);return n}},{key:"toGeoJSON",value:function(t){var e=this.getCoordinates(t);return{type:"Feature",properties:t.attribute,geometry:{type:"Point",coordinates:e}}}}]),t}();e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=function(){function t(e,n,i){r(this,t),this.dataSource=e,this.entity=n,this.options=i,this.draggers=[],this.initDraggers()}return o(t,[{key:"initDraggers",value:function(){var t=this,e=this.entity.position._value,n=Number(this.entity.attribute.style.heightRadii)||0,i=Cesium.Cartographic.fromCartesian(e);i.height+=n;var r=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,i.height),o=s.default.createDragger(this.dataSource,{dragIcon:this.options.dragIcon,position:r,onDrag:function(e,n){var i=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(n,t.entity.position._value,i);var r=Cesium.Cartographic.fromCartesian(n),o=Number(t.entity.attribute.style.heightRadii)||0;r.height-=o;var a=Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,r.height);t.entity.position._value=a,t.entity.changeEditing()}});this.draggers.push(o)}},{key:"updateDraggers",value:function(){this.destroy(),this.initDraggers()}},{key:"destroy",value:function(){for(var t=0;t<this.draggers.length;t++)this.dataSource.entities.remove(this.draggers[t]);this.draggers=[]}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(39),s=i(a),u=n(64),l=i(u),c=function(){function t(e){r(this,t),this.viewer=e,e.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),e.screenSpaceEventHandler.removeInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK)}return o(t,[{key:"setCursor",value:function(t){document.getElementById(this.viewer._container.id).style.cursor=t||""}},{key:"createDrawPointHandler",value:function(t){this.setCursor("crosshair");var e=this;t.inProgress=!0;var n=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);return n.setInputAction(function(i){var r=l.default.getCurrentMousePosition(e.viewer.scene,i.position);r&&(e.setCursor(),t.updatePositions(r),t.inProgress=!1,t.stopDrawing(),t.startEditing(),n.destroy(),e.drawHandler=null)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.drawHandler=n,n}},{key:"createDrawPolylineHandler",value:function(t,e){this.setCursor("crosshair");var n=this;t.inProgress=!0;var i=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);return i.lastPointTemporary=!1,i.setInputAction(function(r){var o=l.default.getCurrentMousePosition(n.viewer.scene,r.position);o&&(i.lastPointTemporary&&e.pop(),t.attribute&&t.attribute.addHeight&&(o=s.default.getPositionsWithHeight(o,t.attribute.addHeight)),e.push(o),i.lastPointTemporary=!1,t.attribute&&t.attribute.minMaxPoints&&(e.length==t.attribute.minMaxPoints.min&&e.length==t.attribute.minMaxPoints.max||t.attribute.minMaxPoints.isSuper&&4==e.length)&&(t.inProgress=!1,i.destroy(),n.drawHandler=null,t.stopDrawing(),t.startEditing(),n.setCursor()),t.changeDrawing())},Cesium.ScreenSpaceEventType.LEFT_CLICK),i.setInputAction(function(r){if(r.endPosition){var o=l.default.getCurrentMousePosition(n.viewer.scene,r.endPosition);o&&(i.lastPointTemporary&&e.pop(),e.push(o),i.lastPointTemporary=!0,t.moveDrawing())}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),i.setInputAction(function(r){t.inProgress=!1,i.destroy(),n.drawHandler=null,e.pop(),t.stopDrawing(),t.startEditing(),n.setCursor()},Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.drawHandler=i,i}},{key:"createDrawPolygonHandler",value:function(t,e){this.setCursor("crosshair");var n=this;t.inProgress=!0;var i=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);return i.lastPointTemporary=!1,i.setInputAction(function(r){var o=l.default.getCurrentMousePosition(n.viewer.scene,r.position);if(o){if(i.lastPointTemporary&&e.pop(),e.push(o),t.polygon.hierarchy=e,t.attribute.style.extrudedHeight){var a=s.default.getMaxHeightForPositions(e);t.polygon.extrudedHeight=a+Number(t.attribute.style.extrudedHeight)}i.lastPointTemporary=!1,t.changeDrawing()}},Cesium.ScreenSpaceEventType.LEFT_CLICK),i.setInputAction(function(r){if(r.endPosition){var o=l.default.getCurrentMousePosition(n.viewer.scene,r.endPosition);if(o){if(i.lastPointTemporary&&e.pop(),e.push(o),t.polygon.hierarchy=e,t.attribute.style.extrudedHeight){var a=s.default.getMaxHeightForPositions(e);t.polygon.extrudedHeight=a+Number(t.attribute.style.extrudedHeight)}i.lastPointTemporary=!0,t.moveDrawing()}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),i.setInputAction(function(r){t.inProgress=!1,i.destroy(),n.drawHandler=null,e.pop(),t.polygon.hierarchy=e,t.stopDrawing(),t.startEditing(),n.setCursor()},Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.drawHandler=i,i}},{key:"createTwoPointsModelHandler",value:function(t,e){this.setCursor("crosshair");var n=this;t.inProgress=!0;var i=[],r=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);return r.lastPointTemporary=!1,r.setInputAction(function(o){var a=l.default.getCurrentMousePosition(n.viewer.scene,o.position);if(a){if(r.lastPointTemporary&&i.pop(),i.push(a),1==i.length&&t.attribute.style.extrudedHeight){var s=Number(Cesium.Cartographic.fromCartesian(a).height).toFixed(2);t.rectangle.height=Number(s),t.rectangle.extrudedHeight=Number(s)+Number(t.attribute.style.extrudedHeight),t.attribute.style.height=Number(s)}if(2==i.length){var u=Cesium.Rectangle.fromCartesianArray(i);e.setValue(u)}r.lastPointTemporary=!1,t.changeDrawing(),2==i.length&&(t.inProgress=!1,r.destroy(),n.drawHandler=null,t.stopDrawing(),t.startEditing(),n.setCursor())}},Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction(function(o){if(o.endPosition){var a=l.default.getCurrentMousePosition(n.viewer.scene,o.endPosition);if(a){if(r.lastPointTemporary&&i.pop(),i.push(a),2==i.length){var s=Cesium.Rectangle.fromCartesianArray(i);e.setValue(s)}r.lastPointTemporary=!0,t.moveDrawing()}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.drawHandler=r,r}},{key:"createDrawWallHandler",value:function(t,e,n,i){this.setCursor("crosshair");var r=this;t.inProgress=!0;var o=new Cesium.ScreenSpaceEventHandler(this.viewer.scene.canvas);return o.lastPointTemporary=!1,o.setInputAction(function(a){var s=l.default.getCurrentMousePosition(r.viewer.scene,a.position);if(s){o.lastPointTemporary&&(e.pop(),n.pop(),i.pop()),e.push(s);var u=Cesium.Cartographic.fromCartesian(s),c=Number(u.height).toFixed(2),h=Number(c)+Number(t.attribute.style.extrudedHeight);n.push(c),i.push(h),o.lastPointTemporary=!1,t.changeDrawing()}},Cesium.ScreenSpaceEventType.LEFT_CLICK),o.setInputAction(function(a){if(a.endPosition){var s=l.default.getCurrentMousePosition(r.viewer.scene,a.endPosition);if(s){o.lastPointTemporary&&(e.pop(),n.pop(),i.pop()),e.push(s);var u=Cesium.Cartographic.fromCartesian(s),c=Number(u.height).toFixed(2),h=Number(c)+Number(t.attribute.style.extrudedHeight);n.push(c),i.push(h),o.lastPointTemporary=!0,t.moveDrawing()}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),o.setInputAction(function(a){t.inProgress=!1,o.destroy(),r.drawHandler=null,e.pop(),n.pop(),i.pop(),t.stopDrawing(),t.startEditing(),r.setCursor()},Cesium.ScreenSpaceEventType.RIGHT_CLICK),this.drawHandler=o,o}},{key:"destroyDrawHandler",value:function(){this.setCursor(),this.drawHandler&&(this.setCursor(),this.drawHandler.destroy(),this.drawHandler=null)}},{key:"createEditSelectHandler",value:function(t){var e=this,n=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);n.setInputAction(function(n){var i=e.viewer.scene.pick(n.position),r=null;if(Cesium.defined(i)){var o=Cesium.defaultValue(i.id,i.primitive.id);if(o instanceof Cesium.Entity){var a=Cesium.defaultValue(o.inProgress,!1);a||(r=o)}}t(r)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.selectHandler=n}},{key:"createEditDraggerHandler",value:function(){var t=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas);t.dragger=null;var e=this;t.setInputAction(function(n){var i=e.viewer.scene.pick(n.position);if(Cesium.defined(i)){var r=i.id;r&&Cesium.defaultValue(r._isDragger,!1)&&(r.point&&(r.point.color=Cesium.Color.RED,r.point.pixelSize=10),t.dragger=r,e.viewer.scene.screenSpaceCameraController.enableRotate=!1,e.viewer.scene.screenSpaceCameraController.enableTilt=!1,e.viewer.scene.screenSpaceCameraController.enableTranslate=!1)}},Cesium.ScreenSpaceEventType.LEFT_DOWN),t.setInputAction(function(n){var i=e.viewer.scene.pick(n.position);if(Cesium.defined(i)){var r=i.id;r&&Cesium.defaultValue(r._isDragger,!1)&&(r.billboard&&(r.billboard.scale_src=r.billboard.scale._value,r.billboard.scale._value=1.2*r.billboard.scale_src),t.dragger=r,e.viewer.scene.screenSpaceCameraController.enableRotate=!1,e.viewer.scene.screenSpaceCameraController.enableTilt=!1,e.viewer.scene.screenSpaceCameraController.enableTranslate=!1)}},Cesium.ScreenSpaceEventType.LEFT_DOWN,Cesium.KeyboardEventModifier.CTRL),t.setInputAction(function(i){if(t.dragger){if(t.dragger.horizontal){var r;if(t.dragger.model){var o=e.viewer.scene,a=o.pick(i.endPosition);if(Cesium.defined(a)&&a.id==t.dragger){var s=o.camera.getPickRay(i.endPosition);r=o.globe.pick(s,o)}}null==r&&(r=l.default.getCurrentMousePosition(e.viewer.scene,i.endPosition)),r&&(t.dragger.position=r,t.dragger.onDrag&&t.dragger.onDrag(t.dragger,r))}if(t.dragger.vertical){var u=i.endPosition.y-i.startPosition.y,c=t.dragger.position._value,h=new Cesium.EllipsoidTangentPlane(c);n.center=c,n.radius=1;var f=e.viewer.scene.frameState.camera.getPixelSize(n,e.viewer.scene.frameState.context.drawingBufferWidth,e.viewer.scene.frameState.context.drawingBufferHeight),p=new Cesium.Cartesian3;Cesium.Cartesian3.multiplyByScalar(h.zAxis,-u*f,p);var d=Cesium.Cartesian3.clone(c);Cesium.Cartesian3.add(c,p,d),t.dragger.position=d,t.dragger.onDrag&&t.dragger.onDrag(t.dragger,d)}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE);var n=new Cesium.BoundingSphere;t.setInputAction(function(i){if(t.dragger&&t.dragger.verticalCtrl){var r=i.endPosition.y-i.startPosition.y,o=t.dragger.position._value,a=new Cesium.EllipsoidTangentPlane(o);n.center=o,n.radius=1;var s=e.viewer.scene.frameState.camera.getPixelSize(n,e.viewer.scene.frameState.context.drawingBufferWidth,e.viewer.scene.frameState.context.drawingBufferHeight),u=new Cesium.Cartesian3;Cesium.Cartesian3.multiplyByScalar(a.zAxis,-r*s,u);var l=Cesium.Cartesian3.clone(o);Cesium.Cartesian3.add(o,u,l),t.dragger.position=l,t.dragger.onDrag&&t.dragger.onDrag(t.dragger,l)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE,Cesium.KeyboardEventModifier.CTRL),t.setInputAction(function(){t.dragger&&((t.dragger.billboard||t.dragger.model||t.dragger.label)&&(t.dragger.billboard?t.dragger.billboard.scale._value=t.dragger.billboard.scale_src:t.dragger.model||t.dragger.label,t.dragger._isDragger=!1),t.dragger=null,e.viewer.scene.screenSpaceCameraController.enableRotate=!0,e.viewer.scene.screenSpaceCameraController.enableTilt=!0,e.viewer.scene.screenSpaceCameraController.enableTranslate=!0)},Cesium.ScreenSpaceEventType.LEFT_UP),t.setInputAction(function(){t.dragger&&((t.dragger.billboard||t.dragger.model||t.dragger.label)&&(t.dragger.billboard?t.dragger.billboard.scale._value=t.dragger.billboard.scale_src:t.dragger.model||t.dragger.label,t.dragger._isDragger=!1),t.dragger=null,e.viewer.scene.screenSpaceCameraController.enableRotate=!0,e.viewer.scene.screenSpaceCameraController.enableTilt=!0,e.viewer.scene.screenSpaceCameraController.enableTranslate=!0)},Cesium.ScreenSpaceEventType.LEFT_UP,Cesium.KeyboardEventModifier.CTRL),this.draggerHandler=t}},{key:"destroyEditHandler",value:function(){this.selectHandler&&(this.selectHandler.destroy(),this.selectHandler=null),this.draggerHandler&&(this.draggerHandler.destroy(),this.draggerHandler=null)}}]),t}();e.default=c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i);
}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t)}return i(t,null,[{key:"formatPositon",value:function(t){var e=Cesium.Cartographic.fromCartesian(t),n={};return n.y=Number(Cesium.Math.toDegrees(e.latitude).toFixed(6)),n.x=Number(Cesium.Math.toDegrees(e.longitude).toFixed(6)),n.z=Number(e.height.toFixed(1)),n}},{key:"getCurrentMousePosition",value:function(t,e){var n,i=t.pick(e);if(t.pickPositionSupported&&Cesium.defined(i)&&(n=t.pickPosition(e),Cesium.defined(n))){var r=Cesium.Cartographic.fromCartesian(n),o=r.height;if(o>=0)return n;if(!Cesium.defined(i.id)&&o>=-2e3)return n}if(t.mode===Cesium.SceneMode.SCENE3D){var a=t.camera.getPickRay(e);n=t.globe.pick(a,t)}else n=t.camera.pickEllipsoid(e,t.globe.ellipsoid);return n}},{key:"getCenter",value:function(t,e){var n=t.scene,i=pickCenterPoint(n),r=i;if(!r){var o=n.globe,a=n.camera.positionCartographic.clone(),s=o.getHeight(a);a.height=s||0,r=Cesium.Ellipsoid.WGS84.cartographicToCartesian(a)}var u=formatPositon(r);return e&&(u=t.mars.point2wgs(u)),u}},{key:"pickCenterPoint",value:function(t){var e=t.canvas,n=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2),i=t.camera.getPickRay(n),r=t.globe.pick(i,t);return r||t.camera.pickEllipsoid(n)}},{key:"getExtent",value:function(t,e){var n={xmin:70,xmax:140,ymin:0,ymax:55},i=t.scene,r=i.globe.ellipsoid,o=i.canvas,a=t.camera.pickEllipsoid(new Cesium.Cartesian2(0,0),r);if(a){var s=r.cartesianToCartographic(a);n.xmin=Cesium.Math.toDegrees(s.longitude),n.ymax=Cesium.Math.toDegrees(s.latitude)}else{for(var u,l=o.width/2,c=o.height/2,h=0;h<=c;h+=10){var f=h<=l?h:l;if(u=t.camera.pickEllipsoid(new Cesium.Cartesian2(f,h),r))break}if(u){var s=r.cartesianToCartographic(u);n.xmin=Cesium.Math.toDegrees(s.longitude),n.ymax=Cesium.Math.toDegrees(s.latitude)}}var p=t.camera.pickEllipsoid(new Cesium.Cartesian2(o.width,o.height),r);if(p){var d=r.cartesianToCartographic(p);n.xmax=Cesium.Math.toDegrees(d.longitude),n.ymin=Cesium.Math.toDegrees(d.latitude)}else{for(var g,l=o.width/2,c=o.height/2,h=o.height;h>=c;h-=10){var f=h>=l?h:l;if(g=t.camera.pickEllipsoid(new Cesium.Cartesian2(f,h),r))break}if(g){var d=r.cartesianToCartographic(g);n.xmax=Cesium.Math.toDegrees(d.longitude),n.ymin=Cesium.Math.toDegrees(d.latitude)}}if(e){var y=t.mars.point2wgs({x:n.xmin,y:n.ymin});n.xmin=y.x,n.ymin=y.y;var m=t.mars.point2wgs({x:n.xmax,y:n.ymax});n.xmax=m.x,n.ymax=m.y}return n}},{key:"getCameraView",value:function(t,e){var n=t.camera,i=n.positionCartographic,r={};return r.y=Number(Cesium.Math.toDegrees(i.latitude).toFixed(6)),r.x=Number(Cesium.Math.toDegrees(i.longitude).toFixed(6)),r.z=Number(i.height.toFixed(1)),r.heading=Number(Cesium.Math.toDegrees(n.heading).toFixed(1)),r.pitch=Number(Cesium.Math.toDegrees(n.pitch).toFixed(1)),r.roll=Number(Cesium.Math.toDegrees(n.roll).toFixed(1)),e&&(r=t.mars.point2wgs(r)),r}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(66),u=i(s),l=function(){function t(){r(this,t)}return a(t,null,[{key:"isNumber",value:function(t){return"number"==typeof t&&t.constructor==Number}},{key:"isString",value:function(t){return"string"==typeof t&&t.constructor==String}},{key:"getRequest",value:function(){var t=location.search,e=new Object;if(t.indexOf("?")!=-1)for(var n=t.substr(1),i=n.split("&"),r=0;r<i.length;r++)e[i[r].split("=")[0]]=decodeURI(i[r].split("=")[1]);return e}},{key:"getRequestByName",value:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(e);return null!=n?decodeURI(n[2]):null}},{key:"clone",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){if(null==t||"object"!=("undefined"==typeof t?"undefined":o(t)))return t;if(t instanceof Date){var e=new Date;return e.setTime(t.getTime()),e}if(t instanceof Array){for(var e=[],n=0,i=t.length;n<i;++n)e[n]=clone(t[n]);return e}if("object"===("undefined"==typeof t?"undefined":o(t))){var e={};for(var r in t)"_layer"!=r&&"_layers"!=r&&"_parent"!=r&&t.hasOwnProperty(r)&&(e[r]=clone(t[r]));return e}return t})},{key:"isPCBroswer",value:function(){var t=navigator.userAgent.toLowerCase(),e="ipad"==t.match(/ipad/i),n="iphone"==t.match(/iphone/i),i="midp"==t.match(/midp/i),r="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),o="ucweb"==t.match(/ucweb/i),a="android"==t.match(/android/i),s="windows ce"==t.match(/windows ce/i),u="windows mobile"==t.match(/windows mobile/i);return!(e||n||i||r||o||a||s||u)}},{key:"webglreport",value:function(){var t=haoutil.system.getExplorerInfo();if("IE"==t.type&&t.version<11)return!1;try{var e,n=document.createElement("canvas"),i="undefined"!=typeof WebGL2RenderingContext;if(i&&(e=n.getContext("webgl2")||n.getContext("experimental-webgl2")||void 0),null==e&&(e=n.getContext("webgl")||n.getContext("experimental-webgl")||void 0),null==e)return!1}catch(t){return!1}return!0}},{key:"terrainPolyline",value:function(t){var e=t.viewer,n=t.positions;if(null==n||0==n.length)return void(t.calback&&t.calback(n));for(var i=Cesium.PolylinePipeline.generateArc({positions:n,granularity:t.granularity||1e-5}),r=[],o=e.scene.globe.ellipsoid,a=0;a<i.length;a+=3){var s=Cesium.Cartesian3.unpack(i,a);r.push(o.cartesianToCartographic(s))}var u=Cesium.Cartographic.fromCartesian(n[0]).height;Cesium.when(Cesium.sampleTerrainMostDetailed(e.terrainProvider,r),function(i){for(var r=!1,a=t.offset||2,s=0;s<i.length;++s)null==i[s].height?(r=!0,i[s].height=u):i[s].height=a+i[s].height*e.scene._terrainExaggeration;var l=o.cartographicArrayToCartesianArray(i);t.calback?t.calback(l,r):n.setValue&&n.setValue(l)})}},{key:"createModel",value:function(t,e){t=e.mars.point2map(t);var n=Cesium.Cartesian3.fromDegrees(t.x,t.y,t.z||0),i=Cesium.Math.toRadians(t.heading||0),r=Cesium.Math.toRadians(t.pitch||0),o=Cesium.Math.toRadians(t.roll||0),a=new Cesium.HeadingPitchRoll(i,r,o),s=Cesium.Transforms.headingPitchRollQuaternion(n,a),u=e.entities.add({name:t.name||"",position:n,orientation:s,model:t,tooltip:t.tooltip,popup:t.popup});return u}},{key:"toLatLon",value:function(t){var e=Cesium.Cartographic.fromCartesian(t);return[Cesium.Math.toDegrees(e.longitude),Cesium.Math.toDegrees(e.latitude),e.height]}},{key:"cartesians2lonlats",value:function(e){for(var n=[],i=0,r=e.length;i<r;i++){var o=t.toLatLon(e[i]);n.push(o)}return n}},{key:"getArea",value:function(e){var n=t.cartesians2lonlats(e);return n.push(n[0]),u.area({type:"Feature",geometry:{type:"Polygon",coordinates:[n]}})}}]),t}();e.default=l},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&S(i),r&&P(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function n(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var r=n.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");r&&S(r);var a;switch(t){case"Point":a=i(e).geometry;break;case"LineString":a=s(e).geometry;break;case"Polygon":a=o(e).geometry;break;case"MultiPoint":a=h(e).geometry;break;case"MultiLineString":a=c(e).geometry;break;case"MultiPolygon":a=f(e).geometry;break;default:throw new Error(t+" is invalid")}return r&&(a.bbox=r),a}function i(t,n,i){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!x(t[0])||!x(t[1]))throw new Error("coordinates must contain numbers");return e({type:"Point",coordinates:t},n,i)}function r(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return l(t.map(function(t){return i(t,e)}),n)}function o(t,n,i){if(!t)throw new Error("coordinates is required");for(var r=0;r<t.length;r++){var o=t[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++){if(0===r&&0===a&&!x(o[0][0])||!x(o[0][1]))throw new Error("coordinates must contain numbers");if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}}return e({type:"Polygon",coordinates:t},n,i)}function a(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return l(t.map(function(t){return o(t,e)}),n)}function s(t,n,i){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!x(t[0][1])||!x(t[0][1]))throw new Error("coordinates must contain numbers");return e({type:"LineString",coordinates:t},n,i)}function u(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return l(t.map(function(t){return s(t,e)}),n)}function l(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&S(n),i&&P(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function c(t,n,i){if(!t)throw new Error("coordinates is required");return e({type:"MultiLineString",coordinates:t},n,i)}function h(t,n,i){if(!t)throw new Error("coordinates is required");return e({type:"MultiPoint",coordinates:t},n,i)}function f(t,n,i){if(!t)throw new Error("coordinates is required");return e({type:"MultiPolygon",coordinates:t},n,i)}function p(t,n,i){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return e({type:"GeometryCollection",geometries:t},n,i)}function d(t,e){if(void 0===t||null===t||isNaN(t))throw new Error("num is required");if(e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function g(t,e){if(void 0===t||null===t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=Fo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t*n}function y(t,e){if(void 0===t||null===t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=Fo[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t/n}function m(t,e){return _(y(t,e))}function v(t){if(null===t||void 0===t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e}function _(t){if(null===t||void 0===t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function w(t){if(null===t||void 0===t)throw new Error("degrees is required");return t%360*Math.PI/180}function b(t,e,n){if(null===t||void 0===t)throw new Error("length is required");if(!(t>=0))throw new Error("length must be a positive number");return g(y(t,e),n||"kilometers")}function C(t,e,n){if(null===t||void 0===t)throw new Error("area is required");if(!(t>=0))throw new Error("area must be a positive number");var i=zo[e||"meters"];if(!i)throw new Error("invalid original units");var r=zo[n||"kilometers"];if(!r)throw new Error("invalid final units");return t/i*r}function x(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function E(t){return!!t&&t.constructor===Object}function S(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!x(t))throw new Error("bbox must only contain numbers")})}function P(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function M(t,e,n){if(null!==t)for(var i,r,o,a,s,u,l,c,h=0,f=0,p=t.type,d="FeatureCollection"===p,g="Feature"===p,y=d?t.features.length:1,m=0;m<y;m++){s=(c=!!(l=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var v=0;v<s;v++){var _=0,w=0;if(null!==(a=c?l.geometries[v]:l)){u=a.coordinates;var b=a.type;switch(h=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":e(u,f,m,_,w),f++,_++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++)e(u[i],f,m,_,w),f++,"MultiPoint"===b&&_++;"LineString"===b&&_++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(r=0;r<u[i].length-h;r++)e(u[i][r],f,m,_,w),f++;"MultiLineString"===b&&_++,"Polygon"===b&&w++}"Polygon"===b&&_++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for("MultiPolygon"===b&&(w=0),r=0;r<u[i].length;r++){for(o=0;o<u[i][r].length-h;o++)e(u[i][r][o],f,m,_,w),f++;w++}_++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)M(a.geometries[i],e,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function L(t,e,n,i){var r=n;return M(t,function(t,i,o,a,s){r=0===i&&void 0===n?t:e(r,t,i,o,a,s)},i),r}function I(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function T(t,e,n){var i=n;return I(t,function(t,r){i=0===r&&void 0===n?t:e(i,t,r)}),i}function N(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function k(t,e,n){var i=n;return N(t,function(t,r){i=0===r&&void 0===n?t:e(i,t,r)}),i}function O(t){var e=[];return M(t,function(t){e.push(t)}),e}function D(t,e){var n,i,r,o,a,s,u,l,c,h,f=0,p="FeatureCollection"===t.type,d="Feature"===t.type,g=p?t.features.length:1;for(n=0;n<g;n++){for(s=p?t.features[n].geometry:d?t.geometry:t,l=p?t.features[n].properties:d?t.properties:{},c=p?t.features[n].bbox:d?t.bbox:void 0,h=p?t.features[n].id:d?t.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,r=0;r<a;r++)if(null!==(o=u?s.geometries[r]:s))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,f,l,c,h);break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)e(o.geometries[i],f,l,c,h);break;default:throw new Error("Unknown Geometry Type")}else e(null,f,l,c,h);f++}}function A(t,e,n){var i=n;return D(t,function(t,r,o,a,s){i=0===r&&void 0===n?t:e(i,t,r,o,a,s)}),i}function R(t,n){D(t,function(t,i,r,o,a){var s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return void n(e(t,r,{bbox:o,id:a}),i,0)}var u;switch(s){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon"}t.coordinates.forEach(function(t,o){n(e({type:u,coordinates:t},r),i,o)})})}function F(t,e,n){var i=n;return R(t,function(t,r,o){i=0===r&&0===o&&void 0===n?t:e(i,t,r,o)}),i}function j(t,e){R(t,function(t,n,i){var r=0;if(t.geometry){var o=t.geometry.type;"Point"!==o&&"MultiPoint"!==o&&L(t,function(o,a,u,l,c,h){var f=s([o,a],t.properties);return e(f,n,i,h,r),r++,a})}})}function z(t,e,n){var i=n,r=!1;return j(t,function(t,o,a,s,u){i=!1===r&&void 0===n?t:e(i,t,o,a,s,u),r=!0}),i}function B(t,e){if(!t)throw new Error("geojson is required");R(t,function(t,n,i){if(null!==t.geometry){var r=t.geometry.type,o=t.geometry.coordinates;switch(r){case"LineString":e(t,n,i,0,0);break;case"Polygon":for(var a=0;a<o.length;a++)e(s(o[a],t.properties),n,i,a)}}})}function G(t,e,n){var i=n;return B(t,function(t,r,o,a){i=0===r&&void 0===n?t:e(i,t,r,o,a)}),i}function U(t){var e=[1/0,1/0,-1/0,-1/0];return M(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}function H(t){if(!t)throw new Error("obj is required");var e=q(t);if(e.length>1&&x(e[0])&&x(e[1]))return e;throw new Error("Coordinate is not a valid Point")}function q(t){if(!t)throw new Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return V(e),e;throw new Error("No valid coordinates")}function V(t){if(t.length>1&&x(t[0])&&x(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return V(t[0]);throw new Error("coordinates must only contain numbers")}function W(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function Y(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function X(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}function Z(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}function J(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function K(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}function $(t,e,n){n=n||{};for(var i=Object.keys(Ho),r=0;r<i.length;r++){var o=i[r],a=n[o];a=void 0!==a&&null!==a?a:Ho[o],qo[o]=a}qo.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var s=function(t){var e=[],n=0;return t.rows,t.cols,t.cells.forEach(function(i,r){i.forEach(function(i,o){if(void 0!==i&&!function(t){return 5===t.cval||10===t.cval}(i)&&!tt(i)){var a=function(t,e,n){var i,r,o,a=t.length,s=[],u=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],l=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],c=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],h=(t[e][n],t[e][n]),f=h.cval,p=nt(h,o=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][f]);s.push([n+p[0],e+p[1]]),p=nt(h,o=c[f]),s.push([n+p[0],e+p[1]]),et(h);for(var d=n+u[f],g=e+l[f],y=f;d>=0&&g>=0&&g<a&&(d!=n||g!=e)&&void 0!==(h=t[g][d]);){if(0===(f=h.cval)||15===f)return{path:s,info:"mergeable"};o=c[f],i=u[f],r=l[f],5!==f&&10!==f||(5===f?h.flipped?-1===l[y]?(o="left",i=-1,r=0):(o="right",i=1,r=0):-1===u[y]&&(o="bottom",i=0,r=-1):10===f&&(h.flipped?-1===u[y]?(o="top",i=0,r=1):(o="bottom",i=0,r=-1):1===l[y]&&(o="left",i=-1,r=0))),p=nt(h,o),s.push([d+p[0],g+p[1]]),et(h),d+=i,g+=r,y=f}return{path:s,info:"closed"}}(t.cells,r,o),s=!1;if("mergeable"===a.info)for(var u=a.path[a.path.length-1][0],l=a.path[a.path.length-1][1],c=n-1;c>=0;c--)if(Math.abs(e[c][0][0]-u)<=1e-7&&Math.abs(e[c][0][1]-l)<=1e-7){for(var h=a.path.length-2;h>=0;--h)e[c].unshift(a.path[h]);s=!0;break}s||(e[n++]=a.path)}})}),e}(function(t,e){for(var n=t.length-1,i=t[0].length-1,r={rows:n,cols:i,cells:[]},o=0;o<n;++o){r.cells[o]=[];for(var a=0;a<i;++a){var s=0,u=t[o+1][a],l=t[o+1][a+1],c=t[o][a+1],h=t[o][a];if(!(isNaN(u)||isNaN(l)||isNaN(c)||isNaN(h))){s|=u>=e?8:0,s|=l>=e?4:0,s|=c>=e?2:0;var f=!1;if(5===(s|=h>=e?1:0)||10===s){var p=(u+l+c+h)/4;5===s&&p<e?(s=10,f=!0):10===s&&p<e&&(s=5,f=!0)}if(0!==s&&15!==s){var d,g,y,m;d=g=y=m=.5,1===s?(y=1-Q(e,u,h),g=1-Q(e,c,h)):2===s?(g=Q(e,h,c),m=1-Q(e,l,c)):3===s?(y=1-Q(e,u,h),m=1-Q(e,l,c)):4===s?(d=Q(e,u,l),m=Q(e,c,l)):5===s?(d=Q(e,u,l),m=Q(e,c,l),g=1-Q(e,c,h),y=1-Q(e,u,h)):6===s?(g=Q(e,h,c),d=Q(e,u,l)):7===s?(y=1-Q(e,u,h),d=Q(e,u,l)):8===s?(y=Q(e,h,u),d=1-Q(e,l,u)):9===s?(g=1-Q(e,c,h),d=1-Q(e,l,u)):10===s?(d=1-Q(e,l,u),m=1-Q(e,l,c),g=Q(e,h,c),y=Q(e,h,u)):11===s?(d=1-Q(e,l,u),m=1-Q(e,l,c)):12===s?(y=Q(e,h,u),m=Q(e,c,l)):13===s?(g=1-Q(e,c,h),m=Q(e,c,l)):14===s?(y=Q(e,h,u),g=Q(e,h,c)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+s),r.cells[o][a]={cval:s,flipped:f,top:d,right:m,bottom:g,left:y}}}}}return r}(t,e));return"function"==typeof qo.successCallback&&qo.successCallback(s),s}function Q(t,e,n){return(t-e)/(n-e)}function tt(t){return 0===t.cval||15===t.cval}function et(t){tt(t)||5===t.cval||10===t.cval||(t.cval=15)}function nt(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}function it(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;X(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return N(t,function(t){var e=q(t)[1];n[e]||(n[e]=[]),n[e].push(t)}),Object.keys(n).map(function(t){var e=n[t],i=e.sort(function(t,e){return q(t)[0]-q(e)[0]});return i}).sort(function(t,n){return e?q(t[0])[1]-q(n[0])[1]:q(n[0])[1]-q(t[0])[1]})}(t,i),a=[],s=0;s<o.length;s++){for(var u=o[s],l=[],c=0;c<u.length;c++){var h=u[c];h.properties[n]?l.push(h.properties[n]):l.push(0),!0===r&&(h.properties.matrixPosition=[s,c])}a.push(l)}return a}function rt(t,e,n,i,r){for(n=n||0,i=i||t.length-1,r=r||function(t,e){return t<e?-1:t>e?1:0};i>n;){if(i-n>600){var o=i-n+1,a=e-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);rt(t,e,Math.max(n,Math.floor(e-a*u/o+l)),Math.min(i,Math.floor(e+(o-a)*u/o+l)),r)}var c=t[e],h=n,f=i;for(ot(t,n,e),r(t[i],c)>0&&ot(t,n,i);h<f;){for(ot(t,h,f),h++,f--;r(t[h],c)<0;)h++;for(;r(t[f],c)>0;)f--}0===r(t[n],c)?ot(t,n,f):ot(t,++f,i),f<=e&&(n=f+1),e<=f&&(i=f-1)}}function ot(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function at(t,e){return this instanceof at?(this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear(),void 0):new at(t,e)}function st(t,e){ut(t,0,t.children.length,e,t)}function ut(t,e,n,i,r){r||(r=yt(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],lt(r,t.leaf?i(o):o);return r}function lt(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function ct(t,e){return t.minX-e.minX}function ht(t,e){return t.minY-e.minY}function ft(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function pt(t){return t.maxX-t.minX+(t.maxY-t.minY)}function dt(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function gt(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function yt(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function mt(t,e,n,i,r){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,Vo(t,o,e,n,r),a.push(e,o,o,n))}function vt(t,e){return e={exports:{}},t(e,e.exports),e.exports}function _t(t,e){if(!(this instanceof _t))return new _t(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||function(t,e){return t<e?-1:t>e?1:0},this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function wt(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;for(var i,r=function(t){for(var e=t[0],n=t[0],i=t[0],r=t[0],o=0;o<t.length;o++){var a=t[o];a[0]<e[0]&&(e=a),a[0]>i[0]&&(i=a),a[1]<n[1]&&(n=a),a[1]>r[1]&&(r=a)}var s=[e,n,i,r],u=s.slice();for(o=0;o<t.length;o++)ra(t[o],s)||u.push(t[o]);var l=ta(u),c=[];for(o=0;o<l.length;o++)c.push(u[l[o]]);return c}(t),o=Wo(16,["[0]","[1]","[0]","[1]"]).load(t),a=[],s=0;s<r.length;s++){var u=r[s];o.remove(u),i=St(u,i),a.push(i)}var l=Wo(16);for(s=0;s<a.length;s++)l.insert(Et(a[s]));for(var c=e*e,h=n*n;a.length;){var f=a.shift(),p=f.p,d=f.next.p,g=Pt(p,d);if(!(g<h)){var y=g/c;(u=function(t,e,n,i,r,o,a){for(var s=new na(null,bt),u=t.data;u;){for(var l=0;l<u.children.length;l++){var c=u.children[l],h=u.leaf?Mt(c,n,i):function(t,e,n){if(Ct(t,n)||Ct(e,n))return 0;var i=Lt(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===i)return 0;var r=Lt(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===r)return 0;var o=Lt(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var a=Lt(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===a?0:Math.min(i,r,o,a)}(n,i,c);h>o||s.push({node:c,dist:h})}for(;s.length&&!s.peek().node.children;){var f=s.pop(),p=f.node,d=Mt(p,e,n),g=Mt(p,i,r);if(f.dist<d&&f.dist<g&&xt(n,p,a)&&xt(i,p,a))return p}(u=s.pop())&&(u=u.node)}return null}(o,f.prev.p,p,d,f.next.next.p,y,l))&&Math.min(Pt(u,p),Pt(u,d))<=y&&(a.push(f),a.push(St(u,f)),o.remove(u),l.remove(f),l.insert(Et(f)),l.insert(Et(f.next)))}}f=i;var m=[];do m.push(f.p),f=f.next;while(f!==i);return m.push(f.p),m}function bt(t,e){return t.dist-e.dist}function Ct(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function xt(t,e,n){for(var i=Math.min(t[0],e[0]),r=Math.min(t[1],e[1]),o=Math.max(t[0],e[0]),a=Math.max(t[1],e[1]),s=n.search({minX:i,minY:r,maxX:o,maxY:a}),u=0;u<s.length;u++)if(function(t,e,n,i){return t!==i&&e!==n&&oa(t,e,n)>0!=oa(t,e,i)>0&&oa(n,i,t)>0!=oa(n,i,e)>0}(s[u].p,s[u].next.p,t,e))return!1;return!0}function Et(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function St(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function Pt(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function Mt(t,e,n){var i=e[0],r=e[1],o=n[0]-i,a=n[1]-r;if(0!==o||0!==a){var s=((t[0]-i)*o+(t[1]-r)*a)/(o*o+a*a);s>1?(i=n[0],r=n[1]):s>0&&(i+=o*s,r+=a*s)}return o=t[0]-i,a=t[1]-r,o*o+a*a}function Lt(t,e,n,i,r,o,a,s){var u,l,c,h,f=n-t,p=i-e,d=a-r,g=s-o,y=t-r,m=e-o,v=f*f+p*p,_=f*d+p*g,w=d*d+g*g,b=f*y+p*m,C=d*y+g*m,x=v*w-_*_,E=x,S=x;0===x?(l=0,E=1,h=C,S=w):(h=v*C-_*b,(l=_*C-w*b)<0?(l=0,h=C,S=w):l>E&&(l=E,h=C+_,S=w)),h<0?(h=0,-b<0?l=0:-b>v?l=E:(l=-b,E=v)):h>S&&(h=S,-b+_<0?l=0:-b+_>v?l=E:(l=-b+_,E=v)),u=0===l?0:l/E;var P=(1-(c=0===h?0:h/S))*r+c*a-((1-u)*t+u*n),M=(1-c)*o+c*s-((1-u)*e+u*i);return P*P+M*M}function It(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.concavity||1/0,i=[];if(M(t,function(t){i.push([t[0],t[1]])}),!i.length)return null;var r=aa(i,n);return r.length>3?o([r]):null}function Tt(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=H(t),o=q(e),a=e.geometry?e.geometry.type:e.type,s=e.bbox;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,s))return!1;"Polygon"===a&&(o=[o]);for(var u=0,l=!1;u<o.length&&!l;u++)if(Nt(r,o[u][0],i)){for(var c=!1,h=1;h<o[u].length&&!c;)Nt(r,o[u][h],!i)&&(c=!0),h++;c||(l=!0)}return l}function Nt(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var a=e[r][0],s=e[r][1],u=e[o][0],l=e[o][1];if(t[1]*(a-u)+s*(u-t[0])+l*(t[0]-a)==0&&(a-t[0])*(u-t[0])<=0&&(s-t[1])*(l-t[1])<=0)return!n;s>t[1]!=l>t[1]&&t[0]<(u-a)*(t[1]-s)/(l-s)+a&&(i=!i)}return i}function kt(t,e){var n=[];return D(e,function(e){N(t,function(t){Tt(t,e)&&n.push(t)})}),l(n)}function Ot(t,e){if("FeatureCollection"!==t.type)throw new Error("points must be a FeatureCollection");var n=!1;return l(function(t){if(t.length<3)return[];t.sort(At);for(var e,n,i,r,o,a,s=t.length-1,u=t[s].x,l=t[0].x,c=t[s].y,h=c;s--;)t[s].y<c&&(c=t[s].y),t[s].y>h&&(h=t[s].y);var f,p=l-u,d=h-c,g=p>d?p:d,y=.5*(l+u),m=.5*(h+c),v=[new Dt({x:y-20*g,y:m-g,__sentinel:!0},{x:y,y:m+20*g,__sentinel:!0},{x:y+20*g,y:m-g,__sentinel:!0})],_=[],w=[];for(s=t.length;s--;){for(w.length=0,f=v.length;f--;)(p=t[s].x-v[f].x)>0&&p*p>v[f].r?(_.push(v[f]),v.splice(f,1)):(d=t[s].y-v[f].y,p*p+d*d>v[f].r||(w.push(v[f].a,v[f].b,v[f].b,v[f].c,v[f].c,v[f].a),v.splice(f,1)));for(Rt(w),f=w.length;f;)n=w[--f],e=w[--f],i=t[s],r=n.x-e.x,o=n.y-e.y,a=2*(r*(i.y-n.y)-o*(i.x-n.x)),Math.abs(a)>1e-12&&v.push(new Dt(e,n,i))}for(Array.prototype.push.apply(_,v),s=_.length;s--;)(_[s].a.__sentinel||_[s].b.__sentinel||_[s].c.__sentinel)&&_.splice(s,1);return _}(t.features.map(function(t){var i={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e?i.z=t.properties[e]:3===t.geometry.coordinates.length&&(n=!0,i.z=t.geometry.coordinates[2]),i})).map(function(t){var e=[t.a.x,t.a.y],i=[t.b.x,t.b.y],r=[t.c.x,t.c.y],a={};return n?(e.push(t.a.z),i.push(t.b.z),r.push(t.c.z)):a={a:t.a.z,b:t.b.z,c:t.c.z},o([[e,i,r,e]],a)}))}function Dt(t,e,n){this.a=t,this.b=e,this.c=n;var i,r,o=e.x-t.x,a=e.y-t.y,s=n.x-t.x,u=n.y-t.y,l=o*(t.x+e.x)+a*(t.y+e.y),c=s*(t.x+n.x)+u*(t.y+n.y),h=2*(o*(n.y-e.y)-a*(n.x-e.x));this.x=(u*l-a*c)/h,this.y=(o*c-s*l)/h,i=this.x-t.x,r=this.y-t.y,this.r=i*i+r*r}function At(t,e){return e.x-t.x}function Rt(t){var e,n,i,r,o,a=t.length;t:for(;a;)for(n=t[--a],e=t[--a],i=a;i;)if(o=t[--i],r=t[--i],e===r&&n===o||e===o&&n===r){t.splice(a,2),t.splice(i,2),a-=2;continue t}}function Ft(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.units,r=H(t),o=H(e),a=w(o[1]-r[1]),s=w(o[0]-r[0]),u=w(r[1]),l=w(o[1]),c=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(u)*Math.cos(l);return g(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),i)}function jt(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return zt(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}}),e.features=t.features.map(function(t){return zt(t)}),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Gt(t);default:throw new Error("unknown GeoJSON type")}}function zt(t){var e={type:"Feature"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}}),e.properties=Bt(t.properties),e.geometry=Gt(t.geometry),e}function Bt(t){var e={};return t?(Object.keys(t).forEach(function(n){var i=t[n];"object"==typeof i?null===i?e[n]=null:i.length?e[n]=i.map(function(t){return t}):e[n]=Bt(i):e[n]=i}),e):e}function Gt(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map(function(t){return Gt(t)}),e):(e.coordinates=Ut(t.coordinates),e)}function Ut(t){return"object"!=typeof t[0]?t.slice():t.map(function(t){return Ut(t)})}function Ht(t,e){function n(t,e){e.length&&e.pop();for(var n=l[t<0?~t:t],i=0,r=n.length;i<r;++i)e.push(u(n[i],i));t<0&&ca(e,r)}function i(t){return u(t)}function r(t){for(var e=[],i=0,r=t.length;i<r;++i)n(t[i],e);return e.length<2&&e.push(e[0]),e}function o(t){for(var e=r(t);e.length<4;)e.push(e[0]);return e}function a(t){return t.map(o)}function s(t){var e,n=t.type;switch(n){case"GeometryCollection":
return{type:n,geometries:t.geometries.map(s)};case"Point":e=i(t.coordinates);break;case"MultiPoint":e=t.coordinates.map(i);break;case"LineString":e=r(t.arcs);break;case"MultiLineString":e=t.arcs.map(r);break;case"Polygon":e=a(t.arcs);break;case"MultiPolygon":e=t.arcs.map(a);break;default:return null}return{type:n,coordinates:e}}var u=la(t.transform),l=t.arcs;return s(e)}function qt(t,e){function n(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(n);break;case"Polygon":i(t.arcs);break;case"MultiPolygon":t.arcs.forEach(i)}}function i(t){t.forEach(function(e){e.forEach(function(e){(o[e=e<0?~e:e]||(o[e]=[])).push(t)})}),a.push(t)}function r(e){return function(t){for(var e,n=-1,i=t.length,r=t[i-1],o=0;++n<i;)e=r,r=t[n],o+=e[0]*r[1]-e[1]*r[0];return Math.abs(o)}(Ht(t,{type:"Polygon",arcs:[e]}).coordinates[0])}var o={},a=[],s=[];return e.forEach(n),a.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,s.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){o[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),a.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:s.map(function(e){var n,i=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){o[t<0?~t:t].length<2&&i.push(t)})})}),i=ha(t,i),(n=i.length)>1)for(var a,s,u=1,l=r(i[0]);u<n;++u)(a=r(i[u]))>l&&(s=i[0],i[0]=i[u],i[u]=s,l=a);return i})}}function Vt(t,e,n){for(var i,r=e+(n-- -e>>1);e<r;++e,--n)i=t[e],t[e]=t[n],t[n]=i}function Wt(t){return null==t?{type:null}:("FeatureCollection"===t.type?function(t){var e={type:"GeometryCollection",geometries:t.features.map(Yt)};return null!=t.bbox&&(e.bbox=t.bbox),e}:"Feature"===t.type?Yt:Xt)(t)}function Yt(t){var e,n=Xt(t.geometry);null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox);for(e in t.properties){n.properties=t.properties;break}return n}function Xt(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(Xt)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}function Zt(t){var e,n=t[0],i=t[1];return i<n&&(e=n,n=i,i=e),n+31*i}function Jt(t,e){var n,i=t[0],r=t[1],o=e[0],a=e[1];return r<i&&(n=i,i=r,r=n),a<o&&(n=o,o=a,a=n),i===o&&r===a}function Kt(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==K(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=jt(t));var i=[],r=G(t,function(t,e){var n=function(t,e){var n,i=t.geometry.coordinates,r=e.geometry.coordinates,o=$t(i[0]),a=$t(i[i.length-1]),u=$t(r[0]),l=$t(r[r.length-1]);if(o===l)n=r.concat(i.slice(1));else if(u===a)n=i.concat(r.slice(1));else if(o===u)n=i.slice(1).reverse().concat(r);else{if(a!==l)return null;n=i.concat(r.reverse().slice(1))}return s(n)}(t,e);return n||(i.push(t),e)});return r&&i.push(r),i.length?1===i.length?i[0]:c(i.map(function(t){return t.coordinates})):null}function $t(t){return t[0].toString()+","+t[1].toString()}function Qt(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==K(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=jt(t));var i=function(t){var e={};R(t,function(t){e[t.geometry.type]=!0});var n=Object.keys(e);return 1===n.length?n[0]:null}(t);if(!i)throw new Error("geojson must be homogenous");switch(i){case"LineString":return Kt(t,e);case"Polygon":return function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==K(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=jt(t));var i=[];R(t,function(t){i.push(t.geometry)});var r=Ca({geoms:p(i).geometry});return fa(r,r.objects.geoms.geometries)}(t,e);default:throw new Error(i+" is not supported")}}function te(t,n){var i="object"==typeof n?n.mutate:n;if(!t)throw new Error("geojson is required");var r=K(t),o=[];switch(r){case"LineString":o=ee(t);break;case"MultiLineString":case"Polygon":q(t).forEach(function(t){o.push(ee(t))});break;case"MultiPolygon":q(t).forEach(function(t){var e=[];t.forEach(function(t){e.push(ee(t))}),o.push(e)});break;case"Point":return t;case"MultiPoint":var a={};q(t).forEach(function(t){var e=t.join("-");a.hasOwnProperty(e)||(o.push(t),a[e]=!0)});break;default:throw new Error(r+" geometry not supported")}return t.coordinates?!0===i?(t.coordinates=o,t):{type:r,coordinates:o}:!0===i?(t.geometry.coordinates=o,t):e({type:r,coordinates:o},t.properties,t.bbox,t.id)}function ee(t){var e=q(t);if(2===e.length&&!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(e[0],e[1]))return e;var n,i,r,o=[],a=e.length-1;o.push(e[0]);for(var s=1;s<a;s++)n=e[s-1],i=e[s],function(t,e,n){var i=n[0],r=n[1],o=t[0],a=t[1],s=e[0],u=e[1],l=s-o,c=u-a;return(i-o)*c-(r-a)*l==0&&(Math.abs(l)>=Math.abs(c)?l>0?o<=i&&i<=s:s<=i&&i<=o:c>0?a<=r&&r<=u:u<=r&&r<=a)}(n,r=e[s+1],i)||o.push(i);return o.push(r),o}function ne(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function ie(t,e,n){var i=e.x,r=e.y,o=n.x-i,a=n.y-r;if(0!==o||0!==a){var s=((t.x-i)*o+(t.y-r)*a)/(o*o+a*a);s>1?(i=n.x,r=n.y):s>0&&(i+=o*s,r+=a*s)}return o=t.x-i,a=t.y-r,o*o+a*a}function re(t,e,n,i,r){for(var o,a=i,s=e+1;s<n;s++){var u=ie(t[s],t[e],t[n]);u>a&&(o=s,a=u)}a>i&&(o-e>1&&re(t,e,o,i,r),r.push(t[o]),n-o>1&&re(t,o,n,i,r))}function oe(t,e,n){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return t=n?t:function(t,e){for(var n,i=t[0],r=[i],o=1,a=t.length;o<a;o++)ne(n=t[o],i)>e&&(r.push(n),i=n);return i!==n&&r.push(n),r}(t,i),t=function(t,e){var n=t.length-1,i=[t[0]];return re(t,0,n,e,i),i.push(t[n]),i}(t,i)}function ae(t,e,n){return oe(t.map(function(t){return{x:t[0],y:t[1],z:t[2]}}),e,n).map(function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]})}function se(t,e,n){return t.map(function(t){var i=t.map(function(t){return{x:t[0],y:t[1]}});if(i.length<4)throw new Error("invalid polygon");for(var r=oe(i,e,n).map(function(t){return[t.x,t.y]});!function(t){return!(t.length<3||3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}(r);)r=oe(i,e-=.01*e,n).map(function(t){return[t.x,t.y]});return r[r.length-1][0]===r[0][0]&&r[r.length-1][1]===r[0][1]||r.push(r[0]),r})}function ue(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.resolution||1e4,i=e.sharpness||.85;if(!t)throw new Error("line is required");if(!x(n))throw new Error("resolution must be an number");if(!x(i))throw new Error("sharpness must be an number");for(var r=[],o=new xa({points:Z(t).coordinates.map(function(t){return{x:t[0],y:t[1]}}),duration:n,sharpness:i}),a=0;a<o.duration;a+=10){var u=o.pos(a);Math.floor(a/100)%2==0&&r.push([u.x,u.y])}return s(r,t.properties)}function le(t){S(t);var e=Number(t[0]),n=Number(t[1]),i=Number(t[2]),r=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[e,n];return o([[a,[i,n],[i,r],[e,r],a]])}function ce(t){return le(U(t))}function he(t){var e=t[0],n=t[1],i=t[2],r=t[3];if(Ft(t.slice(0,2),[i,n])>=Ft(t.slice(0,2),[e,r])){var o=(n+r)/2;return[e,o-(i-e)/2,i,o+(i-e)/2]}var a=(e+i)/2;return[a-(r-n)/2,n,a+(r-n)/2,r]}function fe(t,e,n,r){if(r=r||{},!E(r))throw new Error("options is invalid");var o=r.units,a=r.properties,s=H(t),u=w(s[0]),l=w(s[1]),c=w(n),h=y(e,o),f=Math.asin(Math.sin(l)*Math.cos(h)+Math.cos(l)*Math.sin(h)*Math.cos(c));return i([_(u+Math.atan2(Math.sin(c)*Math.sin(h)*Math.cos(l),Math.cos(h)-Math.sin(l)*Math.sin(f))),_(f)],a)}function pe(t,e,n){var i=(n=n||{}).steps||64,r=n.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be a number");i=i||64,r=r||t.properties||{};for(var a=[],s=0;s<i;s++)a.push(fe(t,e,-360*s/i,n).geometry.coordinates);return a.push(a[0]),o([a],r)}function de(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");if(!0===n.final)return function(t,e){var n=de(e,t);return n=(n+180)%360}(t,e);var i=H(t),r=H(e),o=w(i[0]),a=w(r[0]),s=w(i[1]),u=w(r[1]),l=Math.sin(a-o)*Math.cos(u),c=Math.cos(s)*Math.sin(u)-Math.sin(s)*Math.cos(u)*Math.cos(a-o);return _(Math.atan2(l,c))}function ge(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.properties;if(!t)throw new Error("geojson is required");var r=U(t);return i([(r[0]+r[2])/2,(r[1]+r[3])/2],n)}function ye(t,e){var n=0,r=0,o=0;return M(t,function(t){n+=t[0],r+=t[1],o++},!0),i([n/o,r/o],e)}function me(t,e){switch(K(t)){case"Point":return t;case"Polygon":var n=[];M(t,function(t){n.push(t)});var r,o,a,s,u,l,c,h,f=ye(t,e),p=f.geometry.coordinates,d=0,g=0,y=0,m=n.map(function(t){return[t[0]-p[0],t[1]-p[1]]});for(r=0;r<n.length-1;r++)s=(o=m[r])[0],l=o[1],u=(a=m[r+1])[0],y+=h=s*(c=a[1])-u*l,d+=(s+u)*h,g+=(l+c)*h;if(0===y)return f;var v=1/(6*(.5*y));return i([p[0]+v*d,p[1]+v*g],e);default:var _=It(t);return _?me(_,e):ye(t,e)}}function ve(t){var e=[];return"FeatureCollection"===t.type?N(t,function(t){M(t,function(n){e.push(i(n,t.properties))})}):M(t,function(n){e.push(i(n,t.properties))}),l(e)}function _e(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,o=we(t,0,r,n,!0),a=[];if(!o)return a;var s,u,l,c,h,f,p;if(i&&(o=function(t,e,n,i){var r,o,a,s,u,l=[];for(r=0,o=e.length;r<o;r++)a=e[r]*i,s=r<o-1?e[r+1]*i:t.length,(u=we(t,a,s,i,!1))===u.next&&(u.steiner=!0),l.push(function(t){var e=t,n=t;do e.x<n.x&&(n=e),e=e.next;while(e!==t);return n}(u));for(l.sort(xe),r=0;r<l.length;r++)!function(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n.prev;var u,l=n,c=n.x,h=n.y,f=1/0;for(i=n.next;i!==l;)r>=i.x&&i.x>=c&&r!==i.x&&Se(o<h?r:a,o,c,h,o<h?a:r,o,i.x,i.y)&&((u=Math.abs(o-i.y)/(r-i.x))<f||u===f&&i.x>n.x)&&Ie(i,t)&&(n=i,f=u),i=i.next;return n}(t,e)){var n=Te(e,t);be(n,n.next)}}(l[r],n),n=be(n,n.next);return n}(t,e,o,n)),t.length>80*n){s=l=t[0],u=c=t[1];for(var d=n;d<r;d+=n)h=t[d],f=t[d+1],h<s&&(s=h),f<u&&(u=f),h>l&&(l=h),f>c&&(c=f);p=0!==(p=Math.max(l-s,c-u))?1/p:0}return Ce(o,a,n,s,u,p),a}function we(t,e,n,i,r){var o,a;if(r===De(t,e,n,i)>0)for(o=e;o<n;o+=i)a=Ne(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=Ne(o,t[o],t[o+1],a);return a&&Me(a,a.next)&&(ke(a),a=a.next),a}function be(t,e){if(!t)return t;e||(e=t);var n,i=t;do if(n=!1,i.steiner||!Me(i,i.next)&&0!==Pe(i.prev,i,i.next))i=i.next;else{if(ke(i),(i=e=i.prev)===i.next)break;n=!0}while(n||i!==e);return e}function Ce(t,e,n,i,r,o,a){if(t){!a&&o&&function(t,e,n,i){var r=t;do null===r.z&&(r.z=Ee(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,u,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<l&&(s++,i=i.nextZ);e++);for(u=l;s>0||u>0&&i;)0!==s&&(0===u||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(a>1)}(r)}(t,i,r,o);for(var s,u,l=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?function(t,e,n,i){var r=t.prev,o=t,a=t.next;if(Pe(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,u=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,c=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=Ee(s,u,e,n,i),f=Ee(l,c,e,n,i),p=t.nextZ;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&Se(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Pe(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&Se(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Pe(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}(t,i,r,o):function(t){var e=t.prev,n=t,i=t.next;if(Pe(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(Se(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Pe(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),ke(t),t=u.next,l=u.next;else if((t=u)===l){a?1===a?Ce(t=function(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Me(r,o)&&Le(r,i,i.next,o)&&Ie(r,o)&&Ie(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),ke(i),ke(i.next),i=t=o),i=i.next}while(i!==t);return i}(t,e,n),e,n,i,r,o,2):2===a&&function(t,e,n,i,r,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Le(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&Ie(t,e)&&Ie(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}(t,e)}(a,s)){var u=Te(a,s);return a=be(a,a.next),u=be(u,u.next),Ce(a,e,n,i,r,o),void Ce(u,e,n,i,r,o)}s=s.next}a=a.next}while(a!==t)}(t,e,n,i,r,o):Ce(be(t),e,n,i,r,o,1);break}}}function xe(t,e){return t.x-e.x}function Ee(t,e,n,i,r){return t=32767*(t-n)*r,e=32767*(e-i)*r,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function Se(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function Pe(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Me(t,e){return t.x===e.x&&t.y===e.y}function Le(t,e,n,i){return!!(Me(t,e)&&Me(n,i)||Me(t,i)&&Me(n,e))||Pe(t,e,n)>0!=Pe(t,e,i)>0&&Pe(n,i,t)>0!=Pe(n,i,e)>0}function Ie(t,e){return Pe(t.prev,t,t.next)<0?Pe(t,e,t.next)>=0&&Pe(t,t.prev,e)>=0:Pe(t,e,t.prev)<0||Pe(t,t.next,e)<0}function Te(t,e){var n=new Oe(t.i,t.x,t.y),i=new Oe(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Ne(t,e,n,i){var r=new Oe(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function ke(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Oe(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function De(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}function Ae(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}(t),n=Ea(e.vertices,e.holes,2),i=[],r=[];n.forEach(function(t,i){var o=n[i];r.push([e.vertices[2*o],e.vertices[2*o+1]])});for(var a=0;a<r.length;a+=3){var s=r.slice(a,a+3);s.push(r[a]),i.push(o([s]))}return i}function Re(t,e){if(!t)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");var n,i=1/0;return N(e,function(e,r){var o=Ft(t,e);o<i&&((n=jt(e)).properties.featureIndex=r,n.properties.distanceToPoint=o,i=o)}),n}function Fe(t,e,n,i,r){je(t,e,n||0,i||t.length-1,r||function(t,e){return t<e?-1:t>e?1:0})}function je(t,e,n,i,r){for(;i>n;){if(i-n>600){var o=i-n+1,a=e-n+1,s=Math.log(o),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);je(t,e,Math.max(n,Math.floor(e-a*u/o+l)),Math.min(i,Math.floor(e+(o-a)*u/o+l)),r)}var c=t[e],h=n,f=i;for(ze(t,n,e),r(t[i],c)>0&&ze(t,n,i);h<f;){for(ze(t,h,f),h++,f--;r(t[h],c)<0;)h++;for(;r(t[f],c)>0;)f--}0===r(t[n],c)?ze(t,n,f):ze(t,++f,i),f<=e&&(n=f+1),e<=f&&(i=f-1)}}function ze(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Be(t,e){return this instanceof Be?(this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear(),void 0):new Be(t,e)}function Ge(t,e){Ue(t,0,t.children.length,e,t)}function Ue(t,e,n,i,r){r||(r=Je(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],He(r,t.leaf?i(o):o);return r}function He(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function qe(t,e){return t.minX-e.minX}function Ve(t,e){return t.minY-e.minY}function We(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Ye(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Xe(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Ze(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Je(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ke(t,e,n,i,r){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(Fe(t,o=e+Math.ceil((n-e)/i/2)*i,e,n,r),a.push(e,o,o,n))}function $e(t){var e=Be(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=Qe(e)).bbox=e}else t.bbox=t.bbox?t.bbox:tn(t);return Be.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach(function(t){var n=Qe(t);n.bbox=t,e.push(n)}):N(t,function(t){t.bbox=t.bbox?t.bbox:tn(t),e.push(t)}),Be.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=Qe(e)).bbox=e}return Be.prototype.remove.call(this,t)},e.clear=function(){return Be.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:Be.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return Be.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:Be.prototype.all.call(this)}},e.toJSON=function(){return Be.prototype.toJSON.call(this)},e.fromJSON=function(t){return Be.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:tn(t),{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}function Qe(t){var e=[t[0],t[1]],n=[t[0],t[3]],i=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],i,n,e]]}}}function tn(t){var e=[1/0,1/0,-1/0,-1/0];return M(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}function en(t){if(!t)throw new Error("geojson is required");var e=[];return R(t,function(t){!function(t,e){var n=[],i=t.geometry;switch(i.type){case"Polygon":n=q(i);break;case"LineString":n=[q(i)]}n.forEach(function(n){var i=function(t,e){var n=[];return t.reduce(function(t,i){var r=s([t,i],e);return r.bbox=function(t,e){var n=t[0],i=t[1],r=e[0],o=e[1];return[n<r?n:r,i<o?i:o,n>r?n:r,i>o?i:o]}(t,i),n.push(r),i}),n}(n,t.properties);i.forEach(function(t){t.id=e.length,e.push(t)})})}(t,e)}),l(e)}function nn(t,n){var i={},r=[];if("LineString"===t.type&&(t=e(t)),"LineString"===n.type&&(n=e(n)),"Feature"===t.type&&"Feature"===n.type&&"LineString"===t.geometry.type&&"LineString"===n.geometry.type&&2===t.geometry.coordinates.length&&2===n.geometry.coordinates.length){var o=rn(t,n);return o&&r.push(o),l(r)}var a=$e();return a.load(en(n)),N(en(t),function(t){N(a.search(t),function(e){var n=rn(t,e);if(n){var o=q(n).join(",");i[o]||(i[o]=!0,r.push(n))}})}),l(r)}function rn(t,e){var n=q(t),r=q(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=n[0][0],a=n[0][1],s=n[1][0],u=n[1][1],l=r[0][0],c=r[0][1],h=r[1][0],f=r[1][1],p=(f-c)*(s-o)-(h-l)*(u-a),d=(h-l)*(a-c)-(f-c)*(o-l),g=(s-o)*(a-c)-(u-a)*(o-l);if(0===p)return null;var y=d/p,m=g/p;return y>=0&&y<=1&&m>=0&&m<=1?i([o+y*(s-o),a+y*(u-a)]):null}function on(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var r=t.geometry?t.geometry.type:t.type;if("LineString"!==r&&"MultiLineString"!==r)throw new Error("lines must be LineString or MultiLineString");var o=i([1/0,1/0],{dist:1/0}),a=0;return R(t,function(t){for(var r=q(t),u=0;u<r.length-1;u++){var l=i(r[u]);l.properties.dist=Ft(e,l,n);var c=i(r[u+1]);c.properties.dist=Ft(e,c,n);var h=Ft(l,c,n),f=Math.max(l.properties.dist,c.properties.dist),p=de(l,c),d=fe(e,f,p+90,n),g=fe(e,f,p-90,n),y=nn(s([d.geometry.coordinates,g.geometry.coordinates]),s([l.geometry.coordinates,c.geometry.coordinates])),m=null;y.features.length>0&&((m=y.features[0]).properties.dist=Ft(e,m,n),m.properties.location=a+Ft(l,m,n)),l.properties.dist<o.properties.dist&&((o=l).properties.index=u,o.properties.location=a),c.properties.dist<o.properties.dist&&((o=c).properties.index=u+1,o.properties.location=a+h),m&&m.properties.dist<o.properties.dist&&((o=m).properties.index=u),a+=h}}),o}function an(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.final;if(!t)throw new Error("start point is required");if(!e)throw new Error("end point is required");var r;return(r=i?sn(H(e),H(t)):sn(H(t),H(e)))>180?-(360-r):r}function sn(t,e){var n=w(t[1]),i=w(e[1]),r=w(e[0]-t[0]);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var o=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(_(Math.atan2(r,o))+360)%360}function un(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("from point is required");if(!e)throw new Error("to point is required");var r=H(t),o=H(e);return o[0]+=o[0]-r[0]>180?-360:r[0]-o[0]>180?360:0,b(function(t,e,n){var i=n=void 0===n?Ro:Number(n),r=t[1]*Math.PI/180,o=e[1]*Math.PI/180,a=o-r,s=Math.abs(e[0]-t[0])*Math.PI/180;s>Math.PI&&(s-=2*Math.PI);var u=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(r/2+Math.PI/4)),l=Math.abs(u)>1e-11?a/u:Math.cos(r);return Math.sqrt(a*a+l*l*s*s)*i}(r,o),"meters",i)}function ln(t,e){return hn(t,"mercator",e)}function cn(t,e){return hn(t,"wgs84",e)}function hn(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&x(t[0])?t="mercator"===e?fn(t):pn(t):(!0!==i&&(t=jt(t)),M(t,function(t){var n="mercator"===e?fn(t):pn(t);t[0]=n[0],t[1]=n[1]})),t}function fn(t){var e=Math.PI/180,n=20037508.342789244,i=[6378137*(Math.abs(t[0])<=180?t[0]:t[0]-360*function(t){return t<0?-1:t>0?1:0}(t[0]))*e,6378137*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return i[0]>n&&(i[0]=n),i[0]<-n&&(i[0]=-n),i[1]>n&&(i[1]=n),i[1]<-n&&(i[1]=-n),i}function pn(t){var e=180/Math.PI;return[t[0]*e/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/6378137)))*e]}function dn(t,n,r){if(r=r||{},!E(r))throw new Error("options is invalid");if(!t)throw new Error("pt is required");if(Array.isArray(t)?t=i(t):"Point"===t.type?t=e(t):Y(t,"Point","point"),!n)throw new Error("line is required");Array.isArray(n)?n=s(n):"LineString"===n.type?n=e(n):Y(n,"LineString","line");var o=1/0,a=t.geometry.coordinates;return j(n,function(t){var e=t.geometry.coordinates[0],n=t.geometry.coordinates[1],s=function(t,e,n,r){var o=r.mercator,a=!0!==o?Ft(e,t,r):gn(e,t,r),s=v(!0!==o?de(e,t):an(e,t)),u=v(!0!==o?de(e,n):an(e,n)),l=Math.abs(s-u);if(l>90)return a;var c=(u+180)%360,h=v(!0!==o?de(n,t):an(n,t)),f=Math.abs(h-c);return f>180&&(f=Math.abs(f-360)),f>90?!0!==o?Ft(t,n,r):gn(t,n,r):!0!==o?a*Math.sin(w(l)):function(t,e,n,r){var o=0;(Math.abs(t[0])>=180||Math.abs(e[0])>=180||Math.abs(n[0])>=180)&&(o=t[0]>0||e[0]>0||n[0]>0?-180:180);var a=i(n),s=ln([t[0]+o,t[1]]),u=ln([e[0]+o,e[1]]),l=ln([n[0]+o,n[1]]),c=cn(function(t,e,n){var i=t[0],r=t[1],o=e[0],a=e[1],s=n[0],u=n[1],l=o-i,c=a-r,h=((s-i)*l+(u-r)*c)/(l*l+c*c);return[i+h*l,r+h*c]}(s,u,l));return 0!==o&&(c[0]-=o),un(a,c,r)}(e,n,t,r)}(a,e,n,r);o>s&&(o=s)}),o}function gn(t,e,n){var i=n.units,r=0;Math.abs(t[0])>=180&&(r=t[0]>0?-180:180),Math.abs(e[0])>=180&&(r=e[0]>0?-180:180);var o=ln([t[0]+r,t[1]]),a=ln([e[0]+r,e[1]]),s=function(t){return t*t},u=s(o[0]-a[0])+s(o[1]-a[1]);return b(Math.sqrt(u),"meters",i)}function yn(t){for(var n=function(t){return"FeatureCollection"!==t.type?l("Feature"!==t.type?[e(t)]:[t]):t}(t),r=ge(n),o=!1,a=0;!o&&a<n.features.length;){var s,u=n.features[a].geometry,c=!1;if("Point"===u.type)r.geometry.coordinates[0]===u.coordinates[0]&&r.geometry.coordinates[1]===u.coordinates[1]&&(o=!0);else if("MultiPoint"===u.type){var h=!1;for(s=0;!h&&s<u.coordinates.length;)r.geometry.coordinates[0]===u.coordinates[s][0]&&r.geometry.coordinates[1]===u.coordinates[s][1]&&(o=!0,h=!0),s++}else if("LineString"===u.type)for(s=0;!c&&s<u.coordinates.length-1;)mn(r.geometry.coordinates[0],r.geometry.coordinates[1],u.coordinates[s][0],u.coordinates[s][1],u.coordinates[s+1][0],u.coordinates[s+1][1])&&(c=!0,o=!0),s++;else if("MultiLineString"===u.type)for(var f=0;f<u.coordinates.length;){c=!1,s=0;for(var p=u.coordinates[f];!c&&s<p.length-1;)mn(r.geometry.coordinates[0],r.geometry.coordinates[1],p[s][0],p[s][1],p[s+1][0],p[s+1][1])&&(c=!0,o=!0),s++;f++}else"Polygon"!==u.type&&"MultiPolygon"!==u.type||Tt(r,u)&&(o=!0);a++}if(o)return r;var d=l([]);for(a=0;a<n.features.length;a++)d.features=d.features.concat(ve(n.features[a]).features);return i(Re(r,d).geometry.coordinates)}function mn(t,e,n,i,r,o){return Math.sqrt((r-n)*(r-n)+(o-i)*(o-i))===Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))+Math.sqrt((r-t)*(r-t)+(o-e)*(o-e))}function vn(t){return A(t,function(t,e){return t+_n(e)},0)}function _n(t){var e,n=0;switch(t.type){case"Polygon":return wn(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=wn(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(e=0;e<t.geometries.length;e++)n+=_n(t.geometries[e]);return n}}function wn(t){var e=0;if(t&&t.length>0){e+=Math.abs(bn(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(bn(t[n]))}return e}function bn(t){var e,n,i,r,o,a,s=0,u=t.length;if(u>2){for(a=0;a<u;a++)a===u-2?(i=u-2,r=u-1,o=0):a===u-1?(i=u-1,r=0,o=1):(i=a,r=a+1,o=a+2),e=t[i],n=t[r],s+=(Cn(t[o][0])-Cn(e[0]))*Math.sin(Cn(n[1]));s=s*Ma*Ma/2}return s}function Cn(t){return t*Math.PI/180}function xn(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");if(!t)throw new Error("geojson is required");return z(t,function(t,n){var i=n.geometry.coordinates;return t+Ft(i[0],i[1],e)},0)}function En(t,e,n,i){if(i=i||{},!E(i))throw new Error("options is invalid");var r,o=[];if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}for(var a,u,l,c=0,h=0;h<r.length&&!(e>=c&&h===r.length-1);h++){if(c>e&&0===o.length){if(!(a=e-c))return o.push(r[h]),s(o);u=de(r[h],r[h-1])-180,l=fe(r[h],a,u,i),o.push(l.geometry.coordinates)}if(c>=n)return(a=n-c)?(u=de(r[h],r[h-1])-180,l=fe(r[h],a,u,i),o.push(l.geometry.coordinates),s(o)):(o.push(r[h]),s(o));if(c>=e&&o.push(r[h]),h===r.length-1)return s(o);c+=Ft(r[h],r[h+1],i)}return s(r[r.length-1])}function Sn(t,e,n){var i=(n=n||{}).ignoreEndVertices;if(!E(n))throw new Error("invalid options");if(!t)throw new Error("pt is required");if(!e)throw new Error("line is required");for(var r=H(t),o=q(e),a=0;a<o.length-1;a++){var s=!1;if(i&&(0===a&&(s="start"),a===o.length-2&&(s="end"),0===a&&a+1===o.length-1&&(s="both")),function(t,e,n,i){var r=n[0],o=n[1],a=t[0],s=t[1],u=e[0],l=e[1],c=n[0]-a,h=n[1]-s,f=u-a,p=l-s;return c*p-h*f==0&&(i?"start"===i?Math.abs(f)>=Math.abs(p)?f>0?a<r&&r<=u:u<=r&&r<a:p>0?s<o&&o<=l:l<=o&&o<s:"end"===i?Math.abs(f)>=Math.abs(p)?f>0?a<=r&&r<u:u<r&&r<=a:p>0?s<=o&&o<l:l<o&&o<=s:"both"===i?Math.abs(f)>=Math.abs(p)?f>0?a<r&&r<u:u<r&&r<a:p>0?s<o&&o<l:l<o&&o<s:void 0:Math.abs(f)>=Math.abs(p)?f>0?a<=r&&r<=u:u<=r&&r<=a:p>0?s<=o&&o<=l:l<=o&&o<=s)}(o[a],o[a+1],r,s))return!0}return!1}function Pn(t,e){var n=K(t),i=K(e),r=Z(t),o=Z(e);switch(n){case"Point":switch(i){case"MultiPoint":return function(t,e){var n,i=!1;for(n=0;n<e.coordinates.length;n++)if(Ln(e.coordinates[n],t.coordinates)){i=!0;break}return i}(r,o);case"LineString":return Sn(r,o,{ignoreEndVertices:!0});case"Polygon":return Tt(r,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var i=!1,r=0;r<e.coordinates.length;r++)Ln(t.coordinates[n],e.coordinates[r])&&(i=!0);if(!i)return!1}return!0}(r,o);case"LineString":return function(t,e){for(var n=!1,i=0;i<t.coordinates.length;i++){if(!Sn(t.coordinates[i],e))return!1;n||(n=Sn(t.coordinates[i],e,{ignoreEndVertices:!0}))}return n}(r,o);case"Polygon":return function(t,e){for(var n=!0,i=0;i<t.coordinates.length;i++){var r=Tt(t.coordinates[1],e);if(!r){n=!1;break}r=Tt(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&r}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!Sn(t.coordinates[n],e))return!1;return!0}(r,o);case"Polygon":return function(t,e){var n=U(e),i=U(t);if(!Mn(n,i))return!1;for(var r=!1,o=0;o<t.coordinates.length-1;o++){if(!Tt(t.coordinates[o],e))return!1;if(r||(r=Tt(t.coordinates[o],e,{ignoreBoundary:!0})),!r){var a=function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}(t.coordinates[o],t.coordinates[o+1]);r=Tt(a,e,{ignoreBoundary:!0})}}return r}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Polygon":return function(t,e){var n=U(t);if(!Mn(U(e),n))return!1;for(var i=0;i<t.coordinates[0].length;i++)if(!Tt(t.coordinates[0][i],e))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Mn(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Ln(t,e){return t[0]===e[0]&&t[1]===e[1]}function In(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var r=n.mask,o=n.properties,a=[];if(null===e||void 0===e)throw new Error("cellSide is required");if(!x(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(K(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],u=t[1],c=t[2],h=t[3],f=e/Ft([s,u],[c,u],n)*(c-s),p=e/Ft([s,u],[s,h],n)*(h-u),d=c-s,g=h-u,y=Math.floor(d/f),m=(g-Math.floor(g/p)*p)/2,v=s+(d-y*f)/2;v<=c;){for(var _=u+m;_<=h;){var w=i([v,_],o);r?Pn(w,r)&&a.push(w):a.push(w),_+=p}v+=f}return l(a)}function Tn(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.precision,i=e.coordinates,r=e.mutate;if(n=void 0===n||null===n||isNaN(n)?6:n,i=void 0===i||null===i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,n);return M(t,function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,o,i)}),t}function Nn(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!Nn(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function kn(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function On(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!On(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}function Dn(t,e){var n=[],i=$e();return R(e,function(e){if(n.forEach(function(t,e){t.id=e}),n.length){var r=i.search(e);if(r.features.length){var o=Rn(e,r);n=n.filter(function(t){return t.id!==o.id}),i.remove(o),N(An(o,e),function(t){n.push(t),i.insert(t)})}}else(n=An(t,e).features).forEach(function(t){t.bbox||(t.bbox=he(U(t)))}),i.load(l(n))}),l(n)}function An(t,e){var n=[],i=q(t)[0],r=q(t)[t.geometry.coordinates.length-1];if(Fn(i,H(e))||Fn(r,H(e)))return l([t]);
var o=$e(),a=en(t);o.load(a);var u=o.search(e);if(!u.features.length)return l([t]);var c=Rn(e,u),h=k(a,function(t,i,r){var o=q(i)[1],a=H(e);return r===c.id?(t.push(a),n.push(s(t)),Fn(a,o)?[a]:[a,o]):(t.push(o),t)},[i]);return h.length>1&&n.push(s(h)),l(n)}function Rn(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var n,i=1/0;return N(e,function(e){var r=on(e,t).properties.dist;r<i&&(n=e,i=r)}),n}function Fn(t,e){return t[0]===e[0]&&t[1]===e[1]}function jn(t,e,n,i,r){if(r=r||{},!E(r))throw new Error("options is invalid");var o=r.steps,a=r.units;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if(void 0===n||null===n)throw new Error("bearing1 is required");if(void 0===i||null===i)throw new Error("bearing2 is required");if("object"!=typeof r)throw new Error("options must be an object");o=o||64;var u=zn(n),l=zn(i),c=t.properties;if(u===l)return s(pe(t,e,r).geometry.coordinates[0],c);for(var h=u,f=u<l?l:l+360,p=h,d=[],g=0;p<f;)d.push(fe(t,e,p,a).geometry.coordinates),p=h+360*++g/o;return p>f&&d.push(fe(t,e,f,a).geometry.coordinates),s(d,c)}function zn(t){var e=t%360;return e<0&&(e+=360),e}function Bn(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.properties,i=K(t),r=q(t);if(n=n||t.properties||{},!r.length)throw new Error("polygon must contain coordinates");switch(i){case"Polygon":return Gn(r,n);case"MultiPolygon":var o=[];return r.forEach(function(t){o.push(Gn(t,n))}),l(o);default:throw new Error("geom "+i+" not supported")}}function Gn(t,e){return t.length>1?c(t,e):s(t[0],e)}function Un(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.properties,i=e.autoComplete,r=e.orderCoords;if(!t)throw new Error("lines is required");switch(i=void 0===i||i,r=void 0===r||r,K(t)){case"FeatureCollection":case"GeometryCollection":var o=[];return(t.features?t.features:t.geometries).forEach(function(t){o.push(q(Hn(t,{},i,r)))}),f(o,n)}return Hn(t,n,i,r)}function Hn(t,e,n,i){e=e||t.properties||{};var r=q(t),a=K(t);if(!r.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return n&&(r=qn(r)),o([r],e);case"MultiLineString":var u=[],l=0;return r.forEach(function(t){if(n&&(t=qn(t)),i){var e=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.abs(e-i)*Math.abs(n-r)}(U(s(t)));e>l?(u.unshift(t),l=e):u.push(t)}else u.push(t)}),o(u,e);default:throw new Error("geometry type "+a+" is not supported")}}function qn(t){var e=t[0],n=e[0],i=e[1],r=t[t.length-1],o=r[0],a=r[1];return n===o&&i===a||t.push(e),t}function Vn(t,e,n){var i,r,o,a,s,u=t.length,l=Yn(t[0],e),c=[];for(n||(n=[]),i=1;i<u;i++){for(r=t[i-1],a=s=Yn(o=t[i],e);;){if(!(l|a)){c.push(r),a!==s?(c.push(o),i<u-1&&(n.push(c),c=[])):i===u-1&&c.push(o);break}if(l&a)break;l?l=Yn(r=Wn(r,o,l,e),e):a=Yn(o=Wn(r,o,a,e),e)}l=s}return c.length&&n.push(c),n}function Wn(t,e,n,i){return 8&n?[t[0]+(e[0]-t[0])*(i[3]-t[1])/(e[1]-t[1]),i[3]]:4&n?[t[0]+(e[0]-t[0])*(i[1]-t[1])/(e[1]-t[1]),i[1]]:2&n?[i[2],t[1]+(e[1]-t[1])*(i[2]-t[0])/(e[0]-t[0])]:1&n?[i[0],t[1]+(e[1]-t[1])*(i[0]-t[0])/(e[0]-t[0])]:null}function Yn(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Xn(t,e){for(var n=[],i=0;i<t.length;i++){var r=ja.polygon(t[i],e);r.length>0&&(r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]||r.push(r[0]),r.length>=4&&n.push(r))}return n}function Zn(t){return"[object Arguments]"===Object.prototype.toString.call(t)}function Jn(t,e,n){return n||(n={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?(n.strict,t===e):function(t,e,n){var i,r;if(Kn(t)||Kn(e))return!1;if(t.prototype!==e.prototype)return!1;if(Zn(t))return!!Zn(e)&&(t=za.call(t),e=za.call(e),Jn(t,e,n));if($n(t)){if(!$n(e))return!1;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}try{var o=Object.keys(t),a=Object.keys(e)}catch(t){return!1}if(o.length!==a.length)return!1;for(o.sort(),a.sort(),i=o.length-1;i>=0;i--)if(o[i]!==a[i])return!1;for(i=o.length-1;i>=0;i--)if(r=o[i],!Jn(t[r],e[r],n))return!1;return typeof t==typeof e}(t,e,n))}function Kn(t){return null===t||void 0===t}function $n(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}function Qn(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.tolerance||0,r=[],o=$e();o.load(en(t));var a;return j(e,function(t){var e=!1;N(o.search(t),function(n){if(!1===e){var r=q(t).sort(),o=q(n).sort();Jn(r,o)?(e=!0,a=a?ti(a,t):t):(0===i?Sn(r[0],n)&&Sn(r[1],n):on(n,r[0]).properties.dist<=i&&on(n,r[1]).properties.dist<=i)?(e=!0,a=a?ti(a,t):t):(0===i?Sn(o[0],t)&&Sn(o[1],t):on(t,o[0]).properties.dist<=i&&on(t,o[1]).properties.dist<=i)&&(a=a?ti(a,n):n)}}),!1===e&&a&&(r.push(a),a=void 0)}),a&&r.push(a),l(r)}function ti(t,e){var n=q(e),i=q(t),r=i[0],o=i[i.length-1],a=t.geometry.coordinates;return Jn(n[0],r)?a.unshift(n[1]):Jn(n[0],o)?a.push(n[1]):Jn(n[1],r)?a.unshift(n[0]):Jn(n[1],o)&&a.push(n[0]),t}function ei(t){var e=t%360;return e<0&&(e+=360),e}function ni(t,e,n,r){if(r=r||{},!E(r))throw new Error("options is invalid");var o=r.units,a=r.properties;if(!t)throw new Error("origin is required");if(void 0===e||null===e)throw new Error("distance is required");if(void 0===n||null===n)throw new Error("bearing is required");if(!(e>=0))throw new Error("distance must be greater than 0");var s=b(e,o,"meters"),u=H(t),l=function(t,e,n,i){i=void 0===i?Ro:Number(i);var r=e/i,o=t[0]*Math.PI/180,a=w(t[1]),s=w(n),u=r*Math.cos(s),l=a+u;Math.abs(l)>Math.PI/2&&(l=l>0?Math.PI-l:-Math.PI-l);var c=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),h=Math.abs(c)>1e-11?u/c:Math.cos(a),f=r*Math.sin(s)/h;return[(180*(o+f)/Math.PI+540)%360-180,180*l/Math.PI]}(u,s,n);return l[0]+=l[0]-u[0]>180?-360:u[0]-l[0]>180?360:0,i(l,a)}function ii(t,e,n,i,r,o){for(var a=0;a<t.length;a++){var s=t[a],u=t[a+1];a===t.length-1&&(u=t[0]),i=ri(s,u,e),n<=0&&i>0?function(t,e,n){return ri(t,e,n)<0}(e,s,r)||(r=s):n>0&&i<=0&&(function(t,e,n){return ri(t,e,n)>0}(e,s,o)||(o=s)),n=i}return[r,o]}function ri(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function oi(t){if(!t)throw new Error("line is required");var e=t.geometry?t.geometry.type:t.type;if(!Array.isArray(t)&&"LineString"!==e)throw new Error("geometry must be a LineString");for(var n,i,r=q(t),o=0,a=1;a<r.length;)n=i||r[0],o+=((i=r[a])[0]-n[0])*(i[1]+n[1]),a++;return o>0}function ai(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return D(t,function(t){ai(t,e)}),t;case"LineString":return si(q(t),e),t;case"Polygon":return ui(q(t),e),t;case"MultiLineString":return q(t).forEach(function(t){si(t,e)}),t;case"MultiPolygon":return q(t).forEach(function(t){ui(t,e)}),t;case"Point":case"MultiPoint":return t}}function si(t,e){oi(t)===e&&t.reverse()}function ui(t,e){oi(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)oi(t[n])===e&&t[n].reverse()}function li(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;X(t,"Point","input must contain Points");for(var o=function(t,e){var n={};return N(t,function(t){var e=q(t)[1];n[e]||(n[e]=[]),n[e].push(t)}),Object.keys(n).map(function(t){var e=n[t],i=e.sort(function(t,e){return q(t)[0]-q(e)[0]});return i}).sort(function(t,n){return e?q(t[0])[1]-q(n[0])[1]:q(n[0])[1]-q(t[0])[1]})}(t,i),a=[],s=0;s<o.length;s++){for(var u=o[s],l=[],c=0;c<u.length;c++){var h=u[c];h.properties[n]?l.push(h.properties[n]):l.push(0),!0===r&&(h.properties.matrixPosition=[s,c])}a.push(l)}return a}function ci(t,e,n,i){i=i||{};for(var r=Object.keys(Ba),o=0;o<r.length;o++){var a=r[o],s=i[a];s=void 0!==s&&null!==s?s:Ba[a],Ga[a]=s}Ga.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+n)+"]");var u,l=function(t,e,n){for(var i=t.length-1,r=t[0].length-1,o={rows:i,cols:r,cells:[]},a=e+Math.abs(n),s=0;s<i;++s){o.cells[s]=[];for(var u=0;u<r;++u){var l=0,c=t[s+1][u],h=t[s+1][u+1],f=t[s][u+1],p=t[s][u];if(!(isNaN(c)||isNaN(h)||isNaN(f)||isNaN(p))){l|=c<e?0:c>a?128:64,l|=h<e?0:h>a?32:16,l|=f<e?0:f>a?8:4;var d=+(l|=p<e?0:p>a?2:1),g=0;if(17===l||18===l||33===l||34===l||38===l||68===l||72===l||98===l||102===l||132===l||136===l||137===l||152===l||153===l){var y=(c+h+f+p)/4;g=y>a?2:y<e?0:1,34===l?1===g?l=35:0===g&&(l=136):136===l?1===g?(l=35,g=4):0===g&&(l=34):17===l?1===g?(l=155,g=4):0===g&&(l=153):68===l?1===g?(l=103,g=4):0===g&&(l=102):153===l?1===g&&(l=155):102===l?1===g&&(l=103):152===l?g<2&&(l=156,g=1):137===l?g<2&&(l=139,g=1):98===l?g<2&&(l=99,g=1):38===l?g<2&&(l=39,g=1):18===l?g>0?(l=156,g=4):l=152:33===l?g>0?(l=139,g=4):l=137:72===l?g>0?(l=99,g=4):l=98:132===l&&(g>0?(l=39,g=4):l=38)}if(0!=l&&170!=l){var m,v,_,w,b,C,x,E;m=v=_=w=b=C=x=E=.5;var S=[];1===l?(_=1-hi(e,f,p),E=1-hi(e,c,p),S.push(Ms[l])):169===l?(_=hi(a,p,f),E=hi(a,p,c),S.push(Ms[l])):4===l?(C=1-hi(e,h,f),w=hi(e,p,f),S.push(Ss[l])):166===l?(C=hi(a,f,h),w=1-hi(a,f,p),S.push(Ss[l])):16===l?(b=hi(e,f,h),v=hi(e,c,h),S.push(Es[l])):154===l?(b=1-hi(a,h,f),v=1-hi(a,h,c),S.push(Es[l])):64===l?(x=hi(e,p,c),m=1-hi(e,h,c),S.push(Is[l])):106===l?(x=1-hi(a,c,p),m=hi(a,c,h),S.push(Is[l])):168===l?(w=hi(a,p,f),_=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),S.push(Ps[l]),S.push(Ms[l])):2===l?(w=1-hi(e,f,p),_=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),S.push(Ps[l]),S.push(Ms[l])):162===l?(b=hi(a,f,h),C=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),S.push(Ps[l]),S.push(Ms[l])):8===l?(b=1-hi(e,h,f),C=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),S.push(Es[l]),S.push(Ss[l])):138===l?(b=1-hi(e,h,f),C=1-hi(a,h,f),m=1-hi(a,h,c),v=1-hi(e,h,c),S.push(Es[l]),S.push(Ss[l])):32===l?(b=hi(a,f,h),C=hi(e,f,h),m=hi(e,c,h),v=hi(a,c,h),S.push(Es[l]),S.push(Ss[l])):42===l?(E=1-hi(a,c,p),x=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h),S.push(Ls[l]),S.push(Is[l])):128===l&&(E=hi(e,p,c),x=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c),S.push(Ls[l]),S.push(Is[l])),5===l?(C=1-hi(e,h,f),E=1-hi(e,c,p),S.push(Ss[l])):165===l?(C=hi(a,f,h),E=hi(a,p,c),S.push(Ss[l])):20===l?(w=hi(e,p,f),v=hi(e,c,h),S.push(Ps[l])):150===l?(w=1-hi(a,f,p),v=1-hi(a,h,c),S.push(Ps[l])):80===l?(b=hi(e,f,h),x=hi(e,p,c),S.push(Es[l])):90===l?(b=1-hi(a,h,f),x=1-hi(a,c,p),S.push(Es[l])):65===l?(_=1-hi(e,f,p),m=1-hi(e,h,c),S.push(Ms[l])):105===l?(_=hi(a,p,f),m=hi(a,c,h),S.push(Ms[l])):160===l?(b=hi(a,f,h),C=hi(e,f,h),E=hi(e,p,c),x=hi(a,p,c),S.push(Es[l]),S.push(Ss[l])):10===l?(b=1-hi(e,h,f),C=1-hi(a,h,f),E=1-hi(a,c,p),x=1-hi(e,c,p),S.push(Es[l]),S.push(Ss[l])):130===l?(w=1-hi(e,f,p),_=1-hi(a,f,p),m=1-hi(a,h,c),v=1-hi(e,h,c),S.push(Ps[l]),S.push(Ms[l])):40===l?(w=hi(a,p,f),_=hi(e,p,f),m=hi(e,c,h),v=hi(a,c,h),S.push(Ps[l]),S.push(Ms[l])):101===l?(C=hi(a,f,h),m=hi(a,c,h),S.push(Ss[l])):69===l?(C=1-hi(e,h,f),m=1-hi(e,h,c),S.push(Ss[l])):149===l?(E=hi(a,p,c),v=1-hi(a,h,c),S.push(Ls[l])):21===l?(E=1-hi(e,c,p),v=hi(e,c,h),S.push(Ls[l])):86===l?(w=1-hi(a,f,p),x=1-hi(a,c,p),S.push(Ps[l])):84===l?(w=hi(e,p,f),x=hi(e,p,c),S.push(Ps[l])):89===l?(b=1-hi(a,h,f),_=hi(a,p,f),S.push(Ms[l])):81===l?(b=hi(e,f,h),_=1-hi(e,f,p),S.push(Ms[l])):96===l?(b=hi(a,f,h),C=hi(e,f,h),x=hi(e,p,c),m=hi(a,c,h),S.push(Es[l]),S.push(Ss[l])):74===l?(b=1-hi(e,h,f),C=1-hi(a,h,f),x=1-hi(a,c,p),m=1-hi(e,h,c),S.push(Es[l]),S.push(Ss[l])):24===l?(b=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),v=hi(e,c,h),S.push(Es[l]),S.push(Ms[l])):146===l?(b=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),v=1-hi(a,h,c),S.push(Es[l]),S.push(Ms[l])):6===l?(C=1-hi(e,h,f),w=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),S.push(Ss[l]),S.push(Ps[l])):164===l?(C=hi(a,f,h),w=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),S.push(Ss[l]),S.push(Ps[l])):129===l?(_=1-hi(e,f,p),E=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c),S.push(Ms[l]),S.push(Ls[l])):41===l?(_=hi(a,p,f),E=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h),S.push(Ms[l]),S.push(Ls[l])):66===l?(w=1-hi(e,f,p),_=1-hi(a,f,p),x=1-hi(a,c,p),m=1-hi(e,h,c),S.push(Ps[l]),S.push(Ms[l])):104===l?(w=hi(a,p,f),_=hi(e,p,f),x=hi(e,p,c),m=hi(a,c,h),S.push(Ms[l]),S.push(Ts[l])):144===l?(b=hi(e,f,h),E=hi(e,p,c),x=hi(a,p,c),v=1-hi(a,h,c),S.push(Es[l]),S.push(Is[l])):26===l?(b=1-hi(a,h,f),E=1-hi(a,c,p),x=1-hi(e,c,p),v=hi(e,c,h),S.push(Es[l]),S.push(Is[l])):36===l?(C=hi(a,f,h),w=hi(e,p,f),m=hi(e,c,h),v=hi(a,c,h),S.push(Ss[l]),S.push(Ps[l])):134===l?(C=1-hi(e,h,f),w=1-hi(a,f,p),m=1-hi(a,h,c),v=1-hi(e,h,c),S.push(Ss[l]),S.push(Ps[l])):9===l?(b=1-hi(e,h,f),C=1-hi(a,h,f),_=hi(a,p,f),E=1-hi(e,c,p),S.push(Es[l]),S.push(Ss[l])):161===l?(b=hi(a,f,h),C=hi(e,f,h),_=1-hi(e,f,p),E=hi(a,p,c),S.push(Es[l]),S.push(Ss[l])):37===l?(C=hi(a,f,h),E=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h),S.push(Ss[l]),S.push(Ls[l])):133===l?(C=1-hi(e,h,f),E=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c),S.push(Ss[l]),S.push(Ls[l])):148===l?(w=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),v=1-hi(a,h,c),S.push(Ps[l]),S.push(Is[l])):22===l?(w=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),v=hi(e,c,h),S.push(Ps[l]),S.push(Is[l])):82===l?(b=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),x=1-hi(a,c,p),S.push(Es[l]),S.push(Ms[l])):88===l?(b=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),x=hi(e,p,c),S.push(Es[l]),S.push(Ms[l])):73===l?(b=1-hi(e,h,f),C=1-hi(a,h,f),_=hi(a,p,f),m=1-hi(e,h,c),S.push(Es[l]),S.push(Ss[l])):97===l?(b=hi(a,f,h),C=hi(e,f,h),_=1-hi(e,f,p),m=hi(a,c,h),S.push(Es[l]),S.push(Ss[l])):145===l?(b=hi(e,f,h),_=1-hi(e,f,p),E=hi(a,p,c),v=1-hi(a,h,c),S.push(Es[l]),S.push(Ls[l])):25===l?(b=1-hi(a,h,f),_=hi(a,p,f),E=1-hi(e,c,p),v=hi(e,c,h),S.push(Es[l]),S.push(Ls[l])):70===l?(C=1-hi(e,h,f),w=1-hi(a,f,p),x=1-hi(a,c,p),m=1-hi(e,h,c),S.push(Ss[l]),S.push(Ps[l])):100===l?(C=hi(a,f,h),w=hi(e,p,f),x=hi(e,p,c),m=hi(a,c,h),S.push(Ss[l]),S.push(Ps[l])):34===l?(0===g?(b=1-hi(e,h,f),C=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c)):(b=hi(a,f,h),C=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h)),S.push(Es[l]),S.push(Ss[l]),S.push(Ls[l]),S.push(Is[l])):35===l?(4===g?(b=1-hi(e,h,f),C=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c)):(b=hi(a,f,h),C=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h)),S.push(Es[l]),S.push(Ss[l]),S.push(Ms[l]),S.push(Is[l])):136===l?(0===g?(b=hi(a,f,h),C=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h)):(b=1-hi(e,h,f),C=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c)),S.push(Es[l]),S.push(Ss[l]),S.push(Ls[l]),S.push(Is[l])):153===l?(0===g?(b=hi(e,f,h),_=1-hi(e,f,p),E=1-hi(e,c,p),v=hi(e,c,h)):(b=1-hi(a,h,f),_=hi(a,p,f),E=hi(a,p,c),v=1-hi(a,h,c)),S.push(Es[l]),S.push(Ms[l])):102===l?(0===g?(C=1-hi(e,h,f),w=hi(e,p,f),x=hi(e,p,c),m=1-hi(e,h,c)):(C=hi(a,f,h),w=1-hi(a,f,p),x=1-hi(a,c,p),m=hi(a,c,h)),S.push(Ss[l]),S.push(Is[l])):155===l?(4===g?(b=hi(e,f,h),_=1-hi(e,f,p),E=1-hi(e,c,p),v=hi(e,c,h)):(b=1-hi(a,h,f),_=hi(a,p,f),E=hi(a,p,c),v=1-hi(a,h,c)),S.push(Es[l]),S.push(Ls[l])):103===l?(4===g?(C=1-hi(e,h,f),w=hi(e,p,f),x=hi(e,p,c),m=1-hi(e,h,c)):(C=hi(a,f,h),w=1-hi(a,f,p),x=1-hi(a,c,p),m=hi(a,c,h)),S.push(Ss[l]),S.push(Ps[l])):152===l?(0===g?(b=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),v=hi(e,c,h)):(b=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),v=1-hi(a,h,c)),S.push(Es[l]),S.push(Ps[l]),S.push(Ms[l])):156===l?(4===g?(b=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),v=hi(e,c,h)):(b=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),v=1-hi(a,h,c)),S.push(Es[l]),S.push(Ms[l]),S.push(Is[l])):137===l?(0===g?(b=hi(a,f,h),C=hi(e,f,h),_=1-hi(e,f,p),E=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h)):(b=1-hi(e,h,f),C=1-hi(a,h,f),_=hi(a,p,f),E=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c)),S.push(Es[l]),S.push(Ss[l]),S.push(Ms[l])):139===l?(4===g?(b=hi(a,f,h),C=hi(e,f,h),_=1-hi(e,f,p),E=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h)):(b=1-hi(e,h,f),C=1-hi(a,h,f),_=hi(a,p,f),E=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c)),S.push(Es[l]),S.push(Ss[l]),S.push(Ls[l])):98===l?(0===g?(b=1-hi(e,h,f),C=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),x=hi(e,p,c),m=1-hi(e,h,c)):(b=hi(a,f,h),C=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),x=1-hi(a,c,p),m=hi(a,c,h)),S.push(Es[l]),S.push(Ss[l]),S.push(Is[l])):99===l?(4===g?(b=1-hi(e,h,f),C=1-hi(a,h,f),w=hi(a,p,f),_=hi(e,p,f),x=hi(e,p,c),m=1-hi(e,h,c)):(b=hi(a,f,h),C=hi(e,f,h),w=1-hi(e,f,p),_=1-hi(a,f,p),x=1-hi(a,c,p),m=hi(a,c,h)),S.push(Es[l]),S.push(Ss[l]),S.push(Ms[l])):38===l?(0===g?(C=1-hi(e,h,f),w=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c)):(C=hi(a,f,h),w=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h)),S.push(Ss[l]),S.push(Ls[l]),S.push(Is[l])):39===l?(4===g?(C=1-hi(e,h,f),w=hi(e,p,f),E=hi(e,p,c),x=hi(a,p,c),m=1-hi(a,h,c),v=1-hi(e,h,c)):(C=hi(a,f,h),w=1-hi(a,f,p),E=1-hi(a,c,p),x=1-hi(e,c,p),m=hi(e,c,h),v=hi(a,c,h)),S.push(Ss[l]),S.push(Ps[l]),S.push(Is[l])):85===l&&(b=1,C=0,w=1,_=0,E=0,x=1,m=0,v=1),(m<0||m>1||v<0||v>1||b<0||b>1||w<0||w>1||E<0||E>1||x<0||x>1)&&console.log("MarchingSquaresJS-isoBands: "+l+" "+d+" "+c+","+h+","+f+","+p+" "+g+" "+m+" "+v+" "+b+" "+C+" "+w+" "+_+" "+E+" "+x),o.cells[s][u]={cval:l,cval_real:d,flipped:g,topleft:m,topright:v,righttop:b,rightbottom:C,bottomright:w,bottomleft:_,leftbottom:E,lefttop:x,edges:S}}}}}return o}(t,e,n);return Ga.polygons?(Ga.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),u=function(t){var e=[],n=0;return t.cells.forEach(function(t,i){t.forEach(function(t,r){if(void 0!==t){var o=ks[t.cval](t);"object"==typeof o&&fi(o)?"object"==typeof o[0]&&fi(o[0])?"object"==typeof o[0][0]&&fi(o[0][0])?o.forEach(function(t){t.forEach(function(t){t[0]+=r,t[1]+=i}),e[n++]=t}):(o.forEach(function(t){t[0]+=r,t[1]+=i}),e[n++]=o):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),e}(l)):(Ga.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),u=function(t){for(var e=[],n=t.rows,i=t.cols,r=[],o=0;o<n;o++)for(var a=0;a<i;a++)if(void 0!==t.cells[o][a]&&t.cells[o][a].edges.length>0){var s=t.cells[o][a],u=function(t){if(t.edges.length>0){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return n&Ha?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return n&qa?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return n&qa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return n&Va?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return n&Ha?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return n&qa?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return n&qa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return n&Va?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return n&qa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return n&Va?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return n&Va?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return n&Ua?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return n&qa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return n&Va?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return n&Va?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return n&Ua?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return n&qa?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return n&Ua?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return n&Va?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return n&Ua?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return n&Ua?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return n&Ha?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return n&Ua?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return n&Ha?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}(s),l=null,c=a,h=o;null!==u&&r.push([u.p[0]+c,u.p[1]+h]);do{if(null===(l=function(t,e,n,i){var r,o,a,s,u,l=t.cval;switch(e){case-1:switch(i){case 0:r=Ss[l],a=es[l],s=ns[l],u=is[l];break;default:r=Es[l],a=$a[l],s=Qa[l],u=ts[l]}break;case 1:switch(i){case 0:r=Ls[l],a=ps[l],s=ds[l],u=gs[l];break;default:r=Is[l],a=cs[l],s=hs[l],u=fs[l]}break;default:switch(n){case-1:switch(i){case 0:r=Ts[l],a=Wa[l],s=Ya[l],u=Xa[l];break;default:r=Ns[l],a=Za[l],s=Ja[l],u=Ka[l]}break;case 1:switch(i){case 0:r=Ms[l],a=rs[l],s=os[l],u=as[l];break;default:r=Ps[l],a=ss[l],s=us[l],u=ls[l]}}}if(o=t.edges.indexOf(r),void 0===t.edges[o])return null;switch(!function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,o),l=t.cval_real,r){case 0:l&Ha?(e=t.topleft,n=1):(e=1,n=t.righttop);break;case 1:l&qa?(e=1,n=t.rightbottom):(e=t.topleft,n=1);break;case 2:l&qa?(e=t.topleft,n=1):(e=t.bottomright,n=0);break;case 3:l&Va?(e=t.bottomleft,n=0):(e=t.topleft,n=1);break;case 4:l&Ha?(e=t.topright,n=1):(e=1,n=t.righttop);break;case 5:l&qa?(e=1,n=t.rightbottom):(e=t.topright,n=1);break;case 6:l&qa?(e=t.topright,n=1):(e=t.bottomright,n=0);break;case 7:l&Va?(e=t.bottomleft,n=0):(e=t.topright,n=1);break;case 8:l&qa?(e=1,n=t.righttop):(e=t.bottomright,n=0);break;case 9:l&Va?(e=t.bottomleft,n=0):(e=1,n=t.righttop);break;case 10:l&Va?(e=1,n=t.righttop):(e=0,n=t.leftbottom);break;case 11:l&Ua?(e=0,n=t.lefttop):(e=1,n=t.righttop);break;case 12:l&qa?(e=1,n=t.rightbottom):(e=t.bottomright,n=0);break;case 13:l&Va?(e=t.bottomleft,n=0):(e=1,n=t.rightbottom);break;case 14:l&Va?(e=1,n=t.rightbottom):(e=0,n=t.leftbottom);break;case 15:l&Ua?(e=0,n=t.lefttop):(e=1,n=t.rightbottom);break;case 16:l&qa?(e=0,n=t.leftbottom):(e=t.bottomright,n=0);break;case 17:l&Ua?(e=0,n=t.lefttop):(e=t.bottomright,n=0);break;case 18:l&Va?(e=t.bottomleft,n=0):(e=0,n=t.leftbottom);break;case 19:l&Ua?(e=0,n=t.lefttop):(e=t.bottomleft,n=0);break;case 20:l&Ua?(e=0,n=t.leftbottom):(e=t.topleft,n=1);break;case 21:l&Ha?(e=t.topright,n=1):(e=0,n=t.leftbottom);break;case 22:l&Ua?(e=0,n=t.lefttop):(e=t.topleft,n=1);break;case 23:l&Ha?(e=t.topright,n=1):(e=0,n=t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==n&&void 0!==a&&void 0!==s&&void 0!==u||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+n+" "+a+" "+s+" "+u)),{p:[e,n],x:a,y:s,o:u}}(t.cells[h][c],u.x,u.y,u.o)))break;if(r.push([l.p[0]+c,l.p[1]+h]),c+=l.x,h+=l.y,u=l,h<0||h>=n||c<0||c>=i||void 0===t.cells[h][c]){c-=l.x,h-=l.y;var f=function(t,e,n,i,r,o){for(var a=t.cells[n][e],s=a.cval_real,u=e+i,l=n+r,c=[],h=!1;!h;){if(void 0===t.cells[l]||void 0===t.cells[l][u])if(l-=r,u-=i,a=t.cells[l][u],s=a.cval_real,-1===r)if(0===o)if(s&Va)c.push([u,l]),i=-1,r=0,o=0;else{if(!(s&qa)){c.push([u+a.bottomright,l]),i=0,r=1,o=1,h=!0;break}c.push([u+1,l]),i=1,r=0,o=0}else{if(!(s&Va)){if(s&qa){c.push([u+a.bottomright,l]),i=0,r=1,o=1,h=!0;break}c.push([u+a.bottomleft,l]),i=0,r=1,o=0,h=!0;break}c.push([u,l]),i=-1,r=0,o=0}else if(1===r)if(0===o){if(!(s&Ha)){if(s&Ua){c.push([u+a.topleft,l+1]),i=0,r=-1,o=0,h=!0;break}c.push([u+a.topright,l+1]),i=0,r=-1,o=1,h=!0;break}c.push([u+1,l+1]),i=1,r=0,o=1}else c.push([u+1,l+1]),i=1,r=0,o=1;else if(-1===i)if(0===o){if(!(s&Ua)){if(s&Va){c.push([u,l+a.leftbottom]),i=1,r=0,o=0,h=!0;break}c.push([u,l+a.lefttop]),i=1,r=0,o=1,h=!0;break}c.push([u,l+1]),i=0,r=1,o=0}else{if(!(s&Ua)){console.log("MarchingSquaresJS-isoBands: wtf");break}c.push([u,l+1]),i=0,r=1,o=0}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(s&qa)){c.push([u+1,l+a.rightbottom]),i=-1,r=0,o=0,h=!0;break}c.push([u+1,l]),i=0,r=-1,o=1}else{if(!(s&qa)){if(s&Ha){c.push([u+1,l+a.righttop]),i=-1,r=0,o=1;break}c.push([u+1,l+a.rightbottom]),i=-1,r=0,o=0,h=!0;break}c.push([u+1,l]),i=0,r=-1,o=1}}else if(a=t.cells[l][u],s=a.cval_real,-1===i)if(0===o)if(void 0!==t.cells[l-1]&&void 0!==t.cells[l-1][u])i=0,r=-1,o=1;else{if(!(s&Va)){c.push([u+a.bottomright,l]),i=0,r=1,o=1,h=!0;break}c.push([u,l])}else{if(!(s&Ua)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+u+","+l);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===i){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l+1]&&void 0!==t.cells[l+1][u])i=0,r=1,o=0;else{if(!(s&Ha)){c.push([u+a.topleft,l+1]),i=0,r=-1,o=0,h=!0;break}c.push([u+1,l+1]),i=1,r=0,o=1}}else if(-1===r){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][u+1])i=1,r=0,o=1;else{if(!(s&qa)){c.push([u+1,l+a.righttop]),i=-1,r=0,o=1,h=!0;break}c.push([u+1,l]),i=0,r=-1,o=1}}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][u-1])i=-1,r=0,o=0;else{if(!(s&Ua)){c.push([u,l+a.leftbottom]),i=1,r=0,o=0,h=!0;break}c.push([u,l+1]),i=0,r=1,o=0}}if(u+=i,l+=r,u===e&&l===n)break}return{path:c,i:u,j:l,x:i,y:r,o:o}}(t,c,h,l.x,l.y,l.o);if(null===f)break;f.path.forEach(function(t){r.push(t)}),c=f.i,h=f.j,u=f}}while(void 0!==t.cells[h][c]&&t.cells[h][c].edges.length>0);e.push(r),r=[],t.cells[o][a].edges.length>0&&a--}return e}(l)),"function"==typeof Ga.successCallback&&Ga.successCallback(u),u}function hi(t,e,n){return(t-e)/(n-e)}function fi(t){return t.constructor.toString().indexOf("Array")>-1}function pi(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.pivot,r=n.mutate;if(!t)throw new Error("geojson is required");if(void 0===e||null===e||isNaN(e))throw new Error("angle is required");return 0===e?t:(i||(i=ye(t)),!1!==r&&void 0!==r||(t=jt(t)),M(t,function(t){var n=an(i,t)+e,r=un(i,t),o=q(ni(i,r,n));t[0]=o[0],t[1]=o[1]}),t)}function di(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.origin,r=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(i)||"object"==typeof i;return!0!==r&&(t=jt(t)),"FeatureCollection"!==t.type||o?gi(t,e,i):(N(t,function(n,r){t.features[r]=gi(n,e,i)}),t)}function gi(t,e,n){var r="Point"===K(t);return n=function(t,e){if(void 0!==e&&null!==e||(e="centroid"),Array.isArray(e)||"object"==typeof e)return H(e);var n=t.bbox?t.bbox:U(t),r=n[0],o=n[1],a=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return i([r,o]);case"se":case"southeast":case"eastsouth":case"bottomright":return i([a,o]);case"nw":case"northwest":case"westnorth":case"topleft":return i([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return i([a,s]);case"center":return ge(t);case void 0:case null:case"centroid":return ye(t);default:throw new Error("invalid origin")}}(t,n),1===e||r?t:(M(t,function(t){var i=un(n,t),r=an(n,t),o=q(ni(n,i*e,r));t[0]=o[0],t[1]=o[1],3===t.length&&(t[2]*=e)}),t)}function yi(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function mi(t,e){return t[0]*e[1]-e[0]*t[1]}function vi(t,e){return!function(t,e){return 0===mi(yi(t),yi(e))}(t,e)&&function(t,e){var n=t[0],i=yi(t),r=e[0],o=yi(e),a=mi(i,o);return function(t,e){return[t[0]+e[0],t[1]+e[1]]}(n,function(t,e){return[t*e[0],t*e[1]]}(mi(function(t,e){return[t[0]-e[0],t[1]-e[1]]}(r,n),o)/a,i))}(t,e)}function _i(t,e,n){var i=[],r=m(e,n),o=q(t),a=[];return o.forEach(function(t,e){if(e!==o.length-1){var n=function(t,e,n){var i=Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])),r=t[0]+n*(e[1]-t[1])/i,o=e[0]+n*(e[1]-t[1])/i,a=t[1]+n*(t[0]-e[0])/i,s=e[1]+n*(t[0]-e[0])/i;return[[r,a],[o,s]]}(t,o[e+1],r);if(i.push(n),e>0){var s=i[e-1],u=vi(n,s);!1!==u&&(s[1]=u,n[0]=u),a.push(s[0]),e===o.length-2&&(a.push(n[0]),a.push(n[1]))}2===o.length&&(a.push(n[0]),a.push(n[1]))}}),s(a,t.properties)}function wi(t,e,n){var i=e[0]-t[0],r=e[1]-t[1],o=n[0]-e[0],a=n[1]-e[1];return Math.sign(i*a-o*r)}function bi(t,e){return e.geometry.coordinates[0].every(function(e){return Tt(i(e),t)})}function Ci(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(function(t,e,n){var i=n[0]-t[0],r=n[1]-t[1],o=e[0]-t[0],a=e[1]-t[1];return i*a-r*o==0&&(Math.abs(o)>=Math.abs(a)?o>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:a>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function xi(t,e){return nn(e,Bn(t)).features.length>0}function Ei(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Si(t,e){return t[0]===e[0]&&t[1]===e[1]}function Pi(t,e){for(var n=!1,i=!1,r=t.coordinates.length,o=0;o<r&&!n&&!i;){for(var a=0;a<e.coordinates.length-1;a++){var s=!0;0!==a&&a!==e.coordinates.length-2||(s=!1),Ii(e.coordinates[a],e.coordinates[a+1],t.coordinates[o],s)?n=!0:i=!0}o++}return n&&i}function Mi(t,e){return nn(t,Bn(e)).features.length>0}function Li(t,e){for(var n=!1,r=!1,o=t.coordinates[0].length,a=0;a<o&&n&&r;)Tt(i(t.coordinates[0][a]),e)?n=!0:r=!0,a++;return r&&r}function Ii(t,e,n,i){var r=n[0]-t[0],o=n[1]-t[1],a=e[0]-t[0],s=e[1]-t[1];return 0==r*s-o*a&&(i?Math.abs(a)>=Math.abs(s)?a>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:s>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(a)>=Math.abs(s)?a>0?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:s>0?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}function Ti(t){return t.coordinates.map(function(e){return{type:t.type.replace("Multi",""),coordinates:e}})}function Ni(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function ki(t,e){return Bs(t,e,{strict:!0})}function Oi(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");var n=K(t);if(n!==K(e))throw new Error("features must be of the same type");if("Point"===n)throw new Error("Point geometry not supported");if(new Us({precision:6}).compare(t,e))return!1;var i=0;switch(n){case"MultiPoint":var r=O(t),o=O(e);r.forEach(function(t){o.forEach(function(e){t[0]===e[0]&&t[1]===e[1]&&i++})});break;case"LineString":case"MultiLineString":j(t,function(t){j(e,function(e){Qn(t,e).features.length&&i++})});break;case"Polygon":case"MultiPolygon":j(t,function(t){j(e,function(e){nn(t,e).features.length&&i++})})}return i>0}function Di(t,e,n){n=n||[];for(var i=0;i<t;i++)n[i]=e;return n}function Ai(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}function Ri(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}function Fi(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var i=0,r=t[n];i<r.length;i++){var o=new ji(n,i,r[i]);this.grid[n][i]=o,this.nodes.push(o)}}this.init()}function ji(t,e,n){this.x=t,this.y=e,this.weight=n}function zi(t){this.content=[],this.scoreFunction=t}function Bi(t){return t[0]}function Gi(t){return t[1]}function Ui(){this._=null}function Hi(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function qi(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function Vi(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Wi(t){for(;t.L;)t=t.L;return t}function Yi(t,e,n,i){var r=[null,null],o=uu.push(r)-1;return r.left=t,r.right=e,n&&Zi(r,t,e,n),i&&Zi(r,e,t,i),au[t.index].halfedges.push(o),au[e.index].halfedges.push(o),r}function Xi(t,e,n){var i=[e,n];return i.left=t,i}function Zi(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Ji(t,e,n,i,r){var o,a=t[0],s=t[1],u=a[0],l=a[1],c=0,h=1,f=s[0]-u,p=s[1]-l;
if(o=e-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}if(o=n-l,p||!(o>0)){if(o/=p,p<0){if(o<c)return;o<h&&(h=o)}else if(p>0){if(o>h)return;o>c&&(c=o)}if(o=r-l,p||!(o<0)){if(o/=p,p<0){if(o>h)return;o>c&&(c=o)}else if(p>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[u+c*f,l+c*p]),h<1&&(t[1]=[u+h*f,l+h*p]),!0)}}}}}function Ki(t,e,n,i,r){var o=t[1];if(o)return!0;var a,s,u=t[0],l=t.left,c=t.right,h=l[0],f=l[1],p=c[0],d=c[1],g=(h+p)/2,y=(f+d)/2;if(d===f){if(g<e||g>=i)return;if(h>p){if(u){if(u[1]>=r)return}else u=[g,n];o=[g,r]}else{if(u){if(u[1]<n)return}else u=[g,r];o=[g,n]}}else if(a=(h-p)/(d-f),s=y-a*g,a<-1||a>1)if(h>p){if(u){if(u[1]>=r)return}else u=[(n-s)/a,n];o=[(r-s)/a,r]}else{if(u){if(u[1]<n)return}else u=[(r-s)/a,r];o=[(n-s)/a,n]}else if(f<d){if(u){if(u[0]>=i)return}else u=[e,a*e+s];o=[i,a*i+s]}else{if(u){if(u[0]<e)return}else u=[i,a*i+s];o=[e,a*e+s]}return t[0]=u,t[1]=o,!0}function $i(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function Qi(t,e){return e[+(e.left!==t.site)]}function tr(t,e){return e[+(e.left===t.site)]}function er(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var a=r[0],s=r[1],u=i[0]-a,l=i[1]-s,c=o[0]-a,h=o[1]-s,f=2*(u*h-l*c);if(!(f>=-fu)){var p=u*u+l*l,d=c*c+h*h,g=(h*p-l*d)/f,y=(u*d-c*p)/f,m=lu.pop()||new function(){Hi(this),this.x=this.y=this.arc=this.site=this.cy=null};m.arc=t,m.site=r,m.x=g+a,m.y=(m.cy=y+s)+Math.sqrt(g*g+y*y),t.circle=m;for(var v=null,_=su._;_;)if(m.y<_.y||m.y===_.y&&m.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}su.insert(v,m),v||(ru=m)}}}}function nr(t){var e=t.circle;e&&(e.P||(ru=e.N),su.remove(e),lu.push(e),Hi(e),t.circle=null)}function ir(t){var e=cu.pop()||new function(){Hi(this),this.edge=this.site=this.circle=null};return e.site=t,e}function rr(t){nr(t),ou.remove(t),cu.push(t),Hi(t)}function or(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,a=t.N,s=[t];rr(t);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<hu&&Math.abs(i-u.circle.cy)<hu;)o=u.P,s.unshift(u),rr(u),u=o;s.unshift(u),nr(u);for(var l=a;l.circle&&Math.abs(n-l.circle.x)<hu&&Math.abs(i-l.circle.cy)<hu;)a=l.N,s.push(l),rr(l),l=a;s.push(l),nr(l);var c,h=s.length;for(c=1;c<h;++c)l=s[c],u=s[c-1],Zi(l.edge,u.site,l.site,r);u=s[0],(l=s[h-1]).edge=Yi(u.site,l.site,null,r),er(u),er(l)}function ar(t){for(var e,n,i,r,o=t[0],a=t[1],s=ou._;s;)if((i=sr(s,a)-o)>hu)s=s.L;else{if(!((r=o-function(t,e){var n=t.N;if(n)return sr(n,e);var i=t.site;return i[1]===e?i[0]:1/0}(s,a))>hu)){i>-hu?(e=s.P,n=s):r>-hu?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){au[t.index]={site:t,halfedges:[]}}(t);var u=ir(t);if(ou.insert(e,u),e||n){if(e===n)return nr(e),n=ir(e.site),ou.insert(u,n),u.edge=n.edge=Yi(e.site,u.site),er(e),void er(n);if(n){nr(e),nr(n);var l=e.site,c=l[0],h=l[1],f=t[0]-c,p=t[1]-h,d=n.site,g=d[0]-c,y=d[1]-h,m=2*(f*y-p*g),v=f*f+p*p,_=g*g+y*y,w=[(y*v-p*_)/m+c,(f*_-g*v)/m+h];Zi(n.edge,l,d,w),u.edge=Yi(l,t,null,w),n.edge=Yi(t,d,null,w),er(e),er(n)}else u.edge=Yi(e.site,u.site)}}function sr(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],u=n[1],l=u-e;if(!l)return s;var c=s-i,h=1/o-1/l,f=c/l;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*l)-u+l/2+r-o/2)))/h+i:(i+s)/2}function ur(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function lr(t,e){return e[1]-t[1]||e[0]-t[0]}function cr(t,e){var n,i,r,o=t.sort(lr).pop();for(uu=[],au=new Array(t.length),ou=new Ui,su=new Ui;;)if(r=ru,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(ar(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;or(r.arc)}if(function(){for(var t,e,n,i,r=0,o=au.length;r<o;++r)if((t=au[r])&&(i=(e=t.halfedges).length)){var a=new Array(i),s=new Array(i);for(n=0;n<i;++n)a[n]=n,s[n]=$i(t,uu[e[n]]);for(a.sort(function(t,e){return s[e]-s[t]}),n=0;n<i;++n)s[n]=e[a[n]];for(n=0;n<i;++n)e[n]=s[n]}}(),e){var a=+e[0][0],s=+e[0][1],u=+e[1][0],l=+e[1][1];!function(t,e,n,i){for(var r,o=uu.length;o--;)Ki(r=uu[o],t,e,n,i)&&Ji(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>hu||Math.abs(r[0][1]-r[1][1])>hu)||delete uu[o]}(a,s,u,l),function(t,e,n,i){var r,o,a,s,u,l,c,h,f,p,d,g,y=au.length,m=!0;for(r=0;r<y;++r)if(o=au[r]){for(a=o.site,s=(u=o.halfedges).length;s--;)uu[u[s]]||u.splice(s,1);for(s=0,l=u.length;s<l;)d=(p=tr(o,uu[u[s]]))[0],g=p[1],h=(c=Qi(o,uu[u[++s%l]]))[0],f=c[1],(Math.abs(d-h)>hu||Math.abs(g-f)>hu)&&(u.splice(s,0,uu.push(Xi(a,p,Math.abs(d-t)<hu&&i-g>hu?[t,Math.abs(h-t)<hu?f:i]:Math.abs(g-i)<hu&&n-d>hu?[Math.abs(f-i)<hu?h:n,i]:Math.abs(d-n)<hu&&g-e>hu?[n,Math.abs(h-n)<hu?f:e]:Math.abs(g-e)<hu&&d-t>hu?[Math.abs(f-e)<hu?h:t,e]:null))-1),++l);l&&(m=!1)}if(m){var v,_,w,b=1/0;for(r=0,m=null;r<y;++r)(o=au[r])&&(w=(v=(a=o.site)[0]-t)*v+(_=a[1]-e)*_)<b&&(b=w,m=o);if(m){var C=[t,e],x=[t,i],E=[n,i],S=[n,e];m.halfedges.push(uu.push(Xi(a=m.site,C,x))-1,uu.push(Xi(a,x,E))-1,uu.push(Xi(a,E,S))-1,uu.push(Xi(a,S,C))-1)}}for(r=0;r<y;++r)(o=au[r])&&(o.halfedges.length||delete au[r])}(a,s,u,l)}this.edges=uu,this.cells=au,ou=su=uu=au=null}function hr(t){return(t=t.slice()).push(t[0]),o([t])}function fr(t,e,n,i){var r=(i=i||{}).steps||64,a=i.units||"kilometers",s=i.angle||0,u=i.pivot||t,l=i.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!E(i))throw new Error("options must be an object");if(!x(r))throw new Error("steps must be a number");if(!x(s))throw new Error("angle must be a number");var c=H(t);if("degrees"===a)var h=w(s);else e=ni(t,e,90,{units:a}),n=ni(t,n,0,{units:a}),e=H(e)[0]-c[0],n=H(n)[1]-c[1];for(var f=[],p=0;p<r;p+=1){var d=-360*p/r,g=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(pr(d),2)),y=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(pr(d),2));if(d<-90&&d>=-270&&(g=-g),d<-180&&d>=-360&&(y=-y),"degrees"===a){var m=g*Math.cos(h)+y*Math.sin(h),v=y*Math.cos(h)-g*Math.sin(h);g=m,y=v}f.push([g+c[0],y+c[1]])}return f.push(f[0]),"degrees"===a?o([f],l):pi(o([f],l),s,{pivot:u})}function pr(t){var e=t*Math.PI/180;return Math.tan(e)}function dr(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.properties,r=e.weight;if(!t)throw new Error("geojson is required");var o=0,a=0,s=0;return D(t,function(t,e,n){var i=n[r];if(i=void 0===i||null===i?1:i,!x(i))throw new Error("weight value must be a number for feature index "+e);(i=Number(i))>0&&M(t,function(t){o+=t[0]*i,a+=t[1]*i,s+=i})}),i([o/s,a/s],n)}function gr(t,e,n,r){var o=n.properties.tolerance||.001,a=0,s=0,u=0,l=0;if(N(n,function(e){var n=e.properties.weight,i=void 0===n||null===n?1:n;if(i=Number(i),!x(i))throw new Error("weight value must be a number");if(i>0){l+=1;var r=i*Ft(e,t);0===r&&(r=1);var o=i/r;a+=e.geometry.coordinates[0]*o,s+=e.geometry.coordinates[1]*o,u+=o}}),l<1)throw new Error("no features to measure");var c=a/u,h=s/u;return 1===l||0===r||Math.abs(c-e[0])<o&&Math.abs(h-e[1])<o?i([c,h],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([c,h]),gr([c,h],t,n,r-1))}function yr(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}function mr(t){if(E(t)&&(t=t.bbox),t&&!Array.isArray(t))throw new Error("bbox is invalid");return t?function(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}(t):[360*br(),180*br()]}function vr(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.bbox;void 0!==t&&null!==t||(t=1);for(var r=[],o=0;o<t;o++)r.push(i(mr(n)));return l(r)}function _r(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_radial_length;void 0!==t&&null!==t||(t=1),x(i)||(i=10),x(r)||(r=10);for(var a=[],s=0;s<t;s++){var u=[],c=Array.apply(null,new Array(i+1)).map(Math.random);c.forEach(function(t,e,n){n[e]=e>0?t+n[e-1]:t}),c.forEach(function(t){t=2*t*Math.PI/c[c.length-1];var e=Math.random();u.push([e*r*Math.sin(t),e*r*Math.cos(t)])}),u[u.length-1]=u[0],u=u.map(function(t){return function(e){return[e[0]+t[0],e[1]+t[1]]}}(mr(n))),a.push(o([u]))}return l(a)}function wr(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_length,o=e.max_rotation;void 0!==t&&null!==t||(t=1),(!x(i)||i<2)&&(i=10),x(r)||(r=1e-4),x(o)||(o=Math.PI/8);for(var a=[],u=0;u<t;u++){for(var c=[mr(n)],h=0;h<i-1;h++){var f=(0===h?2*Math.random()*Math.PI:Math.tan((c[h][1]-c[h-1][1])/(c[h][0]-c[h-1][0])))+(Math.random()-.5)*o*2,p=Math.random()*r;c.push([c[h][0]+p*Math.cos(f),c[h][1]+p*Math.sin(f)])}a.push(s(c))}return l(a)}function br(){return Math.random()-.5}function Cr(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(void 0===e||null===e)throw new Error("filter is required");var n=[];return N(t,function(t){Pr(t.properties,e)&&n.push(t)}),l(n)}function xr(t,e,n){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(void 0===e||null===e)throw new Error("property is required");for(var i=Sr(t,e),r=Object.keys(i),o=0;o<r.length;o++){for(var a=r[o],s=i[a],u=[],c=0;c<s.length;c++)u.push(t.features[s[c]]);n(l(u),a,o)}}function Er(t,e,n,i){var r=i;return xr(t,e,function(t,e,o){r=0===o&&void 0===i?t:n(r,t,e,o)}),r}function Sr(t,e){var n={};return N(t,function(t,i){var r=t.properties||{};if(r.hasOwnProperty(e)){var o=r[e];n.hasOwnProperty(o)?n[o].push(i):n[o]=[i]}}),n}function Pr(t,e){if(void 0===t)return!1;var n=typeof e;if("number"===n||"string"===n)return t.hasOwnProperty(e);if(Array.isArray(e)){for(var i=0;i<e.length;i++)if(!Pr(t,e[i]))return!1;return!0}return Mr(t,e)}function Mr(t,e){for(var n=Object.keys(e),i=0;i<n.length;i++){var r=n[i];if(t[r]!==e[r])return!1}return!0}function Lr(t,e){if(!e)return{};if(!e.length)return{};for(var n={},i=0;i<e.length;i++){var r=e[i];t.hasOwnProperty(r)&&(n[r]=t[r])}return n}function Ir(){}function Tr(t){this.message=t||""}function Nr(t){this.message=t||""}function kr(){}function Or(t){return null===t?Dl:t.color}function Dr(t){return null===t?null:t.parent}function Ar(t,e){null!==t&&(t.color=e)}function Rr(t){return null===t?null:t.left}function Fr(t){return null===t?null:t.right}function jr(){this.root_=null,this.size_=0}function zr(){}function Br(){this.array_=[],arguments[0]instanceof _l&&this.addAll(arguments[0])}function Gr(){}function Ur(t){this.message=t||""}function Hr(){this.array_=[]}function qr(t){switch(t.type){case"Polygon":return vn(t)>1?t:null;case"MultiPolygon":var e=[];if(R(t,function(t){vn(t)>1&&e.push(t.geometry.coordinates)}),e.length)return{type:"MultiPolygon",coordinates:e}}}function Vr(){this.reset()}function Wr(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}function Yr(t){return t>1?Bp:t<-1?-Bp:Math.asin(t)}function Xr(){}function Zr(t,e){t&&ed.hasOwnProperty(t.type)&&ed[t.type](t,e)}function Jr(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Kr(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Jr(t[n],e,1);e.polygonEnd()}function $r(t){return[Yp(t[1],t[0]),Yr(t[2])]}function Qr(t){var e=t[0],n=t[1],i=Xp(n);return[i*Xp(e),i*Kp(e),Kp(n)]}function to(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function eo(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function no(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function io(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function ro(t){var e=$p(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function oo(t,e){return[t>zp?t-Up:t<-zp?t+Up:t,e]}function ao(t,e,n){return(t%=Up)?e||n?id(uo(t),lo(e,n)):uo(t):e||n?lo(e,n):oo}function so(t){return function(e,n){return e+=t,[e>zp?e-Up:e<-zp?e+Up:e,n]}}function uo(t){var e=so(t);return e.invert=so(-t),e}function lo(t,e){function n(t,e){var n=Xp(e),s=Xp(t)*n,u=Kp(t)*n,l=Kp(e),c=l*i+s*r;return[Yp(u*o-c*a,s*i-l*r),Yr(c*o+u*a)]}var i=Xp(t),r=Kp(t),o=Xp(e),a=Kp(e);return n.invert=function(t,e){var n=Xp(e),s=Xp(t)*n,u=Kp(t)*n,l=Kp(e),c=l*o-u*a;return[Yp(u*o+l*a,s*i+c*r),Yr(c*i-s*r)]},n}function co(t,e){(e=Qr(e))[0]-=t,ro(e);var n=function(t){return t>1?0:t<-1?zp:Math.acos(t)}(-e[1]);return((-e[2]<0?-n:n)+Up-jp)%Up}function ho(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function fo(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function po(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,s,l){var c=0,h=0;if(null==r||(c=a(r,s))!==(h=a(o,s))||u(r,o)<0^s>0){do l.point(0===c||3===c?t:n,c>1?i:e);while((c=(c+s+4)%4)!==h)}else l.point(o[0],o[1])}function a(i,r){return Vp(i[0]-t)<jp?r>0?0:3:Vp(i[0]-n)<jp?r>0?2:1:Vp(i[1]-e)<jp?r>0?1:0:r>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=a(t,1),i=a(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){function u(t,e){r(t,e)&&b.point(t,e)}function l(o,a){var s=r(o,a);if(h&&f.push([o,a]),_)p=o,d=a,g=s,_=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&v)b.point(o,a);else{var u=[y=Math.max(fd,Math.min(hd,y)),m=Math.max(fd,Math.min(hd,m))],l=[o=Math.max(fd,Math.min(hd,o)),a=Math.max(fd,Math.min(hd,a))];ad(u,l,t,e,n,i)?(v||(b.lineStart(),b.point(u[0],u[1])),b.point(l[0],l[1]),s||b.lineEnd(),w=!1):s&&(b.lineStart(),b.point(o,a),w=!1)}y=o,m=a,v=s}var c,h,f,p,d,g,y,m,v,_,w,b=a,C=od(),x={point:u,lineStart:function(){x.point=l,h&&h.push(f=[]),_=!0,v=!1,y=m=NaN},lineEnd:function(){c&&(l(p,d),g&&v&&C.rejoin(),c.push(C.result())),x.point=u,v&&b.lineEnd()},polygonStart:function(){b=C,c=[],h=[],w=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=h.length;n<r;++n)for(var o,a,s=h[n],u=1,l=s.length,c=s[0],f=c[0],p=c[1];u<l;++u)o=f,a=p,f=(c=s[u])[0],p=c[1],a<=i?p>i&&(f-o)*(i-a)>(p-a)*(t-o)&&++e:p<=i&&(f-o)*(i-a)<(p-a)*(t-o)&&--e;return e}(),n=w&&e,r=(c=cd(c)).length;(n||r)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),r&&ud(c,s,e,o,a),a.polygonEnd()),b=a,c=h=f=null}};return x}}function go(t){return t.length>1}function yo(t,e){return((t=t.x)[0]<0?t[1]-Bp-jp:Bp-t[1])-((e=e.x)[0]<0?e[1]-Bp-jp:Bp-e[1])}function mo(t){return function(e){var n=new vo;for(var i in t)n[i]=t[i];return n.stream=e,n}}function vo(){}function _o(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),nd(n,t.stream(_d));var a=_d.result(),s=Math.min(i/(a[1][0]-a[0][0]),r/(a[1][1]-a[0][1])),u=+e[0][0]+(i-s*(a[1][0]+a[0][0]))/2,l=+e[0][1]+(r-s*(a[1][1]+a[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*s).translate([u,l])}function wo(t){return function(t){function e(t){return t=l(t[0]*qp,t[1]*qp),[t[0]*g+a,s-t[1]*g]}function n(t,e){return t=o(t,e),[t[0]*g+a,s-t[1]*g]}function i(){l=id(u=ao(w,b,C),o);var t=o(v,_);return a=y-t[0]*g,s=m+t[1]*g,r()}function r(){return p=d=null,e}var o,a,s,u,l,c,h,f,p,d,g=150,y=480,m=250,v=0,_=0,w=0,b=0,C=0,x=null,E=bd,S=null,P=dd,M=.5,L=Sd(n,M);return e.stream=function(t){return p&&d===t?p:p=Pd(E(u,L(P(d=t))))},e.clipAngle=function(t){return arguments.length?(E=+t?Cd(x=t*qp,6*qp):(x=null,bd),r()):x*Hp},e.clipExtent=function(t){return arguments.length?(P=null==t?(S=c=h=f=null,dd):po(S=+t[0][0],c=+t[0][1],h=+t[1][0],f=+t[1][1]),r()):null==S?null:[[S,c],[h,f]]},e.scale=function(t){return arguments.length?(g=+t,i()):g},e.translate=function(t){return arguments.length?(y=+t[0],m=+t[1],i()):[y,m]},e.center=function(t){return arguments.length?(v=t[0]%360*qp,_=t[1]%360*qp,i()):[v*Hp,_*Hp]},e.rotate=function(t){return arguments.length?(w=t[0]%360*qp,b=t[1]%360*qp,C=t.length>2?t[2]%360*qp:0,i()):[w*Hp,b*Hp,C*Hp]},e.precision=function(t){return arguments.length?(L=Sd(n,M=t*t),r()):$p(M)},e.fitExtent=function(t,n){return _o(e,t,n)},e.fitSize=function(t,n){return function(t,e,n){return _o(t,[[0,0],e],n)}(e,t,n)},function(){return o=t.apply(this,arguments),e.invert=o.invert&&function(t){return(t=l.invert((t[0]-a)/g,(s-t[1])/g))&&[t[0]*Hp,t[1]*Hp]},i()}}(function(){return t})()}function bo(t,e){return[t,Jp(Qp((Bp+e)/2))]}function Co(t,e){return[Jp(Qp((Bp+e)/2)),-t]}function xo(t,n,i,r){var o=t.properties||{},a="Feature"===t.type?t.geometry:t;if("GeometryCollection"===a.type){var s=[];return D(t,function(t){var e=xo(t,n,i,r);e&&s.push(e)}),l(s)}var u,c=U(t),h=c[1]>50&&c[3]>50;u=h?{type:a.type,coordinates:So(a.coordinates,Mo(a))}:ln(a);var f=(new xc).read(u),p=g(y(n,i),"meters"),d=gf.bufferOp(f,p);if(d=(new Ec).write(d),!Eo(d.coordinates)){var m;return(m=h?{type:d.type,coordinates:Po(d.coordinates,Mo(a))}:cn(d)).geometry?m:e(m,o)}}function Eo(t){return Array.isArray(t[0])?Eo(t[0]):isNaN(t[0])}function So(t,e){return"object"!=typeof t[0]?e(t):t.map(function(t){return So(t,e)})}function Po(t,e){return"object"!=typeof t[0]?e.invert(t):t.map(function(t){return Po(t,e)})}function Mo(t){var e=ge(t).geometry.coordinates.reverse(),n=e.map(function(t){return-t});return Md().center(e).rotate(n).scale(Ro)}function Lo(){for(var t=new xc,e=t.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)e=Ap.union(e,t.read(JSON.stringify(arguments[n].geometry)));return e=(new Ec).write(e),{type:"Feature",geometry:e,properties:arguments[0].properties}}function Io(t,n){var i=Z(t),r=Z(n);if(te(Tn(r,{precision:4})).coordinates[0].length<4)return null;if(te(Tn(i,{precision:4})).coordinates[0].length<4)return null;var o=new xc,a=o.read(Tn(i)),s=o.read(Tn(r)),u=Pp.intersection(a,s);return u.isEmpty()?null:e((new Ec).write(u))}function To(t,e){return function(t,e,n){var i,r;if(!Array.isArray(e))throw new Error("Get closest expects an array as second argument");return e.forEach(function(e,o){var a=n(e,t);a>=0&&(void 0===r||a<r)&&(r=a,i=o)}),i}(t,e,function(t,e){return t-e})}function No(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.properties||{},r=n.triangles,a=n.mask;if(null===e||void 0===e)throw new Error("cellSide is required");if(!x(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(a&&-1===["Polygon","MultiPolygon"].indexOf(K(a)))throw new Error("options.mask must be a (Multi)Polygon");var s=t[0],u=t[1],c=t[2],h=t[3],f=(u+h)/2,p=(s+c)/2,d=2*e/Ft([s,f],[c,f],n)*(c-s),g=2*e/Ft([p,u],[p,h],n)*(h-u),y=d/2,m=2*y,v=Math.sqrt(3)/2*g,_=c-s,w=h-u,b=.75*m,C=v,S=(_-m)/(m-y/2),P=Math.floor(S),M=(P*b-y/2-_)/2-y/2+b/2,L=Math.floor((w-v)/v),I=(w-L*v)/2,T=L*v-w>v/2;T&&(I-=v/4);for(var N=[],k=[],O=0;O<6;O++){var D=2*Math.PI/6*O;N.push(Math.cos(D)),k.push(Math.sin(D))}for(var A=[],R=0;R<=P;R++)for(var F=0;F<=L;F++){var j=R%2==1;if(!(0===F&&j||0===F&&T)){var z=R*b+s-M,B=F*C+u+I;if(j&&(B-=v/2),!0===r)(function(t,e,n,i,r,a){for(var s=[],u=0;u<6;u++){var l=[];l.push(t),l.push([t[0]+e*r[u],t[1]+n*a[u]]),l.push([t[0]+e*r[(u+1)%6],t[1]+n*a[(u+1)%6]]),l.push(t),s.push(o([l],i))}return s})([z,B],d/2,g/2,i,N,k).forEach(function(t){a?Io(a,t)&&A.push(t):A.push(t)});else{var G=function(t,e,n,i,r,a){for(var s=[],u=0;u<6;u++){var l=t[0]+e*r[u],c=t[1]+n*a[u];s.push([l,c])}return s.push(s[0].slice()),o([s],i)}([z,B],d/2,g/2,i,N,k);a?Io(a,G)&&A.push(G):A.push(G)}}}return l(A)}function ko(t){if(t.features.length<=1)return t;var e=function(t){var e=Wo(),n=[];return R(t,function(t,e){var i=U(t);n.push({minX:i[0],minY:i[1],maxX:i[2],maxY:i[3],geojson:t,index:e})}),e.load(n),e}(t),n=[],i={};return R(t,function(t,r){if(i[r])return!0;for(e.remove({index:r},Oo),i[r]=!0;;){var o=U(t),a=e.search({minX:o[0],minY:o[1],maxX:o[2],maxY:o[3]});if(a.length>0){var s=a.map(function(t){return i[t.index]=!0,e.remove({index:t.index},Oo),t.geojson});s.push(t),t=Lo.apply(this,s)}if(0===a.length)break}n.push(t)}),l(n)}function Oo(t,e){return t.index===e.index}function Do(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.properties,r=n.mask,a=[];if(null===e||void 0===e)throw new Error("cellSide is required");if(!x(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(K(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],u=t[1],c=t[2],h=t[3],f=e/Ft([s,u],[c,u],n)*(c-s),p=e/Ft([s,u],[s,h],n)*(h-u),d=c-s,g=h-u,y=Math.floor(d/f),m=Math.floor(g/p),v=(g-m*p)/2,_=s+(d-y*f)/2,w=0;w<y;w++){for(var b=u+v,C=0;C<m;C++){var S=o([[[_,b],[_,b+p],[_+f,b+p],[_+f,b],[_,b]]],i);r?Io(r,S)&&a.push(S):a.push(S),b+=p}_+=f}return l(a)}function Ao(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.properties,r=n.mask,a=[];if(null===e||void 0===e)throw new Error("cellSide is required");if(!x(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(K(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=e/Ft([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),u=e/Ft([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),c=0,h=t[0];h<=t[2];){for(var f=0,p=t[1];p<=t[3];){var d=null,g=null;c%2==0&&f%2==0?(d=o([[[h,p],[h,p+u],[h+s,p],[h,p]]],i),g=o([[[h,p+u],[h+s,p+u],[h+s,p],[h,p+u]]],i)):c%2==0&&f%2==1?(d=o([[[h,p],[h+s,p+u],[h+s,p],[h,p]]],i),g=o([[[h,p],[h,p+u],[h+s,p+u],[h,p]]],i)):f%2==0&&c%2==1?(d=o([[[h,p],[h,p+u],[h+s,p+u],[h,p]]],i),g=o([[[h,p],[h+s,p+u],[h+s,p],[h,p]]],i)):f%2==1&&c%2==1&&(d=o([[[h,p],[h,p+u],[h+s,p],[h,p]]],i),g=o([[[h,p+u],[h+s,p+u],[h+s,p],[h,p+u]]],i)),r?(Io(r,d)&&a.push(d),Io(r,g)&&a.push(g)):(a.push(d),a.push(g)),p+=u,f++}c++,h+=s}return l(a)}var Ro=6371008.8,Fo={meters:Ro,metres:Ro,millimeters:1e3*Ro,millimetres:1e3*Ro,centimeters:100*Ro,centimetres:100*Ro,kilometers:Ro/1e3,kilometres:Ro/1e3,miles:Ro/1609.344,nauticalmiles:Ro/1852,inches:39.37*Ro,yards:Ro/1.0936,feet:3.28084*Ro,radians:1,degrees:Ro/111325},jo={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/Ro,degrees:1/111325},zo={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:3.86e-7,yards:1.195990046,feet:10.763910417,inches:1550.003100006},Bo=Object.freeze({earthRadius:Ro,factors:Fo,unitsFactors:jo,areaFactors:zo,feature:e,geometry:n,point:i,points:r,polygon:o,polygons:a,lineString:s,lineStrings:u,featureCollection:l,multiLineString:c,multiPoint:h,multiPolygon:f,geometryCollection:p,round:d,radiansToLength:g,lengthToRadians:y,lengthToDegrees:m,bearingToAzimuth:v,radiansToDegrees:_,degreesToRadians:w,convertLength:b,convertArea:C,isNumber:x,isObject:E,validateBBox:S,validateId:P,radians2degrees:function(){throw new Error("method has been renamed to `radiansToDegrees`")},degrees2radians:function(){throw new Error("method has been renamed to `degreesToRadians`")},distanceToDegrees:function(){throw new Error("method has been renamed to `lengthToDegrees`")},distanceToRadians:function(){throw new Error("method has been renamed to `lengthToRadians`")},radiansToDistance:function(){throw new Error("method has been renamed to `radiansToLength`")},bearingToAngle:function(){throw new Error("method has been renamed to `bearingToAzimuth`")},convertDistance:function(){throw new Error("method has been renamed to `convertLength`")}}),Go=Object.freeze({coordEach:M,coordReduce:L,propEach:I,propReduce:T,featureEach:N,featureReduce:k,coordAll:O,geomEach:D,geomReduce:A,flattenEach:R,flattenReduce:F,segmentEach:j,segmentReduce:z,lineEach:B,lineReduce:G}),Uo=Object.freeze({getCoord:H,getCoords:q,containsNumber:V,geojsonType:W,featureOf:Y,collectionOf:X,getGeom:Z,getGeomType:J,getType:K}),Ho={successCallback:null,verbose:!1},qo={},Vo=rt,Wo=at;at.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!gt(t,e))return n;for(var r,o,a,s,u=[];e;){for(r=0,o=e.children.length;r<o;r++)a=e.children[r],gt(t,s=e.leaf?i(a):a)&&(e.leaf?n.push(a):dt(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!gt(t,e))return!1;for(var i,r,o,a,s=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],a=e.leaf?n(o):o,gt(t,a)){if(e.leaf||dt(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=yt([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,a=this.data,s=this.toBBox(t),u=[],l=[];a||u.length;){if(a||(a=u.pop(),i=u[u.length-1],n=l.pop(),o=!0),a.leaf&&-1!==(r=function(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;o||a.leaf||!dt(a,s)?i?(n++,a=i.children[n],o=!1):a=null:(u.push(a),l.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:ct,compareMinY:ht,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return r=yt(t.slice(e,n+1)),st(r,this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=yt([])).leaf=!1,r.height=i;var s,u,l,c,h=Math.ceil(o/a),f=h*Math.ceil(Math.sqrt(a));for(mt(t,e,n,f,this.compareMinX),s=e;s<=n;s+=f)for(mt(t,s,l=Math.min(s+f-1,n),h,this.compareMinY),u=s;u<=l;u+=h)c=Math.min(u+h-1,l),r.children.push(this._build(t,u,c,i-1));return st(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,a,s,u,l,c,h;i.push(e),!e.leaf&&i.length-1!==n;){for(c=h=1/0,r=0,o=e.children.length;r<o;r++)u=ft(a=e.children[r]),(l=function(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}(t,a)-u)<h?(h=l,c=u<c?u:c,s=a):l===h&&u<c&&(c=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],a=this._chooseSubtree(r,this.data,e,o);for(a.children.push(t),lt(a,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=yt(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,st(n,this.toBBox),st(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=yt([t,e]),this.data.height=t.height+1,this.data.leaf=!1,st(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,a,s,u,l,c;for(u=l=1/0,i=e;i<=n-e;i++)a=function(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-i)}(r=ut(t,0,i,this.toBBox),o=ut(t,i,n,this.toBBox)),s=ft(r)+ft(o),a<u?(u=a,c=i,l=s<l?s:l):a===u&&s<l&&(l=s,c=i);return c},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:ct,r=t.leaf?this.compareMinY:ht;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,a=this.toBBox,s=ut(t,0,e,a),u=ut(t,n-e,n,a),l=pt(s)+pt(u);for(r=e;r<n-e;r++)o=t.children[r],lt(s,t.leaf?a(o):o),l+=pt(s);for(r=n-e-1;r>=e;r--)o=t.children[r],lt(u,t.leaf?a(o):o),l+=pt(u);return l},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)lt(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():st(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Yo=function(t,e,n){var i=t*e,r=Xo*t,o=r-(r-t),a=t-o,s=Xo*e,u=s-(s-e),l=e-u,c=a*l-(i-o*u-a*u-o*l);return n?(n[0]=c,n[1]=i,n):[c,i]},Xo=+(Math.pow(2,27)+1),Zo=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],e[0]);var r,o,a=n+i,s=new Array(a),u=0,l=0,c=0,h=Math.abs,f=t[l],p=h(f),d=e[c],g=h(d);p<g?(o=f,(l+=1)<n&&(p=h(f=t[l]))):(o=d,(c+=1)<i&&(g=h(d=e[c]))),l<n&&p<g||c>=i?(r=f,(l+=1)<n&&(p=h(f=t[l]))):(r=d,(c+=1)<i&&(g=h(d=e[c])));for(var y,m,v=r+o,_=v-r,w=o-_,b=w,C=v;l<n&&c<i;)p<g?(r=f,(l+=1)<n&&(p=h(f=t[l]))):(r=d,(c+=1)<i&&(g=h(d=e[c]))),(w=(o=b)-(_=(v=r+o)-r))&&(s[u++]=w),b=C-((y=C+v)-(m=y-C))+(v-m),C=y;for(;l<n;)(w=(o=b)-(_=(v=(r=f)+o)-r))&&(s[u++]=w),b=C-((y=C+v)-(m=y-C))+(v-m),C=y,(l+=1)<n&&(f=t[l]);for(;c<i;)(w=(o=b)-(_=(v=(r=d)+o)-r))&&(s[u++]=w),b=C-((y=C+v)-(m=y-C))+(v-m),C=y,(c+=1)<i&&(d=e[c]);return b&&(s[u++]=b),C&&(s[u++]=C),u||(s[u++]=0),s.length=u,s},Jo=function(t,e,n){var i=t+e,r=i-t,o=e-r,a=t-(i-r);return n?(n[0]=a+o,n[1]=i,n):[a+o,i]},Ko=function(t,e){var n=t.length;if(1===n){var i=Yo(t[0],e);return i[0]?i:[i[1]]}var r=new Array(2*n),o=[.1,.1],a=[.1,.1],s=0;Yo(t[0],e,o),o[0]&&(r[s++]=o[0]);for(var u=1;u<n;++u){Yo(t[u],e,a);var l=o[1];Jo(l,a[0],o),o[0]&&(r[s++]=o[0]);var c=a[1],h=o[1],f=c+h,p=h-(f-c);o[1]=f,p&&(r[s++]=p)}return o[1]&&(r[s++]=o[1]),0===s&&(r[s++]=0),r.length=s,r},$o=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],-e[0]);var r,o,a=n+i,s=new Array(a),u=0,l=0,c=0,h=Math.abs,f=t[l],p=h(f),d=-e[c],g=h(d);p<g?(o=f,(l+=1)<n&&(p=h(f=t[l]))):(o=d,(c+=1)<i&&(g=h(d=-e[c]))),l<n&&p<g||c>=i?(r=f,(l+=1)<n&&(p=h(f=t[l]))):(r=d,(c+=1)<i&&(g=h(d=-e[c])));for(var y,m,v=r+o,_=v-r,w=o-_,b=w,C=v;l<n&&c<i;)p<g?(r=f,(l+=1)<n&&(p=h(f=t[l]))):(r=d,(c+=1)<i&&(g=h(d=-e[c]))),(w=(o=b)-(_=(v=r+o)-r))&&(s[u++]=w),b=C-((y=C+v)-(m=y-C))+(v-m),C=y;for(;l<n;)(w=(o=b)-(_=(v=(r=f)+o)-r))&&(s[u++]=w),b=C-((y=C+v)-(m=y-C))+(v-m),C=y,(l+=1)<n&&(f=t[l]);for(;c<i;)(w=(o=b)-(_=(v=(r=d)+o)-r))&&(s[u++]=w),b=C-((y=C+v)-(m=y-C))+(v-m),C=y,(c+=1)<i&&(d=-e[c]);return b&&(s[u++]=b),C&&(s[u++]=C),u||(s[u++]=0),s.length=u,s},Qo=vt(function(t){function e(t,e){for(var n=new Array(t.length-1),i=1;i<t.length;++i)for(var r=n[i-1]=new Array(t.length-1),o=0,a=0;o<t.length;++o)o!==e&&(r[a++]=t[i][o]);return n}function n(t){return 1&t?"-":""}function i(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",i(t.slice(0,e)),",",i(t.slice(e)),")"].join("")}function r(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var o=[],a=0;a<t.length;++a)o.push(["scale(",i(r(e(t,a))),",",n(a),t[0][a],")"].join(""));return o}function o(t){for(var n=[],o=[],a=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var i=0;i<t;++i)e[n][i]=["m",i,"[",t-n-1,"]"].join("")}return e}(t),s=[],u=0;u<t;++u)0==(1&u)?n.push.apply(n,r(e(a,u))):o.push.apply(o,r(e(a,u))),s.push("m"+u);var l=i(n),c=i(o),h="orientation"+t+"Exact",f=["function ",h,"(",s.join(),"){var p=",l,",n=",c,",d=sub(p,n);return d[d.length-1];};return ",h].join("");return new Function("sum","prod","scale","sub",f)(Zo,Yo,Ko,$o)}var a=5,s=o(3),u=o(4),l=[function(){return 0},function(){
return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),a=r-o;if(r>0){if(o<=0)return a;i=r+o}else{if(!(r<0))return a;if(o>=0)return a;i=-(r+o)}var u=3.3306690738754716e-16*i;return a>=u||a<=-u?a:s(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],o=e[0]-i[0],a=n[0]-i[0],s=t[1]-i[1],l=e[1]-i[1],c=n[1]-i[1],h=t[2]-i[2],f=e[2]-i[2],p=n[2]-i[2],d=o*c,g=a*l,y=a*s,m=r*c,v=r*l,_=o*s,w=h*(d-g)+f*(y-m)+p*(v-_),b=7.771561172376103e-16*((Math.abs(d)+Math.abs(g))*Math.abs(h)+(Math.abs(y)+Math.abs(m))*Math.abs(f)+(Math.abs(v)+Math.abs(_))*Math.abs(p));return w>b||-w>b?w:u(t,e,n,i)}];!function(){for(;l.length<=a;)l.push(o(l.length));for(var e=[],n=["slow"],i=0;i<=a;++i)e.push("a"+i),n.push("o"+i);var r=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(i=2;i<=a;++i)r.push("case ",i,":return o",i,"(",e.slice(0,i).join(),");");r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(r.join(""));var s=Function.apply(void 0,n);for(t.exports=s.apply(void 0,[function(t){var e=l[t.length];return e||(e=l[t.length]=o(t.length)),e.apply(void 0,t)}].concat(l)),i=0;i<=a;++i)t.exports[i]=l[i]}()}),ta=function(t){var e=t.length;if(e<3){for(var n=new Array(e),i=0;i<e;++i)n[i]=i;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}var r=new Array(e);for(i=0;i<e;++i)r[i]=i;r.sort(function(e,n){var i=t[e][0]-t[n][0];return i||t[e][1]-t[n][1]});var o=[r[0],r[1]],a=[r[0],r[1]];for(i=2;i<e;++i){for(var s=r[i],u=t[s],l=o.length;l>1&&ea(t[o[l-2]],t[o[l-1]],u)<=0;)l-=1,o.pop();for(o.push(s),l=a.length;l>1&&ea(t[a[l-2]],t[a[l-1]],u)>=0;)l-=1,a.pop();a.push(s)}n=new Array(a.length+o.length-2);for(var c=0,h=(i=0,o.length);i<h;++i)n[c++]=o[i];for(var f=a.length-2;f>0;--f)n[c++]=a[f];return n},ea=Qo[3],na=_t,ia=_t;_t.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];t>0;){var r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),a=o+1,s=e[o];if(a<this.length&&n(e[a],s)<0&&(o=a,s=e[a]),n(s,r)>=0)break;e[t]=s,t=o}e[t]=r}},na.default=ia;var ra=function(t,e){for(var n=t[0],i=t[1],r=!1,o=0,a=e.length-1;o<e.length;a=o++){var s=e[o][0],u=e[o][1],l=e[a][0],c=e[a][1];u>i!=c>i&&n<(l-s)*(i-u)/(c-u)+s&&(r=!r)}return r},oa=Qo[3],aa=wt,sa=wt;aa.default=sa;var ua=function(t){return t},la=function(t){if(null==t)return ua;var e,n,i=t.scale[0],r=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var u=2,l=t.length,c=new Array(l);for(c[0]=(e+=t[0])*i+o,c[1]=(n+=t[1])*r+a;u<l;)c[u]=t[u],++u;return c}},ca=function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n},ha=function(t,e){function n(t,e){for(var n in t){var r=t[n];delete e[r.start],delete r.start,delete r.end,r.forEach(function(t){i[t<0?~t:t]=1}),a.push(r)}}var i={},r={},o={},a=[],s=-1;return e.forEach(function(n,i){var r,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(r=e[++s],e[s]=n,e[i]=r)}),e.forEach(function(e){var n,i,a=function(e){var n,i=t.arcs[e<0?~e:e],r=i[0];return t.transform?(n=[0,0],i.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=i[i.length-1],e<0?[n,r]:[r,n]}(e),s=a[0],u=a[1];if(n=o[s])if(delete o[n.end],n.push(e),n.end=u,i=r[u]){delete r[i.start];var l=i===n?n:n.concat(i);r[l.start=n.start]=o[l.end=i.end]=l}else r[n.start]=o[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(e),n.start=s,i=o[s]){delete o[i.end];var c=i===n?n:i.concat(n);r[c.start=i.start]=o[c.end=n.end]=c}else r[n.start]=o[n.end]=n;else r[(n=[e]).start=s]=o[n.end=u]=n}),n(o,r),n(r,o),e.forEach(function(t){i[t<0?~t:t]||a.push([t])}),a},fa=function(t){return Ht(t,qt.apply(this,arguments))},pa=function(t,e,n,i,r,o){3===arguments.length&&(i=o=Array,r=null);for(var a=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),s=new o(t),u=t-1,l=0;l<t;++l)a[l]=r;return{set:function(i,o){for(var l=e(i)&u,c=a[l],h=0;c!=r;){if(n(c,i))return s[l]=o;if(++h>=t)throw new Error("full hashmap");c=a[l=l+1&u]}return a[l]=i,s[l]=o,o},maybeSet:function(i,o){for(var l=e(i)&u,c=a[l],h=0;c!=r;){if(n(c,i))return s[l];if(++h>=t)throw new Error("full hashmap");c=a[l=l+1&u]}return a[l]=i,s[l]=o,o},get:function(i,o){for(var l=e(i)&u,c=a[l],h=0;c!=r;){if(n(c,i))return s[l];if(++h>=t)break;c=a[l=l+1&u]}return o},keys:function(){for(var t=[],e=0,n=a.length;e<n;++e){var i=a[e];i!=r&&t.push(i)}return t}}},da=function(t,e){return t[0]===e[0]&&t[1]===e[1]},ga=new ArrayBuffer(16),ya=new Float64Array(ga),ma=new Uint32Array(ga),va=function(t){ya[0]=t[0],ya[1]=t[1];var e=ma[0]^ma[1];return 2147483647&(e=e<<5^e>>7^ma[2]^ma[3])},_a=function(t){function e(t,e,n,i){if(f[n]!==t){f[n]=t;var r=p[n];if(r>=0){var o=d[n];r===e&&o===i||r===i&&o===e||(++y,g[n]=1)}else p[n]=e,d[n]=i}}function n(t){return va(u[t])}function i(t,e){return da(u[t],u[e])}var r,o,a,s,u=t.coordinates,l=t.lines,c=t.rings,h=function(){for(var t=pa(1.4*u.length,n,i,Int32Array,-1,Int32Array),e=new Int32Array(u.length),r=0,o=u.length;r<o;++r)e[r]=t.maybeSet(r,r);return e}(),f=new Int32Array(u.length),p=new Int32Array(u.length),d=new Int32Array(u.length),g=new Int8Array(u.length),y=0;for(r=0,o=u.length;r<o;++r)f[r]=p[r]=d[r]=-1;for(r=0,o=l.length;r<o;++r){var m=l[r],v=m[0],_=m[1];for(a=h[v],s=h[++v],++y,g[a]=1;++v<=_;)e(r,a,a=s,s=h[v]);++y,g[s]=1}for(r=0,o=u.length;r<o;++r)f[r]=-1;for(r=0,o=c.length;r<o;++r){var w=c[r],b=w[0]+1,C=w[1];for(e(r,h[C-1],a=h[b-1],s=h[b]);++b<=C;)e(r,a,a=s,s=h[b])}f=p=d=null;var x,E=function(t,e,n,i,r){3===arguments.length&&(i=Array,r=null);for(var o=new i(t=1<<Math.max(4,Math.ceil(Math.log(t)/Math.LN2))),a=t-1,s=0;s<t;++s)o[s]=r;return{add:function(i){for(var s=e(i)&a,u=o[s],l=0;u!=r;){if(n(u,i))return!0;if(++l>=t)throw new Error("full hashset");u=o[s=s+1&a]}return o[s]=i,!0},has:function(i){for(var s=e(i)&a,u=o[s],l=0;u!=r;){if(n(u,i))return!0;if(++l>=t)break;u=o[s=s+1&a]}return!1},values:function(){for(var t=[],e=0,n=o.length;e<n;++e){var i=o[e];i!=r&&t.push(i)}return t}}}(1.4*y,va,da);for(r=0,o=u.length;r<o;++r)g[x=h[r]]&&E.add(u[x]);return E},wa=function(t){var e,n,i,r=_a(t),o=t.coordinates,a=t.lines,s=t.rings;for(n=0,i=a.length;n<i;++n)for(var u=a[n],l=u[0],c=u[1];++l<c;)r.has(o[l])&&(e={0:l,1:u[1]},u[1]=l,u=u.next=e);for(n=0,i=s.length;n<i;++n)for(var h=s[n],f=h[0],p=f,d=h[1],g=r.has(o[f]);++p<d;)r.has(o[p])&&(g?(e={0:p,1:h[1]},h[1]=p,h=h.next=e):(!function(t,e,n,i){Vt(t,e,n),Vt(t,e,e+i),Vt(t,e+i,n)}(o,f,d,d-p),o[d]=o[f],g=!0,p=f));return t},ba=function(t){function e(t){var e,n,i,r,o,a,s,u;if(i=p.get(e=l[t[0]]))for(s=0,u=i.length;s<u;++s)if(r=i[s],function(t,e){var n=t[0],i=e[0],r=t[1],o=e[1];if(n-r!=i-o)return!1;for(;n<=r;++n,++i)if(!da(l[n],l[i]))return!1;return!0}(r,t))return t[0]=r[0],void(t[1]=r[1]);if(o=p.get(n=l[t[1]]))for(s=0,u=o.length;s<u;++s)if(a=o[s],function(t,e){var n=t[0],i=e[0],r=t[1],o=e[1];if(n-r!=i-o)return!1;for(;n<=r;++n,--o)if(!da(l[n],l[o]))return!1;return!0}(a,t))return t[1]=a[0],void(t[0]=a[1]);i?i.push(t):p.set(e,[t]),o?o.push(t):p.set(n,[t]),d.push(t)}function n(t,e){var n=t[0],i=e[0],o=t[1]-n;if(o!==e[1]-i)return!1;for(var a=r(t),s=r(e),u=0;u<o;++u)if(!da(l[n+(u+a)%o],l[i+(u+s)%o]))return!1;return!0}function i(t,e){var n=t[0],i=e[0],o=t[1],a=e[1],s=o-n;if(s!==a-i)return!1;for(var u=r(t),c=s-r(e),h=0;h<s;++h)if(!da(l[n+(h+u)%s],l[a-(h+c)%s]))return!1;return!0}function r(t){for(var e=t[0],n=t[1],i=e,r=i,o=l[i];++i<n;){var a=l[i];(a[0]<o[0]||a[0]===o[0]&&a[1]<o[1])&&(r=i,o=a)}return r-e}var o,a,s,u,l=t.coordinates,c=t.lines,h=t.rings,f=c.length+h.length;for(delete t.lines,delete t.rings,s=0,u=c.length;s<u;++s)for(o=c[s];o=o.next;)++f;for(s=0,u=h.length;s<u;++s)for(a=h[s];a=a.next;)++f;var p=pa(2*f*1.4,va,da),d=t.arcs=[];for(s=0,u=c.length;s<u;++s){o=c[s];do e(o);while(o=o.next)}for(s=0,u=h.length;s<u;++s)if((a=h[s]).next){do e(a);while(a=a.next)}else!function(t){var e,o,a,s,u;if(o=p.get(e=l[t[0]]))for(s=0,u=o.length;s<u;++s){if(a=o[s],n(a,t))return t[0]=a[0],void(t[1]=a[1]);if(i(a,t))return t[0]=a[1],void(t[1]=a[0])}if(o=p.get(e=l[t[0]+r(t)]))for(s=0,u=o.length;s<u;++s){if(a=o[s],n(a,t))return t[0]=a[0],void(t[1]=a[1]);if(i(a,t))return t[0]=a[1],void(t[1]=a[0])}o?o.push(t):p.set(e,[t]),d.push(t)}(a);return t},Ca=function(t,e){function n(t){t&&c.hasOwnProperty(t.type)&&c[t.type](t)}function i(t){var e=[];do{var n=l.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function r(t){return t.map(i)}var o=function(t){function e(t){null!=t&&l.hasOwnProperty(t.type)&&l[t.type](t)}function n(t){var e=t[0],n=t[1];e<o&&(o=e),e>s&&(s=e),n<a&&(a=n),n>u&&(u=n)}function i(t){t.forEach(n)}function r(t){t.forEach(i)}var o=1/0,a=1/0,s=-1/0,u=-1/0,l={GeometryCollection:function(t){t.geometries.forEach(e)},Point:function(t){n(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(n)},LineString:function(t){i(t.arcs)},MultiLineString:function(t){t.arcs.forEach(i)},Polygon:function(t){t.arcs.forEach(i)},MultiPolygon:function(t){t.arcs.forEach(r)}};for(var c in t)e(t[c]);return s>=o&&u>=a?[o,a,s,u]:void 0}(t=function(t){var e,n={};for(e in t)n[e]=Wt(t[e]);return n}(t)),a=e>0&&o&&function(t,e,n){function i(t){return[Math.round((t[0]-l)*p),Math.round((t[1]-c)*d)]}function r(t,e){for(var n,i,r,o,a,s=-1,u=0,h=t.length,f=new Array(h);++s<h;)n=t[s],o=Math.round((n[0]-l)*p),a=Math.round((n[1]-c)*d),o===i&&a===r||(f[u++]=[i=o,r=a]);for(f.length=u;u<e;)u=f.push([f[0][0],f[0][1]]);return f}function o(t){return r(t,2)}function a(t){return r(t,4)}function s(t){return t.map(a)}function u(t){null!=t&&g.hasOwnProperty(t.type)&&g[t.type](t)}var l=e[0],c=e[1],h=e[2],f=e[3],p=h-l?(n-1)/(h-l):1,d=f-c?(n-1)/(f-c):1,g={GeometryCollection:function(t){t.geometries.forEach(u)},Point:function(t){t.coordinates=i(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(i)},LineString:function(t){t.arcs=o(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(o)},Polygon:function(t){t.arcs=s(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(s)}};for(var y in t)u(t[y]);return{scale:[1/p,1/d],translate:[l,c]}}(t,o,e),s=ba(wa(function(t){function e(t){t&&l.hasOwnProperty(t.type)&&l[t.type](t)}function n(t){for(var e=0,n=t.length;e<n;++e)u[++o]=t[e];var i={0:o-n+1,1:o};return a.push(i),i}function i(t){for(var e=0,n=t.length;e<n;++e)u[++o]=t[e];var i={0:o-n+1,1:o};return s.push(i),i}function r(t){return t.map(i)}var o=-1,a=[],s=[],u=[],l={GeometryCollection:function(t){t.geometries.forEach(e)},LineString:function(t){t.arcs=n(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(n)},Polygon:function(t){t.arcs=t.arcs.map(i)},MultiPolygon:function(t){t.arcs=t.arcs.map(r)}};for(var c in t)e(t[c]);return{type:"Topology",coordinates:u,lines:a,rings:s,objects:t}}(t))),u=s.coordinates,l=pa(1.4*s.arcs.length,Zt,Jt);t=s.objects,s.bbox=o,s.arcs=s.arcs.map(function(t,e){return l.set(t,e),u.slice(t[0],t[1]+1)}),delete s.coordinates,u=null;var c={GeometryCollection:function(t){t.geometries.forEach(n)},LineString:function(t){t.arcs=i(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(i)},Polygon:function(t){t.arcs=t.arcs.map(i)},MultiPolygon:function(t){t.arcs=t.arcs.map(r)}};for(var h in t)n(t[h]);return a&&(s.transform=a,s.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var i,r,o=t[e],a=0,s=1,u=o.length,l=o[0],c=l[0],h=l[1];++a<u;)i=(l=o[a])[0],r=l[1],i===c&&r===h||(o[s++]=[i-c,r-h],c=i,h=r);1===s&&(o[s++]=[0,0]),o.length=s}return t}(s.arcs)),s},xa=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){n=this.centers[e],i=this.centers[e+1];var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,a=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+a)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+a)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};xa.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))>t&&(e.push(i),n=r)}return e},xa.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},xa.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*n);return function(t,e,n,i,r){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*o[0]+i.x*o[1]+n.x*o[2]+e.x*o[3],y:r.y*o[0]+i.y*o[1]+n.y*o[2]+e.y*o[3],z:r.z*o[0]+i.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-i,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])};var Ea=_e,Sa=_e;_e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(De(t,0,o,n));if(r)for(var s=0,u=e.length;s<u;s++){var l=e[s]*n,c=s<u-1?e[s+1]*n:t.length;a-=Math.abs(De(t,l,c,n))}var h=0;for(s=0;s<i.length;s+=3){var f=i[s]*n,p=i[s+1]*n,d=i[s+2]*n;h+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},_e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n},Ea.default=Sa,Be.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!Ze(t,e))return n;for(var r,o,a,s,u=[];e;){for(r=0,o=e.children.length;r<o;r++)a=e.children[r],Ze(t,s=e.leaf?i(a):a)&&(e.leaf?n.push(a):Xe(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Ze(t,e))return!1;for(var i,r,o,a,s=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],a=e.leaf?n(o):o,Ze(t,a)){if(e.leaf||Xe(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Je([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,a=this.data,s=this.toBBox(t),u=[],l=[];a||u.length;){if(a||(a=u.pop(),i=u[u.length-1],n=l.pop(),o=!0),a.leaf&&-1!==(r=function(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;o||a.leaf||!Xe(a,s)?i?(n++,a=i.children[n],o=!1):a=null:(u.push(a),l.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:qe,compareMinY:Ve,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return r=Je(t.slice(e,n+1)),Ge(r,this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=Je([])).leaf=!1,r.height=i;var s,u,l,c,h=Math.ceil(o/a),f=h*Math.ceil(Math.sqrt(a));for(Ke(t,e,n,f,this.compareMinX),s=e;s<=n;s+=f)for(Ke(t,s,l=Math.min(s+f-1,n),h,this.compareMinY),u=s;u<=l;u+=h)c=Math.min(u+h-1,l),r.children.push(this._build(t,u,c,i-1));return Ge(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,a,s,u,l,c,h;i.push(e),!e.leaf&&i.length-1!==n;){for(c=h=1/0,r=0,o=e.children.length;r<o;r++)u=We(a=e.children[r]),(l=function(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}(t,a)-u)<h?(h=l,c=u<c?u:c,s=a):l===h&&u<c&&(c=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],a=this._chooseSubtree(r,this.data,e,o);for(a.children.push(t),He(a,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=Je(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Ge(n,this.toBBox),Ge(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=Je([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Ge(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,a,s,u,l,c;for(u=l=1/0,i=e;i<=n-e;i++)a=function(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-i)}(r=Ue(t,0,i,this.toBBox),o=Ue(t,i,n,this.toBBox)),s=We(r)+We(o),a<u?(u=a,c=i,l=s<l?s:l):a===u&&s<l&&(l=s,c=i);return c},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:qe,r=t.leaf?this.compareMinY:Ve;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,a=this.toBBox,s=Ue(t,0,e,a),u=Ue(t,n-e,n,a),l=Ye(s)+Ye(u);for(r=e;r<n-e;r++)o=t.children[r],He(s,t.leaf?a(o):o),l+=Ye(s);for(r=n-e-1;r>=e;r--)o=t.children[r],He(u,t.leaf?a(o):o),l+=Ye(u);return l},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)He(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Ge(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Pa=Object.freeze({toMercator:ln,toWgs84:cn}),Ma=6378137,La=function(t,e,n){function i(t,n,i,r){var u=o[t][n],l=o[t][n+1],c=o[i][r],h=o[i][r+1],f=function(t,e,n,i){if(Nn(t,n)||Nn(t,i)||Nn(e,n)||Nn(i,n))return null;var r=t[0],o=t[1],a=e[0],s=e[1],u=n[0],l=n[1],c=i[0],h=i[1],f=(r-a)*(l-h)-(o-s)*(u-c);return 0===f?null:[((r*s-o*a)*(u-c)-(r-a)*(u*h-l*c))/f,((r*s-o*a)*(l-h)-(o-s)*(u*h-l*c))/f]}(u,l,c,h);if(null!==f){var p,d;if(p=l[0]!==u[0]?(f[0]-u[0])/(l[0]-u[0]):(f[1]-u[1])/(l[1]-u[1]),d=h[0]!==c[0]?(f[0]-c[0])/(h[0]-c[0]):(f[1]-c[1])/(h[1]-c[1]),!(p>=1||p<=0||d>=1||d<=0)){var g=f,y=!s[g];y&&(s[g]=!0),e?a.push(e(f,t,n,u,l,p,i,r,c,h,d,y)):a.push(f)}}}function r(t,e){var n,i,r,a,s=o[t][e],u=o[t][e+1];return s[0]<u[0]?(n=s[0],i=u[0]):(n=u[0],i=s[0]),s[1]<u[1]?(r=s[1],a=u[1]):(r=u[1],a=s[1]),{minX:n,minY:r,maxX:i,maxY:a,ring:t,edge:e}}if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===n&&(n=1);var o=t.geometry.coordinates,a=[],s={};if(n){for(var u=[],l=0;l<o.length;l++)for(var c=0;c<o[l].length-1;c++)u.push(r(l,c));var h=Wo();h.load(u)}for(var f=0;f<o.length;f++)for(var p=0;p<o[f].length-1;p++)if(n)h.search(r(f,p)).forEach(function(t){var e=t.ring,n=t.edge;i(f,p,e,n)});else for(var d=0;d<o.length;d++)for(var g=0;g<o[d].length-1;g++)i(f,p,d,g);return e||(a={type:"Feature",geometry:{type:"MultiPoint",coordinates:a}}),a},Ia=function(t){function e(){for(var t=[],e=0;e<d.features.length;e++)-1==d.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var n=-1,i=0;i<d.features.length;i++)t[e]!=i&&Tt(d.features[t[e]].geometry.coordinates[0][0],d.features[i],{ignoreBoundary:!0})&&vn(d.features[i])<1/0&&(n=i);d.features[t[e]].properties.parent=n}}function n(){for(var t=0;t<d.features.length;t++)if(-1==d.features[t].properties.parent){var e=d.features[t].properties.winding;d.features[t].properties.netWinding=e,i(t,e)}}function i(t,e){for(var n=0;n<d.features.length;n++)if(d.features[n].properties.parent==t){var r=e+d.features[n].properties.winding;d.features[n].properties.netWinding=r,i(n,r)}}if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var r=t.geometry.coordinates.length,a=[],s=0;s<r;s++){var u=t.geometry.coordinates[s];On(u[0],u[u.length-1])||u.push(u[0]),a.push.apply(a,u.slice(0,u.length-1))}if(!function(t){for(var e={},n=1,i=0,r=t.length;i<r;++i){if(e.hasOwnProperty(t[i])){n=0;break}e[t[i]]=1}return n}(a))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var c=a.length,h=La(t,function(t,e,n,i,r,o,a,s,u,l,c,h){return[t,e,n,i,r,o,a,s,u,l,c,h]}),f=h.length;if(0==f){var p=[];for(s=0;s<r;s++)p.push(o([t.geometry.coordinates[s]],{parent:-1,winding:function(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(kn([t[(e-1).modulo(t.length-1)],t[e],t[(e+1).modulo(t.length-1)]],!0))var i=1;else i=-1;return i}(t.geometry.coordinates[s])}));var d=l(p);return e(),n(),d}var g=[],y=[];for(s=0;s<r;s++){g.push([]);for(var m=0;m<t.geometry.coordinates[s].length-1;m++)g[s].push([new Ta(t.geometry.coordinates[s][(m+1).modulo(t.geometry.coordinates[s].length-1)],1,[s,m],[s,(m+1).modulo(t.geometry.coordinates[s].length-1)],void 0)]),y.push(new Na(t.geometry.coordinates[s][m],[s,(m-1).modulo(t.geometry.coordinates[s].length-1)],[s,m],void 0,void 0,!1,!0))}for(s=0;s<f;s++)g[h[s][1]][h[s][2]].push(new Ta(h[s][0],h[s][5],[h[s][1],h[s][2]],[h[s][6],h[s][7]],void 0)),h[s][11]&&y.push(new Na(h[s][0],[h[s][1],h[s][2]],[h[s][6],h[s][7]],void 0,void 0,!0,!0));var v=y.length;for(s=0;s<g.length;s++)for(m=0;m<g[s].length;m++)g[s][m].sort(function(t,e){return t.param<e.param?-1:1});var _=[];for(s=0;s<v;s++)_.push({minX:y[s].coord[0],minY:y[s].coord[1],maxX:y[s].coord[0],maxY:y[s].coord[1],index:s});var w=Wo();for(w.load(_),s=0;s<g.length;s++)for(m=0;m<g[s].length;m++)for(var b=0;b<g[s][m].length;b++){x=b==g[s][m].length-1?g[s][(m+1).modulo(t.geometry.coordinates[s].length-1)][0].coord:g[s][m][b+1].coord;var C=w.search({minX:x[0],minY:x[1],maxX:x[0],maxY:x[1]})[0];g[s][m][b].nxtIsectAlongEdgeIn=C.index}for(s=0;s<g.length;s++)for(m=0;m<g[s].length;m++)for(b=0;b<g[s][m].length;b++){var x=g[s][m][b].coord,E=(C=w.search({minX:x[0],minY:x[1],maxX:x[0],maxY:x[1]})[0]).index;E<c?y[E].nxtIsectAlongRingAndEdge2=g[s][m][b].nxtIsectAlongEdgeIn:On(y[E].ringAndEdge1,g[s][m][b].ringAndEdgeIn)?y[E].nxtIsectAlongRingAndEdge1=g[s][m][b].nxtIsectAlongEdgeIn:y[E].nxtIsectAlongRingAndEdge2=g[s][m][b].nxtIsectAlongEdgeIn}var S=[];for(s=0,m=0;m<r;m++){var P=s;for(b=0;b<t.geometry.coordinates[m].length-1;b++)y[s].coord[0]<y[P].coord[0]&&(P=s),s++;var M=y[P].nxtIsectAlongRingAndEdge2;for(b=0;b<y.length;b++)if(y[b].nxtIsectAlongRingAndEdge1==P||y[b].nxtIsectAlongRingAndEdge2==P){var L=b;break}var I=kn([y[L].coord,y[P].coord,y[M].coord],!0)?1:-1;S.push({isect:P,parent:-1,winding:I})}for(S.sort(function(t,e){return y[t.isect].coord>y[e.isect].coord?-1:1}),p=[];S.length>0;){var T=S.pop(),N=T.isect,k=T.parent,O=T.winding,D=p.length,A=[y[N].coord],R=N;if(y[N].ringAndEdge1Walkable)var F=y[N].ringAndEdge1,j=y[N].nxtIsectAlongRingAndEdge1;else F=y[N].ringAndEdge2,j=y[N].nxtIsectAlongRingAndEdge2;for(;!On(y[N].coord,y[j].coord);){A.push(y[j].coord);var z=void 0;for(s=0;s<S.length;s++)if(S[s].isect==j){z=s;break}if(void 0!=z&&S.splice(z,1),On(F,y[j].ringAndEdge1)){if(F=y[j].ringAndEdge2,y[j].ringAndEdge2Walkable=!1,y[j].ringAndEdge1Walkable){var B={isect:j};kn([y[R].coord,y[j].coord,y[y[j].nxtIsectAlongRingAndEdge2].coord],1==O)?(B.parent=k,B.winding=-O):(B.parent=D,B.winding=O),S.push(B)}R=j,j=y[j].nxtIsectAlongRingAndEdge2}else F=y[j].ringAndEdge1,y[j].ringAndEdge1Walkable=!1,y[j].ringAndEdge2Walkable&&(B={isect:j},kn([y[R].coord,y[j].coord,y[y[j].nxtIsectAlongRingAndEdge1].coord],1==O)?(B.parent=k,B.winding=-O):(B.parent=D,B.winding=O),S.push(B)),R=j,j=y[j].nxtIsectAlongRingAndEdge1}A.push(y[j].coord),p.push(o([A],{index:D,parent:k,winding:O,netWinding:void 0}))}return d=l(p),e(),n(),d},Ta=function(t,e,n,i,r){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=r},Na=function(t,e,n,i,r,o,a){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=r,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=a};Number.prototype.modulo=function(t){return(this%t+t)%t};var ka=Math.PI/180,Oa=180/Math.PI,Da=function(t,e){this.lon=t,this.lat=e,this.x=ka*t,this.y=ka*e};Da.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},Da.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new Da(e,t)};var Aa=function(){this.coords=[],this.length=0};Aa.prototype.move_to=function(t){this.length++,this.coords.push(t)};var Ra=function(t){this.properties=t||{},this.geometries=[]};Ra.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},Ra.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},i=0;i<this.geometries.length;i++){if(0===this.geometries[i].coords.length)return"LINESTRING(empty)";this.geometries[i].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var Fa=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new Da(t.x,t.y),this.end=new Da(e.x,e.y),this.properties=n||{};var i=this.start.x-this.end.x,r=this.start.y-this.end.y,o=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};Fa.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),i=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),a=Oa*Math.atan2(o,Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));return[Oa*Math.atan2(r,i),a]},Fa.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var i=1/(t-1),r=0;r<t;++r){var o=i*r,a=this.interpolate(o);n.push(a)}for(var s=!1,u=0,l=e&&e.offset?e.offset:10,c=180-l,h=-180+l,f=360-l,p=1;p<n.length;++p){var d=n[p-1][0],g=n[p][0],y=Math.abs(g-d);y>f&&(g>c&&d<h||d>c&&g<h)?s=!0:y>u&&(u=y)}var m=[];if(s&&u<l){var v=[];m.push(v);for(var _=0;_<n.length;++_){var w=parseFloat(n[_][0]);if(_>0&&Math.abs(w-n[_-1][0])>f){var b=parseFloat(n[_-1][0]),C=parseFloat(n[_-1][1]),x=parseFloat(n[_][0]),E=parseFloat(n[_][1]);if(b>-180&&b<h&&180===x&&_+1<n.length&&n[_-1][0]>-180&&n[_-1][0]<h){v.push([-180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(b>c&&b<180&&-180===x&&_+1<n.length&&n[_-1][0]>c&&n[_-1][0]<180){v.push([180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(b<h&&x>c){var S=b;b=x,x=S;var P=C;C=E,E=P}if(b>c&&x<h&&(x+=360),b<=180&&x>=180&&b<x){var M=(180-b)/(x-b),L=M*E+(1-M)*C;v.push([n[_-1][0]>c?180:-180,L]),(v=[]).push([n[_-1][0]>c?-180:180,L]),m.push(v)}else v=[],m.push(v);v.push([w,n[_][1]])}else v.push([n[_][0],n[_][1]])}}else{var I=[];m.push(I);for(var T=0;T<n.length;++T)I.push([n[T][0],n[T][1]])}for(var N=new Ra(this.properties),k=0;k<m.length;++k){var O=new Aa;N.geometries.push(O);for(var D=m[k],A=0;A<D.length;++A)O.move_to(D[A])}return N};var ja=Vn;Vn.polyline=Vn,Vn.polygon=function(t,e){var n,i,r,o,a,s,u;for(i=1;i<=8;i*=2){for(n=[],o=!(Yn(r=t[t.length-1],e)&i),a=0;a<t.length;a++)(u=!(Yn(s=t[a],e)&i))!==o&&n.push(Wn(r,s,i,e)),u&&n.push(s),r=s,o=u;if(!(t=n).length)break}return n};var za=Array.prototype.slice,Ba={successCallback:null,verbose:!1,polygons:!1},Ga={},Ua=64,Ha=16,qa=4,Va=1,Wa=[],Ya=[],Xa=[],Za=[],Ja=[],Ka=[],$a=[],Qa=[],ts=[],es=[],ns=[],is=[],rs=[],os=[],as=[],ss=[],us=[],ls=[],cs=[],hs=[],fs=[],ps=[],ds=[],gs=[];$a[85]=es[85]=-1,Qa[85]=ns[85]=0,ts[85]=is[85]=1,cs[85]=ps[85]=1,hs[85]=ds[85]=0,fs[85]=gs[85]=1,Wa[85]=Za[85]=0,Ya[85]=Ja[85]=-1,Xa[85]=as[85]=0,ss[85]=rs[85]=0,us[85]=os[85]=1,Ka[85]=ls[85]=1,ps[1]=ps[169]=0,ds[1]=ds[169]=-1,gs[1]=gs[169]=0,rs[1]=rs[169]=-1,os[1]=os[169]=0,as[1]=as[169]=0,es[4]=es[166]=0,ns[4]=ns[166]=-1,is[4]=is[166]=1,ss[4]=ss[166]=1,us[4]=us[166]=0,ls[4]=ls[166]=0,$a[16]=$a[154]=0,Qa[16]=Qa[154]=1,ts[16]=ts[154]=1,Za[16]=Za[154]=1,Ja[16]=Ja[154]=0,Ka[16]=Ka[154]=1,cs[64]=cs[106]=0,hs[64]=hs[106]=1,fs[64]=fs[106]=0,Wa[64]=Wa[106]=-1,Ya[64]=Ya[106]=0,Xa[64]=Xa[106]=1,cs[2]=cs[168]=0,hs[2]=hs[168]=-1,fs[2]=fs[168]=1,ps[2]=ps[168]=0,ds[2]=ds[168]=-1,gs[2]=gs[168]=0,rs[2]=rs[168]=-1,os[2]=os[168]=0,as[2]=as[168]=0,ss[2]=ss[168]=-1,us[2]=us[168]=0,ls[2]=ls[168]=1,$a[8]=$a[162]=0,Qa[8]=Qa[162]=-1,ts[8]=ts[162]=0,es[8]=es[162]=0,ns[8]=ns[162]=-1,is[8]=is[162]=1,rs[8]=rs[162]=1,os[8]=os[162]=0,as[8]=as[162]=1,ss[8]=ss[162]=1,us[8]=us[162]=0,ls[8]=ls[162]=0,$a[32]=$a[138]=0,Qa[32]=Qa[138]=1,ts[32]=ts[138]=1,es[32]=es[138]=0,ns[32]=ns[138]=1,is[32]=is[138]=0,Wa[32]=Wa[138]=1,Ya[32]=Ya[138]=0,Xa[32]=Xa[138]=0,Za[32]=Za[138]=1,Ja[32]=Ja[138]=0,Ka[32]=Ka[138]=1,ps[128]=ps[42]=0,ds[128]=ds[42]=1,gs[128]=gs[42]=1,cs[128]=cs[42]=0,hs[128]=hs[42]=1,fs[128]=fs[42]=0,Wa[128]=Wa[42]=-1,Ya[128]=Ya[42]=0,Xa[128]=Xa[42]=1,Za[128]=Za[42]=-1,Ja[128]=Ja[42]=0,Ka[128]=Ka[42]=0,es[5]=es[165]=-1,ns[5]=ns[165]=0,is[5]=is[165]=0,ps[5]=ps[165]=1,ds[5]=ds[165]=0,gs[5]=gs[165]=0,ss[20]=ss[150]=0,us[20]=us[150]=1,ls[20]=ls[150]=1,Za[20]=Za[150]=0,Ja[20]=Ja[150]=-1,Ka[20]=Ka[150]=1,$a[80]=$a[90]=-1,Qa[80]=Qa[90]=0,ts[80]=ts[90]=1,cs[80]=cs[90]=1,hs[80]=hs[90]=0,fs[80]=fs[90]=1,rs[65]=rs[105]=0,os[65]=os[105]=1,as[65]=as[105]=0,Wa[65]=Wa[105]=0,Ya[65]=Ya[105]=-1,Xa[65]=Xa[105]=0,
$a[160]=$a[10]=-1,Qa[160]=Qa[10]=0,ts[160]=ts[10]=1,es[160]=es[10]=-1,ns[160]=ns[10]=0,is[160]=is[10]=0,ps[160]=ps[10]=1,ds[160]=ds[10]=0,gs[160]=gs[10]=0,cs[160]=cs[10]=1,hs[160]=hs[10]=0,fs[160]=fs[10]=1,ss[130]=ss[40]=0,us[130]=us[40]=1,ls[130]=ls[40]=1,rs[130]=rs[40]=0,os[130]=os[40]=1,as[130]=as[40]=0,Wa[130]=Wa[40]=0,Ya[130]=Ya[40]=-1,Xa[130]=Xa[40]=0,Za[130]=Za[40]=0,Ja[130]=Ja[40]=-1,Ka[130]=Ka[40]=1,es[37]=es[133]=0,ns[37]=ns[133]=1,is[37]=is[133]=1,ps[37]=ps[133]=0,ds[37]=ds[133]=1,gs[37]=gs[133]=0,Wa[37]=Wa[133]=-1,Ya[37]=Ya[133]=0,Xa[37]=Xa[133]=0,Za[37]=Za[133]=1,Ja[37]=Ja[133]=0,Ka[37]=Ka[133]=0,ss[148]=ss[22]=-1,us[148]=us[22]=0,ls[148]=ls[22]=0,ps[148]=ps[22]=0,ds[148]=ds[22]=-1,gs[148]=gs[22]=1,cs[148]=cs[22]=0,hs[148]=hs[22]=1,fs[148]=fs[22]=1,Za[148]=Za[22]=-1,Ja[148]=Ja[22]=0,Ka[148]=Ka[22]=1,$a[82]=$a[88]=0,Qa[82]=Qa[88]=-1,ts[82]=ts[88]=1,ss[82]=ss[88]=1,us[82]=us[88]=0,ls[82]=ls[88]=1,rs[82]=rs[88]=-1,os[82]=os[88]=0,as[82]=as[88]=1,cs[82]=cs[88]=0,hs[82]=hs[88]=-1,fs[82]=fs[88]=0,$a[73]=$a[97]=0,Qa[73]=Qa[97]=1,ts[73]=ts[97]=0,es[73]=es[97]=0,ns[73]=ns[97]=-1,is[73]=is[97]=0,rs[73]=rs[97]=1,os[73]=os[97]=0,as[73]=as[97]=0,Wa[73]=Wa[97]=1,Ya[73]=Ya[97]=0,Xa[73]=Xa[97]=1,$a[145]=$a[25]=0,Qa[145]=Qa[25]=-1,ts[145]=ts[25]=0,rs[145]=rs[25]=1,os[145]=os[25]=0,as[145]=as[25]=1,ps[145]=ps[25]=0,ds[145]=ds[25]=1,gs[145]=gs[25]=1,Za[145]=Za[25]=-1,Ja[145]=Ja[25]=0,Ka[145]=Ka[25]=0,es[70]=es[100]=0,ns[70]=ns[100]=1,is[70]=is[100]=0,ss[70]=ss[100]=-1,us[70]=us[100]=0,ls[70]=ls[100]=1,cs[70]=cs[100]=0,hs[70]=hs[100]=-1,fs[70]=fs[100]=1,Wa[70]=Wa[100]=1,Ya[70]=Ya[100]=0,Xa[70]=Xa[100]=0,es[101]=es[69]=0,ns[101]=ns[69]=1,is[101]=is[69]=0,Wa[101]=Wa[69]=1,Ya[101]=Ya[69]=0,Xa[101]=Xa[69]=0,ps[149]=ps[21]=0,ds[149]=ds[21]=1,gs[149]=gs[21]=1,Za[149]=Za[21]=-1,Ja[149]=Ja[21]=0,Ka[149]=Ka[21]=0,ss[86]=ss[84]=-1,us[86]=us[84]=0,ls[86]=ls[84]=1,cs[86]=cs[84]=0,hs[86]=hs[84]=-1,fs[86]=fs[84]=1,$a[89]=$a[81]=0,Qa[89]=Qa[81]=-1,ts[89]=ts[81]=0,rs[89]=rs[81]=1,os[89]=os[81]=0,as[89]=as[81]=1,$a[96]=$a[74]=0,Qa[96]=Qa[74]=1,ts[96]=ts[74]=0,es[96]=es[74]=-1,ns[96]=ns[74]=0,is[96]=is[74]=1,cs[96]=cs[74]=1,hs[96]=hs[74]=0,fs[96]=fs[74]=0,Wa[96]=Wa[74]=1,Ya[96]=Ya[74]=0,Xa[96]=Xa[74]=1,$a[24]=$a[146]=0,Qa[24]=Qa[146]=-1,ts[24]=ts[146]=1,ss[24]=ss[146]=1,us[24]=us[146]=0,ls[24]=ls[146]=1,rs[24]=rs[146]=0,os[24]=os[146]=1,as[24]=as[146]=1,Za[24]=Za[146]=0,Ja[24]=Ja[146]=-1,Ka[24]=Ka[146]=0,es[6]=es[164]=-1,ns[6]=ns[164]=0,is[6]=is[164]=1,ss[6]=ss[164]=-1,us[6]=us[164]=0,ls[6]=ls[164]=0,ps[6]=ps[164]=0,ds[6]=ds[164]=-1,gs[6]=gs[164]=1,cs[6]=cs[164]=1,hs[6]=hs[164]=0,fs[6]=fs[164]=0,rs[129]=rs[41]=0,os[129]=os[41]=1,as[129]=as[41]=1,ps[129]=ps[41]=0,ds[129]=ds[41]=1,gs[129]=gs[41]=0,Wa[129]=Wa[41]=-1,Ya[129]=Ya[41]=0,Xa[129]=Xa[41]=0,Za[129]=Za[41]=0,Ja[129]=Ja[41]=-1,Ka[129]=Ka[41]=0,ss[66]=ss[104]=0,us[66]=us[104]=1,ls[66]=ls[104]=0,rs[66]=rs[104]=-1,os[66]=os[104]=0,as[66]=as[104]=1,cs[66]=cs[104]=0,hs[66]=hs[104]=-1,fs[66]=fs[104]=0,Wa[66]=Wa[104]=0,Ya[66]=Ya[104]=-1,Xa[66]=Xa[104]=1,$a[144]=$a[26]=-1,Qa[144]=Qa[26]=0,ts[144]=ts[26]=0,ps[144]=ps[26]=1,ds[144]=ds[26]=0,gs[144]=gs[26]=1,cs[144]=cs[26]=0,hs[144]=hs[26]=1,fs[144]=fs[26]=1,Za[144]=Za[26]=-1,Ja[144]=Ja[26]=0,Ka[144]=Ka[26]=1,es[36]=es[134]=0,ns[36]=ns[134]=1,is[36]=is[134]=1,ss[36]=ss[134]=0,us[36]=us[134]=1,ls[36]=ls[134]=0,Wa[36]=Wa[134]=0,Ya[36]=Ya[134]=-1,Xa[36]=Xa[134]=1,Za[36]=Za[134]=1,Ja[36]=Ja[134]=0,Ka[36]=Ka[134]=0,$a[9]=$a[161]=-1,Qa[9]=Qa[161]=0,ts[9]=ts[161]=0,es[9]=es[161]=0,ns[9]=ns[161]=-1,is[9]=is[161]=0,rs[9]=rs[161]=1,os[9]=os[161]=0,as[9]=as[161]=0,ps[9]=ps[161]=1,ds[9]=ds[161]=0,gs[9]=gs[161]=1,$a[136]=0,Qa[136]=1,ts[136]=1,es[136]=0,ns[136]=1,is[136]=0,ss[136]=-1,us[136]=0,ls[136]=1,rs[136]=-1,os[136]=0,as[136]=0,ps[136]=0,ds[136]=-1,gs[136]=0,cs[136]=0,hs[136]=-1,fs[136]=1,Wa[136]=1,Ya[136]=0,Xa[136]=0,Za[136]=1,Ja[136]=0,Ka[136]=1,$a[34]=0,Qa[34]=-1,ts[34]=0,es[34]=0,ns[34]=-1,is[34]=1,ss[34]=1,us[34]=0,ls[34]=0,rs[34]=1,os[34]=0,as[34]=1,ps[34]=0,ds[34]=1,gs[34]=1,cs[34]=0,hs[34]=1,fs[34]=0,Wa[34]=-1,Ya[34]=0,Xa[34]=1,Za[34]=-1,Ja[34]=0,Ka[34]=0,$a[35]=0,Qa[35]=1,ts[35]=1,es[35]=0,ns[35]=-1,is[35]=1,ss[35]=1,us[35]=0,ls[35]=0,rs[35]=-1,os[35]=0,as[35]=0,ps[35]=0,ds[35]=-1,gs[35]=0,cs[35]=0,hs[35]=1,fs[35]=0,Wa[35]=-1,Ya[35]=0,Xa[35]=1,Za[35]=1,Ja[35]=0,Ka[35]=1,$a[153]=0,Qa[153]=1,ts[153]=1,rs[153]=-1,os[153]=0,as[153]=0,ps[153]=0,ds[153]=-1,gs[153]=0,Za[153]=1,Ja[153]=0,Ka[153]=1,es[102]=0,ns[102]=-1,is[102]=1,ss[102]=1,us[102]=0,ls[102]=0,cs[102]=0,hs[102]=1,fs[102]=0,Wa[102]=-1,Ya[102]=0,Xa[102]=1,$a[155]=0,Qa[155]=-1,ts[155]=0,rs[155]=1,os[155]=0,as[155]=1,ps[155]=0,ds[155]=1,gs[155]=1,Za[155]=-1,Ja[155]=0,Ka[155]=0,es[103]=0,ns[103]=1,is[103]=0,ss[103]=-1,us[103]=0,ls[103]=1,cs[103]=0,hs[103]=-1,fs[103]=1,Wa[103]=1,Ya[103]=0,Xa[103]=0,$a[152]=0,Qa[152]=1,ts[152]=1,ss[152]=-1,us[152]=0,ls[152]=1,rs[152]=-1,os[152]=0,as[152]=0,ps[152]=0,ds[152]=-1,gs[152]=0,cs[152]=0,hs[152]=-1,fs[152]=1,Za[152]=1,Ja[152]=0,Ka[152]=1,$a[156]=0,Qa[156]=-1,ts[156]=1,ss[156]=1,us[156]=0,ls[156]=1,rs[156]=-1,os[156]=0,as[156]=0,ps[156]=0,ds[156]=-1,gs[156]=0,cs[156]=0,hs[156]=1,fs[156]=1,Za[156]=-1,Ja[156]=0,Ka[156]=1,$a[137]=0,Qa[137]=1,ts[137]=1,es[137]=0,ns[137]=1,is[137]=0,rs[137]=-1,os[137]=0,as[137]=0,ps[137]=0,ds[137]=-1,gs[137]=0,Wa[137]=1,Ya[137]=0,Xa[137]=0,Za[137]=1,Ja[137]=0,Ka[137]=1,$a[139]=0,Qa[139]=1,ts[139]=1,es[139]=0,ns[139]=-1,is[139]=0,rs[139]=1,os[139]=0,as[139]=0,ps[139]=0,ds[139]=1,gs[139]=0,Wa[139]=-1,Ya[139]=0,Xa[139]=0,Za[139]=1,Ja[139]=0,Ka[139]=1,$a[98]=0,Qa[98]=-1,ts[98]=0,es[98]=0,ns[98]=-1,is[98]=1,ss[98]=1,us[98]=0,ls[98]=0,rs[98]=1,os[98]=0,as[98]=1,cs[98]=0,hs[98]=1,fs[98]=0,Wa[98]=-1,Ya[98]=0,Xa[98]=1,$a[99]=0,Qa[99]=1,ts[99]=0,es[99]=0,ns[99]=-1,is[99]=1,ss[99]=1,us[99]=0,ls[99]=0,rs[99]=-1,os[99]=0,as[99]=1,cs[99]=0,hs[99]=-1,fs[99]=0,Wa[99]=1,Ya[99]=0,Xa[99]=1,es[38]=0,ns[38]=-1,is[38]=1,ss[38]=1,us[38]=0,ls[38]=0,ps[38]=0,ds[38]=1,gs[38]=1,cs[38]=0,hs[38]=1,fs[38]=0,Wa[38]=-1,Ya[38]=0,Xa[38]=1,Za[38]=-1,Ja[38]=0,Ka[38]=0,es[39]=0,ns[39]=1,is[39]=1,ss[39]=-1,us[39]=0,ls[39]=0,ps[39]=0,ds[39]=-1,gs[39]=1,cs[39]=0,hs[39]=1,fs[39]=0,Wa[39]=-1,Ya[39]=0,Xa[39]=1,Za[39]=1,Ja[39]=0,Ka[39]=0;var ys=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},ms=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},vs=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},_s=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},ws=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},bs=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},Cs=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},xs=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Es=[],Ss=[],Ps=[],Ms=[],Ls=[],Is=[],Ts=[],Ns=[];Ms[1]=Ls[1]=18,Ms[169]=Ls[169]=18,Ps[4]=Ss[4]=12,Ps[166]=Ss[166]=12,Es[16]=Ns[16]=4,Es[154]=Ns[154]=4,Is[64]=Ts[64]=22,Is[106]=Ts[106]=22,Ps[2]=Is[2]=17,Ms[2]=Ls[2]=18,Ps[168]=Is[168]=17,Ms[168]=Ls[168]=18,Es[8]=Ms[8]=9,Ss[8]=Ps[8]=12,Es[162]=Ms[162]=9,Ss[162]=Ps[162]=12,Es[32]=Ns[32]=4,Ss[32]=Ts[32]=1,Es[138]=Ns[138]=4,Ss[138]=Ts[138]=1,Ls[128]=Ns[128]=21,Is[128]=Ts[128]=22,Ls[42]=Ns[42]=21,Is[42]=Ts[42]=22,Ss[5]=Ls[5]=14,Ss[165]=Ls[165]=14,Ps[20]=Ns[20]=6,Ps[150]=Ns[150]=6,Es[80]=Is[80]=11,Es[90]=Is[90]=11,Ms[65]=Ts[65]=3,Ms[105]=Ts[105]=3,Es[160]=Is[160]=11,Ss[160]=Ls[160]=14,Es[10]=Is[10]=11,Ss[10]=Ls[10]=14,Ps[130]=Ns[130]=6,Ms[130]=Ts[130]=3,Ps[40]=Ns[40]=6,Ms[40]=Ts[40]=3,Ss[101]=Ts[101]=1,Ss[69]=Ts[69]=1,Ls[149]=Ns[149]=21,Ls[21]=Ns[21]=21,Ps[86]=Is[86]=17,Ps[84]=Is[84]=17,Es[89]=Ms[89]=9,Es[81]=Ms[81]=9,Es[96]=Ts[96]=0,Ss[96]=Is[96]=15,Es[74]=Ts[74]=0,Ss[74]=Is[74]=15,Es[24]=Ps[24]=8,Ms[24]=Ns[24]=7,Es[146]=Ps[146]=8,Ms[146]=Ns[146]=7,Ss[6]=Is[6]=15,Ps[6]=Ls[6]=16,Ss[164]=Is[164]=15,Ps[164]=Ls[164]=16,Ms[129]=Ns[129]=7,Ls[129]=Ts[129]=20,Ms[41]=Ns[41]=7,Ls[41]=Ts[41]=20,Ps[66]=Ts[66]=2,Ms[66]=Is[66]=19,Ps[104]=Ts[104]=2,Ms[104]=Is[104]=19,Es[144]=Ls[144]=10,Is[144]=Ns[144]=23,Es[26]=Ls[26]=10,Is[26]=Ns[26]=23,Ss[36]=Ns[36]=5,Ps[36]=Ts[36]=2,Ss[134]=Ns[134]=5,Ps[134]=Ts[134]=2,Es[9]=Ls[9]=10,Ss[9]=Ms[9]=13,Es[161]=Ls[161]=10,Ss[161]=Ms[161]=13,Ss[37]=Ns[37]=5,Ls[37]=Ts[37]=20,Ss[133]=Ns[133]=5,Ls[133]=Ts[133]=20,Ps[148]=Ls[148]=16,Is[148]=Ns[148]=23,Ps[22]=Ls[22]=16,Is[22]=Ns[22]=23,Es[82]=Ps[82]=8,Ms[82]=Is[82]=19,Es[88]=Ps[88]=8,Ms[88]=Is[88]=19,Es[73]=Ts[73]=0,Ss[73]=Ms[73]=13,Es[97]=Ts[97]=0,Ss[97]=Ms[97]=13,Es[145]=Ms[145]=9,Ls[145]=Ns[145]=21,Es[25]=Ms[25]=9,Ls[25]=Ns[25]=21,Ss[70]=Ts[70]=1,Ps[70]=Is[70]=17,Ss[100]=Ts[100]=1,Ps[100]=Is[100]=17,Es[34]=Ms[34]=9,Ss[34]=Ps[34]=12,Ls[34]=Ns[34]=21,Is[34]=Ts[34]=22,Es[136]=Ns[136]=4,Ss[136]=Ts[136]=1,Ps[136]=Is[136]=17,Ms[136]=Ls[136]=18,Es[35]=Ns[35]=4,Ss[35]=Ps[35]=12,Ms[35]=Ls[35]=18,Is[35]=Ts[35]=22,Es[153]=Ns[153]=4,Ms[153]=Ls[153]=18,Ss[102]=Ps[102]=12,Is[102]=Ts[102]=22,Es[155]=Ms[155]=9,Ls[155]=Ns[155]=23,Ss[103]=Ts[103]=1,Ps[103]=Is[103]=17,Es[152]=Ns[152]=4,Ps[152]=Is[152]=17,Ms[152]=Ls[152]=18,Es[156]=Ps[156]=8,Ms[156]=Ls[156]=18,Is[156]=Ns[156]=23,Es[137]=Ns[137]=4,Ss[137]=Ts[137]=1,Ms[137]=Ls[137]=18,Es[139]=Ns[139]=4,Ss[139]=Ms[139]=13,Ls[139]=Ts[139]=20,Es[98]=Ms[98]=9,Ss[98]=Ps[98]=12,Is[98]=Ts[98]=22,Es[99]=Ts[99]=0,Ss[99]=Ps[99]=12,Ms[99]=Is[99]=19,Ss[38]=Ps[38]=12,Ls[38]=Ns[38]=21,Is[38]=Ts[38]=22,Ss[39]=Ns[39]=5,Ps[39]=Ls[39]=16,Is[39]=Ts[39]=22;var ks=[];ks[1]=ks[169]=ys,ks[4]=ks[166]=ms,ks[16]=ks[154]=vs,ks[64]=ks[106]=_s,ks[168]=ks[2]=ws,ks[162]=ks[8]=bs,ks[138]=ks[32]=Cs,ks[42]=ks[128]=xs,ks[5]=ks[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},ks[20]=ks[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},ks[80]=ks[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},ks[65]=ks[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},ks[160]=ks[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},ks[130]=ks[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},ks[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},ks[101]=ks[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},ks[149]=ks[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},ks[86]=ks[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},ks[89]=ks[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},ks[96]=ks[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},ks[24]=ks[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},ks[6]=ks[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},ks[129]=ks[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},ks[66]=ks[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ks[144]=ks[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},ks[36]=ks[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},ks[9]=ks[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},ks[37]=ks[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},ks[148]=ks[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},ks[82]=ks[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},ks[73]=ks[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},ks[145]=ks[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},ks[70]=ks[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ks[34]=function(t){return[xs(t),bs(t)]},ks[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},ks[136]=function(t){return[Cs(t),ws(t)]},ks[153]=function(t){return[vs(t),ys(t)]},ks[102]=function(t){return[ms(t),_s(t)]},ks[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},ks[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ks[152]=function(t){return[vs(t),ws(t)]},ks[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},ks[137]=function(t){return[Cs(t),ys(t)]},ks[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},ks[98]=function(t){return[bs(t),_s(t)]},ks[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},ks[38]=function(t){return[ms(t),xs(t)]},ks[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};var Os=function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1};Os.buildId=function(t){return t.join(",")},Os.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter(function(e){return e.from.id!==t.from.id})},Os.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter(function(e){return e.to.id!==t.to.id})},Os.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},Os.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort(function(e,n){var i=e.to,r=n.to;if(i.coordinates[0]-t.coordinates[0]>=0&&r.coordinates[0]-t.coordinates[0]<0)return 1;if(i.coordinates[0]-t.coordinates[0]<0&&r.coordinates[0]-t.coordinates[0]>=0)return-1;if(i.coordinates[0]-t.coordinates[0]==0&&r.coordinates[0]-t.coordinates[0]==0)return i.coordinates[1]-t.coordinates[1]>=0||r.coordinates[1]-t.coordinates[1]>=0?i.coordinates[1]-r.coordinates[1]:r.coordinates[1]-i.coordinates[1];var o=wi(t.coordinates,i.coordinates,r.coordinates);return o<0?1:o>0?-1:Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2)-(Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2))}),this.outerEdgesSorted=!0)},Os.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},Os.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},Os.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};var Ds=function(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)};Ds.prototype.getSymetric=function(){return this.symetric||(this.symetric=new Ds(this.to,this.from),this.symetric.symetric=this),this.symetric},Ds.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},Ds.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},Ds.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},Ds.prototype.toLineString=function(){return s([this.from.coordinates,this.to.coordinates])},Ds.prototype.compareTo=function(t){return wi(t.from.coordinates,t.to.coordinates,this.to.coordinates)};var As=function(){this.edges=[],this.polygon=void 0,this.envelope=void 0},Rs={length:{configurable:!0}};As.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0},As.prototype.get=function(t){return this.edges[t]},Rs.length.get=function(){return this.edges.length},As.prototype.forEach=function(t){this.edges.forEach(t)},As.prototype.map=function(t){return this.edges.map(t)},As.prototype.some=function(t){return this.edges.some(t)},As.prototype.isValid=function(){return!0},As.prototype.isHole=function(){var t=this,e=this.edges.reduce(function(e,n,i){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=i),e},0),n=(0===e?this.length:e)-1,i=(e+1)%this.length,r=wi(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[i].from.coordinates);return 0===r?this.edges[n].from.coordinates[0]>this.edges[i].from.coordinates[0]:r>0},As.prototype.toMultiPoint=function(){return h(this.edges.map(function(t){return t.from.coordinates}))},As.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(t){return t.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=o([t])},As.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=ce(this.toPolygon())},As.findEdgeRingContaining=function(t,e){var n,r,o=t.getEnvelope();return e.forEach(function(e){var a=e.getEnvelope();if(r&&(n=r.getEnvelope()),!function(t,e){var n=t.geometry.coordinates.map(function(t){return t[0]}),i=t.geometry.coordinates.map(function(t){return t[1]}),r=e.geometry.coordinates.map(function(t){return t[0]}),o=e.geometry.coordinates.map(function(t){return t[1]});return Math.max(null,n)===Math.max(null,r)&&Math.max(null,i)===Math.max(null,o)&&Math.min(null,n)===Math.min(null,r)&&Math.min(null,i)===Math.min(null,o)}(a,o)&&bi(a,o)){var s=t.map(function(t){return t.from.coordinates}).find(function(t){return!e.some(function(e){return function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t,e.from.coordinates)})});s&&e.inside(i(s))&&(r&&!bi(n,a)||(r=e))}}),r},As.prototype.inside=function(t){return Tt(t,this.toPolygon())},Object.defineProperties(As.prototype,Rs);var Fs=function(){this.edges=[],this.nodes={}};Fs.fromGeoJson=function(t){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(t);var e=new Fs;return R(t,function(t){Y(t,"LineString","Graph::fromGeoJson"),L(t,function(t,n){if(t){var i=e.getNode(t),r=e.getNode(n);e.addEdge(i,r)}return n})}),e},Fs.prototype.getNode=function(t){var e=Os.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new Os(t)),n},Fs.prototype.addEdge=function(t,e){var n=new Ds(t,e),i=n.getSymetric();this.edges.push(n),this.edges.push(i)},Fs.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map(function(e){return t.nodes[e]}).forEach(function(e){return t._removeIfDangle(e)})},Fs.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map(function(t){return t.to});this.removeNode(t),n.forEach(function(t){return e._removeIfDangle(t)})}},Fs.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))})},Fs.prototype._computeNextCWEdges=function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach(function(t){return e._computeNextCWEdges(e.nodes[t])}):t.getOuterEdges().forEach(function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e})},Fs.prototype._computeNextCCWEdges=function(t,e){for(var n,i,r=t.getOuterEdges(),o=r.length-1;o>=0;--o){var a=r[o],s=a.symetric,u=void 0,l=void 0;a.label===e&&(u=a),s.label===e&&(l=s),u&&l&&(l&&(i=l),u&&(i&&(i.next=u,i=void 0),n||(n=u)))}i&&(i.next=n)},Fs.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach(function(n){if(!(n.label>=0)){t.push(n);var i=n;do i.label=e,i=i.next;while(!n.isEqual(i));e++}}),t},Fs.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach(function(t){t.label=void 0}),this._findLabeledEdgeRings().forEach(function(e){t._findIntersectionNodes(e).forEach(function(n){t._computeNextCCWEdges(n,e.label)})});var e=[];return this.edges.forEach(function(n){n.ring||e.push(t._findEdgeRing(n))}),e},Fs.prototype._findIntersectionNodes=function(t){var e=[],n=t,i=function(){var i=0;n.from.getOuterEdges().forEach(function(e){e.label===t.label&&++i}),i>1&&e.push(n.from),n=n.next};do i();while(!t.isEqual(n));return e},Fs.prototype._findEdgeRing=function(t){var e=t,n=new As;do n.push(e),e.ring=n,e=e.next;while(!t.isEqual(e));return n},Fs.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach(function(t){return e.removeEdge(t)}),t.innerEdges.forEach(function(t){return e.removeEdge(t)}),delete this.nodes[t.id]},Fs.prototype.removeEdge=function(t){this.edges=this.edges.filter(function(e){return!e.isEqual(t)}),t.deleteEdge()};var js=vt(function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n}),zs=(js.shim,vt(function(t,e){function n(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function i(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();(e=t.exports=r?n:i).supported=n,e.unsupported=i})),Bs=(zs.supported,zs.unsupported,vt(function(t){function e(t){return null===t||void 0===t}function n(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}var i=Array.prototype.slice,r=t.exports=function(t,o,a){return a||(a={}),t===o||(t instanceof Date&&o instanceof Date?t.getTime()===o.getTime():!t||!o||"object"!=typeof t&&"object"!=typeof o?a.strict?t===o:t==o:function(t,o,a){var s,u;if(e(t)||e(o))return!1;if(t.prototype!==o.prototype)return!1;if(zs(t))return!!zs(o)&&(t=i.call(t),o=i.call(o),r(t,o,a));if(n(t)){if(!n(o))return!1;if(t.length!==o.length)return!1;for(s=0;s<t.length;s++)if(t[s]!==o[s])return!1;return!0}try{var l=js(t),c=js(o)}catch(t){return!1}if(l.length!=c.length)return!1;for(l.sort(),c.sort(),s=l.length-1;s>=0;s--)if(l[s]!=c[s])return!1;for(s=l.length-1;s>=0;s--)if(u=l[s],!r(t[u],o[u],a))return!1;return typeof t==typeof o}(t,o,a))}})),Gs=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:ki};Gs.prototype.compare=function(t,e){if(t.type!==e.type||!Ni(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,i=Ti(t),r=Ti(e);return i.every(function(t){return this.some(function(e){return n.compare(t,e)})},r)}}return!1},Gs.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},Gs.prototype.compareLine=function(t,e,n,i){if(!Ni(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!i||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var a=this.compareCoord(r[n],o[n]);return this.direction||a?this.comparePath(r,o):!!this.compareCoord(r[n],o[o.length-(1+n)])&&this.comparePath(r.slice().reverse(),o)}},Gs.prototype.fixStartIndex=function(t,e){for(var n,i=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){i=r;break}return i>=0&&(n=[].concat(t.slice(i,t.length),t.slice(1,i+1))),n},Gs.prototype.comparePath=function(t,e){var n=this;return t.every(function(t,e){return n.compareCoord(t,this[e])},e)},Gs.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),i=e.coordinates.slice(1,e.coordinates.length),r=this;return n.every(function(t){return this.some(function(e){return r.compareLine(t,e,1,!0)})},i)}return!1},Gs.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},Gs.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},Gs.prototype.removePseudo=function(t){return t};var Us=Gs,Hs=vt(function(t){function e(t,e,n,i){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,i)}e.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var r=0;r<this._datasetLength;r++)if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);if(o.length<this.minPts)this.noise.push(r);else{var a=this.clusters.length;this.clusters.push([]),this._addToCluster(r,a),this._expandCluster(a,o)}}return this.clusters},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(1!==this._visited[i]){this._visited[i]=1;var r=this._regionQuery(i);r.length>=this.minPts&&(e=this._mergeArrays(e,r))}1!==this._assigned[i]&&this._addToCluster(i,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++)this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n);return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,i=0;i<n;i++){var r=e[i];t.indexOf(r)<0&&t.push(r)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)}),qs=vt(function(t){function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,i=0;i<this.k;i++)this.centroids[i]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var o=0;o<this.k;o++){for(var a=new Array(c),s=0,u=0;u<c;u++)a[u]=0;for(var l=0;l<n;l++){var c=this.dataset[l].length;if(o===this.assignments[l]){for(u=0;u<c;u++)a[u]+=this.dataset[l][u];s++}}if(s>0){for(u=0;u<c;u++)a[u]/=s;this.centroids[o]=a}else this.centroids[o]=this.randomCentroid(),r=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do e=Math.round(Math.random()*n),t=this.dataset[e];while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,i=0;i<n;i++)(t=this.argmin(this.dataset[i],this.centroids,this.distance))!=this.assignments[i]&&(this.assignments[i]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var i,r=Number.MAX_VALUE,o=0,a=e.length,s=0;s<a;s++)(i=n(t,e[s]))<r&&(r=i,o=s);return o},e.prototype.distance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;){var r=t[i]-e[i];n+=r*r}return Math.sqrt(n)},t.exports&&(t.exports=e)}),Vs=vt(function(t){function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,i=n;i--;){var r=this._priorities[i];"desc"===this._sorting?e>r&&(n=i):e<r&&(n=i)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var i=0;i<t.length;i++)this.insert(t[i],e[i])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)}),Ws=vt(function(t){function e(t,e,n,i){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,i)}if(t.exports)var n=Vs;e.prototype.run=function(t,e,i,r){this._init(t,e,i,r);for(var o=0,a=this.dataset.length;o<a;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var s=this.clusters.length-1;this._orderedList.push(o);var u=new n(null,null,"asc"),l=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,l,u),this._expandCluster(s,u))}return this.clusters},e.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var i=this._orderedList[e],r=this._reachability[i];t.push([i,r])}return t},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._updateQueue=function(t,e,n){var i=this;this._coreDistance=this._distanceToCore(t),e.forEach(function(e){if(void 0===i._processed[e]){var r=i.distance(i.dataset[t],i.dataset[e]),o=Math.max(i._coreDistance,r);void 0===i._reachability[e]?(i._reachability[e]=o,n.insert(e,o)):o<i._reachability[e]&&(i._reachability[e]=o,n.remove(e),n.insert(e,o))}})},e.prototype._expandCluster=function(t,e){for(var n=e.getElements(),i=0,r=n.length;i<r;i++){var o=n[i];if(void 0===this._processed[o]){var a=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,a,e),this._expandCluster(t,e))}}},e.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++)if(this._regionQuery(t,n).length>=this.minPts)return n},e.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],i=0,r=this.dataset.length;i<r;i++)this.distance(this.dataset[t],this.dataset[i])<e&&n.push(i);return n},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)}),Ys=vt(function(t){t.exports&&(t.exports={DBSCAN:Hs,KMEANS:qs,OPTICS:Ws,PriorityQueue:Vs})}),Xs=(Ys.DBSCAN,Ys.KMEANS,Ys.OPTICS,Ys.PriorityQueue,function(t,e,n){for(var i=t.length,r=0,o=0;o<i;o++){var a=(t[o]||0)-(e[o]||0);r+=a*a}return n?Math.sqrt(r):r}),Zs=Xs,Js=function(t,e,n){var i=Math.abs(t-e);return n?i:i*i},Ks=Xs,$s=function(t,e){for(var n={},i=[],r=e<<2,o=t.length,a=t[0].length>0;i.length<e&&r-- >0;){var s=t[Math.floor(Math.random()*o)],u=a?s.join("_"):""+s;n[u]||(n[u]=!0,i.push(s))}if(i.length<e)throw new Error("Error initializating clusters");return i},Qs=function(t,e){var n=t[0].length?Zs:Js,i=[],r=t.length,o=t[0].length>0,a=t[Math.floor(Math.random()*r)];
for(o&&a.join("_"),i.push(a);i.length<e;){for(var s=[],u=i.length,l=0,c=[],h=0;h<r;h++){for(var f=1/0,p=0;p<u;p++){var d=n(t[h],i[p]);d<=f&&(f=d)}s[h]=f}for(var g=0;g<r;g++)l+=s[g];for(var y=0;y<r;y++)c[y]={i:y,v:t[y],pr:s[y]/l,cs:0};c.sort(function(t,e){return t.pr-e.pr}),c[0].cs=c[0].pr;for(var m=1;m<r;m++)c[m].cs=c[m-1].cs+c[m].pr;for(var v=Math.random(),_=0;_<r-1&&c[_++].cs<v;);i.push(c[_-1].v)}return i},tu=1e4,eu=function(t,e,n,i){var r=[],o=[],a=[],s=[],u=!1,l=i||tu,c=t.length,h=t[0].length,f=h>0,p=[];if(n)r="kmrand"==n?$s(t,e):"kmpp"==n?Qs(t,e):n;else for(var d={};r.length<e;){var g=Math.floor(Math.random()*c);d[g]||(d[g]=!0,r.push(t[g]))}do{Di(e,0,p);for(var y=0;y<c;y++){for(var m=1/0,v=0,_=0;_<e;_++)(s=f?Ks(t[y],r[_]):Math.abs(t[y]-r[_]))<=m&&(m=s,v=_);a[y]=v,p[v]++}for(var w=[],b=(o=[],0);b<e;b++)w[b]=f?Di(h,0,w[b]):0,o[b]=r[b];if(f){for(var C=0;C<e;C++)r[C]=[];for(var x=0;x<c;x++)for(var E=w[a[x]],S=t[x],P=0;P<h;P++)E[P]+=S[P];u=!0;for(var M=0;M<e;M++){for(var L=r[M],I=w[M],T=o[M],N=p[M],k=0;k<h;k++)L[k]=I[k]/N||0;if(u)for(var O=0;O<h;O++)if(T[O]!=L[O]){u=!1;break}}}else{for(var D=0;D<c;D++)w[a[D]]+=t[D];for(var A=0;A<e;A++)r[A]=w[A]/p[A]||0;u=!0;for(var R=0;R<e;R++)if(o[R]!=r[R]){u=!1;break}}u=u||--l<=0}while(!u);return{it:tu-l,k:e,idxs:a,centroids:r}},nu={search:function(t,e,n,i){t.cleanDirty();var r=(i=i||{}).heuristic||nu.heuristics.manhattan,o=i.closest||!1,a=new zi(function(t){return t.f}),s=e;for(e.h=r(e,n),a.push(e);a.size()>0;){var u=a.pop();if(u===n)return Ri(u);u.closed=!0;for(var l=t.neighbors(u),c=0,h=l.length;c<h;++c){var f=l[c];if(!f.closed&&!f.isWall()){var p=u.g+f.getCost(u),d=f.visited;(!d||p<f.g)&&(f.visited=!0,f.parent=u,f.h=f.h||r(f,n),f.g=p,f.f=f.g+f.h,t.markDirty(f),o&&(f.h<s.h||f.h===s.h&&f.g<s.g)&&(s=f),d?a.rescoreElement(f):a.push(f))}}}return o?Ri(s):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(i+r)+(n-2)*Math.min(i,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};Fi.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)nu.cleanNode(this.nodes[t])},Fi.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)nu.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Fi.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Fi.prototype.neighbors=function(t){var e=[],n=t.x,i=t.y,r=this.grid;return r[n-1]&&r[n-1][i]&&e.push(r[n-1][i]),r[n+1]&&r[n+1][i]&&e.push(r[n+1][i]),r[n]&&r[n][i-1]&&e.push(r[n][i-1]),r[n]&&r[n][i+1]&&e.push(r[n][i+1]),this.diagonal&&(r[n-1]&&r[n-1][i-1]&&e.push(r[n-1][i-1]),r[n+1]&&r[n+1][i-1]&&e.push(r[n+1][i-1]),r[n-1]&&r[n-1][i+1]&&e.push(r[n-1][i+1]),r[n+1]&&r[n+1][i+1]&&e.push(r[n+1][i+1])),e},Fi.prototype.toString=function(){for(var t,e,n,i,r=[],o=this.grid,a=0,s=o.length;a<s;a++){for(t=[],n=0,i=(e=o[a]).length;n<i;n++)t.push(e[n].weight);r.push(t.join(" "))}return r.join("\n")},ji.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},ji.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},ji.prototype.isWall=function(){return 0===this.weight},zi.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,i=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[n]=e,this.content[t]=i,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],i=this.scoreFunction(n);;){var r,o=t+1<<1,a=o-1,s=null;if(a<e){var u=this.content[a];(r=this.scoreFunction(u))<i&&(s=a)}if(o<e){var l=this.content[o];this.scoreFunction(l)<(null===s?i:r)&&(s=o)}if(null===s)break;this.content[t]=this.content[s],this.content[s]=n,t=s}}};var iu=function(t){return function(){return t}};Ui.prototype={constructor:Ui,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Wi(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(qi(this,n),n=(t=n).U),n.C=!1,i.C=!0,Vi(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(Vi(this,n),n=(t=n).U),n.C=!1,i.C=!0,qi(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,a=t.R;if(n=o?a?Wi(a):o:a,r?r.L===t?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,qi(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,Vi(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,qi(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,Vi(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,qi(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,Vi(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};var ru,ou,au,su,uu,lu=[],cu=[],hu=1e-6,fu=1e-12;cr.prototype={constructor:cr,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return Qi(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,i){if(o=(r=n.halfedges).length)for(var r,o,a,s=n.site,u=-1,l=e[r[o-1]],c=l.left===s?l.right:l.left;++u<o;)a=c,c=(l=e[r[u]]).left===s?l.right:l.left,a&&c&&i<a.index&&i<c.index&&ur(s,a,c)<0&&t.push([s.data,a.data,c.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var i,r,o=this,a=o._found||0,s=o.cells.length;!(r=o.cells[a]);)if(++a>=s)return null;var u=t-r.site[0],l=e-r.site[1],c=u*u+l*l;do r=o.cells[i=a],a=null,r.halfedges.forEach(function(n){var i=o.edges[n],s=i.left;if(s!==r.site&&s||(s=i.right)){var u=t-s[0],l=e-s[1],h=u*u+l*l;h<c&&(c=h,a=s.index)}});while(null!==a);return o._found=i,null==n||c<=n*n?r.site:null}};var pu=function(){function t(t){return new cr(t.map(function(i,r){var o=[Math.round(e(i,r,t)/hu)*hu,Math.round(n(i,r,t)/hu)*hu];return o.index=r,o.data=i,o}),i)}var e=Bi,n=Gi,i=null;return t.polygons=function(e){return t(e).polygons()},t.links=function(e){return t(e).links()},t.triangles=function(e){return t(e).triangles()},t.x=function(n){return arguments.length?(e="function"==typeof n?n:iu(+n),t):e},t.y=function(e){return arguments.length?(n="function"==typeof e?e:iu(+e),t):n},t.extent=function(e){return arguments.length?(i=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],t):i&&[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},t.size=function(e){return arguments.length?(i=null==e?null:[[0,0],[+e[0],+e[1]]],t):i&&[i[1][0]-i[0][0],i[1][1]-i[0][1]]},t},du=Object.freeze({randomPosition:mr,randomPoint:vr,randomPolygon:_r,randomLineString:wr}),gu=Object.freeze({getCluster:Cr,clusterEach:xr,clusterReduce:Er,createBins:Sr,applyFilter:Pr,propertiesContainsFilter:Mr,filterProperties:Lr});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(void 0===this||null===this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments?parseInt(Number(arguments[1]),10)||0:0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var yu=function(){};yu.prototype.interfaces_=function(){return[]},yu.prototype.getClass=function(){return yu},yu.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var mu=function(){},vu=function(){},_u={MAX_VALUE:{configurable:!0}};vu.isNaN=function(t){return Number.isNaN(t)},vu.doubleToLongBits=function(t){return t},vu.longBitsToDouble=function(t){return t},vu.isInfinite=function(t){return!Number.isFinite(t)},_u.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(vu,_u);var wu=function(){},bu=function(){},Cu=function(){},xu=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},Eu={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};xu.prototype.setOrdinate=function(t,e){switch(t){case xu.X:this.x=e;break;case xu.Y:this.y=e;break;case xu.Z:this.z=e;break;default:throw new mu("Invalid ordinate index: "+t)}},xu.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!yu.equalsWithTolerance(this.x,e.x,n)&&!!yu.equalsWithTolerance(this.y,e.y,n)}},xu.prototype.getOrdinate=function(t){switch(t){case xu.X:return this.x;case xu.Y:return this.y;case xu.Z:return this.z}throw new mu("Invalid ordinate index: "+t)},xu.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||vu.isNaN(this.z))&&vu.isNaN(t.z)},xu.prototype.equals=function(t){return t instanceof xu&&this.equals2D(t)},xu.prototype.equalInZ=function(t,e){return yu.equalsWithTolerance(this.z,t.z,e)},xu.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},xu.prototype.clone=function(){},xu.prototype.copy=function(){return new xu(this)},xu.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},xu.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},xu.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},xu.prototype.hashCode=function(){var t=17;return t=37*t+xu.hashCode(this.x),t=37*t+xu.hashCode(this.y)},xu.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},xu.prototype.interfaces_=function(){return[wu,bu,Ir]},xu.prototype.getClass=function(){return xu},xu.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=vu.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},Eu.DimensionalComparator.get=function(){return Su},Eu.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},Eu.NULL_ORDINATE.get=function(){return vu.NaN},Eu.X.get=function(){return 0},Eu.Y.get=function(){return 1},Eu.Z.get=function(){return 2},Object.defineProperties(xu,Eu);var Su=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new mu("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};Su.prototype.compare=function(t,e){var n=t,i=e,r=Su.compare(n.x,i.x);if(0!==r)return r;var o=Su.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:Su.compare(n.z,i.z)},Su.prototype.interfaces_=function(){return[Cu]},Su.prototype.getClass=function(){return Su},Su.compare=function(t,e){return t<e?-1:t>e?1:vu.isNaN(t)?vu.isNaN(e)?0:-1:vu.isNaN(e)?1:0};var Pu=function(){};Pu.prototype.create=function(){},Pu.prototype.interfaces_=function(){return[]},Pu.prototype.getClass=function(){return Pu};var Mu=function(){},Lu={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Mu.prototype.interfaces_=function(){return[]},Mu.prototype.getClass=function(){return Mu},Mu.toLocationSymbol=function(t){switch(t){case Mu.EXTERIOR:return"e";case Mu.BOUNDARY:return"b";case Mu.INTERIOR:return"i";case Mu.NONE:return"-"}throw new mu("Unknown location value: "+t)},Lu.INTERIOR.get=function(){return 0},Lu.BOUNDARY.get=function(){return 1},Lu.EXTERIOR.get=function(){return 2},Lu.NONE.get=function(){return-1},Object.defineProperties(Mu,Lu);var Iu=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},Tu=function(){},Nu={LOG_10:{configurable:!0}};Tu.prototype.interfaces_=function(){return[]},Tu.prototype.getClass=function(){return Tu},Tu.log10=function(t){var e=Math.log(t);return vu.isInfinite(e)?e:vu.isNaN(e)?e:e/Tu.LOG_10},Tu.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},Tu.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:i>o?o:i}},Tu.wrap=function(t,e){return t<0?e- -t%e:t%e},Tu.max=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return e>i&&(i=e),n>i&&(i=n),i}if(4===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=r;return o>u&&(u=o),a>u&&(u=a),s>u&&(u=s),u}},Tu.average=function(t,e){return(t+e)/2},Nu.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(Tu,Nu);var ku=function(t){this.str=t};ku.prototype.append=function(t){this.str+=t},ku.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},ku.prototype.toString=function(t){return this.str};var Ou=function(t){this.value=t};Ou.prototype.intValue=function(){return this.value},Ou.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},Ou.isNaN=function(t){return Number.isNaN(t)};var Du=function(){};Du.isWhitespace=function(t){return t<=32&&t>=0||127===t},Du.toUpperCase=function(t){return t.toUpperCase()};var Au=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if("string"==typeof arguments[0]){var i=arguments[0];t.call(this,t.parse(i))}}else if(2===arguments.length){var r=arguments[0],o=arguments[1];this.init(r,o)}},Ru={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Au.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},Au.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=Au.magnitude(n._hi),r=Au.TEN.pow(i);(n=n.divide(r)).gt(Au.TEN)?(n=n.divide(Au.TEN),i+=1):n.lt(Au.ONE)&&(n=n.multiply(Au.TEN),i-=1);for(var o=i+1,a=new ku,s=Au.MAX_PRINT_DIGITS-1,u=0;u<=s;u++){t&&u===o&&a.append(".");var l=Math.trunc(n._hi);if(l<0)break;var c=!1,h=0;l>9?(c=!0,h="9"):h="0"+l,a.append(h),n=n.subtract(Au.valueOf(l)).multiply(Au.TEN),c&&n.selfAdd(Au.TEN);var f=!0,p=Au.magnitude(n._hi);if(p<0&&Math.abs(p)>=s-u&&(f=!1),!f)break}return e[0]=i,a.toString()},Au.prototype.sqr=function(){return this.multiply(this)},Au.prototype.doubleValue=function(){return this._hi+this._lo},Au.prototype.subtract=function(){if(arguments[0]instanceof Au){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},Au.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},Au.prototype.isZero=function(){return 0===this._hi&&0===this._lo},Au.prototype.selfSubtract=function(){if(arguments[0]instanceof Au){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},Au.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},Au.prototype.min=function(t){return this.le(t)?this:t},Au.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof Au){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,a=null,s=null,u=null,l=null,c=null,h=null;return u=this._hi/n,l=Au.SPLIT*u,r=l-u,h=Au.SPLIT*n,r=l-r,o=u-r,a=h-n,c=u*n,a=h-a,s=n-a,h=r*a-c+r*s+o*a+o*s,l=(this._hi-c-h+this._lo-u*i)/n,h=u+l,this._hi=h,this._lo=u-h+l,this}},Au.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},Au.prototype.divide=function(){if(arguments[0]instanceof Au){var t=arguments[0],e=null,n=null,i=null,r=null,o=null,a=null,s=null,u=null;return n=(o=this._hi/t._hi)-(e=(a=Au.SPLIT*o)-(e=a-o)),u=e*(i=(u=Au.SPLIT*t._hi)-(i=u-t._hi))-(s=o*t._hi)+e*(r=t._hi-i)+n*i+n*r,a=(this._hi-s-u+this._lo-o*t._lo)/t._hi,new Au(u=o+a,o-u+a)}if("number"==typeof arguments[0]){var l=arguments[0];return vu.isNaN(l)?Au.createNaN():Au.copy(this).selfDivide(l,0)}},Au.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},Au.prototype.pow=function(t){if(0===t)return Au.valueOf(1);var e=new Au(this),n=Au.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},Au.prototype.ceil=function(){if(this.isNaN())return Au.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new Au(t,e)},Au.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},Au.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},Au.prototype.setValue=function(){if(arguments[0]instanceof Au){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},Au.prototype.max=function(t){return this.ge(t)?this:t},Au.prototype.sqrt=function(){if(this.isZero())return Au.valueOf(0);if(this.isNegative())return Au.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=Au.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},Au.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof Au){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,o=null,a=null,s=null;return r=this._hi+e,a=r-this._hi,o=r-a,o=e-a+(this._hi-o),s=o+this._lo,n=r+s,i=s+(r-n),this._hi=n+i,this._lo=i+(n-this._hi),this}}else if(2===arguments.length){var u=arguments[0],l=arguments[1],c=null,h=null,f=null,p=null,d=null,g=null,y=null;p=this._hi+u,h=this._lo+l,d=p-(g=p-this._hi),f=h-(y=h-this._lo);var m=(c=p+(g=(d=u-g+(this._hi-d))+h))+(g=(f=l-y+(this._lo-f))+(g+(p-c))),v=g+(c-m);return this._hi=m,this._lo=v,this}},Au.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof Au){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=null,o=null,a=null,s=null,u=null,l=null;r=(u=Au.SPLIT*this._hi)-this._hi,l=Au.SPLIT*n,r=u-r,o=this._hi-r,a=l-n;var c=(u=this._hi*n)+(l=r*(a=l-a)-u+r*(s=n-a)+o*a+o*s+(this._hi*i+this._lo*n)),h=l+(r=u-c);return this._hi=c,this._lo=h,this}},Au.prototype.selfSqr=function(){return this.selfMultiply(this)},Au.prototype.floor=function(){if(this.isNaN())return Au.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new Au(t,e)},Au.prototype.negate=function(){return this.isNaN()?this:new Au(-this._hi,-this._lo)},Au.prototype.clone=function(){},Au.prototype.multiply=function(){if(arguments[0]instanceof Au){var t=arguments[0];return t.isNaN()?Au.createNaN():Au.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return vu.isNaN(e)?Au.createNaN():Au.copy(this).selfMultiply(e,0)}},Au.prototype.isNaN=function(){return vu.isNaN(this._hi)},Au.prototype.intValue=function(){return Math.trunc(this._hi)},Au.prototype.toString=function(){var t=Au.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},Au.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+Au.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+Au.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},Au.prototype.reciprocal=function(){var t=null,e=null,n=null,i=null,r=null,o=null,a=null,s=null;e=(r=1/this._hi)-(t=(o=Au.SPLIT*r)-(t=o-r)),n=(s=Au.SPLIT*this._hi)-this._hi;var u=r+(o=(1-(a=r*this._hi)-(s=t*(n=s-n)-a+t*(i=this._hi-n)+e*n+e*i)-r*this._lo)/this._hi);return new Au(u,r-u+o)},Au.prototype.toSciNotation=function(){if(this.isZero())return Au.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=Au.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},Au.prototype.abs=function(){return this.isNaN()?Au.NaN:this.isNegative()?this.negate():new Au(this)},Au.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},Au.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},Au.prototype.add=function(){if(arguments[0]instanceof Au){var t=arguments[0];return Au.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return Au.copy(this).selfAdd(e)}},Au.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof Au){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},Au.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},Au.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},Au.prototype.trunc=function(){return this.isNaN()?Au.NaN:this.isPositive()?this.floor():this.ceil()},Au.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},Au.prototype.interfaces_=function(){return[Ir,wu,bu]},Au.prototype.getClass=function(){return Au},Au.sqr=function(t){return Au.valueOf(t).selfMultiply(t)},Au.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return Au.parse(t)}if("number"==typeof arguments[0]){var e=arguments[0];return new Au(e)}},Au.sqrt=function(t){return Au.valueOf(t).sqrt()},Au.parse=function(t){for(var e=0,n=t.length;Du.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new Au,a=0,s=0,u=0;!(e>=n);){var l=t.charAt(e);if(e++,Du.isDigit(l)){var c=l-"0";o.selfMultiply(Au.TEN),o.selfAdd(c),a++}else{if("."!==l){if("e"===l||"E"===l){var h=t.substring(e);try{u=Ou.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+l+"' at position "+e+" in string "+t)}s=a}}var f=o,p=a-s-u;if(0===p)f=o;else if(p>0){var d=Au.TEN.pow(p);f=o.divide(d)}else if(p<0){var g=Au.TEN.pow(-p);f=o.multiply(g)}return i?f.negate():f},Au.createNaN=function(){return new Au(vu.NaN,vu.NaN)},Au.copy=function(t){return new Au(t)},Au.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},Au.stringOfChar=function(t,e){for(var n=new ku,i=0;i<e;i++)n.append(t);return n.toString()},Ru.PI.get=function(){return new Au(3.141592653589793,1.2246467991473532e-16)},Ru.TWO_PI.get=function(){return new Au(6.283185307179586,2.4492935982947064e-16)},Ru.PI_2.get=function(){return new Au(1.5707963267948966,6.123233995736766e-17)},Ru.E.get=function(){return new Au(2.718281828459045,1.4456468917292502e-16)},Ru.NaN.get=function(){return new Au(vu.NaN,vu.NaN)},Ru.EPS.get=function(){return 1.23259516440783e-32},Ru.SPLIT.get=function(){return 134217729},Ru.MAX_PRINT_DIGITS.get=function(){return 32},Ru.TEN.get=function(){return Au.valueOf(10)},Ru.ONE.get=function(){return Au.valueOf(1)},Ru.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},Ru.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(Au,Ru);var Fu=function(){},ju={DP_SAFE_EPSILON:{configurable:!0}};Fu.prototype.interfaces_=function(){return[]},Fu.prototype.getClass=function(){return Fu},Fu.orientationIndex=function(t,e,n){var i=Fu.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=Au.valueOf(e.x).selfAdd(-t.x),o=Au.valueOf(e.y).selfAdd(-t.y),a=Au.valueOf(n.x).selfAdd(-e.x),s=Au.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(s).selfSubtract(o.selfMultiply(a)).signum()},Fu.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},Fu.intersection=function(t,e,n,i){var r=Au.valueOf(i.y).selfSubtract(n.y).selfMultiply(Au.valueOf(e.x).selfSubtract(t.x)),o=Au.valueOf(i.x).selfSubtract(n.x).selfMultiply(Au.valueOf(e.y).selfSubtract(t.y)),a=r.subtract(o),s=Au.valueOf(i.x).selfSubtract(n.x).selfMultiply(Au.valueOf(t.y).selfSubtract(n.y)),u=Au.valueOf(i.y).selfSubtract(n.y).selfMultiply(Au.valueOf(t.x).selfSubtract(n.x)),l=s.subtract(u).selfDivide(a).doubleValue(),c=Au.valueOf(t.x).selfAdd(Au.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),h=Au.valueOf(e.x).selfSubtract(t.x).selfMultiply(Au.valueOf(t.y).selfSubtract(n.y)),f=Au.valueOf(e.y).selfSubtract(t.y).selfMultiply(Au.valueOf(t.x).selfSubtract(n.x)),p=h.subtract(f).selfDivide(a).doubleValue(),d=Au.valueOf(n.y).selfAdd(Au.valueOf(i.y).selfSubtract(n.y).selfMultiply(p)).doubleValue();return new xu(c,d)},Fu.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),a=r-o;if(r>0){if(o<=0)return Fu.signum(a);i=r+o}else{if(!(r<0))return Fu.signum(a);if(o>=0)return Fu.signum(a);i=-r-o}var s=Fu.DP_SAFE_EPSILON*i;return a>=s||-a>=s?Fu.signum(a):2},Fu.signum=function(t){return t>0?1:t<0?-1:0},ju.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(Fu,ju);var zu=function(){},Bu={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};Bu.X.get=function(){return 0},Bu.Y.get=function(){return 1},Bu.Z.get=function(){return 2},Bu.M.get=function(){return 3},zu.prototype.setOrdinate=function(t,e,n){},zu.prototype.size=function(){},zu.prototype.getOrdinate=function(t,e){},zu.prototype.getCoordinate=function(){},zu.prototype.getCoordinateCopy=function(t){},zu.prototype.getDimension=function(){},zu.prototype.getX=function(t){},zu.prototype.clone=function(){},zu.prototype.expandEnvelope=function(t){},zu.prototype.copy=function(){},zu.prototype.getY=function(t){},zu.prototype.toCoordinateArray=function(){},zu.prototype.interfaces_=function(){return[bu]},zu.prototype.getClass=function(){return zu},Object.defineProperties(zu,Bu);var Gu=function(){},Uu=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Gu),Hu=function(){};Hu.arraycopy=function(t,e,n,i,r){for(var o=0,a=e;a<e+r;a++)n[i+o]=t[a],o++},Hu.getProperty=function(t){return{"line.separator":"\n"}[t]};var qu=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof xu&&arguments[1]instanceof xu){var a=arguments[0],s=arguments[1];this.x=a.y-s.y,this.y=s.x-a.x,this.w=a.x*s.y-s.x*a.y}}else if(3===arguments.length){var u=arguments[0],l=arguments[1],c=arguments[2];this.x=u,this.y=l,this.w=c}else if(4===arguments.length){var h=arguments[0],f=arguments[1],p=arguments[2],d=arguments[3],g=h.y-f.y,y=f.x-h.x,m=h.x*f.y-f.x*h.y,v=p.y-d.y,_=d.x-p.x,w=p.x*d.y-d.x*p.y;this.x=y*w-_*m,this.y=v*m-g*w,this.w=g*_-v*y}};qu.prototype.getY=function(){var t=this.y/this.w;if(vu.isNaN(t)||vu.isInfinite(t))throw new Uu;return t},qu.prototype.getX=function(){var t=this.x/this.w;if(vu.isNaN(t)||vu.isInfinite(t))throw new Uu;return t},qu.prototype.getCoordinate=function(){var t=new xu;return t.x=this.getX(),t.y=this.getY(),t},qu.prototype.interfaces_=function(){return[]},qu.prototype.getClass=function(){return qu},qu.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,a=t.x*e.y-e.x*t.y,s=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,c=r*u-s*o,h=(o*l-u*a)/c,f=(s*a-r*l)/c;if(vu.isNaN(h)||vu.isInfinite(h)||vu.isNaN(f)||vu.isInfinite(f))throw new Uu;return new xu(h,f)};var Vu=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof xu){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3];this.init(o,a,s,u)}},Wu={serialVersionUID:{configurable:!0}};Vu.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Vu.prototype.equals=function(t){if(!(t instanceof Vu))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Vu.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Vu;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Vu(e,i,n,r)},Vu.prototype.isNull=function(){return this._maxx<this._minx},Vu.prototype.getMaxX=function(){return this._maxx},Vu.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof xu){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof Vu){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},Vu.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof Vu){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof xu){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];
return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},Vu.prototype.getMinY=function(){return this._miny},Vu.prototype.getMinX=function(){return this._minx},Vu.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof xu){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Vu){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},Vu.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Vu.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Vu.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Vu.prototype.translate=function(t,e){return this.isNull()?null:void this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Vu.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Vu.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Vu.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Vu.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},Vu.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Vu.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof Vu){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof xu){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},Vu.prototype.centre=function(){return this.isNull()?null:new xu((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Vu.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof xu){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Vu){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),a<s?(this._miny=a,this._maxy=s):(this._miny=s,this._maxy=a)}},Vu.prototype.getMaxY=function(){return this._maxy},Vu.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},Vu.prototype.hashCode=function(){var t=17;return t=37*t+xu.hashCode(this._minx),t=37*t+xu.hashCode(this._maxx),t=37*t+xu.hashCode(this._miny),t=37*t+xu.hashCode(this._maxy)},Vu.prototype.interfaces_=function(){return[wu,Ir]},Vu.prototype.getClass=function(){return Vu},Vu.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],a=arguments[3],s=Math.min(o.x,a.x),u=Math.max(o.x,a.x),l=Math.min(i.x,r.x),c=Math.max(i.x,r.x);return!(l>u||c<s||(s=Math.min(o.y,a.y),u=Math.max(o.y,a.y),l=Math.min(i.y,r.y),c=Math.max(i.y,r.y),l>u||c<s))}},Wu.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Vu,Wu);var Yu={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Xu=function(t){this.geometryFactory=t||new mc};Xu.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=Yu.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Yu.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Ju[n]&&(e=Ju[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Xu.prototype.write=function(t){return this.extractGeometry(t)},Xu.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Zu[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Zu[e].apply(this,[t])+")"};var Zu={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Zu.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Zu.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Zu.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Zu.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Zu.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Zu.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+Zu.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Zu.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Ju={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Yu.spaces);return this.geometryFactory.createPoint(new xu(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Yu.trimParens,"$1"),i.push(Ju.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Yu.spaces),i.push(new xu(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Yu.spaces),i.push(new xu(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(Yu.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Yu.trimParens,"$1"),i.push(Ju.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(Yu.parenComma),a=[],s=0,u=o.length;s<u;++s)e=o[s].replace(Yu.trimParens,"$1"),n=Ju.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===s?r=i:a.push(i);return this.geometryFactory.createPolygon(r,a)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(Yu.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Yu.trimParens,"$1"),i.push(Ju.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},Ku=function(t){this.parser=new Xu(t)};Ku.prototype.write=function(t){return this.parser.write(t)},Ku.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var $u=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),Qu=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($u),tl=function(){};tl.prototype.interfaces_=function(){return[]},tl.prototype.getClass=function(){return tl},tl.shouldNeverReachHere=function(){if(0===arguments.length)tl.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new Qu("Should never reach here"+(null!==t?": "+t:""))}},tl.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],tl.isTrue(t,null);else if(2===arguments.length&&(t=arguments[0],e=arguments[1],!t))throw null===e?new Qu:new Qu(e)},tl.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],tl.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],e=arguments[1],n=arguments[2],!e.equals(t)))throw new Qu("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var el=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new xu,this._intPt[1]=new xu,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},nl={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};el.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},el.prototype.getTopologySummary=function(){var t=new ku;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},el.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},el.prototype.getIntersectionNum=function(){return this._result},el.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},el.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},el.prototype.setPrecisionModel=function(t){this._precisionModel=t},el.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},el.prototype.getIntersection=function(t){return this._intPt[t]},el.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},el.prototype.hasIntersection=function(){return this._result!==el.NO_INTERSECTION},el.prototype.getEdgeDistance=function(t,e){return el.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},el.prototype.isCollinear=function(){return this._result===el.COLLINEAR_INTERSECTION},el.prototype.toString=function(){return Ku.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Ku.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},el.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},el.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},el.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},el.prototype.interfaces_=function(){return[]},el.prototype.getClass=function(){return el},el.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var a=Math.abs(t.x-e.x),s=Math.abs(t.y-e.y);0!==(o=i>r?a:s)||t.equals(e)||(o=Math.max(a,s))}return tl.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},el.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return tl.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},nl.DONT_INTERSECT.get=function(){return 0},nl.DO_INTERSECT.get=function(){return 1},nl.COLLINEAR.get=function(){return 2},nl.NO_INTERSECTION.get=function(){return 0},nl.POINT_INTERSECTION.get=function(){return 1},nl.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(el,nl);var il=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new Vu(this._inputLines[0][0],this._inputLines[0][1]),n=new Vu(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2];return this._isProper=!1,Vu.intersects(n,i,e)&&0===al.orientationIndex(n,i,e)&&0===al.orientationIndex(i,n,e)?(this._isProper=!0,(e.equals(n)||e.equals(i))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null):void(this._result=t.NO_INTERSECTION)},e.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,n,i,r){var o=null;try{o=qu.intersection(t,n,i,r)}catch(a){if(!(a instanceof Uu))throw a;o=e.nearestEndpoint(t,n,i,r)}return o},e.prototype.intersection=function(t,n,i,r){var o=this.intersectionWithNormalization(t,n,i,r);return this.isInSegmentEnvelopes(o)||(o=new xu(e.nearestEndpoint(t,n,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},e.prototype.checkDD=function(t,e,n,i,r){var o=Fu.intersection(t,e,n,i),a=this.isInSegmentEnvelopes(o);Hu.out.println("DD in env = "+a+"  --------------------- "+o),r.distance(o)>1e-4&&Hu.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new xu(t),o=new xu(e),a=new xu(n),s=new xu(i),u=new xu;this.normalizeToEnvCentre(r,o,a,s,u);var l=this.safeHCoordinateIntersection(r,o,a,s);return l.x+=u.x,l.y+=u.y,l},e.prototype.computeCollinearIntersection=function(e,n,i,r){var o=Vu.intersects(e,n,i),a=Vu.intersects(e,n,r),s=Vu.intersects(i,r,e),u=Vu.intersects(i,r,n);return o&&a?(this._intPt[0]=i,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):s&&u?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&s?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||a||u?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&u?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||a||s?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):a&&s?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||u?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):a&&u?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||o||s?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,a=t.y<e.y?t.y:e.y,s=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,p=((o>l?o:l)+(s<h?s:h))/2,d=((a>c?a:c)+(u<f?u:f))/2;r.x=p,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.computeIntersect=function(e,n,i,r){if(this._isProper=!1,!Vu.intersects(e,n,i,r))return t.NO_INTERSECTION;var o=al.orientationIndex(e,n,i),a=al.orientationIndex(e,n,r);if(o>0&&a>0||o<0&&a<0)return t.NO_INTERSECTION;var s=al.orientationIndex(i,r,e),u=al.orientationIndex(i,r,n);return s>0&&u>0||s<0&&u<0?t.NO_INTERSECTION:0===o&&0===a&&0===s&&0===u?this.computeCollinearIntersection(e,n,i,r):(0===o||0===a||0===s||0===u?(this._isProper=!1,e.equals2D(i)||e.equals2D(r)?this._intPt[0]=e:n.equals2D(i)||n.equals2D(r)?this._intPt[0]=n:0===o?this._intPt[0]=new xu(i):0===a?this._intPt[0]=new xu(r):0===s?this._intPt[0]=new xu(e):0===u&&(this._intPt[0]=new xu(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,i,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,i){var r=t,o=al.distancePointLine(t,n,i),a=al.distancePointLine(e,n,i);return a<o&&(o=a,r=e),(a=al.distancePointLine(n,t,e))<o&&(o=a,r=n),(a=al.distancePointLine(i,t,e))<o&&(o=a,r=i),r},e}(el),rl=function(){};rl.prototype.interfaces_=function(){return[]},rl.prototype.getClass=function(){return rl},rl.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,a=n.y-e.y;return rl.signOfDet2x2(i,r,o,a)},rl.signOfDet2x2=function(t,e,n,i){var r=null,o=null,a=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):e<=-i?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(t<=n))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if(a=Math.floor(n/t),n-=a*t,(i-=a*e)<0)return-r;if(i>e)return r;if(t>n+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(a=Math.floor(t/n),t-=a*n,(e-=a*i)<0)return r;if(e>i)return-r;if(n>t+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var ol=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};ol.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,a=e.x-this._p.x,s=e.y-this._p.y,u=rl.signOfDet2x2(r,o,a,s);if(0===u)return this._isPointOnSegment=!0,null;s<o&&(u=-u),u>0&&this._crossingCount++}},ol.prototype.isPointInPolygon=function(){return this.getLocation()!==Mu.EXTERIOR},ol.prototype.getLocation=function(){return this._isPointOnSegment?Mu.BOUNDARY:this._crossingCount%2==1?Mu.INTERIOR:Mu.EXTERIOR},ol.prototype.isOnSegment=function(){return this._isPointOnSegment},ol.prototype.interfaces_=function(){return[]},ol.prototype.getClass=function(){return ol},ol.locatePointInRing=function(){if(arguments[0]instanceof xu&&Iu(arguments[1],zu)){for(var t=arguments[0],e=arguments[1],n=new ol(t),i=new xu,r=new xu,o=1;o<e.size();o++)if(e.getCoordinate(o,i),e.getCoordinate(o-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof xu&&arguments[1]instanceof Array){for(var a=arguments[0],s=arguments[1],u=new ol(a),l=1;l<s.length;l++){var c=s[l],h=s[l-1];if(u.countSegment(c,h),u.isOnSegment())return u.getLocation()}return u.getLocation()}};var al=function(){},sl={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};al.prototype.interfaces_=function(){return[]},al.prototype.getClass=function(){return al},al.orientationIndex=function(t,e,n){return Fu.orientationIndex(t,e,n)},al.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(Iu(arguments[0],zu)){var a=arguments[0],s=a.size();if(s<3)return 0;var u=new xu,l=new xu,c=new xu;a.getCoordinate(0,l),a.getCoordinate(1,c);var h=l.x;c.x-=h;for(var f=0,p=1;p<s-1;p++)u.y=l.y,l.x=c.x,l.y=c.y,a.getCoordinate(p+1,c),c.x-=h,f+=l.x*(u.y-c.y);return f/2}},al.distanceLineLine=function(t,e,n,i){if(t.equals(e))return al.distancePointLine(t,n,i);if(n.equals(i))return al.distancePointLine(i,t,e);var r=!1;if(Vu.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var a=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),s=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=a/o;(u<0||u>1||s<0||s>1)&&(r=!0)}}else r=!0;return r?Tu.min(al.distancePointLine(t,n,i),al.distancePointLine(e,n,i),al.distancePointLine(n,t,e),al.distancePointLine(i,t,e)):0},al.isPointInRing=function(t,e){return al.locatePointInRing(t,e)!==Mu.EXTERIOR},al.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new xu;t.getCoordinate(0,i);for(var r=i.x,o=i.y,a=1;a<e;a++){t.getCoordinate(a,i);var s=i.x,u=i.y,l=s-r,c=u-o;n+=Math.sqrt(l*l+c*c),r=s,o=u}return n},al.isCCW=function(t){var e=t.length-1;if(e<3)throw new mu("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}var a=i;do(a-=1)<0&&(a=e);while(t[a].equals2D(n)&&a!==i);var s=i;do s=(s+1)%e;while(t[s].equals2D(n)&&s!==i);var u=t[a],l=t[s];if(u.equals2D(n)||l.equals2D(n)||u.equals2D(l))return!1;var c=al.computeOrientation(u,n,l),h=!1;return h=0===c?u.x>l.x:c>0},al.locatePointInRing=function(t,e){return ol.locatePointInRing(t,e)},al.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},al.computeOrientation=function(t,e,n){return al.orientationIndex(t,e,n)},al.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new mu("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=al.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];if(a.x===s.x&&a.y===s.y)return o.distance(a);var u=(s.x-a.x)*(s.x-a.x)+(s.y-a.y)*(s.y-a.y),l=((o.x-a.x)*(s.x-a.x)+(o.y-a.y)*(s.y-a.y))/u;if(l<=0)return o.distance(a);if(l>=1)return o.distance(s);var c=((a.y-o.y)*(s.x-a.x)-(a.x-o.x)*(s.y-a.y))/u;return Math.abs(c)*Math.sqrt(u)}},al.isOnLine=function(t,e){for(var n=new il,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},sl.CLOCKWISE.get=function(){return-1},sl.RIGHT.get=function(){return al.CLOCKWISE},sl.COUNTERCLOCKWISE.get=function(){return 1},sl.LEFT.get=function(){return al.COUNTERCLOCKWISE},sl.COLLINEAR.get=function(){return 0},sl.STRAIGHT.get=function(){return al.COLLINEAR},Object.defineProperties(al,sl);var ul=function(){};ul.prototype.filter=function(t){},ul.prototype.interfaces_=function(){return[]},ul.prototype.getClass=function(){return ul};var ll=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},cl={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ll.prototype.isGeometryCollection=function(){return this.getSortIndex()===ll.SORTINDEX_GEOMETRYCOLLECTION},ll.prototype.getFactory=function(){return this._factory},ll.prototype.getGeometryN=function(t){return this},ll.prototype.getArea=function(){return 0},ll.prototype.isRectangle=function(){return!1},ll.prototype.equals=function(){if(arguments[0]instanceof ll){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ll))return!1;var n=e;return this.equalsExact(n)}},ll.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ll.prototype.geometryChanged=function(){this.apply(ll.geometryChangedFilter)},ll.prototype.geometryChangedAction=function(){this._envelope=null},ll.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ll.prototype.getLength=function(){return 0},ll.prototype.getNumGeometries=function(){return 1},ll.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},ll.prototype.getUserData=function(){return this._userData},ll.prototype.getSRID=function(){return this._SRID},ll.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ll.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ll.SORTINDEX_GEOMETRYCOLLECTION)throw new mu("This method does not support GeometryCollection arguments")},ll.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ll.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ll.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ll.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Vu(this._envelope)},ll.prototype.setSRID=function(t){this._SRID=t},ll.prototype.setUserData=function(t){this._userData=t},ll.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),a=r.compareTo(o);if(0!==a)return a}return n.hasNext()?1:i.hasNext()?-1:0},ll.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ll.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ll.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ll.SORTINDEX_MULTIPOINT||this.getSortIndex()===ll.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ll.SORTINDEX_MULTIPOLYGON},ll.prototype.interfaces_=function(){return[bu,wu,Ir]},ll.prototype.getClass=function(){return ll},ll.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ll.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},cl.serialVersionUID.get=function(){return 0x799ea46522854c00},cl.SORTINDEX_POINT.get=function(){return 0},cl.SORTINDEX_MULTIPOINT.get=function(){return 1},cl.SORTINDEX_LINESTRING.get=function(){return 2},cl.SORTINDEX_LINEARRING.get=function(){return 3},cl.SORTINDEX_MULTILINESTRING.get=function(){return 4},cl.SORTINDEX_POLYGON.get=function(){return 5},cl.SORTINDEX_MULTIPOLYGON.get=function(){return 6},cl.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},cl.geometryChangedFilter.get=function(){return hl},Object.defineProperties(ll,cl);var hl=function(){};hl.interfaces_=function(){return[ul]},hl.filter=function(t){t.geometryChangedAction()};var fl=function(){};fl.prototype.filter=function(t){},fl.prototype.interfaces_=function(){return[]},fl.prototype.getClass=function(){return fl};var pl=function(){},dl={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};pl.prototype.isInBoundary=function(t){},pl.prototype.interfaces_=function(){return[]},pl.prototype.getClass=function(){return pl},dl.Mod2BoundaryNodeRule.get=function(){return gl},dl.EndPointBoundaryNodeRule.get=function(){return yl},dl.MultiValentEndPointBoundaryNodeRule.get=function(){return ml},dl.MonoValentEndPointBoundaryNodeRule.get=function(){return vl},dl.MOD2_BOUNDARY_RULE.get=function(){return new gl},dl.ENDPOINT_BOUNDARY_RULE.get=function(){return new yl},dl.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new ml},dl.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vl},dl.OGC_SFS_BOUNDARY_RULE.get=function(){return pl.MOD2_BOUNDARY_RULE},Object.defineProperties(pl,dl);var gl=function(){};gl.prototype.isInBoundary=function(t){return t%2==1},gl.prototype.interfaces_=function(){return[pl]},gl.prototype.getClass=function(){return gl};var yl=function(){};yl.prototype.isInBoundary=function(t){return t>0},yl.prototype.interfaces_=function(){return[pl]},yl.prototype.getClass=function(){return yl};var ml=function(){};ml.prototype.isInBoundary=function(t){return t>1},ml.prototype.interfaces_=function(){return[pl]},ml.prototype.getClass=function(){return ml};var vl=function(){};vl.prototype.isInBoundary=function(t){return 1===t},vl.prototype.interfaces_=function(){return[pl]},vl.prototype.getClass=function(){return vl};var _l=function(){};_l.prototype.add=function(){},_l.prototype.addAll=function(){},_l.prototype.isEmpty=function(){},_l.prototype.iterator=function(){},_l.prototype.size=function(){},_l.prototype.toArray=function(){},_l.prototype.remove=function(){};var wl=function(t){function e(e){t.call(this),this.message=e||""}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(e,n),e}(Error),bl=function(){};bl.prototype.hasNext=function(){},bl.prototype.next=function(){},bl.prototype.remove=function(){};var Cl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(_l);(Tr.prototype=new Error).name="NoSuchElementException";var xl=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof _l&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),
e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,_l]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new El(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new wl;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(Cl),El=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new Tr;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(bl),Sl=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.ensureCapacity(n.length),this.add(n,i)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=!1,r=e.iterator();r.hasNext();)this.add(r.next(),n),i=!0;return i}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return this.add(n,i,!0),!0}if(arguments[0]instanceof xu&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];return this.add(o,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var s=arguments[0],u=arguments[1];if(arguments[2])for(var l=0;l<s.length;l++)this.add(s[l],u);else for(var c=s.length-1;c>=0;c--)this.add(s[c],u);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof xu){var h=arguments[0],f=arguments[1];if(!arguments[2]){var p=this.size();if(p>0){if(h>0&&this.get(h-1).equals2D(f))return null;if(h<p&&this.get(h).equals2D(f))return null}}t.prototype.add.call(this,h,f)}}else if(4===arguments.length){var d=arguments[0],g=arguments[1],y=arguments[2],m=arguments[3],v=1;y>m&&(v=-1);for(var _=y;_!==m;_+=v)this.add(d[_],g);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new xu(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(xl),Pl=function(){},Ml={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Ml.ForwardComparator.get=function(){return Ll},Ml.BidirectionalComparator.get=function(){return Il},Ml.coordArrayType.get=function(){return new Array(0).fill(null)},Pl.prototype.interfaces_=function(){return[]},Pl.prototype.getClass=function(){return Pl},Pl.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Pl.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Pl.indexOf(i,e)<0)return i}return null},Pl.scroll=function(t,e){var n=Pl.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);Hu.arraycopy(t,n,i,0,t.length-n),Hu.arraycopy(t,0,i,t.length-n,n),Hu.arraycopy(i,0,t,0,t.length)},Pl.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var a=0;a<i.length;a++)if(0!==o.compare(i[a],r[a]))return!1;return!0}},Pl.intersection=function(t,e){for(var n=new Sl,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Pl.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Pl.removeRepeatedPoints=function(t){return Pl.hasRepeatedPoints(t)?new Sl(t,!1).toCoordinateArray():t},Pl.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Pl.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Pl.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new xu(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],a=arguments[3],s=arguments[4],u=0;u<s;u++)o[a+u]=new xu(i[r+u])},Pl.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Pl.envelope=function(t){for(var e=new Vu,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Pl.toCoordinateArray=function(t){return t.toArray(Pl.coordArrayType)},Pl.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Pl.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Pl.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Pl.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Pl.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Pl.extract=function(t,e,n){e=Tu.clamp(e,0,t.length);var i=(n=Tu.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,a=e;a<=n;a++)r[o++]=t[a];return r},Object.defineProperties(Pl,Ml);var Ll=function(){};Ll.prototype.compare=function(t,e){return Pl.compare(t,e)},Ll.prototype.interfaces_=function(){return[Cu]},Ll.prototype.getClass=function(){return Ll};var Il=function(){};Il.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Pl.compare(n,i);return Pl.isEqualReversed(n,i)?0:r},Il.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Pl.increasingDirection(n),o=Pl.increasingDirection(i),a=r>0?0:n.length-1,s=o>0?0:n.length-1,u=0;u<n.length;u++){var l=n[a].compareTo(i[s]);if(0!==l)return l;a+=r,s+=o}return 0},Il.prototype.interfaces_=function(){return[Cu]},Il.prototype.getClass=function(){return Il};var Tl=function(){};Tl.prototype.get=function(){},Tl.prototype.put=function(){},Tl.prototype.size=function(){},Tl.prototype.values=function(){},Tl.prototype.entrySet=function(){};var Nl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Tl);(Nr.prototype=new Error).name="OperationNotSupported",(kr.prototype=new _l).contains=function(){};var kl=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof _l&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Ol(this)},e}(kr),Ol=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new Tr;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new Nr},e}(bl),Dl=0;(jr.prototype=new Nl).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},jr.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Dl,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}while(null!==r);var a={key:t,left:null,right:null,value:e,parent:n,color:Dl,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=a:n.right=a,this.fixAfterInsertion(a),this.size_++,null},jr.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(Dr(t)===Rr(Dr(Dr(t)))){var e=Fr(Dr(Dr(t)));1===Or(e)?(Ar(Dr(t),Dl),Ar(e,Dl),Ar(Dr(Dr(t)),1),t=Dr(Dr(t))):(t===Fr(Dr(t))&&(t=Dr(t),this.rotateLeft(t)),Ar(Dr(t),Dl),Ar(Dr(Dr(t)),1),this.rotateRight(Dr(Dr(t))))}else{var n=Rr(Dr(Dr(t)));1===Or(n)?(Ar(Dr(t),Dl),Ar(n,Dl),Ar(Dr(Dr(t)),1),t=Dr(Dr(t))):(t===Rr(Dr(t))&&(t=Dr(t),this.rotateRight(t)),Ar(Dr(t),Dl),Ar(Dr(Dr(t)),1),this.rotateLeft(Dr(Dr(t))))}this.root_.color=Dl},jr.prototype.values=function(){var t=new xl,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=jr.successor(e));)t.add(e.value);return t},jr.prototype.entrySet=function(){var t=new kl,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=jr.successor(e));)t.add(e);return t},jr.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},jr.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},jr.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},jr.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)i=n,n=n.parent;return n},jr.prototype.size=function(){return this.size_};var Al=function(){};Al.prototype.interfaces_=function(){return[]},Al.prototype.getClass=function(){return Al},zr.prototype=new kr,(Br.prototype=new zr).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},Br.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},Br.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Br.prototype.remove=function(t){throw new Nr},Br.prototype.size=function(){return this.array_.length},Br.prototype.isEmpty=function(){return 0===this.array_.length},Br.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Br.prototype.iterator=function(){return new Rl(this)};var Rl=function(t){this.treeSet_=t,this.position_=0};Rl.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new Tr;return this.treeSet_.array_[this.position_++]},Rl.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Rl.prototype.remove=function(){throw new Nr};var Fl=function(){};Fl.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},Fl.asList=function(t){for(var e=new xl,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var jl=function(){},zl={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};zl.P.get=function(){return 0},zl.L.get=function(){return 1},zl.A.get=function(){return 2},zl.FALSE.get=function(){return-1},zl.TRUE.get=function(){return-2},zl.DONTCARE.get=function(){return-3},zl.SYM_FALSE.get=function(){return"F"},zl.SYM_TRUE.get=function(){return"T"},zl.SYM_DONTCARE.get=function(){return"*"},zl.SYM_P.get=function(){return"0"},zl.SYM_L.get=function(){return"1"},zl.SYM_A.get=function(){return"2"},jl.prototype.interfaces_=function(){return[]},jl.prototype.getClass=function(){return jl},jl.toDimensionSymbol=function(t){switch(t){case jl.FALSE:return jl.SYM_FALSE;case jl.TRUE:return jl.SYM_TRUE;case jl.DONTCARE:return jl.SYM_DONTCARE;case jl.P:return jl.SYM_P;case jl.L:return jl.SYM_L;case jl.A:return jl.SYM_A}throw new mu("Unknown dimension value: "+t)},jl.toDimensionValue=function(t){switch(Du.toUpperCase(t)){case jl.SYM_FALSE:return jl.FALSE;case jl.SYM_TRUE:return jl.TRUE;case jl.SYM_DONTCARE:return jl.DONTCARE;case jl.SYM_P:return jl.P;case jl.SYM_L:return jl.L;case jl.SYM_A:return jl.A}throw new mu("Unknown dimension symbol: "+t)},Object.defineProperties(jl,zl);var Bl=function(){};Bl.prototype.filter=function(t){},Bl.prototype.interfaces_=function(){return[]},Bl.prototype.getClass=function(){return Bl};var Gl=function(){};Gl.prototype.filter=function(t,e){},Gl.prototype.isDone=function(){},Gl.prototype.isGeometryChanged=function(){},Gl.prototype.interfaces_=function(){return[]},Gl.prototype.getClass=function(){return Gl};var Ul=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new mu("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new Vu,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._geometries.length!==i._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(i._geometries[r],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Fl.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=jl.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=jl.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new Br(Fl.asList(this._geometries)),n=new Br(Fl.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o=i,a=this.getNumGeometries(),s=o.getNumGeometries(),u=0;u<a&&u<s;){var l=this.getGeometryN(u),c=o.getGeometryN(u),h=l.compareToSameClass(c,r);if(0!==h)return h;u++}return u<a?1:u<s?-1:0}},e.prototype.apply=function(){if(Iu(arguments[0],fl))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(Iu(arguments[0],Gl)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(Iu(arguments[0],Bl)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(Iu(arguments[0],ul)){var a=arguments[0];a.filter(this);for(var s=0;s<this._geometries.length;s++)this._geometries[s].apply(a)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),tl.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(ll),Hl=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ll.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?jl.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new ql(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Al]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Ul),ql=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=pl.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};ql.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},ql.prototype.getBoundary=function(){return this._geom instanceof Zl?this.boundaryLineString(this._geom):this._geom instanceof Hl?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},ql.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},ql.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},ql.prototype.computeBoundaryCoordinates=function(t){var e=new xl;this._endpointMap=new jr;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),a=o.getValue().count;this._bnRule.isInBoundary(a)&&e.add(o.getKey())}return Pl.toCoordinateArray(e)},ql.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Vl,this._endpointMap.put(t,e)),e.count++},ql.prototype.interfaces_=function(){return[]},ql.prototype.getClass=function(){return ql},ql.getBoundary=function(){if(1===arguments.length){var t=arguments[0];return new ql(t).getBoundary()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new ql(e,n).getBoundary()}};var Vl=function(){this.count=null};Vl.prototype.interfaces_=function(){return[]},Vl.prototype.getClass=function(){return Vl};var Wl=function(){},Yl={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Wl.prototype.interfaces_=function(){return[]},Wl.prototype.getClass=function(){return Wl},Wl.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},Wl.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",a=new function(){}(new function(){}(Wl.getStackTrace(i))),s=0;s<r;s++)try{o+=a.readLine()+Wl.NEWLINE}catch(t){if(!(t instanceof Gr))throw t;tl.shouldNeverReachHere()}return o}},Wl.split=function(t,e){for(var n=e.length,i=new xl,r=""+t,o=r.indexOf(e);o>=0;){var a=r.substring(0,o);i.add(a),o=(r=r.substring(o+n)).indexOf(e)}r.length>0&&i.add(r);for(var s=new Array(i.size()).fill(null),u=0;u<s.length;u++)s[u]=i.get(u);return s},Wl.toString=function(){if(1===arguments.length){var t=arguments[0];return Wl.SIMPLE_ORDINATE_FORMAT.format(t)}},Wl.spaces=function(t){return Wl.chars(" ",t)},Yl.NEWLINE.get=function(){return Hu.getProperty("line.separator")},Yl.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Wl,Yl);var Xl=function(){};Xl.prototype.interfaces_=function(){return[]},Xl.prototype.getClass=function(){return Xl},Xl.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},Xl.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,zu.X)===t.getOrdinate(e-1,zu.X)&&t.getOrdinate(0,zu.Y)===t.getOrdinate(e-1,zu.Y)},Xl.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var a=t.getOrdinate(r,o),s=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||vu.isNaN(a)&&vu.isNaN(s)))return!1}return!0},Xl.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Xl.copy(e,0,i,0,r),r>0)for(var o=r;o<n;o++)Xl.copy(e,r-1,i,o,1);return i},Xl.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)Xl.swap(t,i,e-i)},Xl.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Xl.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)Xl.copyCoord(t,e+o,n,i+o)},Xl.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new ku;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var o=0;o<n;o++)o>0&&i.append(","),i.append(Wl.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},Xl.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Xl.createClosedRing(t,e,4):e.getOrdinate(0,zu.X)===e.getOrdinate(n-1,zu.X)&&e.getOrdinate(0,zu.Y)===e.getOrdinate(n-1,zu.Y)?e:Xl.createClosedRing(t,e,n+1)},Xl.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Xl.copy(e,0,i,0,r);for(var o=r;o<n;o++)Xl.copy(e,0,i,o,1);return i};var Zl=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Vu:this._points.expandEnvelope(new Vu)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._points.size()!==i._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),i._points.getCoordinate(r),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Xl.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?jl.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return al.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Xl.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(Iu(arguments[0],fl))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(Iu(arguments[0],Gl)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else Iu(arguments[0],Bl)?arguments[0].filter(this):Iu(arguments[0],ul)&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new ql(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new mu("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Al]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ll),Jl=function(){};Jl.prototype.interfaces_=function(){return[]},Jl.prototype.getClass=function(){return Jl};var Kl=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Vu;var t=new Vu;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){
return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return jl.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(Iu(arguments[0],fl)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(Iu(arguments[0],Gl)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else Iu(arguments[0],Bl)?arguments[0].filter(this):Iu(arguments[0],ul)&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),tl.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Jl]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(ll),$l=function(){};$l.prototype.interfaces_=function(){return[]},$l.prototype.getClass=function(){return $l};var Ql=function(t){function e(e,n,i){if(t.call(this,i),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new mu("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new mu("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),a=0;a<o.length;a++)t[++e]=o[a];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(al.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(al.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),a=t.getY(0),s=1;s<=4;s++){var u=t.getX(s),l=t.getY(s);if(u!==o==(l!==a))return!1;o=u,a=l}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e,r=this._shell,o=i._shell;if(!r.equalsExact(o,n))return!1;if(this._holes.length!==i._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!this._holes[a].equalsExact(i._holes[a],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Fl.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);Hu.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Pl.minCoordinate(e.getCoordinates());Pl.scroll(i,r),Hu.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],al.isCCW(e.getCoordinates())===n&&Pl.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[0],r=arguments[1],o=i,a=this._shell,s=o._shell,u=a.compareToSameClass(s,r);if(0!==u)return u;for(var l=this.getNumInteriorRing(),c=o.getNumInteriorRing(),h=0;h<l&&h<c;){var f=this.getInteriorRingN(h),p=o.getInteriorRingN(h),d=f.compareToSameClass(p,r);if(0!==d)return d;h++}return h<l?1:h<c?-1:0}},e.prototype.apply=function(t){if(Iu(t,fl)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(Iu(t,Gl)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(Iu(t,Bl))t.filter(this);else if(Iu(t,ul)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),i=0;i<n.length;i++)n[i]=this._holes[i].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[$l]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ll),tc=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ll.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return jl.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Jl]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Ul),ec=function(t){function e(e,n){e instanceof xu&&n instanceof mc&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ll.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return jl.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Xl.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new mu("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new mu("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Zl),nc=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ll.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new xl,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[$l]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Ul),ic=function(t){this._factory=t||null,this._isUserDataCopied=!1},rc={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ic.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ic.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},ic.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Ul?this.editGeometryCollection(t,e):t instanceof Ql?this.editPolygon(t,e):t instanceof Kl?e.edit(t,this._factory):t instanceof Zl?e.edit(t,this._factory):(tl.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ic.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new xl,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===tc?this._factory.createMultiPoint(i.toArray([])):n.getClass()===Hl?this._factory.createMultiLineString(i.toArray([])):n.getClass()===nc?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},ic.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new xl,o=0;o<n.getNumInteriorRing();o++){var a=this.edit(n.getInteriorRingN(o),e);null===a||a.isEmpty()||r.add(a)}return this._factory.createPolygon(i,r.toArray([]))},ic.prototype.interfaces_=function(){return[]},ic.prototype.getClass=function(){return ic},ic.GeometryEditorOperation=function(){},rc.NoOpGeometryOperation.get=function(){return oc},rc.CoordinateOperation.get=function(){return ac},rc.CoordinateSequenceOperation.get=function(){return sc},Object.defineProperties(ic,rc);var oc=function(){};oc.prototype.edit=function(t,e){return t},oc.prototype.interfaces_=function(){return[ic.GeometryEditorOperation]},oc.prototype.getClass=function(){return oc};var ac=function(){};ac.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ec?e.createLinearRing(n):t instanceof Zl?e.createLineString(n):t instanceof Kl?n.length>0?e.createPoint(n[0]):e.createPoint():t},ac.prototype.interfaces_=function(){return[ic.GeometryEditorOperation]},ac.prototype.getClass=function(){return ac};var sc=function(){};sc.prototype.edit=function(t,e){return t instanceof ec?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Zl?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Kl?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},sc.prototype.interfaces_=function(){return[ic.GeometryEditorOperation]},sc.prototype.getClass=function(){return sc};var uc=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new xu}else if(Iu(arguments[0],zu)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],s=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=s;for(var u=0;u<a;u++)this._coordinates[u]=new xu}},lc={serialVersionUID:{configurable:!0}};uc.prototype.setOrdinate=function(t,e,n){switch(e){case zu.X:this._coordinates[t].x=n;break;case zu.Y:this._coordinates[t].y=n;break;case zu.Z:this._coordinates[t].z=n;break;default:throw new mu("invalid ordinateIndex")}},uc.prototype.size=function(){return this._coordinates.length},uc.prototype.getOrdinate=function(t,e){switch(e){case zu.X:return this._coordinates[t].x;case zu.Y:return this._coordinates[t].y;case zu.Z:return this._coordinates[t].z}return vu.NaN},uc.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},uc.prototype.getCoordinateCopy=function(t){return new xu(this._coordinates[t])},uc.prototype.getDimension=function(){return this._dimension},uc.prototype.getX=function(t){return this._coordinates[t].x},uc.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new uc(t,this._dimension)},uc.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},uc.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new uc(t,this._dimension)},uc.prototype.toString=function(){if(this._coordinates.length>0){var t=new ku(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},uc.prototype.getY=function(t){return this._coordinates[t].y},uc.prototype.toCoordinateArray=function(){return this._coordinates},uc.prototype.interfaces_=function(){return[zu,Ir]},uc.prototype.getClass=function(){return uc},lc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(uc,lc);var cc=function(){},hc={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};cc.prototype.readResolve=function(){return cc.instance()},cc.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new uc(t)}if(Iu(arguments[0],zu)){var e=arguments[0];return new uc(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return i>3&&(i=3),i<2?new uc(n):new uc(n,i)}},cc.prototype.interfaces_=function(){return[Pu,Ir]},cc.prototype.getClass=function(){return cc},cc.instance=function(){return cc.instanceObject},hc.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},hc.instanceObject.get=function(){return new cc},Object.defineProperties(cc,hc);var fc=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new xl,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new kl;return this.map_.entries().forEach(function(e){return t.add(e)}),t},e.prototype.size=function(){return this.map_.size()},e}(Tl),pc=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof gc){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},dc={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};pc.prototype.equals=function(t){if(!(t instanceof pc))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},pc.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new Ou(n).compareTo(new Ou(i))},pc.prototype.getScale=function(){return this._scale},pc.prototype.isFloating=function(){return this._modelType===pc.FLOATING||this._modelType===pc.FLOATING_SINGLE},pc.prototype.getType=function(){return this._modelType},pc.prototype.toString=function(){var t="UNKNOWN";return this._modelType===pc.FLOATING?t="Floating":this._modelType===pc.FLOATING_SINGLE?t="Floating-Single":this._modelType===pc.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},pc.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return vu.isNaN(t)?t:this._modelType===pc.FLOATING_SINGLE?t:this._modelType===pc.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof xu){var e=arguments[0];if(this._modelType===pc.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},pc.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===pc.FLOATING?t=16:this._modelType===pc.FLOATING_SINGLE?t=6:this._modelType===pc.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},pc.prototype.setScale=function(t){this._scale=Math.abs(t)},pc.prototype.interfaces_=function(){return[Ir,wu]},pc.prototype.getClass=function(){return pc},pc.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},dc.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},dc.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(pc,dc);var gc=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},yc={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};gc.prototype.readResolve=function(){return gc.nameToTypeMap.get(this._name)},gc.prototype.toString=function(){return this._name},gc.prototype.interfaces_=function(){return[Ir]},gc.prototype.getClass=function(){return gc},yc.serialVersionUID.get=function(){return-552860263173159e4},yc.nameToTypeMap.get=function(){return new fc},Object.defineProperties(gc,yc),pc.Type=gc,pc.FIXED=new gc("FIXED"),pc.FLOATING=new gc("FLOATING"),pc.FLOATING_SINGLE=new gc("FLOATING SINGLE");var mc=function t(){this._precisionModel=new pc,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?Iu(arguments[0],Pu)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof pc&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},vc={serialVersionUID:{configurable:!0}};mc.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new xu(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new xu(t.getMinX(),t.getMinY()),new xu(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new xu(t.getMinX(),t.getMinY()),new xu(t.getMinX(),t.getMaxY()),new xu(t.getMaxX(),t.getMaxY()),new xu(t.getMaxX(),t.getMinY()),new xu(t.getMinX(),t.getMinY())]),null)},mc.prototype.createLineString=function(t){return t?t instanceof Array?new Zl(this.getCoordinateSequenceFactory().create(t),this):Iu(t,zu)?new Zl(t,this):void 0:new Zl(this.getCoordinateSequenceFactory().create([]),this)},mc.prototype.createMultiLineString=function(){if(0===arguments.length)return new Hl(null,this);if(1===arguments.length){var t=arguments[0];return new Hl(t,this)}},mc.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),a=o.getClass();null===e&&(e=a),a!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(mc.toGeometryArray(t));var s=t.iterator().next();if(t.size()>1){if(s instanceof Ql)return this.createMultiPolygon(mc.toPolygonArray(t));if(s instanceof Zl)return this.createMultiLineString(mc.toLineStringArray(t));if(s instanceof Kl)return this.createMultiPoint(mc.toPointArray(t));tl.shouldNeverReachHere("Unhandled class: "+s.getClass().getName())}return s},mc.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},mc.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof xu){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(Iu(arguments[0],zu)){var e=arguments[0];return new Kl(e,this)}}},mc.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},mc.prototype.createPolygon=function(){if(0===arguments.length)return new Ql(null,null,this);if(1===arguments.length){if(Iu(arguments[0],zu)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ec){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return new Ql(i,r,this)}},mc.prototype.getSRID=function(){return this._SRID},mc.prototype.createGeometryCollection=function(){if(0===arguments.length)return new Ul(null,this);if(1===arguments.length){var t=arguments[0];return new Ul(t,this)}},mc.prototype.createGeometry=function(t){return new ic(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},mc.prototype.getPrecisionModel=function(){return this._precisionModel},mc.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(Iu(arguments[0],zu)){var e=arguments[0];return new ec(e,this)}}},mc.prototype.createMultiPolygon=function(){if(0===arguments.length)return new nc(null,this);if(1===arguments.length){var t=arguments[0];return new nc(t,this)}},mc.prototype.createMultiPoint=function(){if(0===arguments.length)return new tc(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return new tc(t,this)}if(arguments[0]instanceof Array){var e=arguments[0];return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(Iu(arguments[0],zu)){var n=arguments[0];if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());Xl.copy(n,r,o,0,1),i[r]=this.createPoint(o)}return this.createMultiPoint(i)}}},mc.prototype.interfaces_=function(){return[Ir]},mc.prototype.getClass=function(){return mc},mc.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.getDefaultCoordinateSequenceFactory=function(){return cc.instance()},mc.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},mc.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},vc.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(mc,vc);var _c=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],wc=function(t){this.geometryFactory=t||new mc};wc.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!bc[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==_c.indexOf(n)?bc[n].apply(this,[e.coordinates]):"GeometryCollection"===n?bc[n].apply(this,[e.geometries]):bc[n].apply(this,[e])},wc.prototype.write=function(t){var e=t.getGeometryType();if(!Cc[e])throw new Error("Geometry is not supported");return Cc[e].apply(this,[t])};var bc={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!bc[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=bc.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new xu(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new xu(t[0],t[1]),new xu(t[2],t[1]),new xu(t[2],t[3]),new xu(t[0],t[3]),new xu(t[0],t[1])])},Point:function(t){var e=new xu(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(bc.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=bc.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(bc.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=bc.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],a=bc.coordinates.apply(this,[o]),s=this.geometryFactory.createLinearRing(a);i.push(s)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(bc.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},Cc={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Cc.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Cc.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(Cc.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Cc.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=Cc.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=Cc.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Cc.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(Cc[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},xc=function(t){this.geometryFactory=t||new mc,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new wc(this.geometryFactory)};xc.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===pc.FIXED&&this.reducePrecision(e),
e},xc.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Ec=function(){this.parser=new wc(this.geometryFactory)};Ec.prototype.write=function(t){return this.parser.write(t)};var Sc=function(){},Pc={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Sc.prototype.interfaces_=function(){return[]},Sc.prototype.getClass=function(){return Sc},Sc.opposite=function(t){return t===Sc.LEFT?Sc.RIGHT:t===Sc.RIGHT?Sc.LEFT:t},Pc.ON.get=function(){return 0},Pc.LEFT.get=function(){return 1},Pc.RIGHT.get=function(){return 2},Object.defineProperties(Sc,Pc),(Ur.prototype=new Error).name="EmptyStackException",(Hr.prototype=new Cl).add=function(t){return this.array_.push(t),!0},Hr.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Hr.prototype.push=function(t){return this.array_.push(t),t},Hr.prototype.pop=function(t){if(0===this.array_.length)throw new Ur;return this.array_.pop()},Hr.prototype.peek=function(){if(0===this.array_.length)throw new Ur;return this.array_[this.array_.length-1]},Hr.prototype.empty=function(){return 0===this.array_.length},Hr.prototype.isEmpty=function(){return this.empty()},Hr.prototype.search=function(t){return this.array_.indexOf(t)},Hr.prototype.size=function(){return this.array_.length},Hr.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Mc=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Mc.prototype.getCoordinate=function(){return this._minCoord},Mc.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Mc.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();tl.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=al.computeOrientation(this._minCoord,n,e),r=!1;e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===al.COUNTERCLOCKWISE?r=!0:e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===al.CLOCKWISE&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Mc.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Sc.LEFT;return n[e].y<n[e+1].y&&(i=Sc.RIGHT),i},Mc.prototype.getEdge=function(){return this._orientedDe},Mc.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Mc.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Mc.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}tl.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Sc.LEFT&&(this._orientedDe=this._minDe.getSym())},Mc.prototype.interfaces_=function(){return[]},Mc.prototype.getClass=function(){return Mc};var Lc=function(t){function e(n,i){t.call(this,e.msgWithCoord(n,i)),this.pt=i?new xu(i):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}($u),Ic=function(){this.array_=[]};Ic.prototype.addLast=function(t){this.array_.push(t)},Ic.prototype.removeFirst=function(){return this.array_.shift()},Ic.prototype.isEmpty=function(){return 0===this.array_.length};var Tc=function(){this._finder=null,this._dirEdgeList=new xl,this._nodes=new xl,this._rightMostCoord=null,this._env=null,this._finder=new Mc};Tc.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Tc.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Tc.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new Lc("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Tc.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Sc.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Tc.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Tc.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Sc.RIGHT)>=1&&e.getDepth(Sc.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Tc.prototype.computeDepths=function(t){var e=new kl,n=new Ic,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var a=o.next().getSym();if(!a.isVisited()){var s=a.getNode();e.contains(s)||(n.addLast(s),e.add(s))}}}},Tc.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Tc.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Vu,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},Tc.prototype.addReachable=function(t){var e=new Hr;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Tc.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Sc.LEFT,t.getDepth(Sc.RIGHT)),e.setDepth(Sc.RIGHT,t.getDepth(Sc.LEFT))},Tc.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},Tc.prototype.getNodes=function(){return this._nodes},Tc.prototype.getDirectedEdges=function(){return this._dirEdgeList},Tc.prototype.interfaces_=function(){return[wu]},Tc.prototype.getClass=function(){return Tc};var Nc=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Sc.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.init(3),this.location[Sc.ON]=o,this.location[Sc.LEFT]=a,this.location[Sc.RIGHT]=s}};Nc.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Nc.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==Mu.NONE)return!1;return!0},Nc.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===Mu.NONE&&(this.location[e]=t)},Nc.prototype.isLine=function(){return 1===this.location.length},Nc.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Sc.ON]=this.location[Sc.ON],e[Sc.LEFT]=Mu.NONE,e[Sc.RIGHT]=Mu.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===Mu.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Nc.prototype.getLocations=function(){return this.location},Nc.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Sc.LEFT];this.location[Sc.LEFT]=this.location[Sc.RIGHT],this.location[Sc.RIGHT]=t},Nc.prototype.toString=function(){var t=new ku;return this.location.length>1&&t.append(Mu.toLocationSymbol(this.location[Sc.LEFT])),t.append(Mu.toLocationSymbol(this.location[Sc.ON])),this.location.length>1&&t.append(Mu.toLocationSymbol(this.location[Sc.RIGHT])),t.toString()},Nc.prototype.setLocations=function(t,e,n){this.location[Sc.ON]=t,this.location[Sc.LEFT]=e,this.location[Sc.RIGHT]=n},Nc.prototype.get=function(t){return t<this.location.length?this.location[t]:Mu.NONE},Nc.prototype.isArea=function(){return this.location.length>1},Nc.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===Mu.NONE)return!0;return!1},Nc.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Sc.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Nc.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(Mu.NONE)},Nc.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Nc.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Nc.prototype.interfaces_=function(){return[]},Nc.prototype.getClass=function(){return Nc};var kc=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Nc(e),this.elt[1]=new Nc(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Nc(n.elt[0]),this.elt[1]=new Nc(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new Nc(Mu.NONE),this.elt[1]=new Nc(Mu.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],a=arguments[1],s=arguments[2];this.elt[0]=new Nc(o,a,s),this.elt[1]=new Nc(o,a,s)}else if(4===arguments.length){var u=arguments[0],l=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new Nc(Mu.NONE,Mu.NONE,Mu.NONE),this.elt[1]=new Nc(Mu.NONE,Mu.NONE,Mu.NONE),this.elt[u].setLocations(l,c,h)}};kc.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},kc.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},kc.prototype.isNull=function(t){return this.elt[t].isNull()},kc.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},kc.prototype.isLine=function(t){return this.elt[t].isLine()},kc.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Nc(t.elt[e]):this.elt[e].merge(t.elt[e])},kc.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},kc.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Sc.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},kc.prototype.toString=function(){var t=new ku;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},kc.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},kc.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},kc.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Sc.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},kc.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},kc.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},kc.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Nc(this.elt[t].location[0]))},kc.prototype.interfaces_=function(){return[]},kc.prototype.getClass=function(){return kc},kc.toLineLabel=function(t){for(var e=new kc(Mu.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Oc=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new xl,this._pts=new xl,this._label=new kc(Mu.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new xl,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Oc.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=al.isCCW(this._ring.getCoordinates())},Oc.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Oc.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Lc("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Lc("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();tl.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Oc.prototype.getLinearRing=function(){return this._ring},Oc.prototype.getCoordinate=function(t){return this._pts.get(t)},Oc.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Oc.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var a=i.length-2;n&&(a=i.length-1);for(var s=a;s>=0;s--)this._pts.add(i[s])}},Oc.prototype.isHole=function(){return this._isHole},Oc.prototype.setInResult=function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)},Oc.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!al.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Oc.prototype.addHole=function(t){this._holes.add(t)},Oc.prototype.isShell=function(){return null===this._shell},Oc.prototype.getLabel=function(){return this._label},Oc.prototype.getEdges=function(){return this._edges},Oc.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Oc.prototype.getShell=function(){return this._shell},Oc.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e.getLocation(n,Sc.RIGHT);if(i===Mu.NONE)return null;if(this._label.getLocation(n)===Mu.NONE)return this._label.setLocation(n,i),null}},Oc.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Oc.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Oc.prototype.interfaces_=function(){return[]},Oc.prototype.getClass=function(){return Oc};var Dc=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Oc),Ac=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new xl,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Dc(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext();while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Oc),Rc=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Rc.prototype.setVisited=function(t){this._isVisited=t},Rc.prototype.setInResult=function(t){this._isInResult=t},Rc.prototype.isCovered=function(){return this._isCovered},Rc.prototype.isCoveredSet=function(){return this._isCoveredSet},Rc.prototype.setLabel=function(t){this._label=t},Rc.prototype.getLabel=function(){return this._label},Rc.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Rc.prototype.updateIM=function(t){tl.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},Rc.prototype.isInResult=function(){return this._isInResult},Rc.prototype.isVisited=function(){return this._isVisited},Rc.prototype.interfaces_=function(){return[]},Rc.prototype.getClass=function(){return Rc};var Fc=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new kc(0,Mu.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=Mu.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==Mu.BOUNDARY&&(n=i)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new kc(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof kc)for(var n=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===Mu.NONE&&this._label.setLocation(i,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=Mu.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case Mu.BOUNDARY:n=Mu.INTERIOR;break;case Mu.INTERIOR:default:n=Mu.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Rc),jc=function(){this.nodeMap=new jr,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};jc.prototype.find=function(t){return this.nodeMap.get(t)},jc.prototype.addNode=function(){if(arguments[0]instanceof xu){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Fc){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},jc.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},jc.prototype.iterator=function(){return this.nodeMap.values().iterator()},jc.prototype.values=function(){return this.nodeMap.values()},jc.prototype.getBoundaryNodes=function(t){for(var e=new xl,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===Mu.BOUNDARY&&e.add(i)}return e},jc.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},jc.prototype.interfaces_=function(){return[]},jc.prototype.getClass=function(){return jc};var zc=function(){},Bc={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};zc.prototype.interfaces_=function(){return[]},zc.prototype.getClass=function(){return zc},zc.isNorthern=function(t){return t===zc.NE||t===zc.NW},zc.isOpposite=function(t,e){return t!==e&&2===(t-e+4)%4},zc.commonHalfPlane=function(t,e){if(t===e)return t;if(2===(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},zc.isInHalfPlane=function(t,e){return e===zc.SE?t===zc.SE||t===zc.SW:t===e||t===e+1},zc.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new mu("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?zc.NE:zc.SE:e>=0?zc.NW:zc.SW}if(arguments[0]instanceof xu&&arguments[1]instanceof xu){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new mu("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?zc.NE:zc.SE:i.y>=n.y?zc.NW:zc.SW}},Bc.NE.get=function(){return 0},Bc.NW.get=function(){return 1},Bc.SW.get=function(){return 2},Bc.SE.get=function(){return 3},Object.defineProperties(zc,Bc);var Gc=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this._edge=r,this.init(o,a),this._label=s}};Gc.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:al.computeOrientation(t._p0,t._p1,this._p1)},Gc.prototype.getDy=function(){return this._dy},Gc.prototype.getCoordinate=function(){return this._p0},Gc.prototype.setNode=function(t){this._node=t},Gc.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},Gc.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},Gc.prototype.getDirectedCoordinate=function(){return this._p1},Gc.prototype.getDx=function(){return this._dx},Gc.prototype.getLabel=function(){return this._label},Gc.prototype.getEdge=function(){return this._edge},Gc.prototype.getQuadrant=function(){return this._quadrant},Gc.prototype.getNode=function(){return this._node},Gc.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},Gc.prototype.computeLabel=function(t){},Gc.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=zc.quadrant(this._dx,this._dy),tl.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Gc.prototype.interfaces_=function(){return[wu]},Gc.prototype.getClass=function(){return Gc};var Uc=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var i=e.getNumPoints()-1;this.init(e.getCoordinate(i),e.getCoordinate(i-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new kc(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Lc("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Sc.LEFT)===Mu.INTERIOR&&this._label.getLocation(e,Sc.RIGHT)===Mu.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Sc.LEFT]+"/"+this._depth[Sc.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,Mu.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,Mu.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Sc.LEFT&&(i=-1);var r=Sc.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===Mu.EXTERIOR&&e===Mu.INTERIOR?1:t===Mu.INTERIOR&&e===Mu.EXTERIOR?-1:0},e}(Gc),Hc=function(){};Hc.prototype.createNode=function(t){return new Fc(t,null)},Hc.prototype.interfaces_=function(){return[]},Hc.prototype.getClass=function(){return Hc};var qc=function(){if(this._edges=new xl,this._nodes=null,this._edgeEndList=new xl,0===arguments.length)this._nodes=new jc(new Hc);else if(1===arguments.length){var t=arguments[0];this._nodes=new jc(t)}};qc.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},qc.prototype.find=function(t){return this._nodes.find(t)},qc.prototype.addNode=function(){if(arguments[0]instanceof Fc){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof xu){var e=arguments[0];return this._nodes.addNode(e)}},qc.prototype.getNodeIterator=function(){return this._nodes.iterator()},qc.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},qc.prototype.debugPrintln=function(t){Hu.out.println(t)},qc.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===Mu.BOUNDARY},qc.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},qc.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&al.computeOrientation(t,e,i)===al.COLLINEAR&&zc.quadrant(t,e)===zc.quadrant(n,i)},qc.prototype.getEdgeEnds=function(){return this._edgeEndList},qc.prototype.debugPrint=function(t){Hu.out.print(t)},qc.prototype.getEdgeIterator=function(){return this._edges.iterator()},qc.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},qc.prototype.insertEdge=function(t){this._edges.add(t)},qc.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},qc.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new Uc(n,!0),r=new Uc(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},qc.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},qc.prototype.getNodes=function(){return this._nodes.values()},qc.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},qc.prototype.interfaces_=function(){return[]},qc.prototype.getClass=function(){return qc},qc.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var Vc=function(){this._geometryFactory=null,this._shellList=new xl;var t=arguments[0];this._geometryFactory=t};Vc.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},Vc.prototype.computePolygons=function(t){for(var e=new xl,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},Vc.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new Lc("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},Vc.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new xl,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var a=o.buildMinimalRings(),s=this.findShell(a);null!==s?(this.placePolygonHoles(s,a),e.add(s)):n.addAll(a)}else i.add(o)}return i},Vc.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Vc.prototype.buildMaximalEdgeRings=function(t){for(var e=new xl,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new Ac(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},Vc.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},Vc.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Vc.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,a=null,s=e.iterator();s.hasNext();){var u=s.next(),l=u.getLinearRing(),c=l.getEnvelopeInternal();null!==o&&(a=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(i)&&al.isPointInRing(r,l.getCoordinates())&&(h=!0),h&&(null===o||a.contains(c))&&(o=u);
}return o},Vc.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return tl.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Vc.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];qc.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new xl,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},Vc.prototype.interfaces_=function(){return[]},Vc.prototype.getClass=function(){return Vc};var Wc=function(){};Wc.prototype.getBounds=function(){},Wc.prototype.interfaces_=function(){return[]},Wc.prototype.getClass=function(){return Wc};var Yc=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Yc.prototype.getItem=function(){return this._item},Yc.prototype.getBounds=function(){return this._bounds},Yc.prototype.interfaces_=function(){return[Wc,Ir]},Yc.prototype.getClass=function(){return Yc};var Xc=function(){this._size=null,this._items=null,this._size=0,this._items=new xl,this._items.add(null)};Xc.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Xc.prototype.size=function(){return this._size},Xc.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Xc.prototype.clear=function(){this._size=0,this._items.clear()},Xc.prototype.isEmpty=function(){return 0===this._size},Xc.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Xc.prototype.interfaces_=function(){return[]},Xc.prototype.getClass=function(){return Xc};var Zc=function(){};Zc.prototype.visitItem=function(t){},Zc.prototype.interfaces_=function(){return[]},Zc.prototype.getClass=function(){return Zc};var Jc=function(){};Jc.prototype.insert=function(t,e){},Jc.prototype.remove=function(t,e){},Jc.prototype.query=function(){},Jc.prototype.interfaces_=function(){return[]},Jc.prototype.getClass=function(){return Jc};var Kc=function(){if(this._childBoundables=new xl,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},$c={serialVersionUID:{configurable:!0}};Kc.prototype.getLevel=function(){return this._level},Kc.prototype.size=function(){return this._childBoundables.size()},Kc.prototype.getChildBoundables=function(){return this._childBoundables},Kc.prototype.addChildBoundable=function(t){tl.isTrue(null===this._bounds),this._childBoundables.add(t)},Kc.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Kc.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Kc.prototype.interfaces_=function(){return[Wc,Ir]},Kc.prototype.getClass=function(){return Kc},$c.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Kc,$c);var Qc=function(){};Qc.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Qc.min=function(t){return Qc.sort(t),t.get(0)},Qc.sort=function(t,e){var n=t.toArray();e?Fl.sort(n,e):Fl.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},Qc.singletonList=function(t){var e=new xl;return e.add(t),e};var th=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};th.prototype.expandToQueue=function(t,e){var n=th.isComposite(this._boundable1),i=th.isComposite(this._boundable2);if(n&&i)return th.area(this._boundable1)>th.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new mu("neither boundable is composite")},th.prototype.isLeaves=function(){return!(th.isComposite(this._boundable1)||th.isComposite(this._boundable2))},th.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},th.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),a=new th(o,e,this._itemDistance);a.getDistance()<i&&n.add(a)}},th.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},th.prototype.getDistance=function(){return this._distance},th.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},th.prototype.interfaces_=function(){return[wu]},th.prototype.getClass=function(){return th},th.area=function(t){return t.getBounds().getArea()},th.isComposite=function(t){return t instanceof Kc};var eh=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new xl,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];tl.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nh={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};eh.prototype.getNodeCapacity=function(){return this._nodeCapacity},eh.prototype.lastNode=function(t){return t.get(t.size()-1)},eh.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Kc?t+=this.size(n):n instanceof Yc&&(t+=1)}return t}},eh.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Yc&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},eh.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new xl:t}if(1===arguments.length){for(var e=arguments[0],n=new xl,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Kc){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Yc?n.add(r.getItem()):tl.shouldNeverReachHere()}return n.size()<=0?null:n}},eh.prototype.insert=function(t,e){tl.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Yc(t,e))},eh.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new xl;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(tl.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var a=o.next();a instanceof Kc?this.boundablesAtLevel(n,a,r):(tl.isTrue(a instanceof Yc),-1===n&&r.add(a))}return null}},eh.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new xl;return this.isEmpty()?e:(this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(Iu(arguments[2],Zc)&&arguments[0]instanceof Object&&arguments[1]instanceof Kc)for(var r=arguments[0],o=arguments[1],a=arguments[2],s=o.getChildBoundables(),u=0;u<s.size();u++){var l=s.get(u);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Kc?this.query(r,l,a):l instanceof Yc?a.visitItem(l.getItem()):tl.shouldNeverReachHere())}else if(Iu(arguments[2],Cl)&&arguments[0]instanceof Object&&arguments[1]instanceof Kc)for(var c=arguments[0],h=arguments[1],f=arguments[2],p=h.getChildBoundables(),d=0;d<p.size();d++){var g=p.get(d);this.getIntersectsOp().intersects(g.getBounds(),c)&&(g instanceof Kc?this.query(c,g,f):g instanceof Yc?f.add(g.getItem()):tl.shouldNeverReachHere())}},eh.prototype.build=function(){return this._built?null:(this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0,void 0)},eh.prototype.getRoot=function(){return this.build(),this._root},eh.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var a=null,s=i.getChildBoundables().iterator();s.hasNext();){var u=s.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof Kc&&(o=this.remove(n,u,r))){a=u;break}}return null!==a&&a.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(a),o}},eh.prototype.createHigherLevels=function(t,e){tl.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},eh.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Kc){var i=this.depth(n);i>t&&(t=i)}}return t+1}},eh.prototype.createParentBoundables=function(t,e){tl.isTrue(!t.isEmpty());var n=new xl;n.add(this.createNode(e));var i=new xl(t);Qc.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},eh.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},eh.prototype.interfaces_=function(){return[Ir]},eh.prototype.getClass=function(){return eh},eh.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nh.IntersectsOp.get=function(){return ih},nh.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nh.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(eh,nh);var ih=function(){},rh=function(){};rh.prototype.distance=function(t,e){},rh.prototype.interfaces_=function(){return[]},rh.prototype.getClass=function(){return rh};var oh=function(t){function e(n){n=n||e.DEFAULT_NODE_CAPACITY,t.call(this,n)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(t,e){tl.isTrue(t.length>0);for(var n=new xl,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},e.prototype.createNode=function(t){return new ah(t)},e.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];return e.isNull()?null:void t.prototype.insert.call(this,e,n)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new xl;for(var a=0;r.hasNext()&&a<n;){var s=r.next();i[o].add(s),a++}}return i},e.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];t.prototype.query.call(this,n,i)}else if(3===arguments.length)if(Iu(arguments[2],Zc)&&arguments[0]instanceof Object&&arguments[1]instanceof Kc){var r=arguments[0],o=arguments[1],a=arguments[2];t.prototype.query.call(this,r,o,a)}else if(Iu(arguments[2],Cl)&&arguments[0]instanceof Object&&arguments[1]instanceof Kc){var s=arguments[0],u=arguments[1],l=arguments[2];t.prototype.query.call(this,s,u,l)}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},e.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(t,n){tl.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new xl(t);Qc.sort(r,e.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(o,n)},e.prototype.nearestNeighbour=function(){if(1===arguments.length){if(Iu(arguments[0],rh)){var t=arguments[0],n=new th(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(n)}if(arguments[0]instanceof th){var i=arguments[0];return this.nearestNeighbour(i,vu.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof e&&Iu(arguments[1],rh)){var r=arguments[0],o=arguments[1],a=new th(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(a)}if(arguments[0]instanceof th&&"number"==typeof arguments[1]){var s=arguments[0],u=arguments[1],l=null,c=new Xc;for(c.add(s);!c.isEmpty()&&u>0;){var h=c.poll(),f=h.getDistance();if(f>=u)break;h.isLeaves()?(u=f,l=h):h.expandToQueue(c,u)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[0],d=arguments[1],g=arguments[2],y=new Yc(p,d),m=new th(this.getRoot(),y,g);return this.nearestNeighbour(m)[0]}},e.prototype.interfaces_=function(){return[Jc,Ir]},e.prototype.getClass=function(){return e},e.centreX=function(t){return e.avg(t.getMinX(),t.getMaxX())},e.avg=function(t,e){return(t+e)/2},e.centreY=function(t){return e.avg(t.getMinY(),t.getMaxY())},n.STRtreeNode.get=function(){return ah},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[Cu]},compare:function(n,i){return t.compareDoubles(e.centreX(n.getBounds()),e.centreX(i.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[Cu]},compare:function(n,i){return t.compareDoubles(e.centreY(n.getBounds()),e.centreY(i.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,n),e}(eh),ah=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new Vu(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Kc),sh=function(){};sh.prototype.interfaces_=function(){return[]},sh.prototype.getClass=function(){return sh},sh.relativeSign=function(t,e){return t<e?-1:t>e?1:0},sh.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=sh.relativeSign(e.x,n.x),r=sh.relativeSign(e.y,n.y);switch(t){case 0:return sh.compareValue(i,r);case 1:return sh.compareValue(r,i);case 2:return sh.compareValue(r,-i);case 3:return sh.compareValue(-i,r);case 4:return sh.compareValue(-i,-r);case 5:return sh.compareValue(-r,-i);case 6:return sh.compareValue(-r,i);case 7:return sh.compareValue(i,-r)}return tl.shouldNeverReachHere("invalid octant value"),0},sh.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var uh=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new xu(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};uh.prototype.getCoordinate=function(){return this.coord},uh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},uh.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:sh.compare(this._segmentOctant,this.coord,e.coord)},uh.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},uh.prototype.isInterior=function(){return this._isInterior},uh.prototype.interfaces_=function(){return[wu]},uh.prototype.getClass=function(){return uh};var lh=function(){this._nodeMap=new jr,this._edge=null;var t=arguments[0];this._edge=t};lh.prototype.getSplitCoordinates=function(){var t=new Sl;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},lh.prototype.addCollapsedNodes=function(){var t=new xl;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},lh.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},lh.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new Ou(e+1))}},lh.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new xu(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new xu(e.coord))},lh.prototype.iterator=function(){return this._nodeMap.values().iterator()},lh.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},lh.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},lh.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new Ou(e[0])),i=r}},lh.prototype.getEdge=function(){return this._edge},lh.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},lh.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),a=0;o[a++]=new xu(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this._edge.getCoordinate(s);return r&&(o[a]=new xu(e.coord)),new ph(o,this._edge.getData())},lh.prototype.add=function(t,e){var n=new uh(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(tl.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},lh.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new $u("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new $u("bad split edge end point at "+r)},lh.prototype.interfaces_=function(){return[]},lh.prototype.getClass=function(){return lh};var ch=function(){};ch.prototype.interfaces_=function(){return[]},ch.prototype.getClass=function(){return ch},ch.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new mu("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof xu&&arguments[1]instanceof xu){var r=arguments[0],o=arguments[1],a=o.x-r.x,s=o.y-r.y;if(0===a&&0===s)throw new mu("Cannot compute the octant for two identical points "+r);return ch.octant(a,s)}};var hh=function(){};hh.prototype.getCoordinates=function(){},hh.prototype.size=function(){},hh.prototype.getCoordinate=function(t){},hh.prototype.isClosed=function(){},hh.prototype.setData=function(t){},hh.prototype.getData=function(){},hh.prototype.interfaces_=function(){return[]},hh.prototype.getClass=function(){return hh};var fh=function(){};fh.prototype.addIntersection=function(t,e){},fh.prototype.interfaces_=function(){return[hh]},fh.prototype.getClass=function(){return fh};var ph=function(){this._nodeList=new lh(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};ph.prototype.getCoordinates=function(){return this._pts},ph.prototype.size=function(){return this._pts.length},ph.prototype.getCoordinate=function(t){return this._pts[t]},ph.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},ph.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},ph.prototype.setData=function(t){this._data=t},ph.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:ch.octant(t,e)},ph.prototype.getData=function(){return this._data},ph.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[3],o=new xu(n.getIntersection(r));this.addIntersection(o,i)}},ph.prototype.toString=function(){return Ku.toLineString(new uc(this._pts))},ph.prototype.getNodeList=function(){return this._nodeList},ph.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},ph.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},ph.prototype.interfaces_=function(){return[fh]},ph.prototype.getClass=function(){return ph},ph.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new xl;return ph.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(i)};var dh=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new xu,this.p1=new xu;else if(1===arguments.length){var t=arguments[0];this.p0=new xu(t.p0),this.p1=new xu(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new xu(e,n),this.p1=new xu(i,r)}},gh={serialVersionUID:{configurable:!0}};dh.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},dh.prototype.orientationIndex=function(){if(arguments[0]instanceof dh){var t=arguments[0],e=al.orientationIndex(this.p0,this.p1,t.p0),n=al.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0?Math.max(e,n):e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof xu){var i=arguments[0];return al.orientationIndex(this.p0,this.p1,i)}},dh.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},dh.prototype.isVertical=function(){return this.p0.x===this.p1.x},dh.prototype.equals=function(t){if(!(t instanceof dh))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},dh.prototype.intersection=function(t){var e=new il;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},dh.prototype.project=function(){if(arguments[0]instanceof xu){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new xu(t);var e=this.projectionFactor(t),n=new xu;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof dh){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var a=this.project(i.p0);r<0&&(a=this.p0),r>1&&(a=this.p1);var s=this.project(i.p1);return o<0&&(s=this.p0),o>1&&(s=this.p1),new dh(a,s)}},dh.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},dh.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},dh.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},dh.prototype.distancePerpendicular=function(t){return al.distancePointLinePerpendicular(t,this.p0,this.p1)},dh.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},dh.prototype.midPoint=function(){return dh.midPoint(this.p0,this.p1)},dh.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?vu.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},dh.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=vu.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var a=this.closestPoint(t.p1);(r=a.distance(t.p1))<i&&(i=r,n[0]=a,n[1]=t.p1);var s=t.closestPoint(this.p0);(r=s.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=s);var u=t.closestPoint(this.p1);return(r=u.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=u),n},dh.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},dh.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},dh.prototype.getLength=function(){return this.p0.distance(this.p1)},dh.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},dh.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},dh.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},dh.prototype.lineIntersection=function(t){try{return qu.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof Uu))throw t}return null},dh.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},dh.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,a=Math.sqrt(r*r+o*o),s=0,u=0;if(0!==e){if(a<=0)throw new Error("Cannot compute offset from zero-length line segment");s=e*r/a,u=e*o/a}return new xu(n-u,i+s)},dh.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},dh.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||vu.isNaN(e))&&(e=1),e},dh.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},dh.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},dh.prototype.distance=function(){if(arguments[0]instanceof dh){var t=arguments[0];return al.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof xu){var e=arguments[0];return al.distancePointLine(e,this.p0,this.p1)}},dh.prototype.pointAlong=function(t){var e=new xu;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},dh.prototype.hashCode=function(){var t=vu.doubleToLongBits(this.p0.x);t^=31*vu.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=vu.doubleToLongBits(this.p1.x);return n^=31*vu.doubleToLongBits(this.p1.y),e^(Math.trunc(n)^Math.trunc(n>>32))},dh.prototype.interfaces_=function(){return[wu,Ir]},dh.prototype.getClass=function(){return dh},dh.midPoint=function(t,e){return new xu((t.x+e.x)/2,(t.y+e.y)/2)},gh.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(dh,gh);var yh=function(){this.tempEnv1=new Vu,this.tempEnv2=new Vu,this._overlapSeg1=new dh,this._overlapSeg2=new dh};yh.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},yh.prototype.interfaces_=function(){return[]},yh.prototype.getClass=function(){return yh};var mh=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};mh.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},mh.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var a=Math.trunc((e+n)/2);e<a&&this.computeSelect(t,e,a,i),a<n&&this.computeSelect(t,a,n,i)},mh.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},mh.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},mh.prototype.setId=function(t){this._id=t},mh.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},mh.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Vu(t,e)}return this._env},mh.prototype.getEndIndex=function(){return this._end},mh.prototype.getStartIndex=function(){return this._start},mh.prototype.getContext=function(){return this._context},mh.prototype.getId=function(){return this._id},mh.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var a=this._pts[t],s=this._pts[e],u=n._pts[i],l=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(a,s),o.tempEnv2.init(u,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((i+r)/2);t<c&&(i<h&&this.computeOverlapsInternal(t,c,n,i,h,o),h<r&&this.computeOverlapsInternal(t,c,n,h,r,o)),c<e&&(i<h&&this.computeOverlapsInternal(c,e,n,i,h,o),h<r&&this.computeOverlapsInternal(c,e,n,h,r,o))},mh.prototype.interfaces_=function(){return[]},mh.prototype.getClass=function(){return mh};var vh=function(){};vh.prototype.interfaces_=function(){return[]},vh.prototype.getClass=function(){return vh},vh.getChainStartIndices=function(t){var e=0,n=new xl;n.add(new Ou(e));do{var i=vh.findChainEnd(t,e);n.add(new Ou(i)),e=i}while(e<t.length-1);return vh.toIntArray(n)},vh.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=zc.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||zc.quadrant(t[r-1],t[r])===i);)r++;return r-1},vh.getChains=function(){if(1===arguments.length){var t=arguments[0];return vh.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new xl,r=vh.getChainStartIndices(e),o=0;o<r.length-1;o++){var a=new mh(e,r[o],r[o+1],n);i.add(a);
}return i}},vh.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var _h=function(){};_h.prototype.computeNodes=function(t){},_h.prototype.getNodedSubstrings=function(){},_h.prototype.interfaces_=function(){return[]},_h.prototype.getClass=function(){return _h};var wh=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};wh.prototype.setSegmentIntersector=function(t){this._segInt=t},wh.prototype.interfaces_=function(){return[_h]},wh.prototype.getClass=function(){return wh};var bh=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new xl,this._index=new oh,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return ph.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=vh.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new Ch(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return Ch},Object.defineProperties(e,n),e}(wh),Ch=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3],o=e.getContext(),a=i.getContext();this._si.processIntersections(o,n,a,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(yh),xh=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(a),this.setMitreLimit(s)}},Eh={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};xh.prototype.getEndCapStyle=function(){return this._endCapStyle},xh.prototype.isSingleSided=function(){return this._isSingleSided},xh.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=xh.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=xh.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==xh.JOIN_ROUND&&(this._quadrantSegments=xh.DEFAULT_QUADRANT_SEGMENTS)},xh.prototype.getJoinStyle=function(){return this._joinStyle},xh.prototype.setJoinStyle=function(t){this._joinStyle=t},xh.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},xh.prototype.getSimplifyFactor=function(){return this._simplifyFactor},xh.prototype.getQuadrantSegments=function(){return this._quadrantSegments},xh.prototype.setEndCapStyle=function(t){this._endCapStyle=t},xh.prototype.getMitreLimit=function(){return this._mitreLimit},xh.prototype.setMitreLimit=function(t){this._mitreLimit=t},xh.prototype.setSingleSided=function(t){this._isSingleSided=t},xh.prototype.interfaces_=function(){return[]},xh.prototype.getClass=function(){return xh},xh.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Eh.CAP_ROUND.get=function(){return 1},Eh.CAP_FLAT.get=function(){return 2},Eh.CAP_SQUARE.get=function(){return 3},Eh.JOIN_ROUND.get=function(){return 1},Eh.JOIN_MITRE.get=function(){return 2},Eh.JOIN_BEVEL.get=function(){return 3},Eh.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Eh.DEFAULT_MITRE_LIMIT.get=function(){return 5},Eh.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(xh,Eh);var Sh=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=al.COUNTERCLOCKWISE,this._inputLine=t||null},Ph={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Sh.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],a=this._inputLine[n];return!!this.isConcave(r,o,a)&&!!this.isShallow(r,o,a,i)&&this.isShallowSampled(r,o,t,n,i)},Sh.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Sh.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},Sh.prototype.isShallowConcavity=function(t,e,n,i){return al.computeOrientation(t,e,n)===this._angleOrientation&&al.distancePointLine(e,t,n)<i},Sh.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/Sh.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var a=n;a<i;a+=o)if(!this.isShallow(t,e,this._inputLine[a],r))return!1;return!0},Sh.prototype.isConcave=function(t,e,n){var i=al.computeOrientation(t,e,n)===this._angleOrientation;return i},Sh.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=al.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do e=this.deleteShallowConcavities();while(e);return this.collapseLine()},Sh.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Sh.DELETE;)e++;return e},Sh.prototype.isShallow=function(t,e,n,i){return al.distancePointLine(e,t,n)<i},Sh.prototype.collapseLine=function(){for(var t=new Sl,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Sh.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Sh.prototype.interfaces_=function(){return[]},Sh.prototype.getClass=function(){return Sh},Sh.simplify=function(t,e){return new Sh(t).simplify(e)},Ph.INIT.get=function(){return 0},Ph.DELETE.get=function(){return 1},Ph.KEEP.get=function(){return 1},Ph.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Sh,Ph);var Mh=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new xl},Lh={COORDINATE_ARRAY_TYPE:{configurable:!0}};Mh.prototype.getCoordinates=function(){return this._ptList.toArray(Mh.COORDINATE_ARRAY_TYPE)},Mh.prototype.setPrecisionModel=function(t){this._precisionModel=t},Mh.prototype.addPt=function(t){var e=new xu(t);return this._precisionModel.makePrecise(e),this.isRedundant(e)?null:void this._ptList.add(e)},Mh.prototype.revere=function(){},Mh.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])},Mh.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Mh.prototype.toString=function(){return(new mc).createLineString(this.getCoordinates()).toString()},Mh.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new xu(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);return t.equals(e)?null:void this._ptList.add(t)},Mh.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Mh.prototype.interfaces_=function(){return[]},Mh.prototype.getClass=function(){return Mh},Lh.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Mh,Lh);var Ih=function(){},Th={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Ih.prototype.interfaces_=function(){return[]},Ih.prototype.getClass=function(){return Ih},Ih.toDegrees=function(t){return 180*t/Math.PI},Ih.normalize=function(t){for(;t>Math.PI;)t-=Ih.PI_TIMES_2;for(;t<=-Math.PI;)t+=Ih.PI_TIMES_2;return t},Ih.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Ih.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},Ih.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},Ih.interiorAngle=function(t,e,n){var i=Ih.angle(e,t),r=Ih.angle(e,n);return Math.abs(r-i)},Ih.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Ih.PI_TIMES_2;t>=Ih.PI_TIMES_2&&(t=0)}else{for(;t>=Ih.PI_TIMES_2;)t-=Ih.PI_TIMES_2;t<0&&(t=0)}return t},Ih.angleBetween=function(t,e,n){var i=Ih.angle(e,t),r=Ih.angle(e,n);return Ih.diff(i,r)},Ih.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Ih.toRadians=function(t){return t*Math.PI/180},Ih.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Ih.COUNTERCLOCKWISE:n<0?Ih.CLOCKWISE:Ih.NONE},Ih.angleBetweenOriented=function(t,e,n){var i=Ih.angle(e,t),r=Ih.angle(e,n)-i;return r<=-Math.PI?r+Ih.PI_TIMES_2:r>Math.PI?r-Ih.PI_TIMES_2:r},Th.PI_TIMES_2.get=function(){return 2*Math.PI},Th.PI_OVER_2.get=function(){return Math.PI/2},Th.PI_OVER_4.get=function(){return Math.PI/4},Th.COUNTERCLOCKWISE.get=function(){return al.COUNTERCLOCKWISE},Th.CLOCKWISE.get=function(){return al.CLOCKWISE},Th.NONE.get=function(){return al.COLLINEAR},Object.defineProperties(Ih,Th);var Nh=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new dh,this._seg1=new dh,this._offset0=new dh,this._offset1=new dh,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new il,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===xh.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},kh={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Nh.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=al.computeOrientation(this._s0,this._s1,this._s2),i=n===al.CLOCKWISE&&this._side===Sc.LEFT||n===al.COUNTERCLOCKWISE&&this._side===Sc.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Nh.prototype.addLineEndCap=function(t,e){var n=new dh(t,e),i=new dh;this.computeOffsetSegment(n,Sc.LEFT,this._distance,i);var r=new dh;this.computeOffsetSegment(n,Sc.RIGHT,this._distance,r);var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o);switch(this._bufParams.getEndCapStyle()){case xh.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,s+Math.PI/2,s-Math.PI/2,al.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case xh.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case xh.CAP_SQUARE:var u=new xu;u.x=Math.abs(this._distance)*Math.cos(s),u.y=Math.abs(this._distance)*Math.sin(s);var l=new xu(i.p1.x+u.x,i.p1.y+u.y),c=new xu(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(c)}},Nh.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Nh.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=qu.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof Uu))throw t;o=new xu(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},Nh.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,a=e.y-t.y,s=Math.atan2(a,o),u=n.x-t.x,l=n.y-t.y,c=Math.atan2(l,u);i===al.CLOCKWISE?s<=c&&(s+=2*Math.PI):s>=c&&(s-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,s,c,i,r),this._segList.addPt(n)},Nh.prototype.addOutsideTurn=function(t,e){return this._offset0.p1.distance(this._offset1.p0)<this._distance*Nh.OFFSET_SEGMENT_SEPARATION_FACTOR?(this._segList.addPt(this._offset0.p1),null):void(this._bufParams.getJoinStyle()===xh.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===xh.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0)))},Nh.prototype.createSquare=function(t){this._segList.addPt(new xu(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new xu(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new xu(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new xu(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Nh.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Nh.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Nh.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Nh.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Nh.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=Ih.angle(r,this._seg0.p0),a=Ih.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,s=Ih.normalize(o+a),u=Ih.normalize(s+Math.PI),l=i*n,c=n-l*Math.abs(Math.sin(a)),h=r.x+l*Math.cos(u),f=r.y+l*Math.sin(u),p=new xu(h,f),d=new dh(r,p),g=d.pointAlongOffset(1,c),y=d.pointAlongOffset(1,-c);this._side===Sc.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},Nh.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===Sc.LEFT?1:-1,o=t.p1.x-t.p0.x,a=t.p1.y-t.p0.y,s=Math.sqrt(o*o+a*a),u=r*n*o/s,l=r*n*a/s;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},Nh.prototype.addFilletArc=function(t,e,n,i,r){var o=i===al.CLOCKWISE?-1:1,a=Math.abs(e-n),s=Math.trunc(a/this._filletAngleQuantum+.5);if(s<1)return null;for(var u=a/s,l=0,c=new xu;l<a;){var h=e+o*l;c.x=t.x+r*Math.cos(h),c.y=t.y+r*Math.sin(h),this._segList.addPt(c),l+=u}},Nh.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Nh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new xu((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new xu((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Nh.prototype.createCircle=function(t){var e=new xu(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Nh.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Nh.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Mh,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Nh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Nh.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===xh.JOIN_BEVEL||this._bufParams.getJoinStyle()===xh.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,al.CLOCKWISE,this._distance))},Nh.prototype.closeRing=function(){this._segList.closeRing()},Nh.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Nh.prototype.interfaces_=function(){return[]},Nh.prototype.getClass=function(){return Nh},kh.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},kh.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},kh.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},kh.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Nh,kh);var Oh=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Oh.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Pl.reverse(o),o},Oh.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Sh.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Sc.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(r[a],!0)}else{n.addSegments(t,!1);var s=Sh.simplify(t,i),u=s.length-1;n.initSideSegments(s[0],s[1],Sc.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(s[l],!0)}n.addLastSegment(),n.closeRing()},Oh.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===Sc.RIGHT&&(i=-i);var r=Sh.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var a=1;a<=o;a++){var s=1!==a;n.addNextSegment(r[a],s)}n.closeRing()},Oh.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=Sh.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Sc.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var a=Sh.simplify(t,-n),s=a.length-1;e.initSideSegments(a[s],a[s-1],Sc.LEFT);for(var u=s-2;u>=0;u--)e.addNextSegment(a[u],!0);e.addLastSegment(),e.addLineEndCap(a[1],a[0]),e.closeRing()},Oh.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case xh.CAP_ROUND:e.createCircle(t);break;case xh.CAP_SQUARE:e.createSquare(t)}},Oh.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},Oh.prototype.getBufferParameters=function(){return this._bufParams},Oh.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Oh.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Oh.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},Oh.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=Sh.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Sc.LEFT),n.addFirstSegment();for(var a=o-2;a>=0;a--)n.addNextSegment(r[a],!0)}else{var s=Sh.simplify(t,i),u=s.length-1;n.initSideSegments(s[0],s[1],Sc.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(s[l],!0)}n.addLastSegment()},Oh.prototype.getSegGen=function(t){return new Nh(this._precisionModel,this._bufParams,t)},Oh.prototype.interfaces_=function(){return[]},Oh.prototype.getClass=function(){return Oh},Oh.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new xu(t[n]);return e};var Dh=function(){this._subgraphs=null,this._seg=new dh,this._cga=new al;var t=arguments[0];this._subgraphs=t},Ah={DepthSegment:{configurable:!0}};Dh.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new xl,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(Iu(arguments[2],Cl)&&arguments[0]instanceof xu&&arguments[1]instanceof Uc){for(var o=arguments[0],a=arguments[1],s=arguments[2],u=a.getEdge().getCoordinates(),l=0;l<u.length-1;l++)if(this._seg.p0=u[l],this._seg.p1=u[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||al.computeOrientation(this._seg.p0,this._seg.p1,o)===al.RIGHT)){var c=a.getDepth(Sc.LEFT);this._seg.p0.equals(u[l])||(c=a.getDepth(Sc.RIGHT));var h=new Rh(this._seg,c);s.add(h)}}else if(Iu(arguments[2],Cl)&&arguments[0]instanceof xu&&Iu(arguments[1],Cl))for(var f=arguments[0],p=arguments[1],d=arguments[2],g=p.iterator();g.hasNext();){var y=g.next();y.isForward()&&this.findStabbedSegments(f,y,d)}},Dh.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Qc.min(e)._leftDepth},Dh.prototype.interfaces_=function(){return[]},Dh.prototype.getClass=function(){return Dh},Ah.DepthSegment.get=function(){return Rh},Object.defineProperties(Dh,Ah);var Rh=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new dh(t),this._leftDepth=e};Rh.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},Rh.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},Rh.prototype.toString=function(){return this._upwardSeg.toString()},Rh.prototype.interfaces_=function(){return[wu]},Rh.prototype.getClass=function(){return Rh};var Fh=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Fh.prototype.area=function(){return Fh.area(this.p0,this.p1,this.p2)},Fh.prototype.signedArea=function(){return Fh.signedArea(this.p0,this.p1,this.p2)},Fh.prototype.interpolateZ=function(t){if(null===t)throw new mu("Supplied point is null.");return Fh.interpolateZ(t,this.p0,this.p1,this.p2)},Fh.prototype.longestSideLength=function(){return Fh.longestSideLength(this.p0,this.p1,this.p2)},Fh.prototype.isAcute=function(){return Fh.isAcute(this.p0,this.p1,this.p2)},Fh.prototype.circumcentre=function(){return Fh.circumcentre(this.p0,this.p1,this.p2)},Fh.prototype.area3D=function(){return Fh.area3D(this.p0,this.p1,this.p2)},Fh.prototype.centroid=function(){return Fh.centroid(this.p0,this.p1,this.p2)},Fh.prototype.inCentre=function(){return Fh.inCentre(this.p0,this.p1,this.p2)},Fh.prototype.interfaces_=function(){return[]},Fh.prototype.getClass=function(){return Fh},Fh.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Fh.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Fh.det=function(t,e,n,i){return t*i-e*n},Fh.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,a=n.x-r,s=i.x-r,u=n.y-o,l=i.y-o,c=a*l-s*u,h=t.x-r,f=t.y-o,p=(l*h-s*f)/c,d=(-u*h+a*f)/c;return e.z+p*(n.z-e.z)+d*(i.z-e.z)},Fh.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),a=i;return r>a&&(a=r),o>a&&(a=o),a},Fh.isAcute=function(t,e,n){return!!Ih.isAcute(t,e,n)&&!!Ih.isAcute(e,n,t)&&!!Ih.isAcute(n,t,e)},Fh.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,a=t.y-r,s=e.x-i,u=e.y-r,l=2*Fh.det(o,a,s,u),c=Fh.det(a,o*o+a*a,u,s*s+u*u),h=Fh.det(o,o*o+a*a,s,s*s+u*u);return new xu(i-c/l,r+h/l)},Fh.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new qu(t.x+n/2,t.y+i/2,1),o=new qu(t.x-i+n/2,t.y+n+i/2,1);return new qu(r,o)},Fh.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,a=n.y-t.y;return new xu(t.x+r*o,t.y+r*a)},Fh.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,a=n.x-t.x,s=n.y-t.y,u=n.z-t.z,l=r*u-o*s,c=o*a-i*u,h=i*s-r*a,f=l*l+c*c+h*h,p=Math.sqrt(f)/2;return p},Fh.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new xu(i,r)},Fh.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),a=i+r+o,s=(i*t.x+r*e.x+o*n.x)/a,u=(i*t.y+r*e.y+o*n.y)/a;return new xu(s,u)};var jh=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new xl;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};jh.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Mu.EXTERIOR,Mu.INTERIOR)},jh.prototype.addPolygon=function(t){var e=this._distance,n=Sc.LEFT;this._distance<0&&(e=-this._distance,n=Sc.RIGHT);var i=t.getExteriorRing(),r=Pl.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,Mu.EXTERIOR,Mu.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var a=t.getInteriorRingN(o),s=Pl.removeRepeatedPoints(a.getCoordinates());this._distance>0&&this.isErodedCompletely(a,-this._distance)||this.addPolygonRing(s,e,Sc.opposite(n),Mu.INTERIOR,Mu.EXTERIOR)}},jh.prototype.isTriangleErodedCompletely=function(t,e){var n=new Fh(t[0],t[1],t[2]),i=n.inCentre();return al.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},jh.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Pl.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,Mu.EXTERIOR,Mu.INTERIOR)},jh.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new ph(t,new kc(0,Mu.BOUNDARY,e,n));this._curveList.add(i)},jh.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},jh.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<ec.MINIMUM_VALID_SIZE)return null;var o=i,a=r;t.length>=ec.MINIMUM_VALID_SIZE&&al.isCCW(t)&&(o=r,a=i,n=Sc.opposite(n));var s=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(s,o,a)},jh.prototype.add=function(t){return t.isEmpty()?null:void(t instanceof Ql?this.addPolygon(t):t instanceof Zl?this.addLineString(t):t instanceof Kl?this.addPoint(t):t instanceof tc?this.addCollection(t):t instanceof Hl?this.addCollection(t):t instanceof nc?this.addCollection(t):t instanceof Ul&&this.addCollection(t))},jh.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},jh.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},jh.prototype.interfaces_=function(){return[]},jh.prototype.getClass=function(){return jh};var zh=function(){};zh.prototype.locate=function(t){},zh.prototype.interfaces_=function(){return[]},zh.prototype.getClass=function(){return zh};var Bh=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Bh.prototype.next=function(){if(this._atStart)return this._atStart=!1,Bh.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new Tr;var t=this._parent.getGeometryN(this._index++);return t instanceof Ul?(this._subcollectionIterator=new Bh(t),this._subcollectionIterator.next()):t},Bh.prototype.remove=function(){throw new Error(this.getClass().getName())},Bh.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Bh.prototype.interfaces_=function(){return[bl]},Bh.prototype.getClass=function(){return Bh},Bh.isAtomic=function(t){return!(t instanceof Ul)};var Gh=function(){this._geom=null;var t=arguments[0];this._geom=t};Gh.prototype.locate=function(t){return Gh.locate(t,this._geom)},Gh.prototype.interfaces_=function(){return[zh]},Gh.prototype.getClass=function(){return Gh},Gh.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&al.isPointInRing(t,e.getCoordinates())},Gh.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Gh.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(Gh.isPointInRing(t,r))return!1}return!0},Gh.containsPoint=function(t,e){if(e instanceof Ql)return Gh.containsPointInPolygon(t,e);if(e instanceof Ul)for(var n=new Bh(e);n.hasNext();){var i=n.next();if(i!==e&&Gh.containsPoint(t,i))return!0}return!1},Gh.locate=function(t,e){return e.isEmpty()?Mu.EXTERIOR:Gh.containsPoint(t,e)?Mu.INTERIOR:Mu.EXTERIOR};var Uh=function(){this._edgeMap=new jr,this._edgeList=null,this._ptInAreaLocation=[Mu.NONE,Mu.NONE]};Uh.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Uh.prototype.propagateSideLabels=function(t){for(var e=Mu.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Sc.LEFT)!==Mu.NONE&&(e=i.getLocation(t,Sc.LEFT))}if(e===Mu.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getLabel();if(s.getLocation(t,Sc.ON)===Mu.NONE&&s.setLocation(t,Sc.ON,r),s.isArea(t)){var u=s.getLocation(t,Sc.LEFT),l=s.getLocation(t,Sc.RIGHT);if(l!==Mu.NONE){if(l!==r)throw new Lc("side location conflict",a.getCoordinate());u===Mu.NONE&&tl.shouldNeverReachHere("found single null side (at "+a.getCoordinate()+")"),r=u}else tl.isTrue(s.getLocation(t,Sc.LEFT)===Mu.NONE,"found single null side"),s.setLocation(t,Sc.RIGHT,r),s.setLocation(t,Sc.LEFT,r)}}},Uh.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Uh.prototype.print=function(t){Hu.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t);
},Uh.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Uh.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Sc.LEFT);tl.isTrue(i!==Mu.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var a=o.next().getLabel();tl.isTrue(a.isArea(t),"Found non-area edge");var s=a.getLocation(t,Sc.LEFT),u=a.getLocation(t,Sc.RIGHT);if(s===u)return!1;if(u!==r)return!1;r=s}return!0},Uh.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Uh.prototype.iterator=function(){return this.getEdges().iterator()},Uh.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new xl(this._edgeMap.values())),this._edgeList},Uh.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===Mu.NONE&&(this._ptInAreaLocation[t]=Gh.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Uh.prototype.toString=function(){var t=new ku;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Uh.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Uh.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===Mu.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel(),u=0;u<2;u++)if(s.isAnyNull(u)){var l=Mu.NONE;if(e[u])l=Mu.EXTERIOR;else{var c=a.getCoordinate();l=this.getLocation(u,c,t)}s.setAllLocationsIfNull(u,l)}},Uh.prototype.getDegree=function(){return this._edgeMap.size()},Uh.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Uh.prototype.interfaces_=function(){return[]},Uh.prototype.getClass=function(){return Uh};var Hh=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Lc("no outgoing dirEdge found",this.getCoordinate());tl.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return zc.isNorthern(r)&&zc.isNorthern(o)?n:zc.isNorthern(r)||zc.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(tl.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},e.prototype.print=function(t){Hu.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new xl;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Sc.LEFT),i=t.getDepth(Sc.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new Lc("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[0],a=arguments[1],s=arguments[2],u=o;u<a;u++){var l=this._edgeList.get(u);l.setEdgeDepths(Sc.RIGHT,s),s=l.getDepth(Sc.LEFT)}return s}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var o=this._resultAreaEdgeList.get(r),a=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(a.getEdgeRing()!==t)continue;n=a,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(tl.isTrue(null!==e,"found null for first outgoing dirEdge"),tl.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=Mu.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=Mu.INTERIOR;break}if(i.isInResult()){t=Mu.EXTERIOR;break}}}if(t===Mu.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var a=o.next(),s=a.getSym();a.isLineEdge()?a.getEdge().setCovered(r===Mu.INTERIOR):(a.isInResult()&&(r=Mu.EXTERIOR),s.isInResult()&&(r=Mu.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new kc(Mu.NONE);for(var n=this.iterator();n.hasNext();)for(var i=n.next().getEdge().getLabel(),r=0;r<2;r++){var o=i.getLocation(r);o!==Mu.INTERIOR&&o!==Mu.BOUNDARY||this._label.setLocation(r,Mu.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Uh),qh=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new Fc(t,new Hh)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Hc),Vh=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Vh.prototype.compareTo=function(t){var e=t;return Vh.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Vh.prototype.interfaces_=function(){return[wu]},Vh.prototype.getClass=function(){return Vh},Vh.orientation=function(t){return 1===Pl.increasingDirection(t)},Vh.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,a=e?t.length:-1,s=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var c=t[u].compareTo(n[l]);if(0!==c)return c;var h=(u+=r)===a,f=(l+=o)===s;if(h&&!f)return-1;if(!h&&f)return 1;if(h&&f)return 0}};var Wh=function(){this._edges=new xl,this._ocaMap=new jr};Wh.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Wh.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Wh.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Wh.prototype.iterator=function(){return this._edges.iterator()},Wh.prototype.getEdges=function(){return this._edges},Wh.prototype.get=function(t){return this._edges.get(t)},Wh.prototype.findEqualEdge=function(t){var e=new Vh(t.getCoordinates());return this._ocaMap.get(e)},Wh.prototype.add=function(t){this._edges.add(t);var e=new Vh(t.getCoordinates());this._ocaMap.put(e,t)},Wh.prototype.interfaces_=function(){return[]},Wh.prototype.getClass=function(){return Wh};var Yh=function(){};Yh.prototype.processIntersections=function(t,e,n,i){},Yh.prototype.isDone=function(){},Yh.prototype.interfaces_=function(){return[]},Yh.prototype.getClass=function(){return Yh};var Xh=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Xh.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Xh.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Xh.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Xh.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Xh.prototype.getLineIntersector=function(){return this._li},Xh.prototype.hasProperIntersection=function(){return this._hasProper},Xh.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[i],s=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,a,s),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Xh.prototype.hasIntersection=function(){return this._hasIntersection},Xh.prototype.isDone=function(){return!1},Xh.prototype.hasInteriorIntersection=function(){return this._hasInterior},Xh.prototype.interfaces_=function(){return[Yh]},Xh.prototype.getClass=function(){return Xh},Xh.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Zh=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new xu(t),this.segmentIndex=e,this.dist=n};Zh.prototype.getSegmentIndex=function(){return this.segmentIndex},Zh.prototype.getCoordinate=function(){return this.coord},Zh.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Zh.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Zh.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Zh.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Zh.prototype.getDistance=function(){return this.dist},Zh.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Zh.prototype.interfaces_=function(){return[wu]},Zh.prototype.getClass=function(){return Zh};var Jh=function(){this._nodeMap=new jr,this.edge=null;var t=arguments[0];this.edge=t};Jh.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Jh.prototype.iterator=function(){return this._nodeMap.values().iterator()},Jh.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Jh.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Jh.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),a=0;o[a++]=new xu(t.coord);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)o[a++]=this.edge.pts[s];return r&&(o[a]=e.coord),new ef(o,new kc(this.edge._label))},Jh.prototype.add=function(t,e,n){var i=new Zh(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Jh.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Jh.prototype.interfaces_=function(){return[]},Jh.prototype.getClass=function(){return Jh};var Kh=function(){};Kh.prototype.getChainStartIndices=function(t){var e=0,n=new xl;n.add(new Ou(e));do{var i=this.findChainEnd(t,e);n.add(new Ou(i)),e=i}while(e<t.length-1);return Kh.toIntArray(n)},Kh.prototype.findChainEnd=function(t,e){for(var n=zc.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&zc.quadrant(t[i-1],t[i])===n;)i++;return i-1},Kh.prototype.interfaces_=function(){return[]},Kh.prototype.getClass=function(){return Kh},Kh.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var $h=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Vu,this.env2=new Vu;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Kh;this.startIndex=e.getChainStartIndices(this.pts)};$h.prototype.getCoordinates=function(){return this.pts},$h.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},$h.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},$h.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=arguments[4],l=arguments[5],c=this.pts[r],h=this.pts[o],f=a.pts[s],p=a.pts[u];if(o-r==1&&u-s==1)return l.addIntersections(this.e,r,a.e,s),null;if(this.env1.init(c,h),this.env2.init(f,p),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((s+u)/2);r<d&&(s<g&&this.computeIntersectsForChain(r,d,a,s,g,l),g<u&&this.computeIntersectsForChain(r,d,a,g,u,l)),d<o&&(s<g&&this.computeIntersectsForChain(d,o,a,s,g,l),g<u&&this.computeIntersectsForChain(d,o,a,g,u,l))}},$h.prototype.getStartIndexes=function(){return this.startIndex},$h.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},$h.prototype.interfaces_=function(){return[]},$h.prototype.getClass=function(){return $h};var Qh=function t(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},tf={NULL_VALUE:{configurable:!0}};Qh.prototype.getDepth=function(t,e){return this._depth[t][e]},Qh.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},Qh.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==Qh.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===Qh.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===Qh.NULL_VALUE}},Qh.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},Qh.prototype.getDelta=function(t){return this._depth[t][Sc.RIGHT]-this._depth[t][Sc.LEFT]},Qh.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?Mu.EXTERIOR:Mu.INTERIOR},Qh.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},Qh.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==Mu.EXTERIOR&&i!==Mu.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=Qh.depthAtLocation(i):this._depth[e][n]+=Qh.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===Mu.INTERIOR&&this._depth[r][o]++}},Qh.prototype.interfaces_=function(){return[]},Qh.prototype.getClass=function(){return Qh},Qh.depthAtLocation=function(t){return t===Mu.EXTERIOR?0:t===Mu.INTERIOR?1:Qh.NULL_VALUE},tf.NULL_VALUE.get=function(){return-1},Object.defineProperties(Qh,tf);var ef=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Jh(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Qh,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,kc.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var i=!0,r=!0,o=this.pts.length,a=0;a<this.pts.length;a++)if(this.pts[a].equals2D(n.pts[a])||(i=!1),this.pts[a].equals2D(n.pts[--o])||(r=!1),!i&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new $h(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new Vu;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,i){var r=new xu(t.getIntersection(i)),o=e,a=t.getEdgeDistance(n,i),s=o+1;if(s<this.pts.length){var u=this.pts[s];r.equals2D(u)&&(o=s,a=0)}this.eiList.add(r,o,a)},e.prototype.toString=function(){var t=new ku;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Sc.ON),e.getLocation(1,Sc.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Sc.LEFT),e.getLocation(1,Sc.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Sc.RIGHT),e.getLocation(1,Sc.RIGHT),2))},e}(Rc),nf=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Wh,this._bufParams=t||null};nf.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},nf.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new kc(t.getLabel())).flip(),n.merge(i);var r=nf.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(nf.depthDelta(t.getLabel()))},nf.prototype.buildSubgraphs=function(t,e){for(var n=new xl,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),a=new Dh(n).getDepth(o);r.computeDepth(a),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},nf.prototype.createSubgraphs=function(t){for(var e=new xl,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Tc;r.create(i),e.add(r)}}return Qc.sort(e,Qc.reverseOrder()),e},nf.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},nf.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new bh,n=new il;return n.setPrecisionModel(t),e.setSegmentIntersector(new Xh(n)),e},nf.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new Oh(n,this._bufParams),r=new jh(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new qc(new qh),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),a=new Vc(this._geomFact);this.buildSubgraphs(o,a);var s=a.getPolygons();return s.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(s)},nf.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var a=r.getData(),s=new ef(r.getCoordinates(),new kc(a));this.insertUniqueEdge(s)}}},nf.prototype.setNoder=function(t){this._workingNoder=t},nf.prototype.interfaces_=function(){return[]},nf.prototype.getClass=function(){return nf},nf.depthDelta=function(t){var e=t.getLocation(0,Sc.LEFT),n=t.getLocation(0,Sc.RIGHT);return e===Mu.INTERIOR&&n===Mu.EXTERIOR?1:e===Mu.EXTERIOR&&n===Mu.INTERIOR?-1:0},nf.convertSegStrings=function(t){for(var e=new mc,n=new xl;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var rf=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};rf.prototype.rescale=function(){if(Iu(arguments[0],_l))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&Hu.out.println(n)}},rf.prototype.scale=function(){if(Iu(arguments[0],_l)){for(var t=arguments[0],e=new xl,n=t.iterator();n.hasNext();){var i=n.next();e.add(new ph(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),a=0;a<r.length;a++)o[a]=new xu(Math.round((r[a].x-this._offsetX)*this._scaleFactor),Math.round((r[a].y-this._offsetY)*this._scaleFactor),r[a].z);return Pl.removeRepeatedPoints(o)}},rf.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},rf.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},rf.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},rf.prototype.interfaces_=function(){return[_h]},rf.prototype.getClass=function(){return rf};var of=function(){this._li=new il,this._segStrings=null;var t=arguments[0];this._segStrings=t},af={fact:{configurable:!0}};of.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new $u("found endpt/interior pt intersection at index "+o+" :pt "+n)},of.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],a=r.getCoordinates(),s=o.getCoordinates(),u=0;u<a.length-1;u++)for(var l=0;l<s.length-1;l++)this.checkInteriorIntersections(r,u,o,l);else if(4===arguments.length){var c=arguments[0],h=arguments[1],f=arguments[2],p=arguments[3];if(c===f&&h===p)return null;var d=c.getCoordinates()[h],g=c.getCoordinates()[h+1],y=f.getCoordinates()[p],m=f.getCoordinates()[p+1];if(this._li.computeIntersection(d,g,y,m),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,y,m)))throw new $u("found non-noded intersection at "+d+"-"+g+" and "+y+"-"+m)}},of.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},of.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},of.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},of.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new $u("found non-noded collapse at "+of.fact.createLineString([t,e,n]))},of.prototype.interfaces_=function(){return[]},of.prototype.getClass=function(){return of},af.fact.get=function(){return new mc},Object.defineProperties(of,af);var sf=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new mu("Scale factor must be non-zero");1!==e&&(this._pt=new xu(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new xu,this._p1Scaled=new xu),this.initCorners(this._pt)},uf={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};sf.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),a=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(a)return!1;var s=this.intersectsToleranceSquare(t,e);return tl.isTrue(!(a&&s),"Found bad envelope test"),s},sf.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new xu(this._maxx,this._maxy),this._corner[1]=new xu(this._minx,this._maxy),this._corner[2]=new xu(this._minx,this._miny),this._corner[3]=new xu(this._maxx,this._miny)},sf.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},sf.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},sf.prototype.getCoordinate=function(){return this._originalPt},sf.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},sf.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=sf.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Vu(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},sf.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},sf.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},sf.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},sf.prototype.interfaces_=function(){return[]},sf.prototype.getClass=function(){return sf},uf.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(sf,uf);var lf=function(){this.tempEnv1=new Vu,this.selectedSegment=new dh};lf.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}},lf.prototype.interfaces_=function(){return[]},lf.prototype.getClass=function(){return lf};var cf=function(){this._index=null;var t=arguments[0];this._index=t},hf={HotPixelSnapAction:{configurable:!0}};cf.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new ff(e,n,i);return this._index.query(r,{interfaces_:function(){return[Zc]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},cf.prototype.interfaces_=function(){return[]},cf.prototype.getClass=function(){return cf},hf.HotPixelSnapAction.get=function(){return ff},Object.defineProperties(cf,hf);var ff=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;
var e=arguments[0],n=arguments[1],i=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[0],n=arguments[1],i=e.getContext();return null!==this._parentEdge&&i===this._parentEdge&&n===this._hotPixelVertexIndex?null:void(this._isNodeAdded=this._hotPixel.addSnappedNode(i,n))},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(lf),pf=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new xl};pf.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[i],s=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},pf.prototype.isDone=function(){return!1},pf.prototype.getInteriorIntersections=function(){return this._interiorIntersections},pf.prototype.interfaces_=function(){return[Yh]},pf.prototype.getClass=function(){return pf};var df=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new il,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};df.prototype.checkCorrectness=function(t){var e=ph.getNodedSubstrings(t),n=new of(e);try{n.checkValid()}catch(t){if(!(t instanceof Gu))throw t;t.printStackTrace()}},df.prototype.getNodedSubstrings=function(){return ph.getNodedSubstrings(this._nodedSegStrings)},df.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},df.prototype.findInteriorIntersections=function(t,e){var n=new pf(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},df.prototype.computeVertexSnaps=function(){if(Iu(arguments[0],_l))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof ph)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new sf(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},df.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new bh,this._pointSnapper=new cf(this._noder.getIndex()),this.snapRound(t,this._li)},df.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new sf(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},df.prototype.interfaces_=function(){return[_h]},df.prototype.getClass=function(){return df};var gf=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new xh,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},yf={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};gf.prototype.bufferFixedPrecision=function(t){var e=new rf(new df(new pc(1)),t.getScale()),n=new nf(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},gf.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=gf.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Lc))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=gf.precisionScaleFactor(this._argGeom,this._distance,n),r=new pc(i);this.bufferFixedPrecision(r)}},gf.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===pc.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},gf.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},gf.prototype.bufferOriginalPrecision=function(){try{var t=new nf(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof $u))throw t;this._saveException=t}},gf.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},gf.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},gf.prototype.interfaces_=function(){return[]},gf.prototype.getClass=function(){return gf},gf.bufferOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new gf(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ll&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2],o=new gf(n);return o.setQuadrantSegments(r),o.getResultGeometry(i)}if(arguments[2]instanceof xh&&arguments[0]instanceof ll&&"number"==typeof arguments[1]){var a=arguments[0],s=arguments[1],u=arguments[2];return new gf(a,u).getResultGeometry(s)}}else if(4===arguments.length){var l=arguments[0],c=arguments[1],h=arguments[2],f=arguments[3],p=new gf(l);return p.setQuadrantSegments(h),p.setEndCapStyle(f),p.getResultGeometry(c)}},gf.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=Tu.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},yf.CAP_ROUND.get=function(){return xh.CAP_ROUND},yf.CAP_BUTT.get=function(){return xh.CAP_FLAT},yf.CAP_FLAT.get=function(){return xh.CAP_FLAT},yf.CAP_SQUARE.get=function(){return xh.CAP_SQUARE},yf.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(gf,yf);var mf=function(){this._pt=[new xu,new xu],this._distance=vu.NaN,this._isNull=!0};mf.prototype.getCoordinates=function(){return this._pt},mf.prototype.getCoordinate=function(t){return this._pt[t]},mf.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},mf.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},mf.prototype.getDistance=function(){return this._distance},mf.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},mf.prototype.interfaces_=function(){return[]},mf.prototype.getClass=function(){return mf};var vf=function(){};vf.prototype.interfaces_=function(){return[]},vf.prototype.getClass=function(){return vf},vf.computeDistance=function(){if(arguments[2]instanceof mf&&arguments[0]instanceof Zl&&arguments[1]instanceof xu)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=t.getCoordinates(),r=new dh,o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var a=r.closestPoint(e);n.setMinimum(a,e)}else if(arguments[2]instanceof mf&&arguments[0]instanceof Ql&&arguments[1]instanceof xu){var s=arguments[0],u=arguments[1],l=arguments[2];vf.computeDistance(s.getExteriorRing(),u,l);for(var c=0;c<s.getNumInteriorRing();c++)vf.computeDistance(s.getInteriorRingN(c),u,l)}else if(arguments[2]instanceof mf&&arguments[0]instanceof ll&&arguments[1]instanceof xu){var h=arguments[0],f=arguments[1],p=arguments[2];if(h instanceof Zl)vf.computeDistance(h,f,p);else if(h instanceof Ql)vf.computeDistance(h,f,p);else if(h instanceof Ul)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);vf.computeDistance(y,f,p)}else p.setMinimum(h.getCoordinate(),f)}else if(arguments[2]instanceof mf&&arguments[0]instanceof dh&&arguments[1]instanceof xu){var m=arguments[0],v=arguments[1],_=arguments[2],w=m.closestPoint(v);_.setMinimum(w,v)}};var _f=function(t){this._maxPtDist=new mf,this._inputGeom=t||null},wf={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};_f.prototype.computeMaxMidpointDistance=function(t){var e=new Cf(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_f.prototype.computeMaxVertexDistance=function(t){var e=new bf(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_f.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},_f.prototype.getDistancePoints=function(){return this._maxPtDist},_f.prototype.interfaces_=function(){return[]},_f.prototype.getClass=function(){return _f},wf.MaxPointDistanceFilter.get=function(){return bf},wf.MaxMidpointDistanceFilter.get=function(){return Cf},Object.defineProperties(_f,wf);var bf=function(t){this._maxPtDist=new mf,this._minPtDist=new mf,this._geom=t||null};bf.prototype.filter=function(t){this._minPtDist.initialize(),vf.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},bf.prototype.getMaxPointDistance=function(){return this._maxPtDist},bf.prototype.interfaces_=function(){return[fl]},bf.prototype.getClass=function(){return bf};var Cf=function(t){this._maxPtDist=new mf,this._minPtDist=new mf,this._geom=t||null};Cf.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new xu((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),vf.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Cf.prototype.isDone=function(){return!1},Cf.prototype.isGeometryChanged=function(){return!1},Cf.prototype.getMaxPointDistance=function(){return this._maxPtDist},Cf.prototype.interfaces_=function(){return[Gl]},Cf.prototype.getClass=function(){return Cf};var xf=function(t){this._comps=t||null};xf.prototype.filter=function(t){t instanceof Ql&&this._comps.add(t)},xf.prototype.interfaces_=function(){return[Bl]},xf.prototype.getClass=function(){return xf},xf.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return xf.getPolygons(t,new xl)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Ql?n.add(e):e instanceof Ul&&e.apply(new xf(n)),n}};var Ef=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};Ef.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ec){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Zl&&this._lines.add(t)},Ef.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Ef.prototype.interfaces_=function(){return[ul]},Ef.prototype.getClass=function(){return Ef},Ef.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Ef.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Ef.getLines(e,n))}},Ef.getLines=function(){if(1===arguments.length){var t=arguments[0];return Ef.getLines(t,!1)}if(2===arguments.length){if(Iu(arguments[0],_l)&&Iu(arguments[1],_l)){for(var e=arguments[0],n=arguments[1],i=e.iterator();i.hasNext();){var r=i.next();Ef.getLines(r,n)}return n}if(arguments[0]instanceof ll&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1],s=new xl;return o.apply(new Ef(s,a)),s}if(arguments[0]instanceof ll&&Iu(arguments[1],_l)){var u=arguments[0],l=arguments[1];return u instanceof Zl?l.add(u):u.apply(new Ef(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&Iu(arguments[0],_l)&&Iu(arguments[1],_l)){for(var c=arguments[0],h=arguments[1],f=arguments[2],p=c.iterator();p.hasNext();){var d=p.next();Ef.getLines(d,h,f)}return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ll&&Iu(arguments[1],_l)){var g=arguments[0],y=arguments[1],m=arguments[2];return g.apply(new Ef(y,m)),y}}};var Sf=function(){if(this._boundaryRule=pl.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new mu("Rule must be non-null");this._boundaryRule=t}};Sf.prototype.locateInternal=function(){if(arguments[0]instanceof xu&&arguments[1]instanceof Ql){var t=arguments[0],e=arguments[1];if(e.isEmpty())return Mu.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===Mu.EXTERIOR)return Mu.EXTERIOR;if(i===Mu.BOUNDARY)return Mu.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),a=this.locateInPolygonRing(t,o);if(a===Mu.INTERIOR)return Mu.EXTERIOR;if(a===Mu.BOUNDARY)return Mu.BOUNDARY}return Mu.INTERIOR}if(arguments[0]instanceof xu&&arguments[1]instanceof Zl){var s=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(s))return Mu.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!s.equals(l[0])&&!s.equals(l[l.length-1])?al.isOnLine(s,l)?Mu.INTERIOR:Mu.EXTERIOR:Mu.BOUNDARY}if(arguments[0]instanceof xu&&arguments[1]instanceof Kl){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?Mu.INTERIOR:Mu.EXTERIOR}},Sf.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?al.locatePointInRing(t,e.getCoordinates()):Mu.EXTERIOR},Sf.prototype.intersects=function(t,e){return this.locate(t,e)!==Mu.EXTERIOR},Sf.prototype.updateLocationInfo=function(t){t===Mu.INTERIOR&&(this._isIn=!0),t===Mu.BOUNDARY&&this._numBoundaries++},Sf.prototype.computeLocation=function(t,e){if(e instanceof Kl&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Zl)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Ql)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Hl)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof nc)for(var o=e,a=0;a<o.getNumGeometries();a++){var s=o.getGeometryN(a);this.updateLocationInfo(this.locateInternal(t,s))}else if(e instanceof Ul)for(var u=new Bh(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}},Sf.prototype.locate=function(t,e){return e.isEmpty()?Mu.EXTERIOR:e instanceof Zl?this.locateInternal(t,e):e instanceof Ql?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?Mu.BOUNDARY:this._numBoundaries>0||this._isIn?Mu.INTERIOR:Mu.EXTERIOR)},Sf.prototype.interfaces_=function(){return[]},Sf.prototype.getClass=function(){return Sf};var Pf=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._component=i,this._segIndex=r,this._pt=o}},Mf={INSIDE_AREA:{configurable:!0}};Pf.prototype.isInsideArea=function(){return this._segIndex===Pf.INSIDE_AREA},Pf.prototype.getCoordinate=function(){return this._pt},Pf.prototype.getGeometryComponent=function(){return this._component},Pf.prototype.getSegmentIndex=function(){return this._segIndex},Pf.prototype.interfaces_=function(){return[]},Pf.prototype.getClass=function(){return Pf},Mf.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Pf,Mf);var Lf=function(t){this._pts=t||null};Lf.prototype.filter=function(t){t instanceof Kl&&this._pts.add(t)},Lf.prototype.interfaces_=function(){return[Bl]},Lf.prototype.getClass=function(){return Lf},Lf.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Kl?Qc.singletonList(t):Lf.getPoints(t,new xl)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Kl?n.add(e):e instanceof Ul&&e.apply(new Lf(n)),n}};var If=function(){this._locations=null;var t=arguments[0];this._locations=t};If.prototype.filter=function(t){(t instanceof Kl||t instanceof Zl||t instanceof Ql)&&this._locations.add(new Pf(t,0,t.getCoordinate()))},If.prototype.interfaces_=function(){return[Bl]},If.prototype.getClass=function(){return If},If.getLocations=function(t){var e=new xl;return t.apply(new If(e)),e};var Tf=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Sf,this._minDistanceLocation=null,this._minDistance=vu.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};Tf.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=xf.getPolygons(this._geom[e]);if(r.size()>0){var o=If.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&Iu(arguments[0],Cl)&&Iu(arguments[1],Cl)){for(var a=arguments[0],s=arguments[1],u=arguments[2],l=0;l<a.size();l++)for(var c=a.get(l),h=0;h<s.size();h++)if(this.computeContainmentDistance(c,s.get(h),u),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Pf&&arguments[1]instanceof Ql){var f=arguments[0],p=arguments[1],d=arguments[2],g=f.getCoordinate();if(Mu.EXTERIOR!==this._ptLocator.locate(g,p))return this._minDistance=0,d[0]=f,d[1]=new Pf(p,g),null}},Tf.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(r,a,n),this._minDistance<=this._terminateDistance)return null}},Tf.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Ef.getLines(this._geom[0]),n=Ef.getLines(this._geom[1]),i=Lf.getPoints(this._geom[0]),r=Lf.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Tf.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Tf.prototype.updateMinDistance=function(t,e){return null===t[0]?null:void(e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1]))},Tf.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Tf.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Zl&&arguments[1]instanceof Kl){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var a=al.distancePointLine(r,i[o],i[o+1]);if(a<this._minDistance){this._minDistance=a;var s=new dh(i[o],i[o+1]).closestPoint(r);n[0]=new Pf(t,o,s),n[1]=new Pf(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Zl&&arguments[1]instanceof Zl){var u=arguments[0],l=arguments[1],c=arguments[2];if(u.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var h=u.getCoordinates(),f=l.getCoordinates(),p=0;p<h.length-1;p++)for(var d=0;d<f.length-1;d++){var g=al.distanceLineLine(h[p],h[p+1],f[d],f[d+1]);if(g<this._minDistance){this._minDistance=g;var y=new dh(h[p],h[p+1]),m=new dh(f[d],f[d+1]),v=y.closestPoints(m);c[0]=new Pf(u,p,v[0]),c[1]=new Pf(l,d,v[1])}if(this._minDistance<=this._terminateDistance)return null}}},Tf.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var a=e.get(o),s=r.getCoordinate().distance(a.getCoordinate());if(s<this._minDistance&&(this._minDistance=s,n[0]=new Pf(r,0,r.getCoordinate()),n[1]=new Pf(a,0,a.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Tf.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new mu("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Tf.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var a=e.get(o);if(this.computeMinDistance(r,a,n),this._minDistance<=this._terminateDistance)return null}},Tf.prototype.interfaces_=function(){return[]},Tf.prototype.getClass=function(){return Tf},Tf.distance=function(t,e){return new Tf(t,e).distance()},Tf.isWithinDistance=function(t,e,n){return new Tf(t,e,n).distance()<=n},Tf.nearestPoints=function(t,e){return new Tf(t,e).nearestPoints()};var Nf=function(){this._pt=[new xu,new xu],this._distance=vu.NaN,this._isNull=!0};Nf.prototype.getCoordinates=function(){return this._pt},Nf.prototype.getCoordinate=function(t){return this._pt[t]},Nf.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Nf.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Nf.prototype.toString=function(){return Ku.toLineString(this._pt[0],this._pt[1])},Nf.prototype.getDistance=function(){return this._distance},Nf.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Nf.prototype.interfaces_=function(){return[]},Nf.prototype.getClass=function(){return Nf};var kf=function(){};kf.prototype.interfaces_=function(){return[]},kf.prototype.getClass=function(){return kf},kf.computeDistance=function(){if(arguments[2]instanceof Nf&&arguments[0]instanceof Zl&&arguments[1]instanceof xu)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new dh,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var a=i.closestPoint(e);n.setMinimum(a,e)}else if(arguments[2]instanceof Nf&&arguments[0]instanceof Ql&&arguments[1]instanceof xu){var s=arguments[0],u=arguments[1],l=arguments[2];kf.computeDistance(s.getExteriorRing(),u,l);for(var c=0;c<s.getNumInteriorRing();c++)kf.computeDistance(s.getInteriorRingN(c),u,l)}else if(arguments[2]instanceof Nf&&arguments[0]instanceof ll&&arguments[1]instanceof xu){var h=arguments[0],f=arguments[1],p=arguments[2];if(h instanceof Zl)kf.computeDistance(h,f,p);else if(h instanceof Ql)kf.computeDistance(h,f,p);else if(h instanceof Ul)for(var d=h,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);kf.computeDistance(y,f,p)}else p.setMinimum(h.getCoordinate(),f)}else if(arguments[2]instanceof Nf&&arguments[0]instanceof dh&&arguments[1]instanceof xu){var m=arguments[0],v=arguments[1],_=arguments[2],w=m.closestPoint(v);_.setMinimum(w,v)}};var Of=function(){this._g0=null,this._g1=null,this._ptDist=new Nf,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Df={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Of.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Of.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new mu("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Of.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Of.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Of.prototype.computeOrientedDistance=function(t,e,n){var i=new Af(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new Rf(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Of.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Of.prototype.interfaces_=function(){return[]},Of.prototype.getClass=function(){return Of},Of.distance=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Of(t,e).distance()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new Of(n,i);return o.setDensifyFraction(r),o.distance()}},Df.MaxPointDistanceFilter.get=function(){return Af},Df.MaxDensifiedByFractionDistanceFilter.get=function(){return Rf},Object.defineProperties(Of,Df);var Af=function(){this._maxPtDist=new Nf,this._minPtDist=new Nf,this._euclideanDist=new kf,this._geom=null;var t=arguments[0];this._geom=t};Af.prototype.filter=function(t){this._minPtDist.initialize(),kf.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Af.prototype.getMaxPointDistance=function(){return this._maxPtDist},Af.prototype.interfaces_=function(){return[fl]},Af.prototype.getClass=function(){return Af};var Rf=function(){this._maxPtDist=new Nf,this._minPtDist=new Nf,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Rf.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,a=0;a<this._numSubSegs;a++){var s=n.x+a*r,u=n.y+a*o,l=new xu(s,u);this._minPtDist.initialize(),kf.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Rf.prototype.isDone=function(){return!1},Rf.prototype.isGeometryChanged=function(){return!1},Rf.prototype.getMaxPointDistance=function(){return this._maxPtDist},Rf.prototype.interfaces_=function(){return[Gl]},Rf.prototype.getClass=function(){return Rf};var Ff=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},jf={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Ff.prototype.checkMaximumDistance=function(t,e,n){var i=new Of(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Ku.toLineString(r[0],r[1])+")"}},Ff.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Ff.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Ff.VERBOSE&&Hu.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Ff.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ql||this._input instanceof nc||this._input instanceof Ul))return null;var t=this.getPolygonLines(this._input);return this.checkMinimumDistance(t,this._result,this._minValidDistance),this._isValid?void this.checkMaximumDistance(t,this._result,this._maxValidDistance):null},Ff.prototype.getErrorIndicator=function(){return this._errorIndicator},Ff.prototype.checkMinimumDistance=function(t,e,n){var i=new Tf(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Ku.toLineString(r[0],r[1])+" )"}},Ff.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();return this.checkMinimumDistance(this._input,t,this._minValidDistance),this._isValid?void this.checkMaximumDistance(this._input,t,this._maxValidDistance):null},Ff.prototype.getErrorLocation=function(){return this._errorLocation},Ff.prototype.getPolygonLines=function(t){for(var e=new xl,n=new Ef(e),i=xf.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},Ff.prototype.getErrorMessage=function(){return this._errMsg},Ff.prototype.interfaces_=function(){return[]},Ff.prototype.getClass=function(){return Ff},jf.VERBOSE.get=function(){return!1},jf.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Ff,jf);var zf=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},Bf={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};zf.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},zf.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*zf.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Vu(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new Vu(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},zf.prototype.checkDistance=function(){var t=new Ff(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),
this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},zf.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},zf.prototype.checkPolygonal=function(){this._result instanceof Ql||this._result instanceof nc||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},zf.prototype.getErrorIndicator=function(){return this._errorIndicator},zf.prototype.getErrorLocation=function(){return this._errorLocation},zf.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2?null:this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},zf.prototype.report=function(t){return zf.VERBOSE?void Hu.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED")):null},zf.prototype.getErrorMessage=function(){return this._errorMsg},zf.prototype.interfaces_=function(){return[]},zf.prototype.getClass=function(){return zf},zf.isValidMsg=function(t,e,n){var i=new zf(t,e,n);return i.isValid()?null:i.getErrorMessage()},zf.isValid=function(t,e,n){return!!new zf(t,e,n).isValid()},Bf.VERBOSE.get=function(){return!1},Bf.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(zf,Bf);var Gf=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Gf.prototype.getCoordinates=function(){return this._pts},Gf.prototype.size=function(){return this._pts.length},Gf.prototype.getCoordinate=function(t){return this._pts[t]},Gf.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Gf.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:ch.octant(this.getCoordinate(t),this.getCoordinate(t+1))},Gf.prototype.setData=function(t){this._data=t},Gf.prototype.getData=function(){return this._data},Gf.prototype.toString=function(){return Ku.toLineString(new uc(this._pts))},Gf.prototype.interfaces_=function(){return[hh]},Gf.prototype.getClass=function(){return Gf};var Uf=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new xl,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Uf.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Uf.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Uf.prototype.getIntersectionSegments=function(){return this._intSegments},Uf.prototype.count=function(){return this._intersectionCount},Uf.prototype.getIntersections=function(){return this._intersections},Uf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Uf.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Uf.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[i],s=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,a,s),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=a,this._intSegments[3]=s,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Uf.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Uf.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Uf.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Uf.prototype.interfaces_=function(){return[Yh]},Uf.prototype.getClass=function(){return Uf},Uf.createAllIntersectionsFinder=function(t){var e=new Uf(t);return e.setFindAllIntersections(!0),e},Uf.createAnyIntersectionFinder=function(t){return new Uf(t)},Uf.createIntersectionCounter=function(t){var e=new Uf(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Hf=function(){this._li=new il,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Hf.prototype.execute=function(){return null!==this._segInt?null:void this.checkInteriorIntersections()},Hf.prototype.getIntersections=function(){return this._segInt.getIntersections()},Hf.prototype.isValid=function(){return this.execute(),this._isValid},Hf.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Hf.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Uf(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new bh;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Hf.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Lc(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Hf.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Ku.toLineString(t[0],t[1])+" and "+Ku.toLineString(t[2],t[3])},Hf.prototype.interfaces_=function(){return[]},Hf.prototype.getClass=function(){return Hf},Hf.computeIntersections=function(t){var e=new Hf(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var qf=function t(){this._nv=null;var e=arguments[0];this._nv=new Hf(t.toSegmentStrings(e))};qf.prototype.checkValid=function(){this._nv.checkValid()},qf.prototype.interfaces_=function(){return[]},qf.prototype.getClass=function(){return qf},qf.toSegmentStrings=function(t){for(var e=new xl,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Gf(i.getCoordinates(),i))}return e},qf.checkValid=function(t){new qf(t).checkValid()};var Vf=function(t){this._mapOp=t};Vf.prototype.map=function(t){for(var e=new xl,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(mc.toGeometryArray(e))},Vf.prototype.interfaces_=function(){return[]},Vf.prototype.getClass=function(){return Vf},Vf.map=function(t,e){return new Vf(e).map(t)};var Wf=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new xl,this._resultLineList=new xl;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Wf.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Wf.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Wf.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Wf.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Pp.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Wf.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Wf.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Wf.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},Wf.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(tl.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Pp.isResultOfOp(i,e)&&e===Pp.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Wf.prototype.interfaces_=function(){return[]},Wf.prototype.getClass=function(){return Wf};var Yf=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new xl;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Yf.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Yf.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Pp.INTERSECTION)){var i=n.getLabel();Pp.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Yf.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Yf.prototype.interfaces_=function(){return[]},Yf.prototype.getClass=function(){return Yf};var Xf=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Xf.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Xf.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof ec&&!i.isEmpty()||(n=!1);for(var r=new xl,o=0;o<t.getNumInteriorRing();o++){var a=this.transformLinearRing(t.getInteriorRingN(o),t);null===a||a.isEmpty()||(a instanceof ec||(n=!1),r.add(a))}if(n)return this._factory.createPolygon(i,r.toArray([]));var s=new xl;return null!==i&&s.add(i),s.addAll(r),this._factory.buildGeometry(s)},Xf.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Xf.prototype.getInputGeometry=function(){return this._inputGeom},Xf.prototype.transformMultiLineString=function(t,e){for(var n=new xl,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Xf.prototype.transformCoordinates=function(t,e){return this.copy(t)},Xf.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Xf.prototype.transformMultiPoint=function(t,e){for(var n=new xl,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Xf.prototype.transformMultiPolygon=function(t,e){for(var n=new xl,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Xf.prototype.copy=function(t){return t.copy()},Xf.prototype.transformGeometryCollection=function(t,e){for(var n=new xl,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(mc.toGeometryArray(n)):this._factory.buildGeometry(n)},Xf.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Kl)return this.transformPoint(t,null);if(t instanceof tc)return this.transformMultiPoint(t,null);if(t instanceof ec)return this.transformLinearRing(t,null);if(t instanceof Zl)return this.transformLineString(t,null);if(t instanceof Hl)return this.transformMultiLineString(t,null);if(t instanceof Ql)return this.transformPolygon(t,null);if(t instanceof nc)return this.transformMultiPolygon(t,null);if(t instanceof Ul)return this.transformGeometryCollection(t,null);throw new mu("Unknown Geometry subtype: "+t.getClass().getName())},Xf.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Xf.prototype.interfaces_=function(){return[]},Xf.prototype.getClass=function(){return Xf};var Zf=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new dh,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Zl&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1];this._srcPts=i,this._isClosed=t.isClosed(i),this._snapTolerance=r}};Zf.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new xu(o)),0===i&&this._isClosed&&t.set(t.size()-1,new xu(o)))}},Zf.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Zf.prototype.snapTo=function(t){var e=new Sl(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Zf.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new xu(r),!1)}},Zf.prototype.findSegmentIndexToSnap=function(t,e){for(var n=vu.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Zf.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Zf.prototype.interfaces_=function(){return[]},Zf.prototype.getClass=function(){return Zf},Zf.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Jf=function(t){this._srcGeom=t||null},Kf={SNAP_PRECISION_FACTOR:{configurable:!0}};Jf.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new $f(e,n).transform(this._srcGeom)},Jf.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new $f(t,n,!0).transform(this._srcGeom),r=i;return e&&Iu(r,$l)&&(r=i.buffer(0)),r},Jf.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Jf.prototype.extractTargetCoordinates=function(t){for(var e=new Br,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},Jf.prototype.computeMinimumSegmentLength=function(t){for(var e=vu.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},Jf.prototype.interfaces_=function(){return[]},Jf.prototype.getClass=function(){return Jf},Jf.snap=function(t,e,n){var i=new Array(2).fill(null),r=new Jf(t);i[0]=r.snapTo(e,n);var o=new Jf(e);return i[1]=o.snapTo(i[0],n),i},Jf.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Jf.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===pc.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(Jf.computeOverlaySnapTolerance(r),Jf.computeOverlaySnapTolerance(o))}},Jf.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Jf.SNAP_PRECISION_FACTOR},Jf.snapToSelf=function(t,e,n){return new Jf(t).snapToSelf(e,n)},Kf.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Jf,Kf);var $f=function(t){function e(e,n,i){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==i&&i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Zf(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Xf),Qf=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Qf.prototype.getCommon=function(){return vu.longBitsToDouble(this._commonBits)},Qf.prototype.add=function(t){var e=vu.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Qf.signExpBits(this._commonBits),this._isFirst=!1,null):Qf.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Qf.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Qf.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Qf.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=vu.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+vu.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},Qf.prototype.interfaces_=function(){return[]},Qf.prototype.getClass=function(){return Qf},Qf.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Qf.signExpBits=function(t){return t>>52},Qf.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Qf.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(Qf.getBit(t,i)!==Qf.getBit(e,i))return n;n++}return 52};var tp=function(){this._commonCoord=null,this._ccFilter=new np},ep={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tp.prototype.addCommonBits=function(t){var e=new ip(this._commonCoord);t.apply(e),t.geometryChanged()},tp.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new xu(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ip(e);return t.apply(n),t.geometryChanged(),t},tp.prototype.getCommonCoordinate=function(){return this._commonCoord},tp.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tp.prototype.interfaces_=function(){return[]},tp.prototype.getClass=function(){return tp},ep.CommonCoordinateFilter.get=function(){return np},ep.Translater.get=function(){return ip},Object.defineProperties(tp,ep);var np=function(){this._commonBitsX=new Qf,this._commonBitsY=new Qf};np.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},np.prototype.getCommonCoordinate=function(){return new xu(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},np.prototype.interfaces_=function(){return[fl]},np.prototype.getClass=function(){return np};var ip=function(){this.trans=null;var t=arguments[0];this.trans=t};ip.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},ip.prototype.isDone=function(){return!1},ip.prototype.isGeometryChanged=function(){return!0},ip.prototype.interfaces_=function(){return[Gl]},ip.prototype.getClass=function(){return ip};var rp=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rp.prototype.selfSnap=function(t){return new Jf(t).snapTo(t,this._snapTolerance)},rp.prototype.removeCommonBits=function(t){this._cbr=new tp,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rp.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rp.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Pp.overlayOp(e[0],e[1],t);return this.prepareResult(n)},rp.prototype.checkValid=function(t){t.isValid()||Hu.out.println("Snapped geometry is invalid")},rp.prototype.computeSnapTolerance=function(){this._snapTolerance=Jf.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rp.prototype.snap=function(t){var e=this.removeCommonBits(t);return Jf.snap(e[0],e[1],this._snapTolerance)},rp.prototype.interfaces_=function(){return[]},rp.prototype.getClass=function(){return rp},rp.overlayOp=function(t,e,n){return new rp(t,e).getResultGeometry(n)},rp.union=function(t,e){return rp.overlayOp(t,e,Pp.UNION)},rp.intersection=function(t,e){return rp.overlayOp(t,e,Pp.INTERSECTION)},rp.symDifference=function(t,e){return rp.overlayOp(t,e,Pp.SYMDIFFERENCE)},rp.difference=function(t,e){return rp.overlayOp(t,e,Pp.DIFFERENCE)};var op=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};op.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=Pp.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof $u))throw t;i=t}if(!n)try{e=rp.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof $u?i:t}return e},op.prototype.interfaces_=function(){return[]},op.prototype.getClass=function(){return op},op.overlayOp=function(t,e,n){return new op(t,e).getResultGeometry(n)},op.union=function(t,e){return op.overlayOp(t,e,Pp.UNION)},op.intersection=function(t,e){return op.overlayOp(t,e,Pp.INTERSECTION)},op.symDifference=function(t,e){return op.overlayOp(t,e,Pp.SYMDIFFERENCE)},op.difference=function(t,e){return op.overlayOp(t,e,Pp.DIFFERENCE)};var ap=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};ap.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},ap.prototype.interfaces_=function(){return[]},ap.prototype.getClass=function(){return ap};var sp=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},up={INSERT:{configurable:!0},DELETE:{configurable:!0}};sp.prototype.isDelete=function(){return this._eventType===sp.DELETE},sp.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},sp.prototype.getObject=function(){return this._obj},sp.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},sp.prototype.getInsertEvent=function(){return this._insertEvent},sp.prototype.isInsert=function(){return this._eventType===sp.INSERT},sp.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},sp.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},sp.prototype.interfaces_=function(){return[wu]},sp.prototype.getClass=function(){return sp},up.INSERT.get=function(){return 1},up.DELETE.get=function(){return 2},Object.defineProperties(sp,up);var lp=function(){};lp.prototype.interfaces_=function(){return[]},lp.prototype.getClass=function(){return lp};var cp=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};cp.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(cp.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},cp.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},cp.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},cp.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},cp.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},cp.prototype.hasProperIntersection=function(){return this._hasProper},cp.prototype.hasIntersection=function(){return this._hasIntersection},cp.prototype.isDone=function(){return this._isDone},cp.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},cp.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},cp.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],a=n.getCoordinates()[i],s=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,a,s),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},cp.prototype.interfaces_=function(){return[]},cp.prototype.getClass=function(){return cp},cp.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var hp=function(t){function e(){t.call(this),this.events=new xl,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Qc.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof cp&&Iu(arguments[0],Cl)&&Iu(arguments[1],Cl)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&Iu(arguments[0],Cl)&&arguments[1]instanceof cp){var a=arguments[0],s=arguments[1];arguments[2]?this.addEdges(a,null):this.addEdges(a),this.computeIntersections(s)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new ap(n,r),a=new sp(e,n.getMinX(r),o);this.events.add(a),this.events.add(new sp(n.getMaxX(r),a))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var a=this.events.get(o);if(a.isInsert()){var s=a.getObject();n.isSameLabel(a)||(r.computeIntersections(s,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1],r=n.iterator();r.hasNext();){var o=r.next();this.addEdge(o,i)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(lp),fp=function(){this._min=vu.POSITIVE_INFINITY,this._max=vu.NEGATIVE_INFINITY},pp={NodeComparator:{configurable:!0}};fp.prototype.getMin=function(){return this._min},fp.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},fp.prototype.getMax=function(){return this._max},fp.prototype.toString=function(){return Ku.toLineString(new xu(this._min,0),new xu(this._max,0))},fp.prototype.interfaces_=function(){return[]},fp.prototype.getClass=function(){return fp},pp.NodeComparator.get=function(){return dp},Object.defineProperties(fp,pp);var dp=function(){};dp.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:r>o?1:0},dp.prototype.interfaces_=function(){return[Cu]},dp.prototype.getClass=function(){return dp};var gp=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],i=arguments[2];this._min=e,this._max=n,this._item=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){return this.intersects(t,e)?void n.visitItem(this._item):null},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fp),yp=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){return this.intersects(t,e)?(null!==this._node1&&this._node1.query(t,e,n),void(null!==this._node2&&this._node2.query(t,e,n))):null},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fp),mp=function(){this._leaves=new xl,this._root=null,this._level=0};mp.prototype.buildTree=function(){Qc.sort(this._leaves,new fp.NodeComparator);for(var t=this._leaves,e=null,n=new xl;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},mp.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new gp(t,e,n))},mp.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},mp.prototype.buildRoot=function(){return null!==this._root?null:void(this._root=this.buildTree())},mp.prototype.printNode=function(t){Hu.out.println(Ku.toLineString(new xu(t._min,this._level),new xu(t._max,this._level)))},mp.prototype.init=function(){return null!==this._root?null:void this.buildRoot()},mp.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new yp(t.get(n),t.get(n+1));e.add(r)}}},mp.prototype.interfaces_=function(){return[]},mp.prototype.getClass=function(){return mp};var vp=function(){this._items=new xl};vp.prototype.visitItem=function(t){this._items.add(t)},vp.prototype.getItems=function(){return this._items},vp.prototype.interfaces_=function(){return[Zc]},vp.prototype.getClass=function(){return vp};var _p=function(){this._index=null;var t=arguments[0];if(!Iu(t,$l))throw new mu("Argument must be Polygonal");this._index=new Cp(t)},wp={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};_p.prototype.locate=function(t){var e=new ol(t),n=new bp(e);return this._index.query(t.y,t.y,n),e.getLocation()},_p.prototype.interfaces_=function(){return[zh]},_p.prototype.getClass=function(){return _p},wp.SegmentVisitor.get=function(){return bp},wp.IntervalIndexedGeometry.get=function(){return Cp},Object.defineProperties(_p,wp);var bp=function(){this._counter=null;var t=arguments[0];
this._counter=t};bp.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},bp.prototype.interfaces_=function(){return[Zc]},bp.prototype.getClass=function(){return bp};var Cp=function(){this._index=new mp;var t=arguments[0];this.init(t)};Cp.prototype.init=function(t){for(var e=Ef.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},Cp.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new dh(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},Cp.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new vp;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},Cp.prototype.interfaces_=function(){return[]},Cp.prototype.getClass=function(){return Cp};var xp=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new fc,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Sf,2===arguments.length){var e=arguments[0],n=arguments[1],i=pl.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=i,null!==n&&this.add(n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=a,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var i=this._nodes.addNode(n).getLabel(),r=1;Mu.NONE,i.getLocation(t,Sc.ON)===Mu.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=new cp(n,!0,!1);o.setIsDoneIfProperInt(r);var a=this.createEdgeSetIntersector(),s=this._parentGeom instanceof ec||this._parentGeom instanceof Ql||this._parentGeom instanceof nc,u=i||!s;return a.computeIntersections(this._edges,o,u),this.addSelfIntersectionNodes(this._argIndex),o}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var i=new cp(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Kl){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,Mu.INTERIOR)}else if(arguments[0]instanceof xu){var e=arguments[0];this.insertPoint(this._argIndex,e,Mu.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),Mu.EXTERIOR,Mu.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,Mu.INTERIOR,Mu.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],Mu.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],Mu.BOUNDARY)},e.prototype.addLineString=function(t){var e=Pl.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new ef(e,new kc(this._argIndex,Mu.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),tl.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){return this.isBoundaryNode(t,e)?null:void(n===Mu.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n))},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Pl.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;al.isCCW(i)&&(r=n,o=e);var a=new ef(i,new kc(this._argIndex,Mu.BOUNDARY,r,o));this._lineEdgeMap.put(t,a),this.insertEdge(a),this.insertPoint(this._argIndex,i[0],Mu.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new kc(t,n):r.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new hp},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof nc&&(this._useBoundaryDeterminationRule=!1),e instanceof Ql)this.addPolygon(e);else if(e instanceof Zl)this.addLineString(e);else if(e instanceof Kl)this.addPoint(e);else if(e instanceof tc)this.addCollection(e);else if(e instanceof Hl)this.addCollection(e);else if(e instanceof nc)this.addCollection(e);else{if(!(e instanceof Ul))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return Iu(this._parentGeom,$l)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new _p(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?Mu.BOUNDARY:Mu.INTERIOR},e}(qc),Ep=function(){if(this._li=new il,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new xp(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=pl.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new xp(0,e,i),this._arg[1]=new xp(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new xp(0,r,a),this._arg[1]=new xp(1,o,a)}};Ep.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Ep.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Ep.prototype.interfaces_=function(){return[]},Ep.prototype.getClass=function(){return Ep};var Sp=function(){};Sp.prototype.interfaces_=function(){return[]},Sp.prototype.getClass=function(){return Sp},Sp.map=function(){if(arguments[0]instanceof ll&&Iu(arguments[1],Sp.MapOp)){for(var t=arguments[0],e=arguments[1],n=new xl,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(Iu(arguments[0],_l)&&Iu(arguments[1],Sp.MapOp)){for(var o=arguments[0],a=arguments[1],s=new xl,u=o.iterator();u.hasNext();){var l=u.next(),c=a.map(l);null!==c&&s.add(c)}return s}},Sp.MapOp=function(){};var Pp=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Sf,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Wh,this._resultPolyList=new xl,this._resultLineList=new xl,this._resultPointList=new xl,this._graph=new qc(new qh),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new kc(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,i,r){var o=new xl;return o.addAll(t),o.addAll(n),o.addAll(i),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==Mu.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new xl,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new xl;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),qf.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new Vc(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Wf(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Yf(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Sc.RIGHT),r.getLocation(1,Sc.RIGHT),t)&&i.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(tl.isTrue(!i.isNull(r,Sc.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Sc.LEFT,i.getLocation(r,Sc.LEFT)),tl.isTrue(!i.isNull(r,Sc.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Sc.RIGHT,i.getLocation(r,Sc.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ep);Pp.overlayOp=function(t,e,n){return new Pp(t,e).getResultGeometry(n)},Pp.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Pp.createEmptyResult(Pp.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Vf.map(t,{interfaces_:function(){return[Sp.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),op.overlayOp(t,e,Pp.INTERSECTION)},Pp.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Pp.createEmptyResult(Pp.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),op.overlayOp(t,e,Pp.SYMDIFFERENCE)},Pp.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case Pp.INTERSECTION:o=Math.min(i,r);break;case Pp.UNION:o=Math.max(i,r);break;case Pp.DIFFERENCE:o=i;break;case Pp.SYMDIFFERENCE:o=Math.max(i,r)}return o},Pp.createEmptyResult=function(t,e,n,i){var r=null;switch(Pp.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Pp.difference=function(t,e){return t.isEmpty()?Pp.createEmptyResult(Pp.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),op.overlayOp(t,e,Pp.DIFFERENCE))},Pp.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Pp.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],a=arguments[2];switch(r===Mu.BOUNDARY&&(r=Mu.INTERIOR),o===Mu.BOUNDARY&&(o=Mu.INTERIOR),a){case Pp.INTERSECTION:return r===Mu.INTERIOR&&o===Mu.INTERIOR;case Pp.UNION:return r===Mu.INTERIOR||o===Mu.INTERIOR;case Pp.DIFFERENCE:return r===Mu.INTERIOR&&o!==Mu.INTERIOR;case Pp.SYMDIFFERENCE:return r===Mu.INTERIOR&&o!==Mu.INTERIOR||r!==Mu.INTERIOR&&o===Mu.INTERIOR}return!1}},Pp.INTERSECTION=1,Pp.UNION=2,Pp.DIFFERENCE=3,Pp.SYMDIFFERENCE=4;var Mp=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Sf,this._seg=new dh;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Mp.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Mp.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?Mu.BOUNDARY:this._ptLocator.locate(t,this._g)},Mp.prototype.extractLinework=function(t){var e=new Lp;t.apply(e);var n=e.getLinework(),i=mc.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},Mp.prototype.interfaces_=function(){return[]},Mp.prototype.getClass=function(){return Mp};var Lp=function(){this._linework=null,this._linework=new xl};Lp.prototype.getLinework=function(){return this._linework},Lp.prototype.filter=function(t){if(t instanceof Ql){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Lp.prototype.interfaces_=function(){return[Bl]},Lp.prototype.getClass=function(){return Lp};var Ip=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Ip.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Ip.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Ip.prototype.getPoints=function(t){for(var e=new xl,n=Ef.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Ip.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,a=Math.sqrt(r*r+o*o),s=n*r/a,u=n*o/a,l=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new xu(l-u,c+s);i.add(h)}if(this._doRight){var f=new xu(l+u,c-s);i.add(f)}},Ip.prototype.interfaces_=function(){return[]},Ip.prototype.getClass=function(){return Ip};var Tp=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new xl;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new Mp(this._geom[0],this._boundaryDistanceTolerance),new Mp(this._geom[1],this._boundaryDistanceTolerance),new Mp(this._geom[2],this._boundaryDistanceTolerance)]},Np={TOLERANCE:{configurable:!0}};Tp.prototype.reportResult=function(t,e,n){Hu.out.println("Overlay result invalid - A:"+Mu.toLocationSymbol(e[0])+" B:"+Mu.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+Mu.toLocationSymbol(e[2]))},Tp.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var e=this.checkValid(t);return e},Tp.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Tp.hasLocation(this._location,Mu.BOUNDARY)||this.isValidResult(i,this._location)}},Tp.prototype.addTestPts=function(t){var e=new Ip(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Tp.prototype.isValidResult=function(t,e){var n=Pp.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===Mu.INTERIOR);return i||this.reportResult(t,e,n),i},Tp.prototype.getInvalidLocation=function(){return this._invalidLocation},Tp.prototype.interfaces_=function(){return[]},Tp.prototype.getClass=function(){return Tp},Tp.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Tp.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Jf.computeSizeBasedSnapTolerance(t),Jf.computeSizeBasedSnapTolerance(e))},Tp.isValid=function(t,e,n,i){return new Tp(t,e,i).isValid(n)},Np.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Tp,Np);var kp=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};kp.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},kp.prototype.combine=function(){for(var t=new xl,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},kp.prototype.interfaces_=function(){return[]},kp.prototype.getClass=function(){return kp},kp.combine=function(){if(1===arguments.length){var t=arguments[0];return new kp(t).combine()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return new kp(kp.createList(e,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];return new kp(kp.createList(i,r,o)).combine()}},kp.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},kp.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new xl;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],a=new xl;return a.add(i),a.add(r),a.add(o),a}};var Op=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new xl)},Dp={STRTREE_NODE_CAPACITY:{configurable:!0}};Op.prototype.reduceToGeometries=function(t){for(var e=new xl,n=t.iterator();n.hasNext();){var i=n.next(),r=null;Iu(i,Cl)?r=this.unionTree(i):i instanceof ll&&(r=i),e.add(r)}return e},Op.prototype.extractByEnvelope=function(t,e,n){for(var i=new xl,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Op.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return kp.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Op.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new oh(Op.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Op.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Op.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Op.getGeometry(e,n),Op.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),a=this.binaryUnion(e,n,o),s=this.binaryUnion(e,o,i);return this.unionSafe(a,s)}},Op.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Op.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Op.prototype.unionActual=function(t,e){return Op.restrictToPolygons(t.union(e))},Op.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Op.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new xl,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),a=this.unionActual(r,o);return i.add(a),kp.combine(i)},Op.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Op.prototype.interfaces_=function(){return[]},Op.prototype.getClass=function(){return Op},Op.restrictToPolygons=function(t){if(Iu(t,$l))return t;var e=xf.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(mc.toPolygonArray(e))},Op.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Op.union=function(t){return new Op(t).union()},Dp.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Op,Dp);var Ap=function(){};Ap.prototype.interfaces_=function(){return[]},Ap.prototype.getClass=function(){return Ap},Ap.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Pp.createEmptyResult(Pp.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),op.overlayOp(t,e,Pp.UNION)};var Rp=function(){return new Vr};Vr.prototype={constructor:Vr,reset:function(){this.s=this.t=0},add:function(t){Wr(Fp,t,this.t),Wr(this,Fp.s,this.s),this.s?this.t+=Fp.t:this.s=Fp.t},valueOf:function(){return this.s}};var Fp=new Vr,jp=1e-6,zp=Math.PI,Bp=zp/2,Gp=zp/4,Up=2*zp,Hp=180/zp,qp=zp/180,Vp=Math.abs,Wp=Math.atan,Yp=Math.atan2,Xp=Math.cos,Zp=Math.exp,Jp=Math.log,Kp=Math.sin,$p=Math.sqrt,Qp=Math.tan,td={Feature:function(t,e){Zr(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Zr(n[i].geometry,e)}},ed={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Jr(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Jr(n[i],e,0)},Polygon:function(t,e){Kr(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Kr(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Zr(n[i],e)}},nd=function(t,e){t&&td.hasOwnProperty(t.type)?td[t.type](t,e):Zr(t,e)},id=(Rp(),Rp(),Rp(),function(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n});oo.invert=oo;var rd=function(t){function e(e){return e=t(e[0]*qp,e[1]*qp),e[0]*=Hp,e[1]*=Hp,e}return t=ao(t[0]*qp,t[1]*qp,t.length>2?t[2]*qp:0),e.invert=function(e){return e=t.invert(e[0]*qp,e[1]*qp),e[0]*=Hp,e[1]*=Hp,e},e},od=function(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Xr,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},ad=function(t,e,n,i,r,o){var a,s=t[0],u=t[1],l=0,c=1,h=e[0]-s,f=e[1]-u;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<l)return;a<c&&(c=a)}else if(h>0){if(a>c)return;a>l&&(l=a)}if(a=r-s,h||!(a<0)){if(a/=h,h<0){if(a>c)return;a>l&&(l=a)}else if(h>0){if(a<l)return;a<c&&(c=a)}if(a=i-u,f||!(a>0)){if(a/=f,f<0){if(a<l)return;a<c&&(c=a)}else if(f>0){if(a>c)return;a>l&&(l=a)}if(a=o-u,f||!(a<0)){if(a/=f,f<0){if(a>c)return;a>l&&(l=a)}else if(f>0){if(a<l)return;a<c&&(c=a)}return l>0&&(t[0]=s+l*h,t[1]=u+l*f),c<1&&(e[0]=s+c*h,e[1]=u+c*f),!0}}}}},sd=function(t,e){return Vp(t[0]-e[0])<jp&&Vp(t[1]-e[1])<jp},ud=function(t,e,n,i,r){var o,a,s=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],a=t[e];if(sd(i,a)){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);r.lineEnd()}else s.push(n=new ho(i,t,null,!0)),u.push(n.o=new ho(i,null,n,!1)),s.push(n=new ho(a,t,null,!1)),u.push(n.o=new ho(a,null,n,!0))}}),s.length){for(u.sort(e),fo(s),fo(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var l,c,h=s[0];;){for(var f=h,p=!0;f.v;)if((f=f.n)===h)return;l=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(o=0,a=l.length;o<a;++o)r.point((c=l[o])[0],c[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(p)for(l=f.p.z,o=l.length-1;o>=0;--o)r.point((c=l[o])[0],c[1]);else i(f.x,f.p.x,-1,r);f=f.p}l=(f=f.o).z,p=!p}while(!f.v);r.lineEnd()}}},ld=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},cd=(function(t){1===t.length&&(t=function(t){return function(e,n){return ld(t(e),n)}}(t))}(ld),function(t){for(var e,n,i,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(n=new Array(a);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--a]=i[e];return n}),hd=1e9,fd=-hd,pd=Rp(),dd=(Rp(),function(t){return t}),gd=(Rp(),Rp(),1/0),yd=gd,md=-gd,vd=md,_d={point:function(t,e){t<gd&&(gd=t),t>md&&(md=t),e<yd&&(yd=e),e>vd&&(vd=e)},lineStart:Xr,lineEnd:Xr,polygonStart:Xr,polygonEnd:Xr,result:function(){var t=[[gd,yd],[md,vd]];return md=vd=-(yd=gd=1/0),t}},wd=(Rp(),function(t,e,n,i){return function(r,o){function a(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function s(t,e){var n=r(t,e);y.point(n[0],n[1])}function u(){b.point=s,y.lineStart()}function l(){b.point=a,y.lineEnd()}function c(t,e){g.push([t,e]);var n=r(t,e);_.point(n[0],n[1])}function h(){_.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),_.lineEnd();var t,e,n,i,r=_.clean(),a=v.result(),s=a.length;if(g.pop(),p.push(g),g=null,s)if(1&r){if(n=a[0],(e=n.length-1)>0){for(w||(o.polygonStart(),w=!0),o.lineStart(),t=0;t<e;++t)o.point((i=n[t])[0],i[1]);o.lineEnd()}}else s>1&&2&r&&a.push(a.pop().concat(a.shift())),d.push(a.filter(go))}var p,d,g,y=e(o),m=r.invert(i[0],i[1]),v=od(),_=e(v),w=!1,b={point:a,lineStart:u,lineEnd:l,polygonStart:function(){b.point=c,b.lineStart=h,b.lineEnd=f,d=[],p=[]},polygonEnd:function(){b.point=a,b.lineStart=u,b.lineEnd=l,d=cd(d);var t=function(t,e){var n=e[0],i=e[1],r=[Kp(n),-Xp(n),0],o=0,a=0;pd.reset();for(var s=0,u=t.length;s<u;++s)if(c=(l=t[s]).length)for(var l,c,h=l[c-1],f=h[0],p=h[1]/2+Gp,d=Kp(p),g=Xp(p),y=0;y<c;++y,f=v,d=w,g=b,h=m){var m=l[y],v=m[0],_=m[1]/2+Gp,w=Kp(_),b=Xp(_),C=v-f,x=C>=0?1:-1,E=x*C,S=E>zp,P=d*w;if(pd.add(Yp(P*x*Kp(E),g*b+P*Xp(E))),o+=S?C+x*Up:C,S^f>=n^v>=n){var M=eo(Qr(h),Qr(m));ro(M);var L=eo(r,M);ro(L);var I=(S^C>=0?-1:1)*Yr(L[2]);(i>I||i===I&&(M[0]||M[1]))&&(a+=S^C>=0?1:-1)}}return(o<-jp||o<jp&&pd<-jp)^1&a}(p,m);d.length?(w||(o.polygonStart(),w=!0),ud(d,yo,t,n,o)):t&&(w||(o.polygonStart(),w=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),w&&(o.polygonEnd(),w=!1),d=p=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};return b}}),bd=wd(function(){return!0},function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?zp:-zp,u=Vp(o-n);Vp(u-zp)<jp?(t.point(n,i=(i+a)/2>0?Bp:-Bp),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):r!==s&&u>=zp&&(Vp(n-r)<jp&&(n-=r*jp),Vp(o-s)<jp&&(o-=s*jp),i=function(t,e,n,i){var r,o,a=Kp(t-n);return Vp(a)>jp?Wp((Kp(e)*(o=Xp(i))*Kp(n)-Kp(i)*(r=Xp(e))*Kp(t))/(r*o*a)):(e+i)/2}(n,i,o,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=o,i=a),r=s},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}},function(t,e,n,i){var r;if(null==t)r=n*Bp,i.point(-zp,r),i.point(0,r),i.point(zp,r),i.point(zp,0),i.point(zp,-r),i.point(0,-r),i.point(-zp,-r),i.point(-zp,0),i.point(-zp,r);else if(Vp(t[0]-e[0])>jp){var o=t[0]<e[0]?zp:-zp;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])},[-zp,-Bp]),Cd=function(t,e){function n(t,e){return Xp(t)*Xp(e)>o}function i(t,e,n){var i=[1,0,0],r=eo(Qr(t),Qr(e)),a=to(r,r),s=r[0],u=a-s*s;if(!u)return!n&&t;var l=o*a/u,c=-o*s/u,h=eo(i,r),f=io(i,l);no(f,io(r,c));var p=h,d=to(f,p),g=to(p,p),y=d*d-g*(to(f,f)-1);if(!(y<0)){var m=$p(y),v=io(p,(-d-m)/g);if(no(v,f),v=$r(v),!n)return v;var _,w=t[0],b=e[0],C=t[1],x=e[1];b<w&&(_=w,w=b,b=_);var E=b-w,S=Vp(E-zp)<jp;if(!S&&x<C&&(_=C,C=x,x=_),S||E<jp?S?C+x>0^v[1]<(Vp(v[0]-w)<jp?C:x):C<=v[1]&&v[1]<=x:E>zp^(w<=v[0]&&v[0]<=b)){var P=io(p,(-d+m)/g);return no(P,f),[v,$r(P)]}}}function r(e,n){var i=a?t:zp-t,r=0;return e<-i?r|=1:e>i&&(r|=2),n<-i?r|=4:n>i&&(r|=8),r}var o=Xp(t),a=o>0,s=Vp(o)>jp;return wd(n,function(t){var e,o,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(h,f){var p,d=[h,f],g=n(h,f),y=a?g?0:r(h,f):g?r(h+(h<0?zp:-zp),f):0;if(!e&&(l=u=g)&&t.lineStart(),g!==u&&(!(p=i(e,d))||sd(e,p)||sd(d,p))&&(d[0]+=jp,d[1]+=jp,g=n(d[0],d[1])),g!==u)c=0,g?(t.lineStart(),p=i(d,e),t.point(p[0],p[1])):(p=i(e,d),t.point(p[0],p[1]),t.lineEnd()),e=p;else if(s&&e&&a^g){
var m;y&o||!(m=i(d,e,!0))||(c=0,a?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||e&&sd(e,d)||t.point(d[0],d[1]),e=d,u=g,o=y},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return c|(l&&u)<<1}}},function(n,i,r,o){!function(t,e,n,i,r,o){if(n){var a=Xp(e),s=Kp(e),u=i*n;null==r?(r=e+i*Up,o=e-u/2):(r=co(a,r),o=co(a,o),(i>0?r<o:r>o)&&(r+=i*Up));for(var l,c=r;i>0?c>o:c<o;c-=u)l=$r([a,-s*Xp(c),-s*Kp(c)]),t.point(l[0],l[1])}}(o,t,e,r,n,i)},a?[0,-t]:[-zp,t-zp])};vo.prototype={constructor:vo,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var xd=16,Ed=Xp(30*qp),Sd=function(t,e){return+e?function(t,e){function n(i,r,o,a,s,u,l,c,h,f,p,d,g,y){var m=l-i,v=c-r,_=m*m+v*v;if(_>4*e&&g--){var w=a+f,b=s+p,C=u+d,x=$p(w*w+b*b+C*C),E=Yr(C/=x),S=Vp(Vp(C)-1)<jp||Vp(o-h)<jp?(o+h)/2:Yp(b,w),P=t(S,E),M=P[0],L=P[1],I=M-i,T=L-r,N=v*I-m*T;(N*N/_>e||Vp((m*I+v*T)/_-.5)>.3||a*f+s*p+u*d<Ed)&&(n(i,r,o,a,s,u,M,L,S,w/=x,b/=x,C,g,y),y.point(M,L),n(M,L,S,w,b,C,l,c,h,f,p,d,g,y))}}return function(e){function i(n,i){n=t(n,i),e.point(n[0],n[1])}function r(){m=NaN,C.point=o,e.lineStart()}function o(i,r){var o=Qr([i,r]),a=t(i,r);n(m,v,y,_,w,b,m=a[0],v=a[1],y=i,_=o[0],w=o[1],b=o[2],xd,e),e.point(m,v)}function a(){C.point=i,e.lineEnd()}function s(){r(),C.point=u,C.lineEnd=l}function u(t,e){o(c=t,e),h=m,f=v,p=_,d=w,g=b,C.point=o}function l(){n(m,v,y,_,w,b,h,f,c,p,d,g,xd,e),C.lineEnd=a,a()}var c,h,f,p,d,g,y,m,v,_,w,b,C={point:i,lineStart:r,lineEnd:a,polygonStart:function(){e.polygonStart(),C.lineStart=s},polygonEnd:function(){e.polygonEnd(),C.lineStart=r}};return C}}(t,e):function(t){return mo({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)},Pd=mo({point:function(t,e){this.stream.point(t*qp,e*qp)}});bo.invert=function(t,e){return[t,2*Wp(Zp(e))-Bp]},Co.invert=function(t,e){return[-e,2*Wp(Zp(t))-Bp]};var Md=function(){var t=function(t){function e(){var e=zp*s(),a=o(rd(o.rotate()).invert([0,0]));return l(null==c?[[a[0]-e,a[1]-e],[a[0]+e,a[1]+e]]:t===bo?[[Math.max(a[0]-e,c),n],[Math.min(a[0]+e,i),r]]:[[c,Math.max(a[1]-e,n)],[i,Math.min(a[1]+e,r)]])}var n,i,r,o=wo(t),a=o.center,s=o.scale,u=o.translate,l=o.clipExtent,c=null;return o.scale=function(t){return arguments.length?(s(t),e()):s()},o.translate=function(t){return arguments.length?(u(t),e()):u()},o.center=function(t){return arguments.length?(a(t),e()):a()},o.clipExtent=function(t){return arguments.length?(null==t?c=n=i=r=null:(c=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),e()):null==c?null:[[c,n],[i,r]]},e()}(Co),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90]).scale(159.155)};t.projection=Pa,t.random=du,t.clusters=gu,t.helpers=Bo,t.invariant=Uo,t.meta=Go,t.isolines=function(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},o=n.breaksProperties||[];if(X(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!E(r))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var a=it(t,{zProperty:i,flip:!0});return l(function(t,e,n){var i=U(n),r=i[2]-i[0],o=i[3]-i[1],a=i[0],s=i[1],u=e[0].length-1,l=e.length-1,c=r/u,h=o/l,f=function(t){t[0]=t[0]*c+a,t[1]=t[1]*h+s};return t.forEach(function(t){M(t,f)}),t}(function(t,e,n,i,r){for(var o=[],a=1;a<e.length;a++){var s=+e[a],u=Object.assign({},i,r[a]);u[n]=s;var l=c($(t,s),u);o.push(l)}return o}(a,e,i,r,o),a,t))},t.convex=It,t.pointsWithinPolygon=kt,t.concave=function(t,n){if(n=n||{},!E(n))throw new Error("options is invalid");if(!t)throw new Error("points is required");var i=n.maxEdge||1/0;if(!x(i))throw new Error("maxEdge is invalid");var r=Ot(function(t){var e=[],n={};return N(t,function(t){if(t.geometry){var i=t.geometry.coordinates.join("-");n.hasOwnProperty(i)||(e.push(t),n[i]=!0)}}),l(e)}(t));if(r.features=r.features.filter(function(t){var e=t.geometry.coordinates[0][0],r=t.geometry.coordinates[0][1],o=t.geometry.coordinates[0][2],a=Ft(e,r,n),s=Ft(r,o,n),u=Ft(e,o,n);return a<=i&&s<=i&&u<=i}),r.features.length<1)return null;var o=Qt(r,n);return 1===o.coordinates.length&&(o.coordinates=o.coordinates[0],o.type="Polygon"),e(o)},t.collect=function(t,e,n,i){var r=Wo(6),o=e.features.map(function(t){return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:t.properties[n]}});return r.load(o),t.features.forEach(function(t){t.properties||(t.properties={});var e=U(t),n=[];r.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}).forEach(function(e){Tt([e.minX,e.minY],t)&&n.push(e.property)}),t.properties[i]=n}),t},t.flip=function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.mutate;if(!t)throw new Error("geojson is required");return!1!==n&&void 0!==n||(t=jt(t)),M(t,function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e}),t},t.simplify=function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=void 0!==e.tolerance?e.tolerance:1,i=e.highQuality||!1,r=e.mutate||!1;if(!t)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return!0!==r&&(t=jt(t)),D(t,function(t){!function(t,e,n){var i=t.type;if("Point"===i||"MultiPoint"===i)return t;te(t,!0);var r=t.coordinates;switch(i){case"LineString":t.coordinates=ae(r,e,n);break;case"MultiLineString":t.coordinates=r.map(function(t){return ae(t,e,n)});break;case"Polygon":t.coordinates=se(r,e,n);break;case"MultiPolygon":t.coordinates=r.map(function(t){return se(t,e,n)})}}(t,n,i)}),t},t.bezierSpline=ue,t.tag=function(t,e,n,i){return t=jt(t),e=jt(e),N(t,function(t){t.properties||(t.properties={}),N(e,function(e){void 0===t.properties[i]&&Tt(t,e)&&(t.properties[i]=e.properties[n])})}),t},t.sample=function(t,e){if(!t)throw new Error("featurecollection is required");if(null===e||void 0===e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return l(function(t,e){for(var n,i,r=t.slice(0),o=t.length,a=o-e;o-- >a;)i=Math.floor((o+1)*Math.random()),n=r[i],r[i]=r[o],r[o]=n;return r.slice(a)}(t.features,e))},t.envelope=ce,t.square=he,t.circle=pe,t.midpoint=function(t,e){return fe(t,Ft(t,e)/2,de(t,e))},t.center=ge,t.centerOfMass=me,t.centroid=ye,t.combine=function(t){function n(t,e,n){n?i[e].coordinates=i[e].coordinates.concat(t.geometry.coordinates):i[e].coordinates.push(t.geometry.coordinates),i[e].properties.push(t.properties)}var i={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},r=Object.keys(i).reduce(function(t,e){return t[e.replace("Multi","")]=e,t},{});return N(t,function(t){t.geometry&&(i[t.geometry.type]?n(t,t.geometry.type,!0):r[t.geometry.type]&&n(t,r[t.geometry.type],!1))}),l(Object.keys(i).filter(function(t){return i[t].coordinates.length}).sort().map(function(t){return e({type:t,coordinates:i[t].coordinates},{collectedProperties:i[t].properties})}))},t.distance=Ft,t.explode=ve,t.bbox=U,t.tesselate=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=Ae(t.geometry.coordinates):t.geometry.coordinates.forEach(function(t){e.features=e.features.concat(Ae(t))}),e},t.bboxPolygon=le,t.booleanPointInPolygon=Tt,t.nearestPoint=Re,t.nearestPointOnLine=on,t.nearestPointToLine=function(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.units,r=n.properties||{};if(!t)throw new Error("points is required");if(!(t=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return D(t,function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})}),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter(function(t){return"Point"===t.geometry.type}),t;default:throw new Error("points must be a Point Collection")}}(t)).features.length)throw new Error("points must contain features");if(!e)throw new Error("line is required");if("LineString"!==K(e))throw new Error("line must be a LineString");var o=1/0,a=null;return N(t,function(t){var n=dn(t,e,{units:i});n<o&&(o=n,a=t)}),a&&(a.properties=Object.assign({dist:o},a.properties,r)),a},t.planepoint=function(t,e){var n=H(t),i=Z(e).coordinates[0];if(i.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var r=e.properties||{},o=r.a,a=r.b,s=r.c,u=n[0],l=n[1],c=i[0][0],h=i[0][1],f=void 0!==o?o:i[0][2],p=i[1][0],d=i[1][1],g=void 0!==a?a:i[1][2],y=i[2][0],m=i[2][1],v=void 0!==s?s:i[2][2];return(v*(u-c)*(l-d)+f*(u-p)*(l-m)+g*(u-y)*(l-h)-g*(u-c)*(l-m)-v*(u-p)*(l-h)-f*(u-y)*(l-d))/((u-c)*(l-d)+(u-p)*(l-m)+(u-y)*(l-h)-(u-c)*(l-m)-(u-p)*(l-h)-(u-y)*(l-d))},t.tin=Ot,t.bearing=de,t.destination=fe,t.kinks=function(t){var e,n,r={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach(function(t){e.forEach(function(e){for(var n=0;n<t.length-1;n++)for(var o=n;o<e.length-1;o++){if(t===e){if(1===Math.abs(n-o))continue;if(0===n&&o===t.length-2&&t[n][0]===t[t.length-1][0]&&t[n][1]===t[t.length-1][1])continue}var a=function(t,e,n,i,r,o,a,s){var u,l,c,h,f,p={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(u=(s-o)*(n-t)-(a-r)*(i-e))?null!==p.x&&null!==p.y&&p:(l=e-o,c=t-r,h=(a-r)*l-(s-o)*c,f=(n-t)*l-(i-e)*c,l=h/u,c=f/u,p.x=t+l*(n-t),p.y=e+l*(i-e),l>=0&&l<=1&&(p.onLine1=!0),c>=0&&c<=1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y])}(t[n][0],t[n][1],t[n+1][0],t[n+1][1],e[o][0],e[o][1],e[o+1][0],e[o+1][1]);a&&r.features.push(i([a[0],a[1]]))}})}),r},t.pointOnFeature=yn,t.area=vn,t.along=function(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var r;if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}if(!x(e))throw new Error("distance must be a number");for(var o=0,a=0;a<r.length&&!(e>=o&&a===r.length-1);a++){if(o>=e){var s=e-o;if(s){var u=de(r[a],r[a-1])-180;return fe(r[a],s,u,n)}return i(r[a])}o+=Ft(r[a],r[a+1],n)}return i(r[r.length-1])},t.length=xn,t.lineSlice=function(t,e,n){var i=q(n);if("LineString"!==K(n))throw new Error("line must be a LineString");for(var r,o=on(n,t),a=on(n,e),u=[(r=o.properties.index<=a.properties.index?[o,a]:[a,o])[0].geometry.coordinates],l=r[0].properties.index+1;l<r[1].properties.index+1;l++)u.push(i[l]);return u.push(r[1].geometry.coordinates),s(u,n.properties)},t.lineSliceAlong=En,t.pointGrid=In,t.truncate=Tn,t.flatten=function(t){if(!t)throw new Error("geojson is required");var e=[];return R(t,function(t){e.push(t)}),l(e)},t.lineIntersect=nn,t.lineChunk=function(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.units,r=n.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return R(t,function(t){r&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,i){var r=xn(t,{units:n});if(r<=e)return i(t);var o=r/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var a=0;a<o;a++){var s=En(t,e*a,e*(a+1),{units:n});i(s,a)}}(t,e,i,function(t){o.push(t)})}),l(o)},t.unkinkPolygon=function(t){var e=[];return R(t,function(t){"Polygon"===t.geometry.type&&N(Ia(t),function(n){e.push(o(n.geometry.coordinates,t.properties))})}),l(e)},t.greatCircle=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.npoints,o=n.offset;return t=H(t),e=H(e),i=i||{},r=r||100,o=o||10,new Fa({x:t[0],y:t[1]},{x:e[0],y:e[1]},i).Arc(r,{offset:o}).json()},t.lineSegment=en,t.lineSplit=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=K(t),i=K(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===i)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===i)throw new Error("splitter cannot be a GeometryCollection");var r=Tn(e,{precision:7});switch(i){case"Point":return An(t,r);case"MultiPoint":return Dn(t,r);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Dn(t,nn(t,r))}},t.lineArc=jn,t.polygonToLine=Bn,t.lineToPolygon=Un,t.bboxClip=function(t,e){var n=function(t){return t.geometry?t.geometry.type:t.type}(t),i=q(t),r=t.properties;switch(n){case"LineString":case"MultiLineString":var a=[];return"LineString"===n&&(i=[i]),i.forEach(function(t){ja(t,e,a)}),1===a.length?s(a[0],r):c(a,r);case"Polygon":return o(Xn(i,e),r);case"MultiPolygon":return f(i.map(function(t){return Xn(t,e)}),r);default:throw new Error("geometry "+n+" not supported")}},t.lineOverlap=Qn,t.sector=function(t,e,n,i,r){if(r=r||{},!E(r))throw new Error("options is invalid");if(!t)throw new Error("center is required");if(void 0===n||null===n)throw new Error("bearing1 is required");if(void 0===i||null===i)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof r)throw new Error("options must be an object");if(ei(n)===ei(i))return pe(t,e,r);var a=q(t),s=[[a]];return M(jn(t,e,n,i,r),function(t){s[0].push(t)}),s[0].push(a),o(s)},t.rhumbBearing=an,t.rhumbDistance=un,t.rhumbDestination=ni,t.polygonTangents=function(t,e){var n,r,o,a=q(t),s=q(e);switch(K(e)){case"Polygon":n=s[0][0],r=s[0][0],o=ri(s[0][0],s[0][s[0].length-1],a);var u=ii(s[0],a,o,void 0,n,r);n=u[0],r=u[1];break;case"MultiPolygon":n=s[0][0][0],r=s[0][0][0],o=ri(s[0][0][0],s[0][0][s[0][0].length-1],a),s.forEach(function(t){var e=ii(t[0],a,o,void 0,n,r);n=e[0],r=e[1]})}return l([i(n),i(r)])},t.rewind=function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.reverse||!1,i=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof i)throw new Error("<mutate> must be a boolean");!1===i&&(t=jt(t));var r=[];switch(t.type){case"GeometryCollection":return D(t,function(t){ai(t,n)}),t;case"FeatureCollection":return N(t,function(t){N(ai(t,n),function(t){r.push(t)})}),l(r)}return ai(t,n)},t.isobands=function(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},a=n.breaksProperties||[];if(X(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!E(r))throw new Error("commonProperties is not an Object");if(!Array.isArray(a))throw new Error("breaksProperties is not an Array");var s=li(t,{zProperty:i,flip:!0}),u=function(t,e,n){for(var i=[],r=1;r<e.length;r++){var a=+e[r-1],s=+e[r],u=ci(t,a,s-a),l=function(t){var e=[],n=[];t.forEach(function(t){var i=vn(o([t]));n.push(i),e.push({ring:t,area:i})}),n.sort(function(t,e){return e-t});var i=[];return n.forEach(function(t){for(var n=0;n<e.length;n++)if(e[n].area===t){i.push(e[n].ring),e.splice(n,1);break}}),i}(u),c=function(t){for(var e=t.map(function(t){return{lrCoordinates:t,grouped:!1}}),n=[];!function(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}(e);)for(var i=0;i<e.length;i++)if(!e[i].grouped){var r=[];r.push(e[i].lrCoordinates),e[i].grouped=!0;for(var a=o([e[i].lrCoordinates]),s=i+1;s<e.length;s++)if(!e[s].grouped){var u=o([e[s].lrCoordinates]);(function(t,e){for(var n=ve(t),i=0;i<n.features.length;i++)if(!Tt(n.features[i],e))return!1;return!0})(u,a)&&(r.push(e[s].lrCoordinates),e[s].grouped=!0)}n.push(r)}return n}(l),h={};h.groupedRings=c,h[n]=a+"-"+s,i.push(h)}return i}(s,e,i);return l((u=function(t,e,n){var i=U(n),r=i[2]-i[0],o=i[3]-i[1],a=i[0],s=i[1],u=e[0].length-1,l=e.length-1,c=r/u,h=o/l,f=function(t){t[0]=t[0]*c+a,t[1]=t[1]*h+s};return t.forEach(function(t){t.groupedRings.forEach(function(t){t.forEach(function(t){t.forEach(f)})})}),t}(u,s,t)).map(function(t,e){if(a[e]&&!E(a[e]))throw new Error("Each mappedProperty is required to be an Object");var n=Object.assign({},r,a[e]);return n[i]=t[i],f(t.groupedRings,n)}))},t.transformRotate=pi,t.transformScale=di,t.transformTranslate=function(t,e,n,i){if(i=i||{},!E(i))throw new Error("options is invalid");var r=i.units,o=i.zTranslation,a=i.mutate;if(!t)throw new Error("geojson is required");if(void 0===e||null===e||isNaN(e))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===e&&0===o)return t;if(void 0===n||null===n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n=-n),!1!==a&&void 0!==a||(t=jt(t)),M(t,function(t){var i=q(ni(t,e,n,{units:r}));t[0]=i[0],t[1]=i[1],o&&3===t.length&&(t[2]+=o)}),t},t.lineOffset=function(t,e,n){if(n=n||{},!E(n))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("geojson is required");if(void 0===e||null===e||isNaN(e))throw new Error("distance is required");var r=K(t),o=t.properties;switch(r){case"LineString":return _i(t,e,i);case"MultiLineString":var a=[];return R(t,function(t){a.push(_i(t,e,i).geometry.coordinates)}),c(a,o);default:throw new Error("geometry "+r+" is not supported")}},t.polygonize=function(t){var e=Fs.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],i=[];return e.getEdgeRings().filter(function(t){return t.isValid()}).forEach(function(t){t.isHole()?n.push(t):i.push(t)}),n.forEach(function(t){As.findEdgeRingContaining(t,i)&&i.push(t)}),l(i.map(function(t){return t.toPolygon()}))},t.booleanDisjoint=function(t,e){var n;return R(t,function(t){R(e,function(e){return!1!==n&&void(n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t.coordinates,e.coordinates);case"LineString":return!Ci(e,t);case"Polygon":return!Tt(t,e)}break;case"LineString":switch(e.type){case"Point":return!Ci(t,e);case"LineString":return!function(t,e){return nn(t,e).features.length>0}(t,e);case"Polygon":return!xi(e,t)}break;case"Polygon":switch(e.type){case"Point":return!Tt(e,t);case"LineString":return!xi(t,e);case"Polygon":return!function(t,e){for(var n=0;n<t.coordinates[0].length;n++)if(Tt(t.coordinates[0][n],e))return!0;for(var i=0;i<e.coordinates[0].length;i++)if(Tt(e.coordinates[0][i],t))return!0;return!1}(e,t)}}}(t.geometry,e.geometry))})}),n},t.booleanContains=function(t,e){var n=K(t),i=K(e),r=Z(t),o=Z(e),a=q(t),s=q(e);switch(n){case"Point":switch(i){case"Point":return Si(a,s);default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"Point":return function(t,e){var n,i=!1;for(n=0;n<t.coordinates.length;n++)if(Si(t.coordinates[n],e.coordinates)){i=!0;break}return i}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++){for(var i=!1,r=0;r<t.coordinates.length;r++)if(Si(e.coordinates[n],t.coordinates[r])){i=!0;break}if(!i)return!1}return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"Point":return Sn(o,r,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(Sn({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!0})&&(n=!0),!Sn({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!1}))return!1;return n}(r,o);case"MultiPoint":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(Sn(e.coordinates[i],t,{ignoreEndVertices:!0})&&(n=!0),!Sn(e.coordinates[i],t))return!1;return!!n}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Point":return Tt(o,r,{ignoreBoundary:!0});case"LineString":return function(t,e){var n=!1,i=0,r=U(t),o=U(e);if(!Ei(r,o))return!1;for(;i<e.coordinates.length-1;i++){var a=function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}(e.coordinates[i],e.coordinates[i+1]);if(Tt({type:"Point",coordinates:a},t,{ignoreBoundary:!0})){n=!0;break}}return n}(r,o);case"Polygon":return function(t,e){var n=U(t),i=U(e);if(!Ei(n,i))return!1;for(var r=0;r<e.coordinates[0].length;r++)if(!Tt(e.coordinates[0][r],t))return!1;return!0}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++)if(!Tt(e.coordinates[n],t,{ignoreBoundary:!0}))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},t.booleanCrosses=function(t,e){var n=K(t),i=K(e),r=Z(t),o=Z(e);switch(n){case"MultiPoint":switch(i){case"LineString":return Pi(r,o);case"Polygon":return Li(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"MultiPoint":return Pi(o,r);case"LineString":return function(t,e){if(nn(t,e).features.length>0)for(var n=0;n<t.coordinates.length-1;n++)for(var i=0;i<e.coordinates.length-1;i++){var r=!0;if(0!==i&&i!==e.coordinates.length-2||(r=!1),Ii(t.coordinates[n],t.coordinates[n+1],e.coordinates[i],r))return!0}return!1}(r,o);case"Polygon":return Mi(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"MultiPoint":return Li(o,r);case"LineString":return Mi(o,r);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},t.booleanClockwise=oi,t.booleanOverlap=Oi,t.booleanPointOnLine=Sn,t.booleanEqual=function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");return K(t)===K(e)&&new Us({precision:6}).compare(te(t),te(e))},t.booleanWithin=Pn,t.clone=jt,t.cleanCoords=te,t.clustersDbscan=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.minPoints,r=n.units;if(X(t,"Point","Input must contain Points"),null===e||void 0===e)throw new Error("maxDistance is required");if(!(Math.sign(e)>0))throw new Error("Invalid maxDistance");if(!(void 0===i||null===i||Math.sign(i)>0))throw new Error("Invalid minPoints");t=jt(t),i=i||3;var o=new Ys.DBSCAN,a=-1;return o.run(O(t),b(e,r),i,Ft).forEach(function(e){a++,e.forEach(function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster=a,n.properties.dbscan="core"})}),o.noise.forEach(function(e){var n=t.features[e];n.properties||(n.properties={}),n.properties.cluster?n.properties.dbscan="edge":n.properties.dbscan="noise"}),t},t.clustersKmeans=function(t,e){if("object"!=typeof(e=e||{}))throw new Error("options is invalid");var n=e.numberOfClusters,i=e.mutate;X(t,"Point","Input must contain Points");var r=t.features.length;(n=n||Math.round(Math.sqrt(r/2)))>r&&(n=r),!1!==i&&void 0!==i||(t=jt(t));var o=O(t),a=o.slice(0,n),s=eu(o,n,a),u={};return s.centroids.forEach(function(t,e){u[e]=t}),N(t,function(t,e){var n=s.idxs[e];t.properties.cluster=n,t.properties.centroid=u[n]}),t},t.pointToLineDistance=dn,t.booleanParallel=function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==Ai(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==Ai(e,"line2"))throw new Error("line2 must be a LineString");for(var n=en(te(t)).features,i=en(te(e)).features,r=0;r<n.length;r++){var o=n[r].geometry.coordinates;if(!i[r])break;if(!function(t,e){var n=v(an(t[0],t[1])),i=v(an(e[0],e[1]));return n===i}(o,i[r].geometry.coordinates))return!1}return!0},t.shortestPath=function(t,n,r){if(r=r||{},!E(r))throw new Error("options is invalid");var o=r.resolution,a=r.minDistance,u=r.obstacles||l([]);if(!t)throw new Error("start is required");if(!n)throw new Error("end is required");if(o&&!x(o)||o<=0)throw new Error("options.resolution must be a number, greater than 0");if(a)throw new Error("options.minDistance is not yet implemented");var c=H(t),h=H(n);switch(t=i(c),n=i(h),K(u)){case"FeatureCollection":if(0===u.features.length)return s([c,h]);break;case"Polygon":u=l([e(Z(u))]);break;default:throw new Error("invalid obstacles")}var f=u;f.features.push(t),f.features.push(n);var p=U(di(le(U(f)),1.15));o||(o=Ft([p[0],p[1]],[p[2],p[1]],r)/100),f.features.pop(),f.features.pop();for(var d=p[0],g=p[1],y=p[2],m=p[3],v=o/Ft([d,g],[y,g],r)*(y-d),_=o/Ft([d,g],[d,m],r)*(m-g),w=y-d,b=m-g,C=(w-Math.floor(w/v)*v)/2,S=[],P=[],M=[],L=[],I=1/0,T=1/0,N=m-(b-Math.floor(b/_)*_)/2,k=0;N>=g;){for(var O=[],D=[],A=d+C,R=0;A<=y;){var F=i([A,N]),j=function(t,e){for(var n=0;n<e.features.length;n++)if(Tt(t,e.features[n]))return!0;return!1}(F,u);O.push(j?0:1),D.push(A+"|"+N);var z=Ft(F,t);!j&&z<I&&(I=z,M={x:R,y:k});var B=Ft(F,n);!j&&B<T&&(T=B,L={x:R,y:k}),A+=v,R++}P.push(O),S.push(D),N-=_,k++}var G=new Fi(P,{diagonal:!0}),q=G.grid[M.y][M.x],V=G.grid[L.y][L.x],W=[c];return nu.search(G,q,V).forEach(function(t){var e=S[t.x][t.y].split("|");W.push([+e[0],+e[1]])}),W.push(h),te(s(W))},t.voronoi=function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(n))throw new Error("bbox is invalid");return X(t,"Point","points"),l(pu().x(function(t){return t.geometry.coordinates[0]}).y(function(t){return t.geometry.coordinates[1]}).extent([[n[0],n[1]],[n[2],n[3]]]).polygons(t.features).map(hr))},t.ellipse=fr,t.centerMean=dr,t.centerMedian=function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.counter||10;if(!x(n))throw new Error("counter must be a number");var i=e.weight,r=dr(t,{weight:e.weight}),o=l([]);return N(t,function(t){o.features.push(ye(t,{weight:t.properties[i]}))}),o.properties={tolerance:e.tolerance,medianCandidates:[]},gr(r.geometry.coordinates,[0,0],o,n)},t.standardDeviationalEllipse=function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.steps||64,i=e.weight,r=e.properties||{};if(!x(n))throw new Error("steps must be a number");if(!E(r))throw new Error("properties must be a number");var o=O(t).length,a=dr(t,{weight:i}),s=0,u=0,c=0;N(t,function(t){var e=t.properties[i]||1,n=yr(q(t),q(a));s+=Math.pow(n.x,2)*e,u+=Math.pow(n.y,2)*e,c+=n.x*n.y*e});var h=s-u,f=Math.sqrt(Math.pow(h,2)+4*Math.pow(c,2)),p=2*c,d=Math.atan((h+f)/p),g=180*d/Math.PI,y=0,m=0,v=0;N(t,function(t){var e=t.properties[i]||1,n=yr(q(t),q(a));y+=Math.pow(n.x*Math.cos(d)-n.y*Math.sin(d),2)*e,m+=Math.pow(n.x*Math.sin(d)+n.y*Math.cos(d),2)*e,v+=e});var _=Math.sqrt(2*y/v),w=Math.sqrt(2*m/v),b=fr(a,_,w,{units:"degrees",angle:g,steps:n,properties:r}),C=kt(t,l([b])),S={meanCenterCoordinates:q(a),semiMajorAxis:_,semiMinorAxis:w,numberOfFeatures:o,angle:g,percentageWithinEllipse:100*O(C).length/o};return b.properties.standardDeviationalEllipse=S,b},t.difference=function(t,n){var i=Z(t),r=Z(n),o=t.properties||{};if(i=qr(i),r=qr(r),!i)return null;if(!r)return e(i,o);var a=new xc,s=a.read(i),u=a.read(r),l=Pp.difference(s,u);return l.isEmpty()?null:e((new Ec).write(l),o)},t.buffer=function(t,e,n){var i=(n=n||{}).units,r=n.steps||64;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");r=r||64,i=i||"kilometers";var o=[];switch(t.type){case"GeometryCollection":return D(t,function(t){var n=xo(t,e,i,r);n&&o.push(n)}),l(o);case"FeatureCollection":return N(t,function(t){var n=xo(t,e,i,r);n&&N(n,function(t){t&&o.push(t)})}),l(o)}return xo(t,e,i,r)},t.union=Lo,t.intersect=Io,t.dissolve=function(t,e){if(e=e||{},!E(e))throw new Error("options is invalid");var n=e.propertyName;X(t,"Polygon","dissolve");var i=jt(t),r=i.features,o=[];r.forEach(function(t,e){t.properties.origIndexPosition=e});var a=$e();a.load(i);for(var u in r){var l=r[u],c=!1;if(a.search(l).features.forEach(function(t){l=r[u];var e=t.properties.origIndexPosition;if(o.length>0&&0!==e)if(e>o[o.length-1])e-=o.length;else{var i=To(e,o);0!==i&&(e-=i)}if(e!==+u){var h=r[e];h&&l&&(void 0!==n&&h.properties[n]!==l.properties[n]||Oi(l,h)&&function(t,e){var n=s(O(t)),i=s(O(e));return nn(n,i).features.length>0}(l,h)&&(r[u]=Lo(l,h),o.push(t.properties.origIndexPosition),o.sort(function(t,e){return t-e}),a.remove(t),r.splice(e,1),l.properties.origIndexPosition=u,a.remove(l,function(t,e){return t.properties.origIndexPosition===e.properties.origIndexPosition}),c=!0))}}),c){if(!l)continue;l.properties.origIndexPosition=u,a.insert(l),u--}}return r.forEach(function(t){delete t.properties.origIndexPosition,delete t.bbox}),i},t.hexGrid=No,t.mask=function(t,e){var n=function(t){return o(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]])}(e),i=function(t){var e=[],n=[];return R(t,function(t){var i=t.geometry.coordinates,r=i[0],a=i.slice(1);e.push(o([r])),a.forEach(function(t){n.push(o([t]))})}),[l(e),l(n)]}(t),r=i[0],a=i[1];return function(t,e,n){var i=[];return i.push(t.geometry.coordinates[0]),R(e,function(t){i.push(t.geometry.coordinates[0])}),R(n,function(t){i.push(t.geometry.coordinates[0])}),o(i)}(n,r=ko(r),a=ko(a))},t.squareGrid=Do,t.triangleGrid=Ao,t.interpolate=function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.gridType,r=n.property,o=n.weight;if(!t)throw new Error("points is required");if(X(t,"Point","input must contain Points"),!e)throw new Error("cellSize is required");if(void 0!==o&&"number"!=typeof o)throw new Error("weight must be a number");r=r||"elevation",i=i||"square",o=o||1;var a,s=U(t);switch(i){case"point":case"points":a=In(s,e,n);break;case"square":case"squares":a=Do(s,e,n);break;case"hex":case"hexes":a=No(s,e,n);break;case"triangle":case"triangles":a=Ao(s,e,n);break;default:throw new Error("invalid gridType")}var u=[];return N(a,function(e){var a=0,s=0;N(t,function(t){var u,l=Ft("point"===i?e:ye(e),t,n);if(void 0!==r&&(u=t.properties[r]),void 0===u&&(u=t.geometry.coordinates[2]),void 0===u)throw new Error("zValue is missing");0===l&&(a=u);var c=1/Math.pow(l,o);s+=c,a+=c*u});var l=jt(e);l.properties[r]=a/s,u.push(l)}),l(u)},t.pointOnSurface=yn,t.polygonToLineString=Bn,t.lineStringToPolygon=Un,t.inside=Tt,t.within=kt,t.bezier=ue,t.nearest=Re,t.pointOnLine=on,t.lineDistance=xn,t.radians2degrees=_,t.degrees2radians=w,t.distanceToDegrees=m,t.distanceToRadians=y,t.radiansToDistance=g,t.bearingToAngle=v,t.convertDistance=b,t.toMercator=ln,t.toWgs84=cn,t.randomPosition=mr,t.randomPoint=vr,t.randomPolygon=_r,t.randomLineString=wr,t.getCluster=Cr,t.clusterEach=xr,t.clusterReduce=Er,t.createBins=Sr,t.applyFilter=Pr,t.propertiesContainsFilter=Mr,t.filterProperties=Lr,t.earthRadius=Ro,t.factors=Fo,t.unitsFactors=jo,t.areaFactors=zo,t.feature=e,t.geometry=n,t.point=i,t.points=r,t.polygon=o,t.polygons=a,t.lineString=s,t.lineStrings=u,t.featureCollection=l,t.multiLineString=c,t.multiPoint=h,t.multiPolygon=f,t.geometryCollection=p,t.round=d,t.radiansToLength=g,t.lengthToRadians=y,t.lengthToDegrees=m,t.bearingToAzimuth=v,t.radiansToDegrees=_,t.degreesToRadians=w,t.convertLength=b,t.convertArea=C,t.isNumber=x,t.isObject=E,t.validateBBox=S,t.validateId=P,t.getCoord=H,t.getCoords=q,t.containsNumber=V,t.geojsonType=W,t.featureOf=Y,t.collectionOf=X,t.getGeom=Z,t.getGeomType=J,t.getType=K,t.coordEach=M,t.coordReduce=L,t.propEach=I,t.propReduce=T,t.featureEach=N,t.featureReduce=k,t.coordAll=O,
t.geomEach=D,t.geomReduce=A,t.flattenEach=R,t.flattenReduce=F,t.segmentEach=j,t.segmentReduce=z,t.lineEach=B,t.lineReduce=G,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function t(e){n(this,t),this.viewer=e};e.default=i},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this._itemList=[],this._currentItems=[],this._isFly=!1,this._relayTime=1e3}return i(t,[{key:"_playAnimation",value:function(t,e){var n=e._currentItems[e._currentIndex];if(e._currentIndex++,e._currentIndex>e._currentItems.length)return void e.stopPlay();var i=n.view,r=new Cesium.Cartesian3(i.position[0],i.position[1],i.position[2]);e.viewer.camera.flyTo({destination:r,orientation:{heading:i.orientation[0],pitch:i.orientation[1],roll:i.orientation[2]},duration:i.duration,easingFunction:Cesium.EasingFunction.LINEAR_NONE,complete:function(){e._isFly&&t(t,e)}})}},{key:"_getNewItem",value:function(t){var e=this.viewer.viewPort.getCurrent();return{view:e,id:Cesium.createGuid(),name:t}}},{key:"fromJSON",value:function(t){this._itemList=t}},{key:"toJSON",value:function(){return this._itemList}},{key:"addGroup",value:function(t){if(!this._isFly){var e={type:"gruop",children:[],id:Cesium.createGuid(),name:t};return this._itemList.push(e),e}}},{key:"removeGroup",value:function(t){if(this._isFly)return!1;for(var e=0;e<this._itemList.length;e++)if(this._itemList[e].id==t){this._itemList.splice(e,1);break}return!0}},{key:"addItem",value:function(t,e){if(this._isFly)return!1;for(var n=void 0,i=0;i<this._itemList.length;i++)if(this._itemList[i].id==t){n=this._getNewItem(e),this._itemList[i].children.push(n);break}return n}},{key:"removeItem",value:function(t,e){if(this._isFly)return!1;for(var n=0;n<this._itemList.length;n++)if(this._itemList[n].id==t)for(var i=this._itemList[n].children,r=0;r<i.length;r++)if(i[r].id==e){i.splice(r,1);break}return!0}},{key:"removeAll",value:function(){return!this._isFly&&(this._itemList=[],!0)}},{key:"flyToItem",value:function(t){t&&this.viewer.viewPort.setCurrent(t.view)}},{key:"playGroup",value:function(t){for(var e=0;e<this._itemList.length;e++)if(this._itemList[e].id==t){var n=this._itemList[e].children;this.playItems(n);break}}},{key:"playItems",value:function(t){this._isFly&&this.stopPlay(),this._isFly=!0,this._currentItems=t,this._currentIndex=0,this._playAnimation(this._playAnimation,this)}},{key:"stopPlay",value:function(){this._playTimer&&clearTimeout(this._playTimer),this.viewer.camera.cancelFlight(),this._currentIndex=0,this._currentItems=[],this._isFly=!1}},{key:"isFly",get:function(){return this._isFly}},{key:"relayTime",get:function(){return this._relayTime},set:function(t){this._relayTime=t}},{key:"itemList",get:function(){return this._itemList}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(30),s=i(a),u=function(){function t(){r(this,t)}return o(t,[{key:"_getTemplate",value:function(t,e,n){return{id:Cesium.createGuid(),name:t,layerType:"Image",config:{type:e,options:n}}}}],[{key:"setTDTKey",value:function(t){this.tdtKey=t}},{key:"setBingKey",value:function(t){this.bingKey=t}},{key:"arcgisImage",value:function(){return this._getTemplate("ArcGIS影像",s.default.ArcGIS,{url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"})}},{key:"googleImage",value:function(){return this._getTemplate("Google影像",s.default.Google,{url:" http://www.google.cn/maps/vt?lyrs=s%2Ch&gl=cn&x={x}&y={y}&z={z}"})}},{key:"bingImage",value:function(){return this._getTemplate("Bing影像",s.default.Bing,{url:"http://www.huaruiview.cn:3500/startlvlone/wmts"})}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(71),s=i(a),u=n(72),l=i(u),c=n(73),h=i(c),f=n(75),p=i(f),d=n(74),g=i(d),y=n(26),m=i(y),v=function(){function t(e){r(this,t),this.viewer=e,Cesium.Camera.DEFAULT_VIEW_RECTANGLE=Cesium.Rectangle.fromDegrees(73,13,135,53),this.FlyAround=new s.default(this.viewer),this.ZoomControl=new l.default(this.viewer),this.ViewPort=new p.default(e),this._mousePosition=new h.default(e),this._cusorPosition=Cesium.Cartesian3.ZERO,this.initMouseCursor()}return o(t,[{key:"registHotKey",value:function(){document.addEventListener("keyup",function(t){var e=getFlagForKeyCode(t.keyCode);"undefined"!=typeof e&&(flags[e]=!1)},!1)}},{key:"initMouseCursor",value:function(){var t=this,e=Cesium.Cartesian3,n=m.default.getResource("Assets/Images/naviCursor.png");this._naviCursor=this.viewer.entities.add({position:Cesium.Cartesian3.ZERO,billboard:{image:n,disableDepthTestDistance:6e7},show:!1});var i=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas),r=Cesium.ScreenSpaceEventType;i.setInputAction(function(e){t._cusorPosition=g.default.pickPosition(t.viewer,e.endPosition)},r.MOUSE_MOVE),i.setInputAction(function(n){var i=g.default.pickPosition(t.viewer,n.position);i&&(t._naviCursor._position._value=e.clone(i),t._naviCursor.show=!0),t._naviCursorShowTime=null},r.MIDDLE_DOWN),i.setInputAction(function(n){var i=g.default.pickPosition(t.viewer,n.position);i&&(t._naviCursor._position._value=e.clone(i),t._naviCursor.show=!0),t._naviCursorShowTime=null},r.RIGHT_DOWN),i.setInputAction(function(e){t._naviCursor.show=!1},r.RIGHT_UP),i.setInputAction(function(e){t._naviCursor.show=!1},r.MIDDLE_UP),i.setInputAction(function(e){t._naviCursor._position._value=t._cusorPosition?t._cusorPosition:Cesium.Cartesian3.ZERO,t._naviCursor.show=!0,t._naviCursorShowTime=(new Date).getTime()},r.WHEEL),this.viewer.clock.onTick.addEventListener(function(e){Cesium.defined(t._naviCursor)&&t._naviCursor.show&&Cesium.defined(t._naviCursorShowTime)&&(new Date).getTime()-t._naviCursorShowTime>200&&(t._naviCursor.show=!1)})}},{key:"fullScreen",value:function(){this.ViewPort.fullScreen()}},{key:"exitFullScreen",value:function(){this.ViewPort.exitFullScreen()}},{key:"goto",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3;return this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(t,e,n),duration:i})}},{key:"zoomTo",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;this.viewer.scene.camera.setView({destination:Cesium.Cartesian3.fromDegrees(t,e,n)})}},{key:"home",value:function(){return this.viewer.camera.flyTo({destination:Cesium.Camera.DEFAULT_VIEW_RECTANGLE})}},{key:"flyAround",value:function(t){t&&this.viewer.scene.camera.setView({destination:t});var e=this.ViewPort.getCenter();return this.FlyAround.startFlyAround(e)}},{key:"flyCenter",value:function(t){t&&this.viewer.scene.camera.setView({destination:t});var e=this.ViewPort.getCenter();return this.FlyAround.startFlyCenter(e)}},{key:"stopFly",value:function(){return this.FlyAround.stopFly()}},{key:"zoomIn",value:function(){this.ZoomControl.zoomIn()}},{key:"zoomOut",value:function(){this.ZoomControl.zoomOut()}},{key:"tiltUp",value:function(){}},{key:"tiltDown",value:function(){}},{key:"switch2D",value:function(){this.ZoomControl.resetView()}},{key:"crossChar",get:function(){return this.ViewPort.crosChar}},{key:"mousePosition",get:function(){return this._mousePosition}},{key:"undergroud",get:function(){},set:function(t){}},{key:"lockView",get:function(){},set:function(t){}}]),t}();e.default=v},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this._shouldAnimate=this.viewer.clock.shouldAnimate,this.isStart=!1,this.isFlyCenter=!1,this.viewer.clock.shouldAnimate=!1}return i(t,[{key:"clock_onTickHandler",value:function(t){var e=Cesium.JulianDate.secondsDifference(this.viewer.clock.currentTime,this.time),n=Cesium.Math.toRadians(e*this.angle)+this.heading;this.isFlyCenter?(this.viewer.scene.camera.setView({destination:this.position,orientation:{heading:n,pitch:this.pitch}}),this.viewer.scene.camera.moveBackward(this.distance)):this.viewer.scene.camera.setView({orientation:{heading:n,pitch:this.pitch}})}},{key:"_setPosition",value:function(t){this.position=t,this.distance=Cesium.Cartesian3.distance(this.position,this.viewer.camera.positionWC),this.angle=6,this.time=this.viewer.clock.currentTime.clone(),this.heading=this.viewer.camera.heading,this.pitch=this.viewer.camera.pitch}},{key:"_startFly",value:function(t){this.isStart||(this._setPosition(t),this.viewer.clock.shouldAnimate=!0,this.viewer.clock.onTick.addEventListener(this.clock_onTickHandler,this),this.isStart=!0)}},{key:"startFlyAround",value:function(t){this._startFly(t),this.isFlyCenter=!1}},{key:"startFlyCenter",value:function(t){this._startFly(t),this.isFlyCenter=!0}},{key:"stopFly",value:function(){this.viewer.clock.onTick.removeEventListener(this.clock_onTickHandler,this),this.isStart=!1,this.viewer.clock.shouldAnimate=this._shouldAnimate}},{key:"lookAt",value:function(){function t(){var t=viewer.camera.heading+r*Math.PI/180;t=t>180?t-360:t;var o=viewer.camera.pitch<n?viewer.camera.pitch+i:viewer.camera.pitch,a=viewer.camera.getMagnitude();viewer.camera.lookAt(e,new Cesium.HeadingPitchRange(t,o,a))}var e=Cesium.Cartesian3.fromDegrees(101.9915,24.069534,30),n=Cesium.Math.toRadians(-28),i=5e-4,r=.02;viewer.clock.onTick.addEventListener(t)}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this.relativeAmount=2,this.cartesian3Scratch=new Cesium.Cartesian3}return i(t,[{key:"zoomIn",value:function(){this._zoomFun2(.5)}},{key:"zoomOut",value:function(){this._zoomFun2(1.5)}},{key:"resetView",value:function(){var t=this.viewer.scene,e=t.camera,n=new Cesium.Cartesian2,i=new Cesium.Cartesian3;n.x=t.canvas.clientWidth/2,n.y=t.canvas.clientHeight/2;var r=e.pickEllipsoid(n,t.globe.ellipsoid,i);if(Cesium.defined(r)){var o=Cesium.Transforms.eastNorthUpToFixedFrame(r,t.globe.ellipsoid),a=t.globe.ellipsoid.cartographicToCartesian(e.positionCartographic,new Cesium.Cartesian3),s=Cesium.Cartesian3.subtract(r,a,new Cesium.Cartesian3),u=Cesium.Matrix4.multiplyByPoint(o,new Cesium.Cartesian3(0,0,Cesium.Cartesian3.magnitude(s)),new Cesium.Cartesian3);e.flyTo({destination:u,duration:1})}}},{key:"_zoomFun2",value:function(t){var e=this.viewer.scene,n=e.screenSpaceCameraController;if(n.enableInputs&&n.enableZoom){var i,r=e.camera;switch(e.mode){case Cesium.SceneMode.MORPHING:break;case Cesium.SceneMode.SCENE2D:r.zoomIn(r.positionCartographic.height*(1-this.relativeAmount));break;default:var o;if(o=Cesium.defined(this.viewer.trackedEntity)?new Cesium.Cartesian3:this.getCameraFocus(this.viewer,!1),Cesium.defined(o))i={direction:r.direction,up:r.up};else{var a=new Cesium.Ray(r.worldToCameraCoordinatesPoint(e.globe.ellipsoid.cartographicToCartesian(r.positionCartographic)),r.directionWC);o=Cesium.IntersectionTests.grazingAltitudeLocation(a,e.globe.ellipsoid),i={heading:r.heading,pitch:r.pitch,roll:r.roll}}var s=Cesium.Cartesian3.subtract(r.position,o,this.cartesian3Scratch),u=Cesium.Cartesian3.multiplyByScalar(s,t,s),l=Cesium.Cartesian3.add(o,u,o);Cesium.defined(this.viewer.trackedEntity)||e.mode==Cesium.SceneMode.COLUMBUS_VIEW?r.position=l:r.flyTo({destination:l,orientation:i,duration:1,convert:!1})}}}},{key:"getCameraFocus",value:function(t,e,n){var i=t.scene,r=i.camera,o=new Cesium.Cartographic,a=new Cesium.Ray;if(i.mode!=Cesium.SceneMode.MORPHING&&(Cesium.defined(n)||(n=new Cesium.Cartesian3),Cesium.defined(t.trackedEntity)?n=t.trackedEntity.position.getValue(t.clock.currentTime,n):(a.origin=r.positionWC,a.direction=r.directionWC,n=i.globe.pick(a,i,n)),Cesium.defined(n)))return i.mode==Cesium.SceneMode.SCENE2D||i.mode==Cesium.SceneMode.COLUMBUS_VIEW?(n=r.worldToCameraCoordinatesPoint(n,n),e&&(n=i.globe.ellipsoid.cartographicToCartesian(i.mapProjection.unproject(n,o),n))):e||(n=r.worldToCameraCoordinatesPoint(n,n)),n}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(74),s=i(a),u=function(){function t(e){r(this,t),this.viewer=e,this._show=!1,this._init()}return o(t,[{key:"_init",value:function(){this._createUi(),this._initEvent()}},{key:"_initEvent",value:function(){var t=this.viewer.scene,e=this.viewer.camera,n=this,i=new Cesium.ScreenSpaceEventHandler(t.canvas);i.setInputAction(function(i){if(n._show){var r,o,a,u,l,c=s.default.pickPosition(n.viewer,i.endPosition);if(Cesium.defined(c)){var h=t.globe.ellipsoid,f=h.cartesianToCartographic(c);r=Cesium.Math.toDegrees(f.longitude).toFixed(7),o=Cesium.Math.toDegrees(f.latitude).toFixed(7),a=f.height.toFixed(4);var u=c.x.toFixed(2),l=c.y.toFixed(2)}else r="",o="",a="",u="",l="";var p=Cesium.Cartographic.fromCartesian(e.position).height.toFixed(4);n.mousePosition.innerHTML="经度: &nbsp;"+r+" &nbsp; &nbsp; &nbsp; 纬度: &nbsp;"+o+" &nbsp; &nbsp; &nbsp;  高程: &nbsp;"+a+" &nbsp; &nbsp; &nbsp;横：&nbsp; "+u+" 纵：&nbsp; "+l+" &nbsp; &nbsp;镜头高度: &nbsp;"+p}},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}},{key:"_createUi",value:function(){this.posPanel=document.createElement("div"),this.posPanel.style.height="26px",this.posPanel.style.width="100%",this.posPanel.style.position="absolute",this.posPanel.style.bottom="0px",this.posPanel.style.background="#00000075",this.mousePosition=document.createElement("div"),this.mousePosition.style.height="26px",this.mousePosition.style.lineHeight="26px",this.mousePosition.style.width="800px",this.mousePosition.style.position="absolute",this.mousePosition.style.left="10px",this.mousePosition.style.color="#e9e9e9",this.mousePosition.style.textAlign="left",this.mousePosition.style.fontSize="13px",this.mousePosition.style.fontFamily="微软雅黑",this.mousePosition.style.textShadow="2px 2px 2px #000;",this.posPanel.appendChild(this.mousePosition),this.viewer.container.appendChild(this.posPanel),this.posPanel.style.display=this._show?"block":"none"}},{key:"show",get:function(){return this._show},set:function(t){this._show=t,this.posPanel.style.display=t?"block":"none"}}]),t}();e.default=u},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){n(this,t)}return i(t,null,[{key:"pickPosition",value:function(e,n){if(!Cesium.defined(n))return null;var i,r=e.scene,o=e.camera.getPickRay(n);if(r.mode!==Cesium.SceneMode.MORPHING){var a=r.pick(n);i=t.isModel(r,a)?r.pickPosition(n):e.scene.globe.pick(o,r)}return i}},{key:"isModel",value:function(t,e){return!!(Cesium.defined(e)&&t.pickPositionSupported&&(e.primitive&&e.primitive.asset||e.id&&e.id.model))}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(76),s=i(a),u=n(77),l=i(u),c=function(){function t(e){r(this,t),this.viewer=e,this._defautduration=3,this.crosChar=new l.default(this.viewer.container)}return o(t,[{key:"exportImage",value:function(t,e){this.viewer.render();var n=this.viewer.canvas;return t=Cesium.defaultValue(t,n.width),e=Cesium.defaultValue(e,n.height),s.default.convertToJPEG(n,t,e)}},{key:"gotoHome",value:function(){var t=Cesium.Rectangle.center(Cesium.Camera.DEFAULT_VIEW_RECTANGLE),e=Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(t.longitude),Cesium.Math.toDegrees(t.latitude),8e6);this.viewer.camera.flyTo({destination:e})}},{key:"setCurrent",value:function(t){var e=new Cesium.Cartesian3(t.position[0],t.position[1],t.position[2]),n=t.orientation;this.viewer.camera.flyTo({destination:e,duration:t.duration?t.duration:3,orientation:{heading:n[0],pitch:n[1],roll:n[2]}})}},{key:"getCurrent",value:function(){var t=this.viewer,e=t.camera.position,n={position:[e.x,e.y,e.z],duration:3,orientation:[t.camera.heading,t.camera.pitch,t.camera.roll]};return n}},{key:"getCenter",value:function(){var t=this.viewer.scene,e=t.globe,n=this.pickCenterPoint();if(!n){var i=t.camera.positionCartographic.clone(),r=e.getHeight(i);i.height=r||0,n=Cesium.Ellipsoid.WGS84.cartographicToCartesian(i)}return n}},{key:"pickCenterPoint",value:function(){var t=this.viewer.scene,e=t.canvas,n=t.globe,i=t.camera,r=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2),o=i.getPickRay(r);return n.pick(o,t)||i.pickEllipsoid(r)}},{key:"fullScreen",value:function(){Cesium.Fullscreen.requestFullscreen(this.viewer.scene.canvas)}},{key:"exitFullScreen",value:function(){Cesium.Fullscreen.exitFullscreen()}},{key:"toJSON",value:function(){return this.getCurrent()}},{key:"fromJSON",value:function(t){var e=t;this.setCurrent(e)}},{key:"defaultDuration",get:function(){return this._defautduration},set:function(t){this._defautduration=t}}]),t}();e.default=c},function(t,e){"use strict";function n(t,e,n){var i=t.width,r=t.height;void 0==e&&(e=i),void 0==n&&(n=r);var o=document.createElement("canvas"),a=o.getContext("2d");return o.width=e,o.height=n,a.drawImage(t,0,0,i,r,0,0,e,n),o}function i(t,e,i,r){return t=n(t,i,r),t.toDataURL(e)}function r(t){document.location.href=t}function o(t){var e=document.createElement("img");return e.src=t,e}function a(t){t=t.toLowerCase().replace(/jpg/i,"jpeg");var e=t.match(/png|jpeg|bmp|gif/)[0];return"image/"+e}function s(t){if(!window.btoa)throw"btoa undefined";var e="";if("string"==typeof t)e=t;else for(var n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function u(t){var e=t.width,n=t.height;return t.getContext("2d").getImageData(0,0,e,n)}function l(t,e){return"data:"+e+";base64,"+t}Object.defineProperty(e,"__esModule",{value:!0});var c=function(){var t=document.createElement("canvas"),e=t.getContext("2d");return{canvas:!!e,imageData:!!e.getImageData,dataURL:!!t.toDataURL,btoa:!!window.btoa}}(),h="image/octet-stream",f=function(t){var e=t.width,n=t.height,i=e*n*3,r=i+54,o=[66,77,255&r,r>>8&255,r>>16&255,r>>24&255,0,0,0,0,54,0,0,0],a=[40,0,0,0,255&e,e>>8&255,e>>16&255,e>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,1,0,24,0,0,0,0,0,255&i,i>>8&255,i>>16&255,i>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u=(4-3*e%4)%4,l=t.data,c="",h=e<<2,f=n,p=String.fromCharCode;do{for(var d=h*(f-1),g="",y=0;y<e;y++){var m=y<<2;g+=p(l[d+m+2])+p(l[d+m+1])+p(l[d+m])}for(var v=0;v<u;v++)g+=String.fromCharCode(0);c+=g}while(--f);var _=s(o.concat(a))+s(c);return _},p=function(t,e,o,s){if(c.canvas&&c.dataURL)if("string"==typeof t&&(t=document.getElementById(t)),void 0==s&&(s="png"),s=a(s),/bmp/.test(s)){var p=u(n(t,e,o)),d=f(p);r(l(d,h))}else{var d=i(t,s,e,o);r(d.replace(s,h))}},d=function(t,e,r,s){if(c.canvas&&c.dataURL){if("string"==typeof t&&(t=document.getElementById(t)),void 0==s&&(s="png"),s=a(s),/bmp/.test(s)){var h=u(n(t,e,r)),p=f(h);return o(l(p,"image/bmp"))}return i(t,s,e,r)}};e.default={saveAsImage:p,saveAsPNG:function(t,e,n){return p(t,e,n,"png")},saveAsJPEG:function(t,e,n){return p(t,e,n,"jpeg")},saveAsGIF:function(t,e,n){return p(t,e,n,"gif")},saveAsBMP:function(t,e,n){return p(t,e,n,"bmp")},convertToImage:d,convertToPNG:function(t,e,n){return d(t,e,n,"png")},convertToJPEG:function(t,e,n){return d(t,e,n,"jpeg")},convertToGIF:function(t,e,n){return d(t,e,n,"gif")},convertToBMP:function(t,e,n){return d(t,e,n,"bmp")}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(26),s=i(a),u=function(){function t(e){r(this,t),this.container=e,this._show=!1,this._crossChairDiv=null,this._init()}return o(t,[{key:"_init",value:function(){this._crossChairDiv=document.createElement("div");var t=this._crossChairDiv.style;t.height="25px",t.width="25px",t.textAlign="center",t.float="left",t.position="absolute",t.top="49%",t.left="49%",t.display="none",t.pointerEvents="none";var e=document.createElement("SPAN");this._crossChairDiv.appendChild(e);var n=document.createElement("IMG");n.src=s.default.getResource("Assets/Images/crosschair.png"),n.style.height="30px",n.style.width="30px",n.style.textAlign="center",e.appendChild(n),this.container.appendChild(this._crossChairDiv)}},{key:"show",get:function(){return this._show},set:function(t){this._show=t,this._crossChairDiv.style.display=t?"block":"none"}}]),t}();e.default=u},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,e.showRenderLoopErrors=!1,e.scene.screenSpaceCameraController.zoomEventTypes=[Cesium.CameraEventType.WHEEL,Cesium.CameraEventType.PINCH],e.scene.screenSpaceCameraController.tiltEventTypes=[Cesium.CameraEventType.RIGHT_DRAG,Cesium.CameraEventType.PINCH],e.scene.screenSpaceCameraController.minimumZoomDistance=5,e.scene.screenSpaceCameraController.maximumZoomDistance=5e7,e.scene.minimumDisableDepthTestDistance=0,e.scene.fxaa=!1}return i(t,[{key:"doKeyDown",value:function(t){var e=t.keyCode?t.keyCode:t.which;38!==e&&87!==e||(clearCanvas(),y-=10,tempContext.fillRect(x,y,80,40),t.preventDefault()),39!==e&&68!==e||(clearCanvas(),x+=10,tempContext.fillRect(x,y,80,40),t.preventDefault()),40!==e&&83!==e||(clearCanvas(),y+=10,tempContext.fillRect(x,y,80,40),t.preventDefault()),37!==e&&65!==e||(clearCanvas(),x-=10,tempContext.fillRect(x,y,80,40),t.preventDefault())}},{key:"registHotKey",value:function(){var t=this;document.addEventListener("keyup",function(e){if("Space"!=e.code)switch(e.key){case"p":t.viewer.FPS=!t.viewer.FPS;break;case"r":break;case"P":break;case"P":break;case"P":}},!1)}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(74),s=i(a),u=function(){function t(e){r(this,t),this.viewer=e;var n=new Cesium.CustomDataSource("graphicDatasource");this.viewer.dataSources.add(n),this.entitycollection=n.entities,this.retainEntity=!0,this.clickEvt=null,this._lonlataltList=[],this._pointList=[],this.drawComplete=null,this._polygonShow=!1,this._polylineShow=!1,this._rectangleShow=!1,this._initEvent()}return o(t,[{key:"trackPolygon",value:function(t,e){this.drawComplete=t,this._polygonShow=!0,this._polylineShow=!1,this._rectangleShow=!1,this._addEntity(e),this._isTrack=!0,this.viewer.canvas.style.cursor="crosshair"}},{key:"trackPolyline",value:function(t,e){this.drawComplete=t,this._polygonShow=!1,this._polylineShow=!0,this._rectangleShow=!1,this._addEntity(e),this._isTrack=!0,this.earth.canvas.style.cursor="crosshair"}},{key:"clear",value:function(){this.entitycollection.removeAll(),this._lonlataltList=[],this._pointList=[],this._isTrack=!1,this.viewer.canvas.style.cursor="default"}},{key:"_initEvent",value:function(){var t=this.viewer.scene,e=this,n=new Cesium.ScreenSpaceEventHandler(t.canvas);this.clickEvt=n.setInputAction(function(n){if(e._isTrack){var i=s.default.pickPosition(e.viewer,n.position);if(i){var r=t.globe.ellipsoid.cartesianToCartographic(i),o=Cesium.Math.toDegrees(r.latitude),a=Cesium.Math.toDegrees(r.longitude),u=r.height;e._pointList.push(i),e._lonlataltList.push(a,o,u),e.entitycollection.add({position:i,point:{color:Cesium.Color.YELLOW,heightReference:Cesium.HeightReference.CLAMP_TO_GROUND,pixelSize:8,disableDepthTestDistance:Number.POSITIVE_INFINITY}})}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),n.setInputAction(function(t){e._isTrack&&(e._isTrack=!1,e.retainEntity||e.clear(),e.drawComplete&&e.drawComplete(e._lonlataltList,e._pointList))},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}},{key:"_addEntity",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.clear(),this.entitycollection.add({polygon:{show:this._polygonShow,perPositionHeight:!e,hierarchy:new Cesium.CallbackProperty(function(){return new Cesium.PolygonHierarchy(t._pointList)},!1),material:Cesium.Color.DEEPSKYBLUE.withAlpha(.7)},polyline:{show:this._polylineShow,clampToGround:e,positions:new Cesium.CallbackProperty(function(){return t._pointList},!1),material:Cesium.Color.DEEPSKYBLUE,width:2}})}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(81),s=i(a),u=n(82),l=i(u),c=n(83),h=i(c),f=n(84),p=i(f),d=n(85),g=i(d),y=n(86),m=i(y),v=n(87),_=i(v),w=n(88),b=i(w),C=n(89),x=i(C),E=n(90),S=i(E),P=n(92),M=i(P),L=n(101),I=i(L),T=n(102),N=i(T),k=n(104),O=i(k),D=function(){function t(e){r(this,t),this.viewer=e,this.toolList=new Map}return o(t,[{key:"closeAll",value:function(){var t=!0,e=!1,n=void 0;try{for(var i,r=this.toolList[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value,a=o[1];"measureTool"==o[0]?a.clearMeasure():a.close()}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}}},{key:"aspect",get:function(){var t=this.toolList.get("aspect");return t||(t=new l.default(this.viewer),this.toolList.set("aspect",t)),t}},{key:"slope",get:function(){var t=this.toolList.get("slope");return t||(t=new s.default(this.viewer),this.toolList.set("slope",t)),t}},{key:"contour",get:function(){var t=this.toolList.get("contour");return t||(t=new h.default(this.viewer),this.toolList.set("contour",t)),t}},{key:"elevation",get:function(){var t=this.toolList.get("elevaton");return t||(t=new p.default(this.viewer),this.toolList.set("elevaton",t)),t}},{key:"profile",get:function(){var t=this.toolList.get("profile");return t||(t=new g.default(this.viewer),this.toolList.set("profile",t)),t}},{key:"flood",get:function(){var t=this.toolList.get("floodAnalyze");return t||(t=new _.default(this.viewer),this.toolList.set("floodAnalyze",t)),t}},{key:"heightAnalyze",get:function(){var t=this.toolList.get("heightAnalyze");return t||(t=new b.default(this.viewer),this.toolList.set("heightAnalyze",t)),t}},{key:"viewshedAnalyze",get:function(){var t=this.toolList.get("viewshedAnalyze");return t||(t=new m.default(this.viewer),this.toolList.set("viewshedAnalyze",t)),t}},{key:"measureTool",get:function(){var t=this.toolList.get("measureTool");return t||(t=new S.default(this.viewer),this.toolList.set("measureTool",t)),t}},{key:"clipTool",get:function(){var t=this.toolList.get("clipTool");return t||(t=new x.default(this.viewer),this.toolList.set("clipTool",t)),t}},{key:"skyline",get:function(){var t=this.toolList.get("skyline");return t||(t=new M.default(this.viewer),this.toolList.set("skyline",t)),t}},{key:"underground",get:function(){var t=this.toolList.get("underground");return t||(t=new I.default(this.viewer),this.toolList.set("underground",t)),t}},{key:"groundClip",get:function(){var t=this.toolList.get("groundClip");return t||(t=new N.default(this.viewer),this.toolList.set("groundClip",t)),t}},{key:"visibilityAnalyze",get:function(){var t=this.toolList.get("visibilityAnalyze");return t||(t=new O.default(this.viewer),this.toolList.set("visibilityAnalyze",t)),t}}]),t}();e.default=D},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this._colorRamp=new Map}return i(t,[{key:"setPolygon",value:function(t){t.length<2||(this._points=Cesium.Cartesian3.fromDegreesArrayHeights(t))}},{key:"open",value:function(){var t=Cesium.Material.fromType("SlopeRamp"),e=t.uniforms;e.image=this.getColorRamp(),Cesium.GlobeSurfaceOption&&Cesium.GlobeSurfaceOption.setPolygon(this._points),this.viewer.scene.globe.material=t}},{key:"close",value:function(){this.viewer.scene.globe.material=void 0}},{key:"getColorRamp",value:function(){var t=document.createElement("canvas");t.width=100,t.height=1;var e=t.getContext("2d"),n=e.createLinearGradient(0,0,100,0),i=!0,r=!1,o=void 0;
try{for(var a,s=this._colorRamp[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;n.addColorStop(u[0],u[1])}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return e.fillStyle=n,e.fillRect(0,0,100,1),t}},{key:"colorRamp",get:function(){return this._colorRamp}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this._colorRamp=new Map}return i(t,[{key:"setPolygon",value:function(t){t.length<2||(this._points=Cesium.Cartesian3.fromDegreesArrayHeights(t))}},{key:"open",value:function(){var t=Cesium.Material.fromType("AspectRamp"),e=t.uniforms;e.image=this.getColorRamp(),Cesium.GlobeSurfaceOption&&Cesium.GlobeSurfaceOption.setPolygon(this._points),this.viewer.scene.globe.material=t}},{key:"close",value:function(){this.viewer.scene.globe.material=void 0}},{key:"getColorRamp",value:function(){var t=document.createElement("canvas");t.width=100,t.height=1;var e=t.getContext("2d"),n=e.createLinearGradient(0,0,100,0),i=!0,r=!1,o=void 0;try{for(var a,s=this._colorRamp[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;n.addColorStop(u[0],u[1])}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return e.fillStyle=n,e.fillRect(0,0,100,1),t}},{key:"colorRamp",get:function(){return this._colorRamp}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this._color=Cesium.Color.clone(Cesium.Color.RED),this._width=2,this._spacing=10,this._material=Cesium.Material.fromType("ElevationContour")}return i(t,[{key:"setPolygon",value:function(t){t.length<2||(this._points=Cesium.Cartesian3.fromDegreesArrayHeights(t),this.open())}},{key:"open",value:function(){var t=this._material.uniforms;t.width=this._width,t.spacing=this._spacing,t.color=this._color,Cesium.GlobeSurfaceOption&&Cesium.GlobeSurfaceOption.setPolygon(this._points),this.viewer.scene.globe.material=this._material}},{key:"close",value:function(){viewer.scene.globe.material=void 0}},{key:"color",get:function(){return this._material.uniforms.color},set:function(t){this._material.uniforms.color=t}},{key:"width",get:function(){return this._material.uniforms.width},set:function(t){this._material.uniforms.width=t}},{key:"spacing",get:function(){return this._material.uniforms.spacing},set:function(t){this._material.uniforms.spacing=t}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this._colorRamp=new Map,this._minimumHeight=-414,this._maximumHeight=8777}return i(t,[{key:"setPolygon",value:function(t){t.length<2||(this._points=Cesium.Cartesian3.fromDegreesArrayHeights(t))}},{key:"open",value:function(){var t=Cesium.Material.fromType("ElevationRamp"),e=t.uniforms;e.image=this.getColorRamp(),e.minimumHeight=this._minimumHeight,e.maximumHeight=this._maximumHeight,Cesium.GlobeSurfaceOption&&Cesium.GlobeSurfaceOption.setPolygon(this._points),this.viewer.scene.globe.material=t}},{key:"close",value:function(){viewer.scene.globe.material=void 0}},{key:"getColorRamp",value:function(){var t=document.createElement("canvas");t.width=100,t.height=1;var e=t.getContext("2d"),n=e.createLinearGradient(0,0,100,0),i=!0,r=!1,o=void 0;try{for(var a,s=this._colorRamp[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;n.addColorStop(u[0],u[1])}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return e.fillStyle=n,e.fillRect(0,0,100,1),t}},{key:"minimumHeight",get:function(){return this._minimumHeight},set:function(t){this._minimumHeight=t}},{key:"maximumHeight",get:function(){return this._maximumHeight},set:function(t){this._maximumHeight=t}},{key:"colorRamp",get:function(){return this._colorRamp}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e}return i(t,[{key:"setPolyline",value:function(t,e){t.length<2}},{key:"caculatePoint",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){viewer.scene.globe.material=void 0}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this._viewer=e,this._scene=e.scene,this._camera=this._scene.camera,this.context=this._scene.context,this._visibleColor=Cesium.Color.LIME,this._inVisibleColor=Cesium.Color.RED,this._offsetDist=.2,this._viewPoint=null,this.timeId,this.cameraPosition=null,this.startAnalyze=!1,this.shadowOptions,this.handler,this.spotLightCamera,this.radii,this.heading,this.roll,this.pitch,this.tempFrustum,this.normalShaderFun=null,this.normalShader,this.lightSwitch=!1,this.testOn=!1,this.entities=[],this.activeShapePoints=[],this._showDistance=!0,this._showDome=!0,this.defaultOption={terrainShadows:this._viewer.terrainShadows,depthTestAgainstTerrain:this._scene.globe.depthTestAgainstTerrain,shadowMap:this._scene.shadowMap}}return i(t,[{key:"open",value:function(){this.startAnalyze||(this.close(),this._viewer.terrainShadows=Cesium.ShadowMode.ENABLED,this.testOn=this._scene.globe.depthTestAgainstTerrain,this.testOn||(this._scene.globe.depthTestAgainstTerrain=!0),this._initialiseHandlers(),this.startAnalyze=!0)}},{key:"close",value:function(){this.startAnalyze=!1,this.cameraPosition=null,this.tempFrustum&&this._scene.primitives.remove(this.tempFrustum),this.handler&&(this.handler.destroy(),this.handler=null),this._scene.shadowMap&&(this._scene.shadowMap.enabled=!1);var t=!0,e=!1,n=void 0;try{for(var i,r=this.entities[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;this._viewer.entities.remove(o)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}this.entities=[],this.activeShapePoints=[],this._viewer.terrainShadows=this.defaultOption.terrainShadows,this._scene.globe.depthTestAgainstTerrain=this.defaultOption.depthTestAgainstTerrain,this._scene.shadowMap=this.defaultOption.shadowMap,this.spotLightCamera=null}},{key:"setPosition",value:function(t,e){var n=!0,i=!1,r=void 0;try{for(var o,a=this.entities[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;this._viewer.entities.remove(s)}}catch(t){i=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}this._updateCamera(t),this._updateTarget(e)}},{key:"_updateTarget",value:function(t){t&&(this._calculatePose(t),this.cameraPosition&&(this.activeShapePoints=[],this.activeShapePoints.push(this.cameraPosition),this.activeShapePoints.push(t))),this._updateLightDirection(),this._creatFrustum()}},{key:"_updateCamera",value:function(t){t&&(this.cameraPosition=t,this._viewPoint=t,this._createViewShad(t),0==this.entities.length&&this._addEntity(),this.activeShapePoints.push(t))}},{key:"_initialiseHandlers",value:function(){var t=this,e=this;this.handler=new Cesium.ScreenSpaceEventHandler(this._scene.canvas),this.handler.setInputAction(function(n){if(e.startAnalyze&&null!=e.cameraPosition){var i=e._pickPosition(n.endPosition);t._updateTarget(i)}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(function(n){if(e.startAnalyze&&null==e.cameraPosition){var i=e._pickPosition(n.position);if(i){var r=!0,o=!1,a=void 0;try{for(var s,u=e.entities[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value;e._viewer.entities.remove(l)}}catch(t){o=!0,a=t}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}e.entities=[],e.activeShapePoints=[];var c=e._viewer.scene.globe.ellipsoid,h=c.cartesianToCartographic(i),f=Cesium.Math.toDegrees(h.latitude),p=Cesium.Math.toDegrees(h.longitude),d=h.height+t._offsetDist,g=Cesium.Cartesian3.fromDegrees(p,f,d);t._updateCamera(g)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(e){t.startAnalyze=!1,t.cameraPosition=null},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}},{key:"_addEntity",value:function(t){var e=this,n=new Cesium.CallbackProperty(function(){return e.viewPoint},!1),i=new Cesium.CallbackProperty(function(){return e.activeShapePoints},!1),r=new Cesium.CallbackProperty(function(){return e.activeShapePoints[e.activeShapePoints.length-1]},!1),o=new Cesium.CallbackProperty(function(){var t="";if(e.activeShapePoints.length>1){var n=Cesium.Cartesian3.distance(e.activeShapePoints[0],e.activeShapePoints[1]);t="距离:"+n.toFixed(2)+"米"}return t},!1),a=new Cesium.CallbackProperty(function(){return e._showDistance},!1);this.entities.push(this._viewer.entities.add({position:n,point:{pixelSize:12,color:Cesium.Color.YELLOW,disableDepthTestDistance:Number.POSITIVE_INFINITY}})),this.entities.push(this._viewer.entities.add({polyline:{positions:i,show:a,width:2,clampToGround:!1,material:Cesium.Color.LIME,disableDepthTestDistance:Number.POSITIVE_INFINITY,classificationType:Cesium.ClassificationType.NONE}})),this.entities.push(this._viewer.entities.add({position:r,label:{show:a,text:o,pixelOffset:new Cesium.Cartesian2(30,-50),scale:.5,font:"32px 微软雅黑",fillColor:Cesium.Color.DEEPSKYBLUE,outlineColor:Cesium.Color.BLACK,outlineWidth:1,showBackground:!0,backgroundColor:Cesium.Color.BLACK.withAlpha(.9),backgroundPadding:new Cesium.Cartesian2(10,6),disableDepthTestDistance:Number.POSITIVE_INFINITY}}))}},{key:"_calculatePose",value:function(t){var e=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(t,this.cameraPosition,e),this.radii=Cesium.Cartesian3.magnitude(e),Cesium.Cartesian3.normalize(e,e);var n=this._scene.frameState.camera,i=n.heading,r=n.pitch,o=n.roll,a=new Cesium.Cartesian3;Cesium.Cartesian3.clone(n.position,a);var s=e.clone(),u=this.cameraPosition.clone(),u=Cesium.Cartesian3.normalize(u,u);Math.abs(Cesium.Cartesian3.dot(u,s))>=1&&(u=Math.abs(Cesium.Cartesian3.dot(s,Cesium.Cartesian3.UNIT_Y))<1?Cesium.Cartesian3.clone(Cesium.Cartesian3.UNIT_Y,u):Cesium.Cartesian3.clone(Cesium.Cartesian3.UNIT_Z,u));var l=new Cesium.Cartesian3;Cesium.Cartesian3.cross(u,s,l),l=Cesium.Cartesian3.normalize(l,l),Cesium.Cartesian3.cross(s,l,u),u=Cesium.Cartesian3.normalize(u,u),n.setView({destination:this.cameraPosition,orientation:{direction:s,up:u}}),this.heading=n.heading,this.roll=n.roll,this.pitch=n.pitch,n.setView({destination:a,orientation:{heading:i,pitch:r,roll:o}})}},{key:"_createViewShad",value:function(t){if(!this.spotLightCamera){this.spotLightCamera=new Cesium.Camera(this._scene),this.spotLightCamera.position=t,this.spotLightCamera.frustum.fov=Cesium.Math.PI_OVER_THREE,this.spotLightCamera.frustum.aspectRatio=1,this.spotLightCamera.frustum.near=1,this.spotLightCamera.frustum.far=2,this.shadowOptions={context:this.context,enabled:!0,lightCamera:this.spotLightCamera,maximumDistance:500,cascadesEnabled:!1};var e=this;this._scene.shadowMap=new Cesium.ShadowMap(this.shadowOptions),null==this.normalShaderFun&&(this.normalShaderFun=Cesium.ShadowMapShader.createShadowReceiveFragmentShader),Cesium.ShadowMapShader.createShadowReceiveFragmentShader=function(t,n,i,r,o){return e._getUIShader(e,t,n,i,r,o)}}this.spotLightCamera.position=t}},{key:"_getUIShader",value:function(t,e,n,i,r,o){var a=t.normalShaderFun(e,n,i,r,o),s=t.visibleColor.red,u=t.visibleColor.green,l=t.visibleColor.blue,c=t.inVisibleColor.red,h=t.inVisibleColor.green,f=t.inVisibleColor.blue,p=" if(visibility == 1.0){ \n          gl_FragColor.rgb *= vec3("+s+","+u+","+l+");  \n        } else { \n          gl_FragColor.rgb *= vec3("+c+","+h+","+f+"); \n        }\n        ";return a.sources[a.sources.length-1]=a.sources[a.sources.length-1].replace("gl_FragColor.rgb *= visibility;",p),a}},{key:"_updateLightDirection",value:function(){this.radii<=1||(this.spotLightCamera.frustum.far=this.radii,this.shadowOptions.maximumDistance=this.radii,this.spotLightCamera.setView({orientation:{heading:this.heading,pitch:this.pitch,roll:this.roll}}))}},{key:"_creatFrustum",value:function(){var t=this.heading-100/57.29578,e=new Cesium.HeadingPitchRoll(t,this.pitch,this.roll),n=Cesium.Quaternion.fromHeadingPitchRoll(e),i=Cesium.Matrix3.fromQuaternion(n),r=Cesium.Matrix4.multiply(Cesium.Transforms.eastNorthUpToFixedFrame(this.cameraPosition),Cesium.Matrix4.fromRotationTranslation(i,new Cesium.Cartesian3(0,0,0)),new Cesium.Matrix4),o=this._getViewShadGeometry({dist:this.radii}),a=new Cesium.GeometryInstance({geometry:o,modelMatrix:r,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.WHITE)}}),s=new Cesium.Primitive({geometryInstances:a,asynchronous:!1,appearance:new Cesium.PerInstanceColorAppearance({flat:!0,translucent:!1})});this.tempFrustum&&this._scene.primitives.remove(this.tempFrustum),this._scene.primitives.add(s),this.tempFrustum=s,this.tempFrustum.show=this._showDome}},{key:"_pickPosition",value:function(t){return this._scene.pickPosition(t)}},{key:"_getViewShadGeometry",value:function(t){t=Cesium.defaultValue(t,Cesium.defaultValue.EMPTY_OBJECT);var e=Cesium.defaultValue(t.dist,200),n=Cesium.defaultValue(t.phiStart,75),i=Cesium.defaultValue(t.phiLength,30),r=Cesium.defaultValue(t.thetaLength,60),o=Cesium.defaultValue(t.thetaStart,320),a=new Cesium.Cartesian3(e,e,e),s=Cesium.Ellipsoid.fromCartesian3(a),u=Cesium.Math.toRadians(n),l=Cesium.Math.toRadians(i),c=Cesium.Math.toRadians(o),h=Cesium.Math.toRadians(r),f=new Float64Array(15),p=Cesium.IndexDatatype.createTypedArray(5,20),d=0,g=1.1547005*e;f[d++]=g*Math.cos(c)*Math.sin(u),f[d++]=g*Math.sin(c)*Math.sin(u),f[d++]=g*Math.cos(u),f[d++]=g*Math.cos(c+h)*Math.sin(u),f[d++]=g*Math.sin(c+h)*Math.sin(u),f[d++]=g*Math.cos(u),f[d++]=g*Math.cos(c)*Math.sin(u+l),f[d++]=g*Math.sin(c)*Math.sin(u+l),f[d++]=g*Math.cos(u+l),f[d++]=g*Math.cos(c+h)*Math.sin(u+l),f[d++]=g*Math.sin(c+h)*Math.sin(u+l),f[d++]=g*Math.cos(u+l),f[d++]=0,f[d++]=0,f[d++]=0,d=0,p[d++]=4,p[d++]=0,p[d++]=4,p[d++]=1,p[d++]=4,p[d++]=2,p[d++]=4,p[d++]=3,p[d++]=0,p[d++]=1,p[d++]=0,p[d++]=2,p[d++]=2,p[d++]=3,p[d++]=3,p[d++]=1;var y=new Cesium.GeometryAttributes({position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:f})});return new Cesium.Geometry({attributes:y,indices:p,primitiveType:Cesium.PrimitiveType.LINES,boundingSphere:Cesium.BoundingSphere.fromEllipsoid(s)})}},{key:"visibleColor",get:function(){return this._visibleColor},set:function(t){t instanceof Cesium.Color&&(this._visibleColor=t)}},{key:"inVisibleColor",get:function(){return this._inVisibleColor},set:function(t){t instanceof Cesium.Color&&(this._inVisibleColor=t)}},{key:"showDistance",get:function(){return this._showDistance},set:function(t){this._showDistance=t}},{key:"offsetDist",get:function(){return this._offsetDist},set:function(t){this._offsetDist=t}},{key:"hpr",get:function(){return new Cesium.HeadingPitchRoll(this.spotLightCamera.heading,this.spotLightCamera.pitch,this.spotLightCamera.roll)},set:function(t){var e=this.spotLightCamera;e.setView({destination:e.position,orientation:{heading:t.heading,pitch:t.pitch,roll:t.roll}})}},{key:"fov",get:function(){var t=this.spotLightCamera.frustum;return Cesium.Math.toDegrees(t.fov)},set:function(t){var e=this.spotLightCamera.frustum;e.fov=Cesium.Math.toRadians(t),this.spotLightCamera.frustum=e}},{key:"near",get:function(){return this.spotLightCamera.frustum.near},set:function(t){this.spotLightCamera.frustum.near=t}},{key:"far",get:function(){return this.spotLightCamera.frustum.far},set:function(t){this.spotLightCamera.frustum.far=t}},{key:"showDome",get:function(){return this._showDome},set:function(t){this._showDome=t,this.tempFrustum&&(this.tempFrustum.show=this._showDome)}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){var i=this;n(this,t),this._viewer=e,this._scene=e.scene,this._camera=this._scene.camera,this._color=Cesium.Color.RED.withAlpha(.4),this._maxHeight=3e3,this._minHeight=0,this._currentHeight=0,this._interpolation=8,this._tickEvent=function(){i.updateGeometry()},this.flayer=null,this.pList=null,this.step=1}return i(t,[{key:"setPolygon",value:function(t,e){for(var n=[],i=[],r=[],o=[],a=0;a<t.length;a+=3)i.push(t[a]),r.push(t[a+1]),o.push(t[a+2]),n.push(Cesium.Cartographic.fromDegrees(t[a],t[a+1]));var s=Math.max.apply(null,r),u=Math.min.apply(null,r),l=Math.max.apply(null,i),c=Math.min.apply(null,i);0==this._minHeight&&(this._minHeight=Math.min.apply(null,o));for(var h=(s-u)/this._interpolation,f=(l-c)/this._interpolation,p=0;p<this._interpolation;p++)for(var d=0;d<this._interpolation;d++){var g=u+p*h,y=c+d*f;n.push(Cesium.Cartographic.fromDegrees(g,y))}var m=Cesium.sampleTerrain(this._viewer.terrainProvider,12,n);Cesium.when(m,function(t){e&&e()}),this.pList=Cesium.Cartesian3.fromDegreesArrayHeights(t)}},{key:"open",value:function(){this.startAnalyze=!0,this._viewer.clock.onTick.removeEventListener(this._tickEvent),this._viewer.clock.onTick.addEventListener(this._tickEvent)}},{key:"close",value:function(){this.startAnalyze=!1,this._viewer.clock.onTick.removeEventListener(this._tickEvent),this._viewer.scene.primitives.remove(this.flayer),this._currentHeight=0}},{key:"updateGeometry",value:function(){var t=this;if(t.startAnalyze){if(!(t._currentHeight<t._maxHeight))return void(t.startAnalyze=!1);t._currentHeight+=t.step;var e=t._minHeight+t._currentHeight;t._viewer.scene.primitives.remove(t.flayer);var n=t.creategeometry(t.pList,t._minHeight,e);t.flayer=new Cesium.ClassificationPrimitive({allowPicking:!1,geometryInstances:n,asynchronous:!1}),t._viewer.scene.primitives.add(t.flayer)}}},{key:"creategeometry",value:function(t,e,n){return new Cesium.GeometryInstance({geometry:Cesium.PolygonGeometry.fromPositions({positions:t,height:e,perPositionHeight:!1,extrudedHeight:n}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(this._color)}})}},{key:"speed",get:function(){return this.step},set:function(t){t<=0||(this.step=t)}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"maxHeight",get:function(){return this._maxHeight},set:function(t){this._maxHeight=t}},{key:"minHeight",get:function(){return this._minHeight},set:function(t){this._minHeight=t}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.viewer=e,this.config={color:Cesium.Color.RED.withAlpha(.7),height:400}}return i(t,[{key:"setPolygon",value:function(t){t.length<2||(this._points=Cesium.Cartesian3.fromDegreesArrayHeights(t),this.updateLayer())}},{key:"open",value:function(){this.updateLayer()}},{key:"close",value:function(){this.viewer.scene.primitives.remove(this._layer)}},{key:"updateLayer",value:function(){if(this.viewer.scene.primitives.remove(this._layer),this._points){var t=this.creategeometry(this._points);this._layer=new Cesium.ClassificationPrimitive({allowPicking:!1,geometryInstances:t,asynchronous:!1}),this.viewer.scene.primitives.add(this._layer)}}},{key:"creategeometry",value:function(t){return new Cesium.GeometryInstance({geometry:Cesium.PolygonGeometry.fromPositions({positions:t,height:this.config.height,perPositionHeight:!1,extrudedHeight:1e6}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(this.config.color)}})}},{key:"color",get:function(){return this.config.color},set:function(t){this.config.color=Cesium.Color.fromCssColorString(t),this.updateLayer()}},{key:"height",get:function(){return this.config.height},set:function(t){this.config.height=t,this.updateLayer()}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(26),s=i(a),u=function(){function t(e){r(this,t),this.viewer=e,this._height=100,this.terrainClipPlan=null,this._path=[]}return o(t,[{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;this.terrainClipPlan||(this.terrainClipPlan=new TerrainClipPlane(this.viewer,{height:e,splitNum:1e4,wallImg:s.default.getResource("Assets/Images/excavate_side_min.jpg"),bottomImg:s.default.getResource("Assets/Images/excavate_side_min.jpg")})),this._height=e,this.terrainClipPlan._height=e,this.path=t}},{key:"getPositionsData",value:function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n],r=i.lon,o=i.lat,a=i.alt,s=Cesium.Cartesian3.fromDegrees(r,o,a);e.push({x:s.x,y:s.y,z:s.z})}return e}},{key:"updateData",value:function(){this.terrainClipPlan.updateData(this.path)}},{key:"clear",value:function(){this.terrainClipPlan.clear()}},{key:"polygon",get:function(){return this._path},set:function(t){this._path=t,this.updateData()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this.terrainClipPlan._height=t,this.updateData()}}]),t}();e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(65),u=i(s),l=n(39),c=i(l),h=n(91),f=i(h),p=function(){function t(e){o(this,t),this.mType="",this.viewer=e,this._font="16px SimHei";var n=this;this._defaultFaax=e.scene.postProcessStages.fxaa.enabled,e.scene.postProcessStages.fxaa.enabled=!1,this.drawControl=this.viewer.drawTool,this.dataSource=this.drawControl.getDataSource(),this._initWorker(this.dataSource),this.drawControl.onChangeDrawing=function(t){switch(n.mType){case"length":case"section":n.workLength.showAddPointLength(t);break;case"area":n.workArea.showAddPointLength(t);break;case"height":n.workHeight.showAddPointLength(t);break;case"super_height":n.workSuperHeight.showAddPointLength(t)}},this.drawControl.onMoveDrawing=function(t){switch(n.mType){case"length":case"section":n.workLength.showMoveDrawing(t);break;case"area":n.workArea.showMoveDrawing(t);break;case"height":n.workHeight.showMoveDrawing(t);break;case"super_height":n.workSuperHeight.showMoveDrawing(t)}},this.drawControl.onStopDrawing=function(t){switch(n.mType){case"length":case"section":n.workLength.showDrawEnd(t);break;case"area":n.workArea.showDrawEnd(t);break;case"height":n.workHeight.showDrawEnd(t);break;case"super_height":n.workSuperHeight.showDrawEnd(t)}}}return a(t,[{key:"_initWorker",value:function(t){var e=this;this.workLength={options:null,arrLables:[],totalLable:null,clearLastNoEnd:function(){if(null!=this.totalLable&&t.entities.remove(this.totalLable),this.arrLables&&this.arrLables.length>0){var e=this.arrLables;if(e&&e.length>0)for(var n in e)t.entities.remove(e[n])}this.totalLable=null,this.arrLables=[]},start:function(n){this.options=n,this.totalLable=t.entities.add({label:{style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.AZURE,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,-15),outlineColor:Cesium.Color.BLACK,outlineWidth:3,font:e._font,show:!1},isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),this.arrLables=[],e.drawControl.startDraw({type:"polyline",addHeight:n.addHeight,style:{color:"#00FF00",clampToGround:"section"==this.options.type||this.options.terrain,width:3}})},showAddPointLength:function(n){var i=e.drawControl.getPositions(n),r=t.entities.add({position:i[i.length-1],label:{style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.AZURE,outlineColor:Cesium.Color.BLACK,outlineWidth:3,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,-15),font:e._font,show:!0},isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}});if(1==i.length)r.label.text="起点";else{var o=this.getLength(i),a=e.formatLength(o,this.options.unit);r.label.text=a,r.attribute.value=o,this.getLength([i[i.length-2],i[i.length-1]])<5&&(r.show=!1)}this.arrLables.push(r)},showMoveDrawing:function(t){var n=e.drawControl.getPositions(t);if(!(n.length<2)){var i=this.getLength(n),r=e.formatLength(i,this.options.unit);this.totalLable&&(this.totalLable.position=n[n.length-1],this.totalLable.label.text="全长:"+r,this.totalLable.label.show=!0,this.totalLable.attribute.value=i,this.totalLable.attribute.textEx="全长:"),this.options.calback&&this.options.calback(r,i)}},showDrawEnd:function(n){var i=e.drawControl.getPositions(n),r=this.arrLables.length-i.length;if(r>=0){this.totalLable.position=i[i.length-1],this.totalLable.label.text="全长:"+this.arrLables[this.arrLables.length-1].label.text;for(var o=this.arrLables.length-1;o>=i.length-1;o--)t.entities.remove(this.arrLables[o]);this.arrLables.splice(i.length-1,r+1)}n._totalLable=this.totalLable,n._arrLables=this.arrLables,this.totalLable=null,this.arrLables=[],null!=n.polyline&&("section"==this.options.type?this.updateSectionForTerrain(n):this.options.terrain&&this.updateLengthForTerrain(n))},updateLengthForTerrain:function(t){function n(){l++;var h=[r[l-1],r[l]];u.default.terrainPolyline({viewer:e.viewer,positions:h,calback:function(u,f){if(c=f?1==l?c.concat(h):c.concat([r[l]]):c.concat(u),l>=r.length-1){if(t.polyline.positions.setValue(c),a){var p=i.getLength(c),d=e.formatLength(p,s);a.label.text="全长:"+d,a.attribute.value=p,i.options.calback&&i.options.calback(d,p)}}else{var p=i.getLength(u),d=e.formatLength(p,s),g=o[l];g.label.text=d,g.attribute.value=p,n()}}})}var i=this,r=t.polyline.positions.getValue(),o=t._arrLables,a=t._totalLable,s=a&&a.unit,l=0,c=[];n()},updateSectionForTerrain:function(t){function n(){s++;var t=[i[s-1],i[s]];u.default.terrainPolyline({viewer:e.viewer,positions:t,calback:function(u,m){l=m?1==s?l.concat(t):l.concat([i[s]]):l.concat(u);for(var v=Cesium.Cartographic.fromCartesian(i[s-1]).height,_=Cesium.Cartographic.fromCartesian(i[s]).height,w=(_-v)/u.length,b=0;b<u.length;b++){0!=b&&(c+=Cesium.Cartesian3.distance(u[b],u[b-1])),h.push(Number(c.toFixed(1)));var C=f.default.formatPositon(u[b]);p.push(C.z),g.push(C);var x=Number((v+w*b).toFixed(1));d.push(x)}if(s>=i.length-1){if(o){var E=y.getLength(l),S=e.formatLength(E,a);o.label.text="全长:"+S,o.attribute.value=E}y.options.calback&&y.options.calback({distancestr:S,distance:E,arrLen:h,arrLX:d,arrHB:p,arrPoint:g})}else{var E=y.getLength(u),S=e.formatLength(E,a),P=r[s];P.label.text=S,P.attribute.value=E,n()}}})}var i=t.polyline.positions.getValue();if(!(i.length<2)){var r=t._arrLables,o=t._totalLable,a=o&&o.unit,s=0,l=[],c=0,h=[],p=[],d=[],g=[],y=this;n()}},getLength:function(t){for(var e=0,n=0,i=t.length-1;n<i;n++)e+=Cesium.Cartesian3.distance(t[n],t[n+1]);return e}},this.workArea={options:null,totalLable:null,clearLastNoEnd:function(){null!=this.totalLable&&t.entities.remove(this.totalLable),this.totalLable=null},start:function(n){this.options=n,this.totalLable=t.entities.add({label:{style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.AZURE,outlineColor:Cesium.Color.BLACK,outlineWidth:3,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,-15),font:e._font,show:!1},isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),e.drawControl.startDraw({type:"polygon",style:{color:"#ffff00",outline:!0,outlineColor:"#ffff00",outlineWidth:4,opacity:.4,perPositionHeight:!0}})},showAddPointLength:function(t){},showMoveDrawing:function(t){var n=e.drawControl.getPositions(t);if(!(n.length<3)){var i=u.default.getArea(n),r=e.formatArea(i,this.options.unit),o=c.default.getMaxHeightForPositions(n),a=Cesium.Cartographic.fromCartesian(n[0]),s=Cesium.Math.toDegrees(a.latitude),l=Cesium.Math.toDegrees(a.longitude),h=Cesium.Cartesian3.fromDegrees(l,s,o+1);this.totalLable&&(this.totalLable.position=h,this.totalLable.label.text="面积:"+r,this.totalLable.label.show=!0,this.totalLable.attribute.value=i,this.totalLable.attribute.textEx="面积:"),this.options.calback&&this.options.calback(r,i)}},showDrawEnd:function(t){if(null!=t.polygon){var n=e.drawControl.getPositions(t);if(!(n.length<3)){var i=u.default.getArea(n),r=e.formatArea(i,this.options.unit);this.totalLable&&(this.totalLable.label.text="面积:"+r);var o=t.polygon.hierarchy.getValue();o.map(function(t){t.z=t.z+1}),t._totalLable=this.totalLable,this.totalLable=null}}}},this.workHeight={options:null,totalLable:null,clearLastNoEnd:function(){null!=this.totalLable&&t.entities.remove(this.totalLable),this.totalLable=null},start:function(n){this.options=n,this.totalLable=t.entities.add({label:{style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.AZURE,outlineColor:Cesium.Color.BLACK,outlineWidth:3,horizontalOrigin:Cesium.HorizontalOrigin.RIGHT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(0,-15),font:e._font,show:!1},isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),e.drawControl.startDraw({type:"polyline",minMaxPoints:{min:2,max:2,isSuper:!1},style:{color:"#ffff00",width:3}})},showAddPointLength:function(t){},showMoveDrawing:function(t){var n=e.drawControl.getPositions(t);if(!(n.length<2)){var i=Cesium.Cartographic.fromCartesian(n[0]),r=Cesium.Cartographic.fromCartesian(n[1]),o=Math.abs(r.height-i.height),a=e.formatLength(o,this.options.unit);
this.totalLable&&(this.totalLable.position=c.default.getMidPosition(n[0],n[1]),this.totalLable.label.text="高度差:"+a,this.totalLable.label.show=!0,this.totalLable.attribute.value=o,this.totalLable.attribute.textEx="高度差:"),this.options.calback&&this.options.calback(a,o)}},showDrawEnd:function(t){t._totalLable=this.totalLable,this.totalLable=null}},this.workSuperHeight={options:null,totalLable:null,xLable:null,hLable:null,clearLastNoEnd:function(){null!=this.totalLable&&t.entities.remove(this.totalLable),null!=this.xLable&&t.entities.remove(this.xLable),null!=this.hLable&&t.entities.remove(this.hLable),this.totalLable=null,this.xLable=null,this.hLable=null},start:function(n){var i;this.options=n,this.totalLable=t.entities.add({label:(i={style:Cesium.LabelStyle.FILL_AND_OUTLINE,outlineColor:Cesium.Color.BLACK,font:e._font,show:!1,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.CENTER},r(i,"font","normal 32px MicroSoft YaHei"),r(i,"scale",.5),r(i,"fillColor",Cesium.Color.YELLOW),r(i,"outlineColor",Cesium.Color.BLACK),r(i,"outlineWidth",2),r(i,"disableDepthTestDistance",Number.POSITIVE_INFINITY),i),isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),this.xLable=t.entities.add({label:{style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.LIME,outlineColor:Cesium.Color.BLACK,outlineWidth:3,font:e._font,show:!1,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM},isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),this.hLable=t.entities.add({label:{style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.RED,outlineColor:Cesium.Color.BLACK,outlineWidth:3,font:e._font,show:!1,horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM},isMarsMeasureLabel:!0,attribute:{unit:this.options.unit,type:this.options.type}}),e.drawControl.startDraw({type:"polyline",minMaxPoints:{min:2,max:2,isSuper:!0},style:{color:"#ffff00",width:2}})},showAddPointLength:function(t){var n=e.drawControl.getPositions(t);if(4==n.length){var i=n[3].clone();n.pop(),n.pop(),n.pop(),n.push(i)}if(2==n.length){var r=c.default.getZHeightPosition(n[0],n[1]),o=c.default.getHDistance(n[0],n[1]);o>3&&(n.push(r),n.push(n[0]))}this.showSuperHeight(n)},showMoveDrawing:function(t){var n=e.drawControl.getPositions(t);if(4==n.length){var i=n[3].clone();n.pop(),n.pop(),n.pop(),n.push(i)}if(2==n.length){var r=c.default.getZHeightPosition(n[0],n[1]),o=c.default.getHDistance(n[0],n[1]);o>3&&(n.push(r),n.push(n[0]))}this.showSuperHeight(n)},showDrawEnd:function(t){t._arrLables=[this.totalLable,this.hLable,this.xLable],this.totalLable=null,this.hLable=null,this.xLable=null},showSuperHeight:function(t){var n,i,r,o;if(4==t.length){var a,s,u=c.default.getMidPosition(t[0],t[1]),l=Cesium.Cartographic.fromCartesian(t[0]),h=Cesium.Cartographic.fromCartesian(t[1]),f=Cesium.Cartographic.fromCartesian(t[2]),p=h.height-f.height;o=h.height-l.height,r=Cesium.Cartesian3.distance(t[0],t[1]),o>-1&&o<1?(s=t[1],this.updateSuperHeightLabel(this.totalLable,s,"高度差",o),this.updateSuperHeightLabel(this.hLable,u,"长度",r)):(p>-.1&&p<.1?(a=c.default.getMidPosition(t[2],t[1]),s=c.default.getMidPosition(t[2],t[3]),i=Cesium.Cartesian3.distance(t[1],t[2]),n=Cesium.Cartesian3.distance(t[3],t[2])):(s=c.default.getMidPosition(t[2],t[1]),a=c.default.getMidPosition(t[2],t[3]),i=Cesium.Cartesian3.distance(t[3],t[2]),n=Cesium.Cartesian3.distance(t[1],t[2])),this.updateSuperHeightLabel(this.totalLable,s,"高度差",n),this.updateSuperHeightLabel(this.xLable,a,"水平距离",i),this.updateSuperHeightLabel(this.hLable,u,"长度",r))}else if(2==t.length){n=Cesium.Cartesian3.distance(t[1],t[0]);var s=c.default.getMidPosition(t[0],t[1]);xLable.label.show&&(xLable.label.show=!1,hLable.label.show=!1),this.updateSuperHeightLabel(this.totalLable,s,"高度差",n)}var d=e.formatLength(n,this.options.unit);this.options.calback&&this.options.calback(d,n)},updateSuperHeightLabel:function(t,n,i,r){null!=t&&(t.position=n,t.label.text=i+":"+e.formatLength(r,this.options.unit),t.label.show=!0,t.attribute.value=r,t.attribute.textEx=i+":")}}}},{key:"measuerLength",value:function(t){this.endLastDraw(),this.mType="length",t=t||{},t.type=this.mType,t.hasOwnProperty("terrain")||(t.terrain=!0),this.workLength.start(t)}},{key:"measureSection",value:function(t){this.endLastDraw(),this.mType="section",t=t||{},t.type=this.mType,t.terrain=!0,this.workLength.start(t)}},{key:"measureArea",value:function(t){this.endLastDraw(),this.mType="area",t=t||{},t.type=this.mType,this.workArea.start(t)}},{key:"measureHeight",value:function(t){this.endLastDraw(),t=t||{},this.mType="height",t.type=this.mType,this.workHeight.start(t)}},{key:"measureTriangle",value:function(t){this.endLastDraw(),t=t||{},this.mType="super_height",t.type=this.mType,this.workSuperHeight.start(t)}},{key:"endLastDraw",value:function(){this.workLength.clearLastNoEnd(),this.workArea.clearLastNoEnd(),this.workHeight.clearLastNoEnd(),this.workSuperHeight.clearLastNoEnd(),this.drawControl.stopDraw()}},{key:"clearMeasure",value:function(){this.mType="",this.endLastDraw(),this.drawControl.removeAll()}},{key:"updateUnit",value:function(t,e){var n=this.dataSource.entities.values;for(var i in n){var r=n[i];if(r.label&&r.isMarsMeasureLabel&&r.attribute&&r.attribute.value){if(r.attribute.type!=t)continue;"area"==t?r.label.text._value=(r.attribute.textEx||"")+this.formatArea(r.attribute.value,e):r._label.text._value=(r.attribute.textEx||"")+this.formatLength(r.attribute.value,e)}}}},{key:"formatArea",value:function(t,e){if(null==t)return"";null!=e&&"auto"!=e||(e=t<1e6?"m":"km"),t=parseFloat(t);var n="";switch(e){default:case"m":n=t.toFixed(2)+" 平方米";break;case"km":n=(t/1e6).toFixed(2)+" 平方公里";break;case"mu":n=(.0015*t).toFixed(2)+" 亩";break;case"ha":n=(1e-4*t).toFixed(2)+" 公顷"}return n}},{key:"formatLength",value:function(t,e){if(null==t)return"";null!=e&&"auto"!=e||(e=t<1e3?"m":"km"),t=parseFloat(t);var n="";switch(e){default:case"m":n=t.toFixed(2)+" 米";break;case"km":n=(.001*t).toFixed(2)+" 公里";break;case"mile":n=(54e-5*t).toFixed(2)+" 海里";break;case"zhang":n=(.3*t).toFixed(2)+" 丈"}return n}}]),t}();e.default=p},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function t(){n(this,t)};i.formatPositon=function(t){var e=Cesium.Cartographic.fromCartesian(t),n={};return n.y=Number(Cesium.Math.toDegrees(e.latitude).toFixed(6)),n.x=Number(Cesium.Math.toDegrees(e.longitude).toFixed(6)),n.z=Number(e.height.toFixed(1)),n},i.getCurrentMousePosition=function(t,e){var n,i=t.pick(e);if(t.pickPositionSupported&&Cesium.defined(i)&&(n=t.pickPosition(e),Cesium.defined(n))){var r=Cesium.Cartographic.fromCartesian(n),o=r.height;if(o>=0)return n;if(!Cesium.defined(i.id)&&o>=-2e3)return n}if(t.mode===Cesium.SceneMode.SCENE3D){var a=t.camera.getPickRay(e);n=t.globe.pick(a,t)}else n=t.camera.pickEllipsoid(e,t.globe.ellipsoid);return n},i.getCenter=function(t,e){var n=t.scene,i=pickCenterPoint(n),r=i;if(!r){var o=n.globe,a=n.camera.positionCartographic.clone(),s=o.getHeight(a);a.height=s||0,r=Cesium.Ellipsoid.WGS84.cartographicToCartesian(a)}var u=formatPositon(r);return e&&(u=t.mars.point2wgs(u)),u},i.pickCenterPoint=function(t){var e=t.canvas,n=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2),i=t.camera.getPickRay(n),r=t.globe.pick(i,t);return r||t.camera.pickEllipsoid(n)},i.getExtent=function(t,e){var n={xmin:70,xmax:140,ymin:0,ymax:55},i=t.scene,r=i.globe.ellipsoid,o=i.canvas,a=t.camera.pickEllipsoid(new Cesium.Cartesian2(0,0),r);if(a){var s=r.cartesianToCartographic(a);n.xmin=Cesium.Math.toDegrees(s.longitude),n.ymax=Cesium.Math.toDegrees(s.latitude)}else{for(var u,l=o.width/2,c=o.height/2,h=0;h<=c;h+=10){var f=h<=l?h:l;if(u=t.camera.pickEllipsoid(new Cesium.Cartesian2(f,h),r))break}if(u){var s=r.cartesianToCartographic(u);n.xmin=Cesium.Math.toDegrees(s.longitude),n.ymax=Cesium.Math.toDegrees(s.latitude)}}var p=t.camera.pickEllipsoid(new Cesium.Cartesian2(o.width,o.height),r);if(p){var d=r.cartesianToCartographic(p);n.xmax=Cesium.Math.toDegrees(d.longitude),n.ymin=Cesium.Math.toDegrees(d.latitude)}else{for(var g,l=o.width/2,c=o.height/2,h=o.height;h>=c;h-=10){var f=h>=l?h:l;if(g=t.camera.pickEllipsoid(new Cesium.Cartesian2(f,h),r))break}if(g){var d=r.cartesianToCartographic(g);n.xmax=Cesium.Math.toDegrees(d.longitude),n.ymin=Cesium.Math.toDegrees(d.latitude)}}if(e){var y=t.mars.point2wgs({x:n.xmin,y:n.ymin});n.xmin=y.x,n.ymin=y.y;var m=t.mars.point2wgs({x:n.xmax,y:n.ymax});n.xmax=m.x,n.ymax=m.y}return n},i.getCameraView=function(t,e){var n=t.camera,i=n.positionCartographic,r={};return r.y=Number(Cesium.Math.toDegrees(i.latitude).toFixed(6)),r.x=Number(Cesium.Math.toDegrees(i.longitude).toFixed(6)),r.z=Number(i.height.toFixed(1)),r.heading=Number(Cesium.Math.toDegrees(n.heading).toFixed(1)),r.pitch=Number(Cesium.Math.toDegrees(n.pitch).toFixed(1)),r.roll=Number(Cesium.Math.toDegrees(n.roll).toFixed(1)),e&&(r=t.mars.point2wgs(r)),r},e.default=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(93),s=i(a),u=n(100),l=i(u),c=function(){function t(e){r(this,t),this.viewer=e,this.skylineOption=new l.default(e),this.effects=new s.default(e)}return o(t,[{key:"open",value:function(){this.skylineEff=this.effects.addSkyline(this.skylineOption)}},{key:"close",value:function(){this.skylineEff&&this.effects.removeEffect(this.skylineEff)}}]),t}();e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(94),s=i(a),u=n(96),l=i(u),c=n(97),h=i(c),f=n(98),p=i(f),d=n(99),g=i(d),y=function(){function t(e){r(this,t),this.viewer=e,this._ParticleList=[]}return o(t,[{key:"addEffect",value:function(t){var e=this.viewer.scene.postProcessStages;e.add(t),(t instanceof s.default||t instanceof l.default)&&this._setFogAtmoshere()}},{key:"removeEffect",value:function(t){var e=this.viewer.scene.postProcessStages;e.remove(t),(t instanceof s.default||t instanceof l.default)&&this._resetFogAtmoshere()}},{key:"addRain",value:function(){var t=new l.default;return this.addEffect(t),t}},{key:"addSnow",value:function(){var t=new s.default;return this.addEffect(t),t}},{key:"addScan",value:function(t,e,n,i){var r=new h.default(this.viewer,t,e,n,i);return this.addEffect(r),r}},{key:"addSkyline",value:function(t){var e=new g.default(t);return this.addEffect(e),e}},{key:"addRadar",value:function(t,e,n,i){var r=new p.default(this.viewer,t,e,n,i);return this.addEffect(r),r}},{key:"removeAll",value:function(){this.viewer.scene.postProcessStages.removeAll()}},{key:"_setFogAtmoshere",value:function(){this.viewer.scene.skyAtmosphere.hueShift=-.8,this.viewer.scene.skyAtmosphere.saturationShift=-.7,this.viewer.scene.skyAtmosphere.brightnessShift=-.33,this.viewer.scene.fog.density=.001,this.viewer.scene.fog.minimumBrightness=.8}},{key:"_resetFogAtmoshere",value:function(){this.viewer.scene.skyAtmosphere.hueShift=0,this.viewer.scene.skyAtmosphere.saturationShift=0,this.viewer.scene.skyAtmosphere.brightnessShift=0,this.viewer.scene.fog.density=2e-4,this.viewer.scene.fog.minimumBrightness=.1}}]),t}();e.default=y},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(95),l=i(u),c=function(t){function e(t){r(this,e);var n=Cesium.defaultValue(t,1),i={fragmentShader:l.default.FS_SNOW,uniforms:{u_scale:n}},a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return a._scale=n,a}return a(e,t),s(e,[{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t}}]),e}(Cesium.PostProcessStage);e.default=c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){n(this,t)}return i(t,null,[{key:"FS_RAIN",get:function(){return"uniform sampler2D colorTexture;\n\t        varying vec2 v_textureCoordinates;\n\t    \n\t        float hash(float x){\n\t            return fract(sin(x*133.3)*13.13);\n\t    }\n\t    \n\t    void main(void){\n\t    \n\t        float time = czm_frameNumber / 60.0;\n\t    vec2 resolution = czm_viewport.zw;\n\t    \n\t    vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n\t    vec3 c=vec3(.6,.7,.8);\n\t    \n\t    float a=-.4;\n\t    float si=sin(a),co=cos(a);\n\t    uv*=mat2(co,-si,si,co);\n\t    uv*=length(uv+vec2(0,4.9))*.3+1.;\n\t    \n\t    float v=1.-sin(hash(floor(uv.x*100.))*2.);\n\t    float b=clamp(abs(sin(20.*time*v+uv.y*(5./(2.+v))))-.95,0.,1.)*20.;\n\t    c*=v*b; \n\t    \n\t    gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);  \n\t    }\n\t    "}},{key:"FS_SNOW",get:function(){return"uniform sampler2D colorTexture;\n\t        varying vec2 v_textureCoordinates;\n\t    \n\t        float snow(vec2 uv,float scale)\n\t        {\n\t            float time = czm_frameNumber / 60.0;\n\t            float w=smoothstep(1.,0.,-uv.y*(scale/10.));if(w<.1)return 0.;\n\t            uv+=time/scale;uv.y+=time*2./scale;uv.x+=sin(uv.y+time*.5)/scale;\n\t            uv*=scale;vec2 s=floor(uv),f=fract(uv),p;float k=3.,d;\n\t            p=.5+.35*sin(11.*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.))-f;d=length(p);k=min(d,k);\n\t            k=smoothstep(0.,k,sin(f.x+f.y)*0.01);\n\t            return k*w;\n\t        }\n\t    \n\t        void main(void){\n\t            vec2 resolution = czm_viewport.zw;\n\t            vec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\n\t            vec3 finalColor=vec3(0);\n\t            float c = 0.0;\n\t            c+=snow(uv,30.)*.0;\n\t            c+=snow(uv,20.)*.0;\n\t            c+=snow(uv,15.)*.0;\n\t            c+=snow(uv,10.);\n\t            c+=snow(uv,8.);\n\t            c+=snow(uv,6.);\n\t            c+=snow(uv,5.);\n\t            finalColor=(vec3(c)); \n\t            gl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor,1), 0.5); \n\t    \n\t        }\n\t    "}},{key:"FS_SCAN",get:function(){return"uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\nvec4 toEye(in vec2 uv, in float depth)\n {\n vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n posInCamera =posInCamera / posInCamera.w;\n return posInCamera;\n }\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point)\n{\nvec3 v01 = point -planeOrigin;\nfloat d = dot(planeNormal, v01) ;\nreturn (point - planeNormal * d);\n}\nfloat getDepth(in vec4 depth)\n{\nfloat z_window = czm_unpackDepth(depth);\nz_window = czm_reverseLogDepth(z_window);\nfloat n_range = czm_depthRange.near;\nfloat f_range = czm_depthRange.far;\nreturn (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\nvoid main()\n{\ngl_FragColor = texture2D(colorTexture, v_textureCoordinates);\nfloat depth = getDepth( texture2D(depthTexture, v_textureCoordinates));\nvec4 viewPos = toEye(v_textureCoordinates, depth);\nvec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\nfloat dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\nif(dis < u_radius)\n{\nfloat f = 1.0 -abs(u_radius - dis) / u_radius;\nf = pow(f, 4.0);\ngl_FragColor = mix(gl_FragColor, u_scanColor, f);\n}\n}\n"}},{key:"FS_RADAR",get:function(){return"uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec4 u_scanCenterEC;\nuniform vec3 u_scanPlaneNormalEC;\nuniform vec3 u_scanLineNormalEC;\nuniform float u_radius;\nuniform vec4 u_scanColor;\nvec4 toEye(in vec2 uv, in float depth)\n {\n vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n posInCamera =posInCamera / posInCamera.w;\n return posInCamera;\n }\nbool isPointOnLineRight(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt)\n{\nvec3 v01 = testPt - ptOnLine;\nnormalize(v01);\nvec3 temp = cross(v01, lineNormal);\nfloat d = dot(temp, u_scanPlaneNormalEC);\nreturn d > 0.5;\n}\nvec3 pointProjectOnPlane(in vec3 planeNormal, in vec3 planeOrigin, in vec3 point)\n{\nvec3 v01 = point -planeOrigin;\nfloat d = dot(planeNormal, v01) ;\nreturn (point - planeNormal * d);\n}\nfloat distancePointToLine(in vec3 ptOnLine, in vec3 lineNormal, in vec3 testPt)\n{\nvec3 tempPt = pointProjectOnPlane(lineNormal, ptOnLine, testPt);\nreturn length(tempPt - ptOnLine);\n}\nfloat getDepth(in vec4 depth)\n{\nfloat z_window = czm_unpackDepth(depth);\nz_window = czm_reverseLogDepth(z_window);\nfloat n_range = czm_depthRange.near;\nfloat f_range = czm_depthRange.far;\nreturn (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n}\nvoid main()\n{\ngl_FragColor = texture2D(colorTexture, v_textureCoordinates);\nfloat depth = getDepth( texture2D(depthTexture, v_textureCoordinates));\nvec4 viewPos = toEye(v_textureCoordinates, depth);\nvec3 prjOnPlane = pointProjectOnPlane(u_scanPlaneNormalEC.xyz, u_scanCenterEC.xyz, viewPos.xyz);\nfloat dis = length(prjOnPlane.xyz - u_scanCenterEC.xyz);\nfloat twou_radius = u_radius * 2.0;\nif(dis < u_radius)\n{\nfloat f0 = 1.0 -abs(u_radius - dis) / u_radius;\nf0 = pow(f0, 64.0);\nvec3 lineEndPt = vec3(u_scanCenterEC.xyz) + u_scanLineNormalEC * u_radius;\nfloat f = 0.0;\nif(isPointOnLineRight(u_scanCenterEC.xyz, u_scanLineNormalEC.xyz, prjOnPlane.xyz))\n{\nfloat dis1= length(prjOnPlane.xyz - lineEndPt);\nf = abs(twou_radius -dis1) / twou_radius;\nf = pow(f, 3.0);\n}\ngl_FragColor = mix(gl_FragColor, u_scanColor, f + f0);\n}\n}\n"}},{key:"FS_STROKE",get:function(){return"#extension GL_OES_standard_derivatives : enable\n\t        uniform sampler2D colorTexture;\n\t        uniform sampler2D depthTexture;\n\t        uniform float lineWidth;\n\t        uniform float height;\n\t        uniform bvec3 strokeType;\n\t        uniform vec3 tjxColor;\n\t        uniform vec3 bjColor;\n\t        uniform vec3 cameraPos;\n\t        uniform float mbDis;\n\t        varying vec2 v_textureCoordinates;\n\t        vec4 toEye(in vec2 uv, in float depth){\n\t            vec2 xy = vec2((uv.x * 2.0 - 1.0),(uv.y * 2.0 - 1.0));\n\t            vec4 posInCamera =czm_inverseProjection * vec4(xy, depth, 1.0);\n\t            posInCamera =posInCamera / posInCamera.w;\n\t            return posInCamera;\n\t        }\n\t        float getDepth(in vec4 depth){\n\t            float z_window = czm_unpackDepth(depth);\n\t            z_window = czm_reverseLogDepth(z_window);\n\t            float n_range = czm_depthRange.near;\n\t            float f_range = czm_depthRange.far;\n\t            return (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n\t        }\n\t        bool isTJX(vec2 uv,float lw){\n\t            vec2 pixelSize = lw / czm_viewport.zw;\n\t            float dx0 = -pixelSize.x;\n\t            float dy0 = -pixelSize.y;\n\t            float dx1 = pixelSize.x;\n\t            float dy1 = pixelSize.y;\n\t            \n\t            vec2 currUV = uv + vec2(dx0, dy0);\n\t            vec4 currDepth = texture2D(depthTexture, currUV);\n\t            float depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            currUV = uv + vec2(0.0, dy0);\n\t            currDepth = texture2D(depthTexture, currUV);\n\t            depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            currUV = uv + vec2(dx1, dy0);\n\t            currDepth = texture2D(depthTexture, currUV);\n\t            depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            currUV = uv + vec2(dx0, 0.0);\n\t            currDepth = texture2D(depthTexture, currUV);\n\t            depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            currUV = uv + vec2(dx1, 0.0);\n\t            currDepth = texture2D(depthTexture, currUV);\n\t            depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            currUV = uv + vec2(dx0, dy1);\n\t            currDepth = texture2D(depthTexture, currUV);\n\t            depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            currUV = uv + vec2(0.0, dy1);\n\t            currDepth = texture2D(depthTexture, currUV);\n\t            depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            currUV = uv + vec2(dx1, dy1);\n\t            currDepth = texture2D(depthTexture, currUV);\n\t            depth = getDepth(currDepth);\n\t            if(depth>=1.0)return true;\n\t            \n\t            return false;\n\t        }\n\t        void main(){\n\t            \n\t            \n\t            vec4 color = texture2D(colorTexture, v_textureCoordinates);\n\t            if(height>14102.0){\n\t                gl_FragColor = color;\n\t                return;\n\t            }\n\t            vec4 currD = texture2D(depthTexture, v_textureCoordinates);\n\t            if(currD.r>=1.0){\n\t                gl_FragColor = color;\n\t                return;\n\t            }\n\t            float depth = getDepth(currD);\n\t            vec4 positionEC = toEye(v_textureCoordinates, depth);\n\t            vec3 dx = dFdx(positionEC.xyz);\n\t            vec3 dy = dFdy(positionEC.xyz);\n\t            vec3 normal = normalize(cross(dx,dy));\n\t            \n\t            if(strokeType.y||strokeType.z){\n\t                vec4 wp = czm_inverseView * positionEC;\n\t                if(distance(wp.xyz,cameraPos)>mbDis){\n\t                    gl_FragColor = color;\n\t                }else{\n\t                    float dotNum = abs(dot(normal,normalize(positionEC.xyz)));\n\t                    if(dotNum<0.05){\n\t                        gl_FragColor = vec4(bjColor,1.0);\n\t                        return;\n\t                    }\n\t                }\n\t            }\n\t            if(strokeType.x||strokeType.z){\n\t                bool tjx = isTJX(v_textureCoordinates,lineWidth);\n\t                if(tjx){\n\t                    gl_FragColor = vec4(tjxColor,1.0);\n\t                    return;\n\t                }\n\t            }\n\t            gl_FragColor = color;\n\t        }\n\t        "}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(95),l=i(u),c=function(t){function e(t){r(this,e);var n=Cesium.defaultValue(t,1),i={fragmentShader:l.default.FS_RAIN,uniforms:{u_scale:n}},a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return a._scale=n,a}return a(e,t),s(e,[{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t}}]),e}(Cesium.PostProcessStage);e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(95),l=i(u),c=function(t){function e(t,n,i,a,s){if(r(this,e),!Cesium.defined(t))return console.error("viewer 未定义"),o(C);if(!Cesium.defined(n))return console.error("中心点未定义"),o(C);var u=t,c=Cesium.defaultValue(i,1500),h=Cesium.defaultValue(a,Cesium.Color.RED),f=Cesium.defaultValue(s,4e3),p=(new Date).getTime(),d=new Cesium.Cartesian4(n.x,n.y,n.z,1),g=Cesium.Cartographic.fromCartesian(n);g.height+=500;var y=Cesium.Cartographic.toCartesian(g),m=new Cesium.Cartesian4(y.x,y.y,y.z,1),v=new Cesium.Cartesian4,_=new Cesium.Cartesian4,w=new Cesium.Cartesian3,b={fragmentShader:l.default.FS_SCAN,uniforms:{u_scanCenterEC:function(){return Cesium.Matrix4.multiplyByVector(u.camera._viewMatrix,d,v)},u_scanPlaneNormalEC:function(){var t=Cesium.Matrix4.multiplyByVector(u.camera._viewMatrix,d,v),e=Cesium.Matrix4.multiplyByVector(u.camera._viewMatrix,m,_);return w.x=e.x-t.x,w.y=e.y-t.y,w.z=e.z-t.z,Cesium.Cartesian3.normalize(w,w),w},u_radius:function(){return c*(((new Date).getTime()-p)%f)/f},u_scanColor:h}},C=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,b));return C.center=n,C}return a(e,t),s(e,[{key:"scanColor",get:function(){return this._scanColor},set:function(t){this._scanColor=t}},{key:"maxRadius",get:function(){},set:function(t){}}]),e}(Cesium.PostProcessStage);e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),u=n(95),l=i(u),c=function(t){function e(t,n,i,a,s){if(r(this,e),!Cesium.defined(t))return console.error("viewer 未定义"),o(_this);if(!Cesium.defined(n))return console.error("中心点未定义"),o(_this);var u=Cesium.defaultValue(i,1500),c=Cesium.defaultValue(a,Cesium.Color.RED),h=Cesium.defaultValue(s,4e3),f=new Cesium.Cartesian4(n.x,n.y,n.z,1),p=Cesium.Cartographic.fromCartesian(n);p.height+=500;var d=Cesium.Cartographic.toCartesian(p),g=new Cesium.Cartesian4(d.x,d.y,d.z,1),y=Cesium.Cartographic.fromCartesian(n);y.longitude+=Cesium.Math.toRadians(.001);var m=Cesium.Cartographic.toCartesian(y),v=new Cesium.Cartesian4(m.x,m.y,m.z,1),_=new Cesium.Quaternion,w=new Cesium.Matrix3,b=(new Date).getTime(),C=new Cesium.Cartesian4,x=new Cesium.Cartesian4,E=new Cesium.Cartesian4,S=new Cesium.Cartesian3,P=new Cesium.Cartesian3,M={fragmentShader:l.default.FS_RADAR,uniforms:{u_scanCenterEC:function(){return Cesium.Matrix4.multiplyByVector(t.camera._viewMatrix,f,C)},u_scanPlaneNormalEC:function(){var e=Cesium.Matrix4.multiplyByVector(t.camera._viewMatrix,f,C),n=Cesium.Matrix4.multiplyByVector(t.camera._viewMatrix,g,x);return S.x=n.x-e.x,S.y=n.y-e.y,S.z=n.z-e.z,Cesium.Cartesian3.normalize(S,S),S},u_radius:u,u_scanLineNormalEC:function(){var e=Cesium.Matrix4.multiplyByVector(t.camera._viewMatrix,f,C),n=Cesium.Matrix4.multiplyByVector(t.camera._viewMatrix,g,x),i=Cesium.Matrix4.multiplyByVector(t.camera._viewMatrix,v,E);S.x=n.x-e.x,S.y=n.y-e.y,S.z=n.z-e.z,Cesium.Cartesian3.normalize(S,S),P.x=i.x-e.x,P.y=i.y-e.y,P.z=i.z-e.z;var r=((new Date).getTime()-b)%h/h;return Cesium.Quaternion.fromAxisAngle(S,r*Cesium.Math.PI*2,_),Cesium.Matrix3.fromQuaternion(_,w),Cesium.Matrix3.multiplyByVector(w,P,P),Cesium.Cartesian3.normalize(P,P),P},u_scanColor:c}};return o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,M))}return a(e,t),s(e,[{key:"scanColor",get:function(){return this._scanColor},set:function(t){this._scanColor=t}},{key:"maxRadius",get:function(){},set:function(t){}}]),e}(Cesium.PostProcessStage);e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=n(95),u=i(s),l=function(t){function e(t){if(r(this,e),!Cesium.defined(t))return console.error("skylineOption 未定义"),o(a);var n=t.viewer.scene.camera.position,i={fragmentShader:u.default.FS_STROKE,uniforms:{height:function(){return Cesium.Cartographic.fromCartesian(n).height},lineWidth:function(){return t.width},strokeType:function(){return t.strokeType},tjxColor:function(){return t.color;
},bjColor:function(){return t.bjColor},cameraPos:function(){return n},mbDis:function(){return t.strokeDistance}}},a=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,i));return a.skylineOption=t,a}return a(e,t),e}(Cesium.PostProcessStage);e.default=l},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this._viewer=e,this._width=2,this._bjColor=Cesium.Color.RED,this._strokeDistance=500,this._color=Cesium.Color.RED,this._strokeType=new Cesium.Cartesian3(1,0,0)}return i(t,[{key:"viewer",get:function(){return this._viewer}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"strokeType",get:function(){return this._strokeType}},{key:"enabeEdge",get:function(){return 1==this._strokeType.x&&1==this._strokeType.y&&1==this._strokeType.z},set:function(t){t?this._strokeType=new Cesium.Cartesian3(1,1,1):this._strokeType=new Cesium.Cartesian3(1,0,0)}},{key:"bjColor",get:function(){return this._bjColor},set:function(t){this._bjColor=t}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"strokeDistance",get:function(){return this._strokeDistance},set:function(t){this._strokeDistance=t}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,i){n(this,t),this._viewer=e;var r=Cesium.defaultValue(i,{});this._depth=Cesium.defaultValue(r.depth,500),this._alpha=Cesium.defaultValue(r.alpha,.5),this.enable=Cesium.defaultValue(r.enable,!1);var o=Cesium.GlobeSurfaceOption;this._underGroundOpt=o?o.underGround:void 0}return i(t,[{key:"_resetLayersAlpha",value:function(t){for(var e=this._viewer.imageryLayers._layers,n=0,i=e.length;n<i;n++)e[n].alpha=t[n]}},{key:"_updateImageryLayersAlpha",value:function(t){for(var e=this._viewer.imageryLayers._layers,n=0,i=e.length;n<i;n++)e[n].alpha=t}},{key:"_historyOpts",value:function(){var t={};t.alpha=[];for(var e=this._viewer.imageryLayers._layers,n=0,i=e.length;n<i;n++)t.alpha.push(e[n].alpha);t.highDynamicRange=Cesium.clone(this._viewer.scene.highDynamicRange),t.skyShow=Cesium.clone(this._viewer.scene.skyAtmosphere.show),t.skyBoxShow=Cesium.clone(this._viewer.scene.skyBox.show),t.depthTest=Cesium.clone(this._viewer.scene.globe.depthTestAgainstTerrain),this._viewer.scene.globe._surface&&this._viewer.scene.globe._surface._tileProvider&&this._viewer.scene.globe._surface._tileProvider._renderState&&(t.blending=Cesium.clone(this._viewer.scene.globe._surface._tileProvider._renderState.blending)),this._oldViewOpts=t}},{key:"open",value:function(){if(this._underGroundOpt&&!this._enable){this._enable=!0,this._historyOpts(),this._updateImageryLayersAlpha(this._alpha);var t=this._viewer;this._underGroundOpt.enableSkirt=!0,this._underGroundOpt.enabled=!0,this._underGroundOpt.cullFace=null,this._underGroundOpt.enableDepth=this._depth,t.scene.globe.baseColor=new Cesium.Color(0,0,0,0),t.scene.globe.depthTestAgainstTerrain=!0,t.scene.highDynamicRange=!1,t.scene.skyAtmosphere.show=!1,t.scene.skyBox.show=!1}}},{key:"close",value:function(){if(this._enable){this._enable=!1,this._resetLayersAlpha(this._oldViewOpts.alpha);var t=this._viewer;this._underGroundOpt.enableSkirt=!1,this._underGroundOpt.enabled=!1,this._underGroundOpt.cullFace=void 0,t.scene.globe.depthTestAgainstTerrain=this._oldViewOpts.depthTest,t.scene.skyBox.show=this._oldViewOpts.skyBoxShow,t.scene.highDynamicRange=this._oldViewOpts.highDynamicRange,t.scene.skyAtmosphere.show=this._oldViewOpts.skyShow}}},{key:"destroy",value:function(){delete this._viewer,delete this._alpha,delete this._depth,delete this._enable,delete this._oldViewOpts}},{key:"alpha",get:function(){return this._alpha},set:function(t){this._alpha=t,this._updateImageryLayersAlpha(t)}},{key:"depth",get:function(){return this._depth},set:function(t){this._depth=t,this._underGroundOpt.enableDepth=t}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(103),s=i(a),u=n(26),l=i(u),c=function(){function t(e){r(this,t),this.viewer=e,this._height=100,this.terrainClipPlan=null,this._path=[]}return o(t,[{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;this.terrainClipPlan||(this.terrainClipPlan=new s.default(this.viewer,{height:e,splitNum:1e4,wallImg:l.default.getResource("Assets/Images/excavate_side_min.jpg"),bottomImg:l.default.getResource("Assets/Images/excavate_side_min.jpg")})),this._height=e,this.terrainClipPlan._height=e,this.polygon=t}},{key:"getPositionsData",value:function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n],r=i.lon,o=i.lat,a=i.alt,s=Cesium.Cartesian3.fromDegrees(r,o,a);e.push({x:s.x,y:s.y,z:s.z})}return e}},{key:"updateData",value:function(){this.terrainClipPlan.updateData(this._path)}},{key:"open",value:function(){this.updateData()}},{key:"close",value:function(){this.terrainClipPlan.clear()}},{key:"polygon",get:function(){return this._path},set:function(t){this._path=t,this.updateData()}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this.terrainClipPlan._height=t,this.updateData()}}]),t}();e.default=c},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,i){n(this,t),this.viewer=e,this.options=i||{},this._positions=i.positions,this._height=this.options.height||0,this.bottomImg=i.bottomImg,this.wallImg=i.wallImg,this.splitNum=Cesium.defaultValue(i.splitNum,50),this._positions&&this._positions.length>0&&this.updateData(this._positions),this.excavateMinHeight=99999}return i(t,[{key:"updateData",value:function(t){this.clear();var e=[],n=t.length,i=new Cesium.Cartesian3,r=Cesium.Cartesian3.subtract(t[0],t[1],i);r=r.x>0,this.excavateMinHeight=9999;for(var o=0;o<n;++o){var a=(o+1)%n,s=Cesium.Cartesian3.midpoint(t[o],t[a],new Cesium.Cartesian3),u=Cesium.Cartographic.fromCartesian(t[o]),l=this.viewer.scene.globe.getHeight(u)||u.height;l<this.excavateMinHeight&&(this.excavateMinHeight=l);var c,h=Cesium.Cartesian3.normalize(s,new Cesium.Cartesian3);c=r?Cesium.Cartesian3.subtract(t[o],s,new Cesium.Cartesian3):Cesium.Cartesian3.subtract(t[a],s,new Cesium.Cartesian3),c=Cesium.Cartesian3.normalize(c,c);var f=Cesium.Cartesian3.cross(c,h,new Cesium.Cartesian3);f=Cesium.Cartesian3.normalize(f,f);var p=new Cesium.Plane(f,0),d=Cesium.Plane.getPointDistance(p,s);e.push(new Cesium.ClippingPlane(f,d))}this.viewer.scene.globe.clippingPlanes=new Cesium.ClippingPlaneCollection({modelMatrix:Cesium.Matrix4.IDENTITY,planes:e,edgeWidth:1,edgeColor:Cesium.Color.RED,enabled:!0}),this._prepareWell(t),this._createWell(this.wellData)}},{key:"_prepareWell",value:function(t){var e=this.splitNum,n=t.length;if(0!=n){for(var i=this.excavateMinHeight-this.height,r=[],o=[],a=[],s=0;s<n;s++){var u=s==n-1?0:s+1,l=Cesium.Cartographic.fromCartesian(t[s]),c=Cesium.Cartographic.fromCartesian(t[u]),h=[l.longitude,l.latitude],f=[c.longitude,c.latitude];0==s&&(a.push(new Cesium.Cartographic(h[0],h[1])),o.push(Cesium.Cartesian3.fromRadians(h[0],h[1],i)),r.push(Cesium.Cartesian3.fromRadians(h[0],h[1],0)));for(var p=1;p<=e;p++){var d=Cesium.Math.lerp(h[0],f[0],p/e),g=Cesium.Math.lerp(h[1],f[1],p/e);s==n-1&&p==e||(a.push(new Cesium.Cartographic(d,g)),o.push(Cesium.Cartesian3.fromRadians(d,g,i)),r.push(Cesium.Cartesian3.fromRadians(d,g,0)))}}this.wellData={lerp_pos:a,bottom_pos:o,no_height_top:r}}}},{key:"_createWell",value:function(t){if(Boolean(this.viewer.terrainProvider._layers)){var e=this;this._createBottomSurface(t.bottom_pos);var n=Cesium.sampleTerrainMostDetailed(this.viewer.terrainProvider,t.lerp_pos);Cesium.when(n,function(n){for(var i=n.length,r=[],o=0;o<i;o++){var a=Cesium.Cartesian3.fromRadians(n[o].longitude,n[o].latitude,n[o].height);r.push(a)}e._createWellWall(t.bottom_pos,r)})}else this._createBottomSurface(t.bottom_pos),this._createWellWall(t.bottom_pos,t.no_height_top)}},{key:"_getMinHeight",value:function(t){for(var e=5e6,n=null,i=0;i<t.length;i++){var r=t[i].z;r<e&&(e=r,n=this._ellipsoidToLonLat(t[i]))}return n.altitude}},{key:"_ellipsoidToLonLat",value:function(t){var e=this.viewer.scene.globe.ellipsoid,n=new Cesium.Cartesian3(t.x,t.y,t.z),i=e.cartesianToCartographic(n),r=Cesium.Math.toDegrees(i.latitude),o=Cesium.Math.toDegrees(i.longitude),a=i.height;return{longitude:o,latitude:r,altitude:a}}},{key:"_createWellWall",value:function(t,e){for(var n=this._getMinHeight(t),i=[],r=[],o=0;o<e.length;o++)i.push(this._ellipsoidToLonLat(e[o]).altitude),r.push(n);var a=new Cesium.WallGeometry({positions:e,maximumHeights:i,minimumHeights:r}),s=Cesium.WallGeometry.createGeometry(a),u=new Cesium.Material({fabric:{type:"Image",uniforms:{image:this.wallImg}}}),l=new Cesium.MaterialAppearance({translucent:!1,flat:!0,material:u});this.wellWall=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:s,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.GREY)},id:"PitWall"}),appearance:l,asynchronous:!1}),this.viewer.scene.primitives.add(this.wellWall)}},{key:"_createBottomSurface",value:function(t){if(t.length){for(var e=this._getMinHeight(t),n=[],i=0;i<t.length;i++){var r=this._ellipsoidToLonLat(t[i]);n.push(r.longitude),n.push(r.latitude),n.push(e)}var o=new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(n)),perPositionHeight:!0}),a=Cesium.PolygonGeometry.createGeometry(o),s=new Cesium.Material({fabric:{type:"Image",uniforms:{image:this.bottomImg}}}),u=new Cesium.MaterialAppearance({translucent:!1,flat:!0,material:s});this.bottomSurface=new Cesium.Primitive({geometryInstances:new Cesium.GeometryInstance({geometry:a}),appearance:u,asynchronous:!1}),this.viewer.scene.primitives.add(this.bottomSurface)}}},{key:"_switchExcavate",value:function(t){t?(this.viewer.scene.globe.material=Cesium.Material.fromType("WaJue"),this.wellWall.show=!0,this.bottomSurface.show=!0):(this.viewer.scene.globe.material=null,this.wellWall.show=!1,this.bottomSurface.show=!1)}},{key:"_updateExcavateDepth",value:function(t){this.bottomSurface&&this.viewer.scene.primitives.remove(this.bottomSurface),this.wellWall&&this.viewer.scene.primitives.remove(this.wellWall);for(var e=this.wellData.lerp_pos,n=[],i=e.length,r=0;r<i;r++)n.push(Cesium.Cartesian3.fromRadians(e[r].longitude,e[r].latitude,this.excavateMinHeight-t));this.wellData.bottom_pos=n,this._createWell(this.wellData),this.viewer.scene.primitives.add(this.bottomSurface),this.viewer.scene.primitives.add(this.wellWall)}},{key:"clear",value:function(){this.viewer.scene.globe.clippingPlanes&&(this.viewer.scene.globe.clippingPlanes.enabled=!1,this.viewer.scene.globe.clippingPlanes.removeAll(),this.viewer.scene.globe.clippingPlanes.isDestroyed()||this.viewer.scene.globe.clippingPlanes.destroy(),this.viewer.scene.globe.clippingPlanes=null,this.viewer.scene.primitives.remove(this.bottomSurface),this.viewer.scene.primitives.remove(this.wellWall),this.bottomSurface=null,this.wellWall=null,this.viewer.scene.render())}},{key:"show",get:function(){return this._show},set:function(t){this._show=t,this.viewer.scene.globe.clippingPlanes&&(this.viewer.scene.globe.clippingPlanes.enabled=t,this._switchExcavate(t))}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this._updateExcavateDepth(t)}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this._viewer=e,this._scene=e.scene,this._camera=this._scene.camera,this.context=this._scene.context,this.entities=[],this.startAnalyze=!1,this._showDome=!0,this._offsetDist=.2,this.activeShapePoints=[],this.defaultOption={terrainShadows:this._viewer.terrainShadows,depthTestAgainstTerrain:this._scene.globe.depthTestAgainstTerrain}}return i(t,[{key:"reset",value:function(){}},{key:"open",value:function(){this.startAnalyze||(this._viewer.terrainShadows=Cesium.ShadowMode.ENABLED,this.testOn=this._scene.globe.depthTestAgainstTerrain,this.testOn||(this._scene.globe.depthTestAgainstTerrain=!0),this._initialiseHandlers(),this.startAnalyze=!0)}},{key:"close",value:function(){this.startAnalyze=!1,this.cameraPosition=null,this.handler&&(this.handler.destroy(),this.handler=null),this._scene.shadowMap&&(this._scene.shadowMap.enabled=!1);var t=!0,e=!1,n=void 0;try{for(var i,r=this.entities[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;this._viewer.entities.remove(o)}}catch(t){e=!0,n=t}finally{try{!t&&r.return&&r.return()}finally{if(e)throw n}}this.entities=[],this.viewPoint=void 0,this.pointLightCamera=void 0,this._viewer.terrainShadows=this.defaultOption.terrainShadows,this._scene.globe.depthTestAgainstTerrain=this.defaultOption.depthTestAgainstTerrain}},{key:"setPosition",value:function(t,e){var n=this;if(!this.viewPoint){this._scene.globe.depthTestAgainstTerrain=!0;var i=new Cesium.CallbackProperty(function(){return n._showDome},!1),r=new Cesium.CallbackProperty(function(){return n.viewPoint?n.viewPoint:new Cesium.Cartesian3},!1);this.entities.push(this._viewer.entities.add({name:"Dome",position:r,ellipsoid:{radii:new Cesium.Cartesian3(e,e,e),maximumCone:Cesium.Math.PI_OVER_TWO,fill:!1,show:i,outlineColor:Cesium.Color.WHITE.withAlpha(.3),outlineWidth:4,slicePartitions:96,stackPartitions:96,outline:!0}}))}this.viewPoint=t,this.distance=e,this._createViewShad(t)}},{key:"_initialiseHandlers",value:function(){var t=this;this.handler=new Cesium.ScreenSpaceEventHandler(this._scene.canvas),this.handler.setInputAction(function(e){if(t.startAnalyze&&null!=t.cameraPosition){var n=t._scene.pickPosition(e.endPosition);if(Cesium.defined(n)){1!=t.activeShapePoints.length&&t.activeShapePoints.pop(),t.activeShapePoints.push(n);var i=Cesium.Cartesian3.distance(t.activeShapePoints[0],t.activeShapePoints[1]);t.shadowMap._pointLightRadius=i}}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),this.handler.setInputAction(function(e){if(t.startAnalyze&&null==t.cameraPosition){var n=t._scene.pickPosition(e.position);if(n){var i=!0,r=!1,o=void 0;try{for(var a,s=t.entities[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value;t._viewer.entities.remove(u)}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}t.entities=[],t.activeShapePoints=[];var l=t._viewer.scene.globe.ellipsoid,c=l.cartesianToCartographic(n),h=Cesium.Math.toDegrees(c.latitude),f=Cesium.Math.toDegrees(c.longitude),p=c.height+t._offsetDist,d=Cesium.Cartesian3.fromDegrees(f,h,p);t.cameraPosition=d,t._createViewShad(d),t._addEntity(d),t.activeShapePoints.push(d)}}},Cesium.ScreenSpaceEventType.LEFT_CLICK),this.handler.setInputAction(function(e){t.startAnalyze=!1,t.cameraPosition=null},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}},{key:"_addEntity",value:function(t){var e=this,n=new Cesium.CallbackProperty(function(){return e.activeShapePoints},!1),i=new Cesium.CallbackProperty(function(){return e.activeShapePoints[e.activeShapePoints.length-1]},!1),r=new Cesium.CallbackProperty(function(){var t="";if(e.activeShapePoints.length>1){var n=Cesium.Cartesian3.distance(e.activeShapePoints[0],e.activeShapePoints[1]);t="距离:"+n.toFixed(2)+"米"}return t},!1),o=new Cesium.CallbackProperty(function(){return e._showDistance},!1),a=new Cesium.CallbackProperty(function(){var t=new Cesium.Cartesian3;if(e.activeShapePoints.length>1){var n=Cesium.Cartesian3.distance(e.activeShapePoints[0],e.activeShapePoints[1]);t=new Cesium.Cartesian3(n,n,n)}return t},!1),s=new Cesium.CallbackProperty(function(){return e._showDome},!1);this.entities.push(this._viewer.entities.add({name:"Dome",position:t,ellipsoid:{radii:a,maximumCone:Cesium.Math.PI_OVER_TWO,fill:!1,show:s,outlineColor:Cesium.Color.WHITE.withAlpha(.3),outlineWidth:4,slicePartitions:96,stackPartitions:96,outline:!0}})),this.entities.push(this._viewer.entities.add({position:t,point:{pixelSize:12,color:Cesium.Color.YELLOW,disableDepthTestDistance:Number.POSITIVE_INFINITY}})),this.entities.push(this._viewer.entities.add({polyline:{positions:n,show:o,width:2,clampToGround:!1,material:Cesium.Color.LIME,disableDepthTestDistance:Number.POSITIVE_INFINITY,classificationType:Cesium.ClassificationType.NONE}})),this.entities.push(this._viewer.entities.add({position:i,label:{show:o,text:r,pixelOffset:new Cesium.Cartesian2(30,-50),scale:.5,font:"32px 微软雅黑",fillColor:Cesium.Color.DEEPSKYBLUE,outlineColor:Cesium.Color.BLACK,outlineWidth:1,showBackground:!0,backgroundColor:Cesium.Color.BLACK.withAlpha(.9),backgroundPadding:new Cesium.Cartesian2(10,6),disableDepthTestDistance:Number.POSITIVE_INFINITY}}))}},{key:"_createViewShad",value:function(t){var e=this;if(!this.pointLightCamera){this.pointLightCamera=new Cesium.Camera(this._scene),this.pointLightCamera.position=t,this.shadowOptions={context:this.context,enabled:!0,isPointLight:!0,lightCamera:this.pointLightCamera,maximumDistance:500,cascadesEnabled:!1},this._scene.shadowMap=new Cesium.ShadowMap(this.shadowOptions);var n=this._scene.shadowMap;n.enabled=!0,n.debugShow=!0,n.maximumDistance=1e4,n._pointLightRadius=1,n._fitNearFar=!0,n.darkness=.3,n.debugShow=!1,n.debugFreezeFrame=!1,n.enabled=!0,n.size=1024,n.debugCascadeColors=!1,n.softShadows=!1,this.shadowMap=n,n.debugCreateRenderStates(),n.dirty=!0,null==this.normalShaderFun&&(this.normalShaderFun=Cesium.ShadowMapShader.createShadowReceiveFragmentShader),Cesium.ShadowMapShader.createShadowReceiveFragmentShader=function(t,n,i,r,o){return e._getUIShader(t,n,i,r,o)}}this.pointLightCamera.position=t,this.shadowMap._pointLightRadius=this.distance?this.distance:10}},{key:"_getUIShader",value:function(t,e,n,i,r){var o=this.normalShaderFun(t,e,n,i,r),a="if(visibility == 1.0){ \n          gl_FragColor.rgb *= vec3(0,1,0);  \n        } else { \n          gl_FragColor.rgb *= vec3(1,0,0); ; \n        }\n        ";return o.sources[o.sources.length-1]=o.sources[o.sources.length-1].replace("gl_FragColor.rgb *= visibility;",a),o}},{key:"showDistance",get:function(){return this._showDistance},set:function(t){this._showDistance=t}},{key:"offsetDist",get:function(){return this._offsetDist},set:function(t){this._offsetDist=t}},{key:"showDome",get:function(){return this._showDome},set:function(t){this._showDome=t}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e,r){n(this,t),this.recordedBlobs=[],this._videoType="video/webm",this.mediaRecorder=null,this.stream=e.captureStream(),void 0!=i(this.stream)&&this.stream&&(this._mbps=r||2.5,this.video=document.createElement("video"),this.video.style.display="none")}return r(t,[{key:"start",value:function(){var t=this,e=["video/webm","video/webm,codecs=vp9","video/vp8","video/webm;codecs=vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mpeg","video/mp4"];if(!MediaRecorder.isTypeSupported(this._videoType)){console.log("No supported type found for MediaRecorder");for(var n in e)if(MediaRecorder.isTypeSupported(e[n])){this._videoType=e[n];break}}var i={mimeType:this._videoType,videoBitsPerSecond:1e6*this._mbps};this.recordedBlobs=[];try{this.mediaRecorder=new MediaRecorder(this.stream,i)}catch(t){return alert("MediaRecorder is not supported by this browser."),void console.error("Exception while creating MediaRecorder:",t)}console.log("Created MediaRecorder",this.mediaRecorder,"with options",i),this.mediaRecorder.onstop=function(){var e=new Blob(t.recordedBlobs,{type:t.supportedType});t.video.src=window.URL.createObjectURL(e)},this.mediaRecorder.ondataavailable=function(e){e.data&&e.data.size>0&&t.recordedBlobs.push(e.data)},this.mediaRecorder.start(100),console.log("MediaRecorder started",this.mediaRecorder)}},{key:"stop",value:function(){this.mediaRecorder.stop(),this.video.controls=!0}},{key:"save",value:function(t){var e=t||"recording.webm",n=new Blob(this.recordedBlobs,{type:this.supportedType}),i=window.URL.createObjectURL(n),r=document.createElement("a");r.style.display="none",r.href=i,r.download=e,document.body.appendChild(r),r.click(),setTimeout(function(){document.body.removeChild(r),window.URL.revokeObjectURL(i)},100)}},{key:"handleDataAvailable",value:function(t){t.data&&t.data.size>0&&this.recordedBlobs.push(t.data)}},{key:"handleStop",value:function(t){var e=new Blob(this.recordedBlobs,{type:this.supportedType});this.video.src=window.URL.createObjectURL(e)}},{key:"mbps",get:function(){return this._mbps},set:function(t){this._mbps=t}},{key:"videoType",get:function(){return this._videoType},set:function(t){this._videoType=t}}]),t}();e.default=o},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t)}return i(t,[{key:"licSuccess",value:function(){}},{key:"licFail",value:function(){}}],[{key:"checkLicense",value:function(){return!0}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,i){n(this,t),this.viewer=e,this.className=i||"popupdialog",this.id=0,this.ctnList={}}return i(t,[{key:"add",value:function(t){var e=this,n=t.geometry,i="popup_"+(65536*(1+Math.random())|0).toString(16)+e.id++,r=document.createElement("div");r.className="bx-popup-ctn"+(this.className?" "+this.className:""),r.id=i,document.getElementById(e.viewer.container.id).appendChild(r);var o=t.content;r.innerHTML=e.createHtml(o.header,o.content,o.isclose),e.ctnList[i]=[n,r],e.render(),e.eventListener||(e.eventListener=function(t){e.render()},e.viewer.clock.onTick.addEventListener(e.eventListener)),t.isclose===!1||r.getElementsByClassName("bx-popup-close")&&r.getElementsByClassName("bx-popup-close").length>0&&(r.getElementsByClassName("bx-popup-close")[0].onclick=function(){e.close(r)}),t.callback}},{key:"render",value:function(){var t=this;for(var e in t.ctnList){var n=Cesium.SceneTransforms.wgs84ToWindowCoordinates(t.viewer.scene,t.ctnList[e][0]);n&&n.x&&n.y&&(Math.abs(n.x)>2*window.innerWidth||Math.abs(n.y)>2*window.innerHeight?t.ctnList[e][1].style.display="none":(t.ctnList[e][1].style.display="",t.ctnList[e][1].style.left=n.x+"px",t.ctnList[e][1].style.top=n.y+"px"))}}},{key:"createHtml",value:function(t,e,n){if(this.html)return this.html(t,e);var i="\n      "+(n===!1?"":'<div class="bx-popup-close"><i class="iconfont icon-guanbi"></i></div>')+'\n            <div class="divpoint-wrap">\n            <div class="divpoint-border">\n            <div class="divpoint-center">\n            <div class="bx-popup-header-ctn">\n            '+t+'\n            </div>\n            <div class="bx-popup-content-ctn" >\n            <div class="bx-popup-content" >\n            '+e+'\n            </div>\n            </div>\n            </div>\n            </div>\n            </div>\n            <div class="directional"></div>\n            ';return i}},{key:"close",value:function(t){t.remove(),delete this.ctnList[t.id],0===Object.keys(this.ctnList).length&&(this.viewer.clock.onTick.removeEventListener(this.eventListener),this.eventListener=null)}},{key:"closeAll",value:function(t){for(var e in this.ctnList)this.ctnList[e][1].remove();this.ctnList={},this.eventListener&&this.viewer.clock.onTick.removeEventListener(this.eventListener),this.eventListener=null}}]),t}();e.default=r},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(26),s=i(a),u=n(109),l=i(u),c=function(){function t(e){r(this,t),this.viewer=e,this.id=0,this.ctnList={},this.g_trailMatrial=[],this.dataSources=new Cesium.CustomDataSource(Cesium.createGuid()),e.dataSources.add(this.dataSources)}return o(t,[{key:"app",value:function(t,e,n){var i=new Cesium.EllipsoidSurfaceAppearance({material:new Cesium.Material({fabric:{type:"Water",uniforms:{normalMap:s.default.getResource("Assets/Images/waterNormals.jpg"),frequency:1e3,animationSpeed:.01,amplitude:10,angle:n,repeate:new Cesium.Cartesian2(t,e)}}}),vertexShaderSource:"attribute vec3 position3DHigh;\n            attribute vec3 position3DLow;\n            attribute vec2 st;\n            attribute float batchId;\n            varying vec3 v_positionMC;\n            varying vec3 v_positionEC;\n            varying vec2 v_st;\n            uniform float angle_4;\n            uniform vec2 repeate_5;\n            varying float v_angle;\n            void main()\n            {\n            vec4 p = czm_computePosition();\n            v_positionMC = position3DHigh + position3DLow;\n            v_positionEC = (czm_modelViewRelativeToEye * p).xyz;\n            v_st = st;\n            v_st=repeate_5*v_st;\n            v_angle=angle_4;\n            gl_Position = czm_modelViewProjectionRelativeToEye * p;\n            }",fragmentShaderSource:"varying vec3 v_positionMC; \n                          varying vec3 v_positionEC; \n                          varying vec2 v_st;\n                varying float v_angle;\n                          void main()\n                          {\n                  czm_materialInput materialInput;\n                  vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n                  #ifdef FACE_FORWARD\n                    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n                  #endif\n                  //materialInput.s = v_st.s;\n                  //materialInput.st = v_st;\n                  materialInput.st = v_st;\n                  //materialInput.s = v_st.s-czm_frameNumber*0.001;\n                  float angle = v_angle;\n                  float s = cos(angle)*v_st.s-sin(angle)*v_st.t;\n                  float t = sin(angle)*v_st.s+cos(angle)*v_st.t;\n                  //materialInput.st.s = v_st.s-czm_frameNumber*0.001;\n                  materialInput.st.t=t;\n                  materialInput.st.s = s-czm_frameNumber*0.001;\n                  //materialInput.str = vec3(v_st, 0.0);\n                  materialInput.normalEC = normalEC;\n                  materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\n                  vec3 positionToEyeEC = -v_positionEC;\n                  materialInput.positionToEyeEC = positionToEyeEC;\n                  //texture2D(image, vec2(st.s, fract(st.t - time)));\n                  czm_material material = czm_getMaterial(materialInput);\n                  #ifdef FLAT\n                    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n                  #else\n                    gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n                    gl_FragColor.a=0.85;\n                  #endif\n                          }"});return i}},{key:"addCircleRipple",value:function(t,e){function n(){return a+=e.deviationR,a>=e.maxR&&(a=e.minR),a}function i(){return s+=e.deviationR,s>=e.maxR&&(s=e.minR),s}var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this,a=e.minR,s=e.minR,u=(o.dataSources.entities.add({id:e.id,name:"",position:Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.height),ellipse:{semiMinorAxis:new Cesium.CallbackProperty(n,!1),semiMajorAxis:new Cesium.CallbackProperty(n,!1),height:e.height,material:new Cesium.ImageMaterialProperty({image:e.imageUrl,repeat:new Cesium.Cartesian2(1,1),transparent:!0,color:new Cesium.CallbackProperty(function(){var t=1-a/e.maxR;return Cesium.Color.WHITE.withAlpha(t+.2)},!1)})}}),setTimeout(function(){o.dataSources.entities.add({name:"",position:Cesium.Cartesian3.fromDegrees(e.lon,e.lat,e.height),ellipse:{semiMinorAxis:new Cesium.CallbackProperty(i,!1),semiMajorAxis:new Cesium.CallbackProperty(i,!1),height:e.height,material:new Cesium.ImageMaterialProperty({image:e.imageUrl,repeat:new Cesium.Cartesian2(1,1),transparent:!0,color:new Cesium.CallbackProperty(function(){var t=1;return t=1-s/e.maxR,Cesium.Color.WHITE.withAlpha(t+.2)},!1)})}});clearTimeout(u)},e.eachInterval));r&&o.dataSources.entities.add({name:"",polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights([e.lon,e.lat,0,e.lon,e.lat,74]),width:8,material:new Cesium.PolylineGlowMaterialProperty({glowPower:.4,color:Cesium.Color.BLUE})}})}},{key:"addDynamicWall",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e3,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=this,s=!1,u=1,c=1,h=new Cesium.Color(0,0,1,.8),f=1,p=e+"-";null!=o&&(o.hasOwnProperty("repeatX")&&(u=o.repeatX,p+=u+"-"),o.hasOwnProperty("repeatY")&&(c=o.repeatY,p+=c+"-"),o.hasOwnProperty("horizontal")&&(f=o.horizontal,p+=f+"-"),o.hasOwnProperty("color")&&(h=o.color,p+=h.red+h.green+h.blue+h.alpha+"-"),o.hasOwnProperty("speed")&&(r=o.speed),o.hasOwnProperty("showTop")&&(s=o.showTop)),p+=r;var d=null;a.g_trailMatrial.hasOwnProperty(p)?d=a.g_trailMatrial[p]:(d=new l.default(p,h,e,r,u,c,f),
Cesium.Material._materialCache.addMaterial(p,{fabric:{type:d.name,uniforms:{color:new Cesium.Color(1,1,1,1),image:d.image,repeat:new Cesium.Cartesian2(u,c),time:0,horizontal:f},source:Cesium.Material.WallLinkMaterialProperty},translucent:function(t){return!0}}),a.g_trailMatrial[p]=d);for(var g=[],y=[],m=0,v=0;v<n.length;v+=3)g[m]=n[v+2],y[m++]=n[v+2]+i;if(a.dataSources.entities.add({name:t,wall:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(n),material:d,minimumHeights:g,maximumHeights:y,outline:!1}}),s){for(var _=[],v=0;v<n.length;v+=3)_[v]=n[v],_[v+1]=n[v+1],_[v+2]=n[v+2]+i;a.dataSources.entities.add({polygon:{hierarchy:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(_)},outline:!1,outlineColor:Cesium.Color.WHITE.withAlpha(0),outlineWidth:2,material:Cesium.Color.GREEN.withAlpha(.8),fill:!0,perPositionHeight:!0,show:!0}})}}},{key:"remove",value:function(){this.dataSources&&(this.viewer.dataSources.remove(this.dataSources),this.dataSources=null)}}]),t}();e.default=c},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;this._definitionChanged=new Cesium.Event,this._color=void 0,this.color=e,this.repeatX=r,this.repeatY=o,this._horizontal=a,this.duration=i,this.image=n,this.name=t,this._time=(new Date).getTime()};Object.defineProperties(n.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}},color:Cesium.createPropertyDescriptor("color")}),n.prototype.getType=function(t){return this.name},n.prototype.getValue=function(t,e){return Cesium.defined(e)||(e={}),e.color=Cesium.Property.getValueOrClonedDefault(this._color,t,Cesium.Color.WHITE,e.color),e.image=this.image,e.horizontal=this._horizontal,e.time=((new Date).getTime()-this._time)%this.duration/this.duration,e},n.prototype.equals=function(t){return this===t||t instanceof n&&Cesium.Property.equals(this._color,t._color)&&this.image===t.image&&this.duration===t.duration&&this.repeatX===t.repeatX&&this.repeatY===t.repeatY},Cesium.WallLinkMaterialProperty=n,Cesium.Material.WallLinkMaterialProperty="czm_material czm_getMaterial(czm_materialInput materialInput)\n\t\t\t\t\t\t\t\t\t\t\t  {\n\t\t\t\t\t\t\t\t\t\t\t\t   czm_material material = czm_getDefaultMaterial(materialInput);\n\t\t\t\t\t\t\t\t\t\t\t\t   vec2 st = repeat *materialInput.st;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t   vec4 colorImage  = texture2D(image, vec2(fract(st.s - time), st.t ));\n\t\t\t\t\t\t\t\t\t\t\t\t   if(horizontal<0.001)\n\t\t\t\t\t\t\t\t\t\t\t\t   {\n\t\t\t\t\t\t\t\t\t\t\t\t\t    colorImage =  texture2D(image, vec2(st.s, fract(st.t - time)));\n\t\t\t\t\t\t\t\t\t\t\t\t   }\n\t\t\t\t\t\t\t\t\t\t\t\t   \n\t\t\t\t\t\t\t\t\t\t\t\t   material.alpha = colorImage.a * color.a;\n\t\t\t\t\t\t\t\t\t\t\t\t   material.diffuse = (colorImage.rgb*0.7+color.rgb*0.3);\n\t\t\t\t\t\t\t\t\t\t\t\t   return material;\n\t\t\t\t\t\t\t\t\t\t\t   }",e.default=n},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(26),s=(i(a),function(){function t(e){r(this,t),this.viewer=e,this.dataSources=new Cesium.CustomDataSource(Cesium.createGuid()),e.dataSources.add(this.dataSources),this.g_trailMatrial=[],this.primitiveList=[]}return o(t,[{key:"addWasi",value:function(t,e){for(var n,i=this,r=8,o=1,a=o/20,s=[],u=[],l=[],c=2*o/(r-1),h=0,f=0;f<r;f++)for(var p=-o+f*c,d=0;d<r;d++){var g=-o+d*c;u.push(g),u.push(p);var y=Math.random()*a-a/2;u.push(y),s.push(d/(r-1)),s.push(f/(r-1))}for(var m=0;m<r-1;m++)for(var v=0;v<r-1;v++)l.push(h+m*r+v),l.push(h+m*r+v+1),l.push(h+(m+1)*r+v),l.push(h+m*r+v+1),l.push(h+(m+1)*r+v+1),l.push(h+(m+1)*r+v);n=new Cesium.Geometry({attributes:{position:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:u}),st:new Cesium.GeometryAttribute({componentDatatype:Cesium.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:s})},indices:l,primitiveType:Cesium.PrimitiveType.TRIANGLES,boundingSphere:Cesium.BoundingSphere.fromVertices(u)});for(var _=[],w=1/3600/30,c=w,b=0;b<t.length-1;b+=3){var C=t[b],x=t[b+1],E=t[b+2],S=t[b+3],P=t[b+4],M=t[b+5];_.push(C),_.push(x),_.push(E);for(var L=Math.sqrt((S-C)*(S-C)+(P-x)*(P-x)),I=0;I<L;){var g=C+(S-C)*I/L,p=x+(P-x)*I/L,y=E+(M-E)*I/L;_.push(g),_.push(p),_.push(y),I+=c}}for(var T=0,N=[],k=0;k<_.length;k+=3){for(var O=_[k],D=_[k+1],A=_[k+2],R=5+(_.length-k)/_.length*20,F=1+(_.length-k)/_.length*1,j=[],z=0;z<R;z++){var B=w/2+Math.random()*Math.random()*w/2,g=Math.random()*B-B/2,p=Math.random()*Math.random()*B-B/2,G=Math.random()*Math.PI,U=Math.random()*Math.random()*F+.5,y=A+2.5*Math.random()-1.5,H=Cesium.Transforms.eastNorthUpToFixedFrame(Cesium.Cartesian3.fromDegrees(O+g,D+p,y)),q=Math.random()*Math.PI/4-Math.PI/8,V=Math.random()*Math.PI/4-Math.PI/8,W=Cesium.Matrix3.fromRotationX(q),Y=Cesium.Matrix3.fromRotationY(V),X=Cesium.Matrix3.fromRotationZ(G),Z=Cesium.Matrix4.fromRotationTranslation(W),J=Cesium.Matrix4.fromRotationTranslation(Y),K=Cesium.Matrix4.fromRotationTranslation(X);Cesium.Matrix4.multiply(Z,J,Z),Cesium.Matrix4.multiply(Z,K,K);var $=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(U,U,U)),Q=new Cesium.Matrix4;Cesium.Matrix4.multiply(K,$,Q),Cesium.Matrix4.multiply(H,Q,H);var tt=new Cesium.GeometryInstance({geometry:n,modelMatrix:H,attributes:{show:new Cesium.ShowGeometryInstanceAttribute(!0)},id:T});j.push(tt)}N.push(j)}for(var et=new Cesium.MaterialAppearance({renderState:{depthTest:{enabled:!1},depthMask:!1,blending:Cesium.BlendingState.ALPHA_BLEND,cull:{enabled:!1,face:Cesium.CullFace.BACK}},translucent:!0,material:new Cesium.Material({fabric:{type:"Image",uniforms:{image:e,fogNear:-100,fogFar:3e3}},source:"\n\t\t\t\t\t\t\t\t#define M_PI 3.1415926535897932384626433832795\n\t\t                        uniform float fogNear;\n\t\t\t\t\t\t\t\tuniform float fogFar;\n\t\t\t\t\t\t\t\tuniform sampler2D image;\n\t\t\t\t\t\t\t\tuniform vec2 st;\n\t\t\t\t\t\t\t\tvarying vec2 v_st;\n\t\t\t\t\t\t\t\tvarying float v_fogNear;\n\t\t\t\t\t\t\t\tvarying float v_fogFar;\n\t\t\t\t\t\t\t\tczm_material czm_getMaterial(czm_materialInput materialInput)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tv_fogNear=fogNear;\n\t\t\t\t\t\t\t\t\tv_fogFar=fogFar;\n\t\t\t\t\t\t\t\t\tv_st = st;\n\t\t\t\t\t\t\t\t\tvec4 colorImage = texture2D(image, st);\n\t\t\t\t\t\t\t\t\tmaterial.diffuse = colorImage.rgb;\n\t\t\t\t\t\t\t\t\tmaterial.alpha = colorImage.a;\n\t\t\t\t\t\t\t\t\t return material;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t"}),fragmentShaderSource:"varying vec3 v_positionMC; \n\t\t\t\t\t\t\tvarying vec3 v_positionEC; \n\t\t\t\t\t\t\tvarying vec2 v_st;\n\t\t\t\t\t\t\tuniform sampler2D v_image;\n\t\t\t\t\t\t\tvoid main()\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tczm_materialInput materialInput;\t\n\t\t\t\t\t\t\t\tmaterialInput.st = v_st;\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//uniform sampler2D map;\n\t\t\t\t\t\t\t\t//uniform vec3 fogColor;\t\t\t\t\n\t\t\t\t\t\t\t\t//varying vec2 vUv;\n                                    float depth = gl_FragCoord.z / gl_FragCoord.w;\n\t\t\t\t\t\t\t\t\tfloat fogFactor = smoothstep( -100.0, 5000.0, depth );\n\t\t\t\t\t\t\t\t\tczm_material material = czm_getMaterial(materialInput);\n\t\t\t\t\t\t\t\t\t//gl_FragColor = vec4(1.0,0.0,0.0,0.5);//vec4(material.diffuse, material.alpha);//texture2D( map, vUv );\n\t\t\t\t\t\t\t\t\tgl_FragColor = vec4(material.diffuse, material.alpha);//texture2D( map, vUv );\n\t\t\t\t\t\t\t\t\t//gl_FragColor.w *= pow( gl_FragCoord.z, 20.0 );\n\t\t\t\t\t\t\t\t   // gl_FragColor = mix( gl_FragColor, vec4( //69.0/255.0,132.0/255.0,180.0/255.0, gl_FragColor.w ),fogFactor );\n\t\t\t\t\t\t\t\t\t\n                                    //gl_FragColor=vec4(1.0,0.0,0.0,0.5);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}"}),nt=0;nt<N.length;nt++){var it=new Cesium.Primitive({geometryInstances:N[nt],appearance:et,show:!0});i.primitiveList.push(it),i.viewer.scene.primitives.add(it)}var rt=i.primitiveList.length,ot=0,at=0;viewer.scene.preUpdate.addEventListener(function(){ot++;var t=viewer.scene,e=t.frameState,n=e.frameNumber;if(n-at>1){ot>=rt&&(ot=0);for(var r=0;r<rt;r++)r<ot?i.primitiveList[r].show=!0:i.primitiveList[r].show=!1;at=n}})}},{key:"remove",value:function(){for(var t=0;t<this.primitiveList.length;t++)this.viewer.scene.primitives.remove(this.primitiveList[t])}},{key:"removeResource",value:function(){this.dataSources&&this.dataSources.entities.removeAll()}}]),t}());e.default=s},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(26),s=i(a),u=function(){function t(e){r(this,t),this.viewer=e,this.dataSources=new Cesium.CustomDataSource(Cesium.createGuid()),e.dataSources.add(this.dataSources),this.g_trailMatrial=[]}return o(t,[{key:"addCaiKong",value:function(t,e){var n=this;$.get(t,{},function(t){for(var e=t,i=0;i<e.Map.length;i++){for(var r=e.Map[i],o=r.Name,a=r.Color.split(","),u=new Cesium.Color(parseFloat(a[0])/255,parseFloat(a[1])/255,parseFloat(a[2])/255),l=r.coords,c=l.split(","),h=[],f=[],p=0,d=0;d<c.length-3;d+=3){var g=parseFloat(c[d]),y=parseFloat(c[d+1]),m=parseFloat(c[d+2]);p++,f.push(g),f.push(y),f.push(m)}for(var d=0;d<f.length-3;d+=3){var g=f[d],y=f[d+1],m=f[d+2];h.push(fromLocal(g,y,m-938))}var v="ww",_=0,w=1,b=1,C=new Cesium.Color(0,0,1,.8),x=new Cesium.WallLinkMaterialProperty(v,C,s.default.getResource("Assets/Images/section.png"),2e3,w,b,_);Cesium.Material._materialCache.addMaterial(v,{fabric:{type:x.name,uniforms:{color:new Cesium.Color(1,1,1,1),image:x.image,repeat:new Cesium.Cartesian2(w,b),time:0,horizontal:_},source:Cesium.Material.WallLinkMaterialProperty},translucent:function(t){return!0}}),o.indexOf("工作面")!==-1?n.dataSources&&n.dataSources.entities.add({polygon:{hierarchy:{positions:h},perPositionHeight:!1,outline:!0,clampToGround:!0,material:x,stRotation:25,outlineColor:Cesium.Color.BLACK.withAlpha(1)}}):n.dataSources&&n.dataSources.entities.add({polygon:{hierarchy:{positions:h},perPositionHeight:!1,outline:!0,clampToGround:!0,material:u.withAlpha(.1),outlineColor:Cesium.Color.BLACK.withAlpha(1)}})}}),$.get(e,{},function(t){for(var e=t,i=0;i<e.Map.length;i++){var r=e.Map[i];if("MModel_Passage"==r.ModelType){for(var o=r.W,a=(r.H,r.XYZ,r.XYZ.split(";")),s=[],u=0;u<a.length;u++){var l=a[u].split(","),c=parseFloat(l[0]),h=parseFloat(l[1]),f=parseFloat(l[2]),p=LocalToDegree(c,h,f);s.push(p.x),s.push(p.y)}n.dataSources&&n.dataSources.entities.add({name:"",polyline:{positions:Cesium.Cartesian3.fromDegreesArray(s),width:o/2,material:Cesium.Color.BLACK.withAlpha(.3),clampToGround:!0}})}}})}},{key:"addGrowLine",value:function(t){this.dataSources&&this.dataSources.entities.add({name:"",polyline:{positions:Cesium.Cartesian3.fromDegreesArrayHeights(t),width:18,material:new Cesium.PolylineGlowMaterialProperty({glowPower:.4,color:Cesium.Color.RED})}})}},{key:"addTrailLine",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=this,s=1,u=1,l=0,c=new Cesium.Color(0,0,1,.8),h=1,f=e+"-";null!=o&&(o.hasOwnProperty("repeatX")&&(s=o.repeatX,f+=s+"-"),o.hasOwnProperty("repeatY")&&(u=o.repeatY,f+=u+"-"),o.hasOwnProperty("horizontal")&&(h=o.horizontal,f+=h+"-"),o.hasOwnProperty("color")&&(c=o.color,f+=c.red+c.green+c.blue+c.alpha+"-"),o.hasOwnProperty("speed")&&(r=o.speed),o.hasOwnProperty("interpolationDis")&&(l=o.interpolationDis));var p=Cesium.Cartesian3.fromDegreesArrayHeights(n),d=[];if(l>0){for(var g=0;g<p.length-1;g++){var y=p[g],m=p[g+1],v=Cesium.Cartesian3.distance(y,m);if(d.push(y),v>l)for(var _=parseInt(v/l),w=(m.x-y.x)/_,b=(m.y-y.y)/_,C=(m.z-y.z)/_,x=1;x<_-1;x++){var E=y.x+x*w,S=y.y+x*b,P=y.z+x*C;d.push(new Cesium.Cartesian3(E,S,P))}}d.push(p[p.length-1])}f+=r;var M=null;a.g_trailMatrial.hasOwnProperty(f)?M=a.g_trailMatrial[f]:(M=new Cesium.WallLinkMaterialProperty(f,c,e,r,s,u),Cesium.Material._materialCache.addMaterial(f,{fabric:{type:M.name,uniforms:{color:new Cesium.Color(1,1,1,1),image:M.image,repeat:new Cesium.Cartesian2(s,u),time:0,horizontal:h},source:Cesium.Material.WallLinkMaterialProperty},translucent:function(t){return!0}}),a.g_trailMatrial[f]=M),this.dataSources.entities.add({name:t,polyline:{positions:d.length>0?d:p,material:M,width:i,outline:!1}})}},{key:"remove",value:function(){this.dataSources&&(this.viewer.dataSources.remove(this.dataSources),this.dataSources=null)}},{key:"removeResource",value:function(){this.dataSources&&this.dataSources.entities.removeAll()}}]),t}();e.default=u},function(e,n,r){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),l=r(26),h=o(l),f=function(){function e(t){a(this,e),this.scene=t,this._transformHandler=null,this._starting=!1,this.axisModel=null,this._isLeftDown=!1,this._meshName=null,this._primitive=null,this._tileset=null,this._transformEditor_Axis="transformEditor_Axis"}return s(e,[{key:"start",value:function(){this._transformHandler||(this._transformHandler=new Cesium.ScreenSpaceEventHandler(this.scene.canvas)),this._starting||(this._initialEvent(),this._starting=!0)}},{key:"stop",value:function(){this._starting=!1,this.axisModel&&this.scene.primitives.remove(this.axisModel),this._transformHandler||this._transformHandler.destroy(),this._ennableNavigation(!0)}},{key:"_ennableNavigation",value:function(t){this.scene.screenSpaceCameraController.enableRotate=t,this.scene.screenSpaceCameraController.enableTranslate=t,this.scene.screenSpaceCameraController.enableZoom=t,this.scene.screenSpaceCameraController.enableTilt=t,this.scene.screenSpaceCameraController.enableLook=t}},{key:"_initialEvent",value:function(){var t=this;this._transformHandler.setInputAction(function(e){t._handleClick(e)},Cesium.ScreenSpaceEventType.LEFT_CLICK),this._transformHandler.setInputAction(function(e){t._handledbClick(e)},Cesium.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this._transformHandler.setInputAction(function(e){t._handleleftDown(e)},Cesium.ScreenSpaceEventType.LEFT_DOWN),this._transformHandler.setInputAction(function(e){t._handleleftUp(e)},Cesium.ScreenSpaceEventType.LEFT_UP),this._transformHandler.setInputAction(function(e){t._handleMove(e)},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}},{key:"getOffSet",value:function(t,e,n){var i=this._tileset?this.tileset._root.transform:this._primitive.modelMatrix,r=Cesium.Matrix4.inverseTransformation(i,new Cesium.Matrix4),o=this.scene.camera.position,a=Cesium.Matrix4.multiplyByPoint(r,o,new Cesium.Cartesian3),s=Cesium.Matrix4.multiplyByPoint(r,t,new Cesium.Cartesian3),u=Cesium.Matrix4.multiplyByPoint(r,e,new Cesium.Cartesian3),l=Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(s,a,new Cesium.Cartesian3),new Cesium.Cartesian3),c=Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(u,a,new Cesium.Cartesian3),new Cesium.Cartesian3),h=Cesium.Plane.fromPointNormal(Cesium.Cartesian3.ZERO,n),f=new Cesium.Ray(a,l),p=new Cesium.Ray(a,c),d=Cesium.IntersectionTests.rayPlane(f,h),g=Cesium.IntersectionTests.rayPlane(p,h);return{start:d,end:g}}},{key:"_handleMove",value:function(t){if((this._primitive||this._tileset)&&this._isLeftDown){var e=this.scene.pickPosition(t.startPosition),n=this.scene.pickPosition(t.endPosition),i=this._tileset?this.tileset._root.transform:this._primitive.modelMatrix,r=this,o=function(t,o,a){var s=r.getOffSet(e,n,t),u=Cesium.Cartesian3.subtract(s.end,s.start,new Cesium.Cartesian3);u[o]=0,u[a]=0;var l=Cesium.Matrix4.multiplyByTranslation(i,u,new Cesium.Matrix4);r._tileset?r.tileset._root.transform=l:r._primitive.modelMatrix=l,r.axisModel.modelMatrix=l},a=function(t,o,a){var s=r.getOffSet(e,n,t),u=(s.start[o]*s.end[a]-s.start[a]*s.end[o])/(s.start[o]*s.end[o]+s.start[a]*s.end[a]),l=Cesium.Quaternion.fromAxisAngle(t,Math.atan(u)),c=Cesium.Matrix3.fromQuaternion(l),h=Cesium.Matrix4.multiplyByMatrix3(i,c,new Cesium.Matrix4);r._tileset?r.tileset._root.transform=h:r._primitive.modelMatrix=h,r.axisModel.modelMatrix=h};switch(this._meshName&&n&&this._ennableNavigation(!1),this._meshName){case"YArrow_1":o(Cesium.Cartesian3.UNIT_Z,"y","z");break;case"XArrow_1":o(Cesium.Cartesian3.UNIT_X,"x","z");break;case"ZArrow_1":o(Cesium.Cartesian3.UNIT_Y,"x","y");break;case"YAxis_1":a(Cesium.Cartesian3.UNIT_X,"y","z");break;case"XAxis_1":a(Cesium.Cartesian3.UNIT_Y,"z","x");break;case"ZAxis_1":a(Cesium.Cartesian3.UNIT_Z,"x","y")}}}},{key:"_handleleftDown",value:function(t){this.scene.pickPosition(t.position);var e=this.scene.pick(t.position);Cesium.defined(e)&&Cesium.defined(e.mesh)&&(this._meshName=e.mesh.name,this._isLeftDown=!0,this._ennableNavigation(!1))}},{key:"_handleleftUp",value:function(t){this._ennableNavigation(!0),this._isLeftDown=!1,this._meshName=null}},{key:"_handleClick",value:function(t){if(this._starting&&!this._tileset){var e=this.scene.pick(t.position);if(Cesium.defined(e)&&e.primitive){if(e.id===this._transformEditor_Axis)return;this._primitive=e.primitive;var n=this._primitive.boundingSphere.radius;this._addAXIS(this._primitive.modelMatrix,n)}}}},{key:"_addAXIS",value:function(t,e){this.axisModel&&this.scene.primitives.remove(this.axisModel),this.axisModel=this.scene.primitives.add(Cesium.Model.fromGltf({url:h.default.getResource("Assets/models/AXIS.gltf"),modelMatrix:t,scale:e,id:this._transformEditor_Axis,colorBlendMode:Cesium.ColorBlendMode.HIGHLIGHT}))}},{key:"_handledbClick",value:function(){this.stop()}},{key:"_translate",value:function(e,n,r){var o=c(e),a=Cesium.Cartesian3.subtract(o.end,o.start,new Cesium.Cartesian3);a[n]=0,a[r]=0;var s=Cesium.Matrix4.multiplyByTranslation(u,a,new Cesium.Matrix4);t.modelMatrix=s,i.modelMatrix=t.modelMatrix}},{key:"tileset",get:function(){return this._tileset},set:function(t){this._tileset=t;var e=this._tileset.boundingSphere.radius;this._addAXIS(t._root.transform,e/8)}}]),e}();n.default=f},function(t,e){"use strict";Cesium.Model.test=function(){console.log("测试成")}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(115),s=i(a),u=function(){function t(e){r(this,t),this.tileset=e,this.tileset._matrixEditor=new s.default(e),this.matrixEditor=this.tileset._matrixEditor}return o(t,[{key:"position",get:function(){var t=this.tileset._root.customTransform.position,e=Cesium.Math.toDegrees(t.latitude),n=Cesium.Math.toDegrees(t.longitude),i=t.height;return[e,n,i]},set:function(t){this.matrixEditor.translateTo(t[0],t[1],t[2])}},{key:"scale",get:function(){return this.tileset._root.customTransform.scale},set:function(t){this.matrixEditor.scale(t)}},{key:"rotate",get:function(){var t=this.tileset._root.customTransform.rotation;return[t.x,t.y,t.z]},set:function(t){this.matrixEditor.rotate(t[0],t[1],t[2])}},{key:"height",get:function(){var t=this.tileset._root.customTransform.position;return t.height},set:function(t){var e=this.position;this.position=[e[0],e[1],t]}}]),t}(),l=function(){function t(e){r(this,t),this.tileset=e,this.enabled=!0,this.edgeStylingEnabled=!0,this.edgeWidth=2,this.edgeColor=Cesium.Color.WHITE,this._polygon=[],this._heightPlane=[],this._clipHeight=null,this._rotateX=0,this._rotateY=0,this._rotateZ=0}return o(t,[{key:"createHeightPlane",value:function(t){if(this.tileset.ready){var e=new Cesium.ClippingPlaneCollection({planes:[new Cesium.ClippingPlane(new Cesium.Cartesian3(0,0,-1),t)],edgeWidth:this.edgeWidth,edgeColor:this.edgeColor,enabled:this.enabled});this.tileset.clippingPlanes=e;var n=this.tileset.clippingPlanes.modelMatrix,i=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(this._rotateX))),r=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationX(Cesium.Math.toRadians(this._rotateY))),o=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationX(Cesium.Math.toRadians(this._rotateZ)));Cesium.Matrix4.multiply(n,i,n),Cesium.Matrix4.multiply(n,r,n),Cesium.Matrix4.multiply(n,o,n),this.tileset.clippingPlanes.modelMatrix=n}}},{key:"createclippingPlanes",value:function(t){for(var e=t.length,n=[],i=0;i<e;++i){var r=(i+1)%e,o=Cesium.Cartesian3.add(t[i],t[r],new Cesium.Cartesian3);o=Cesium.Cartesian3.multiplyByScalar(o,.5,o);var a=Cesium.Cartesian3.normalize(o,new Cesium.Cartesian3),s=Cesium.Cartesian3.subtract(t[r],o,new Cesium.Cartesian3);s=Cesium.Cartesian3.normalize(s,s);var u=Cesium.Cartesian3.cross(s,a,new Cesium.Cartesian3);u=Cesium.Cartesian3.normalize(u,u);var l=new Cesium.Plane(u,0),c=Cesium.Plane.getPointDistance(l,o);n.push(new Cesium.ClippingPlane(u,c))}return n}},{key:"clear",value:function(){this.tileset.clippingPlanes.removeAll(),this._polygon=[]}},{key:"polygon",get:function(){return this._polygon},set:function(t){if(t.length>0){var e=Cesium.Cartesian3.fromDegreesArrayHeights(t),n=this.createclippingPlanes(e);this.tileset.clippingPlanes=new Cesium.ClippingPlaneCollection({planes:n,edgeWidth:this.edgeWidth,edgeColor:this.edgeColor,enabled:this.enabled}),this._polygon=t}}},{key:"clipHeight",get:function(){return this._clipHeight},set:function(t){if(0==this._heightPlane.length){if(this.tileset.ready)this.createHeightPlane(t);else{var e=this;this.tileset.readyPromise.then(function(n){e.createHeightPlane(t)})}this._heightPlane=this.tileset.clippingPlanes}else for(var n=0;n<this._heightPlane.length;++n){var i=this._heightPlane.get(n);i.distance=t}this._clipHeight=t}},{key:"rotateX",get:function(){return this._rotateX},set:function(t){var e=this.tileset.clippingPlanes;if(e){var n=e.modelMatrix,i=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationX(Cesium.Math.toRadians(t)));Cesium.Matrix4.multiply(n,i,n),e.modelMatrix=n}this._rotateX=t}},{key:"rotateY",get:function(){return this._rotateY},set:function(t){var e=this.tileset.clippingPlanes;if(e){var n=e.modelMatrix,i=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationY(Cesium.Math.toRadians(t)));Cesium.Matrix4.multiply(n,i,n),e.modelMatrix=n}this._rotateY=t}},{key:"rotateZ",get:function(){return this._rotateZ},set:function(t){var e=this.tileset.clippingPlanes;if(e){var n=e.modelMatrix,i=Cesium.Matrix4.fromRotationTranslation(Cesium.Matrix3.fromRotationZ(Cesium.Math.toRadians(t)));Cesium.Matrix4.multiply(n,i,n),e.modelMatrix=n}this._rotateZ=t}}]),t}();Object.defineProperties(Cesium.Cesium3DTileset.prototype,{showBound:{get:function(){return this._showBound},set:function(t){t!=this._showBound&&(!this.ready&&t?this.readyPromise.then(function(t){t.createBound()}):this.setBoundVisible(t),this._showBound=t)}},boundColor:{get:function(){return this._showBound},set:function(t){this._showBound=t}},transformer:{get:function(){return this._transformer||(this._transformer=new u(this)),this._transformer}},clippingTool:{get:function(){return this._clippingPolygon||(this._clippingPolygon=new l(this)),this._clippingPolygon}},maxVal:{get:function(){return this._maxVal},set:function(t){this._maxVal=t;var e=[],n=this._maxVal-10,i=this._maxVal-20;e.push(["${z} >= "+this._maxVal,"color('red')"]),e.push(["${z} >= "+n,"color('yellow')"]),e.push(["${z} >= "+i,"color('blue')"]),e.push(["true","color('green')"]),this.style=new Cesium.Cesium3DTileStyle({pointSize:2,color:{conditions:e}})}},psize:{get:function(){return this._psize},set:function(t){this._psize=t,this.style||(this.style=new Cesium.Cesium3DTileStyle),this.style.pointSize=t}}})},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.tileset=e,this._transformInitialize()}return i(t,[{key:"rotate",value:function(t,e,n){var i=this.tileset._root.customTransform;void 0===t&&(t=i.rotation.x),void 0===e&&(e=i.rotation.y),void 0===n&&(n=i.rotation.z);var r=Cesium.Matrix3.fromHeadingPitchRoll(new Cesium.HeadingPitchRoll(Cesium.Math.toRadians(n),Cesium.Math.toRadians(e),Cesium.Math.toRadians(t))),o=Cesium.Matrix4.fromRotationTranslation(r,void 0,void 0);i.matrix.rotation=o,this._transform(),i.rotation.x=t,i.rotation.y=e,this.tileset._root.customTransform.rotation.z=n}},{key:"resetRotation",value:function(){this.tileset._root.customTransform.matrix.rotation=Cesium.Matrix4.IDENTITY,this.tileset._root.customTransform.rotation={x:0,y:0,z:0},this._transform()}},{key:"scale",value:function(t){var e=Cesium.Matrix4.fromScale(new Cesium.Cartesian3(t,t,t));this.tileset._root.customTransform.matrix.scale=e,this.tileset._root.customTransform.scale=t,this._transform()}},{key:"resetScale",value:function(){this.tileset._root.customTransform.matrix.scale=Cesium.Matrix4.IDENTITY,this.tileset._root.customTransform.scale=1,this._transform()}},{key:"translateTo",value:function(t,e,n){var i=this.tileset._root.customTransform.position,r=Cesium.Cartesian3.fromRadians(i.originalLongitude,i.originalLatitude,i.originalHeight),o=Cesium.Cartesian3.fromDegrees(e,t,n),a=Cesium.Cartesian3.subtract(o,r,new Cesium.Cartesian3);this.tileset.modelMatrix=Cesium.Matrix4.fromTranslation(a),i.latitude=Cesium.Math.toRadians(t),i.longitude=Cesium.Math.toRadians(e),i.height=n}},{key:"resetTranslation",value:function(){var t=this.tileset._root.customTransform.position;t.latitude=t.originalLatitude,t.longitude=t.originalLongitude,t.height=t.originalHeight}},{key:"_translate",value:function(t,e,n){var i=Cesium.Cartographic.fromCartesian(tileset.boundingSphere.center),r=Cesium.Cartesian3.fromRadians(i.longitude,i.latitude,0),o=Cesium.Cartesian3.fromRadians(i.longitude+e,i.latitude+t,n),a=Cesium.Cartesian3.subtract(o,r,new Cesium.Cartesian3);Cesium.Matrix4.multiply(this.tileset.modelMatrix,Cesium.Matrix4.fromTranslation(a),this.tileset.modelMatrix)}},{key:"_transform",value:function(){var t=new Cesium.Matrix4;Cesium.Matrix4.multiply(this.tileset._root.customTransform.matrix.origin,this.tileset._root.customTransform.matrix.rotation,t),Cesium.Matrix4.multiply(t,this.tileset._root.customTransform.matrix.scale,t),Cesium.Matrix4.multiply(t,this.tileset._root.customTransform.matrix.translation,this.tileset._root.transform)}},{key:"_transformInitialize",value:function(){var t=Cesium.Cartographic.fromCartesian(this.tileset.boundingSphere.center);this.tileset._root.customTransform={matrix:{origin:this.tileset._root.transform.clone(),rotation:Cesium.Matrix4.IDENTITY,translation:Cesium.Matrix4.IDENTITY,scale:Cesium.Matrix4.IDENTITY},rotation:{x:0,y:0,z:0},scale:1,position:{originalLatitude:t.latitude,originalLongitude:t.longitude,originalHeight:t.height,height:t.height,latitude:t.latitude,longitude:t.longitude}}}}]),t}();e.default=r},function(t,e){"use strict";function n(t){var e,n=33746824,r=33554054;switch(t.layer){case"vec":default:e="http://online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles="+(t.bigfont?"ph":"pl")+"&scaler = 1 & p = 1";break;case"img_d":e="http://shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46";break;case"img_z":e="http://online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles="+(t.bigfont?"sh":"sl")+"&v=020";break;case"custom":t.customid=t.customid||"midnight",e="http://api{s}.map.bdimg.com/customimage/tile?&x={x}&y={y}&z={z}&scale=1&customid="+t.customid;break;case"time":e="http://its.map.baidu.com:8002/traffic/TrafficTileService?x={x}&y={y}&level={z}&time="+(new Date).getTime()+"&label=web2D&v=017"}this._url=e,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=18;var a=new i(-r,-n),s=new i(r,n);this._tilingScheme=new o({rectangleSouthwestInMeters:a,rectangleNortheastInMeters:s}),this._credit=void 0,this._rectangle=this._tilingScheme.rectangle,this._ready=!0}Object.defineProperty(e,"__esModule",{value:!0});var i=Cesium.Cartesian2,r=Cesium.DeveloperError,o=Cesium.WebMercatorTilingScheme,a=Cesium.ImageryProvider;Object.defineProperties(n.prototype,{url:{get:function(){return this._url}},token:{get:function(){return this._token}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){if(!this._ready)throw new r("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new r("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new r("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new r("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new r("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new r("rectangle must not be called before the imagery provider  is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new r("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),n.prototype.getTileCredits=function(t,e,n){},n.prototype.requestImage=function(t,e,n){if(!this._ready)throw new r("requestImage must not be called before the imagery provider is ready.");var i=this._tilingScheme.getNumberOfXTilesAtLevel(n),o=this._tilingScheme.getNumberOfYTilesAtLevel(n),s=this._url.replace("{x}",t-i/2).replace("{y}",o/2-e-1).replace("{z}",n).replace("{s}",Math.floor(10*Math.random()));return a.loadImage(this,s)},e.default=n},function(e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o={ENLARGE:0,NARROW:1,LEFT_ROTATE:2,RIGHT_ROTATE:3,TOP_ROTATE:4,BOTTOM_ROTATE:5},a=function(){function e(t){var n=this;i(this,e),this.viewer=t,this.flags={moveForward:!1,moveBackward:!1,moveUp:!1,moveDown:!1,
moveLeft:!1,moveRight:!1},this._enable=!1,this.l=this.speedRatio=150,this.u=this.dirStep=25,this.c=this.rotateStep=1,this.h=this.minPitch=.1,this.d=this.maxPitch=.95;var r=t.scene.canvas;r.setAttribute("tabindex","0"),r.onclick=function(){r.focus()},document.addEventListener("keydown",function(t){if(n._enable){var e=n.getFlagForKeyCode(t.keyCode);void 0!==e&&(n.flags[e]=!0)}},!1),document.addEventListener("keyup",function(t){if(n._enable){var e=n.getFlagForKeyCode(t.keyCode);void 0!==e&&(n.flags[e]=!1)}},!1),this.handler=new Cesium.ScreenSpaceEventHandler(t.scene.canvas),this.handler.setInputAction(function(t){n._enable&&(t>0?(n.speedRatio=l*=.9,n.rotateStep=n.c*=1.1,n.dirStep=n.u*=.9):(n.speedRatio=n.l*=1.1,n.rotateStep=n.c*=.9,n.dirStep=n.u*=1.1))},Cesium.ScreenSpaceEventType.WHEEL)}return r(e,[{key:"bind",value:function(e){this._enable||(this._enable=!0,Cesium.defined(e)&&(t.speedRatio=l=e.speedRatio||l,t.dirStep=u=e.dirStep||u,t.rotateStep=c=e.rotateStep||c,t.minPitch=h=e.minPitch||h,t.maxPitch=d=e.maxPitch||d),this.viewer.clock.onTick.addEventListener(this.cameraFunc,this))}},{key:"unbind",value:function(){this._enable&&(this._enable=!1,this.viewer.clock.onTick.removeEventListener(this.cameraFunc,this))}},{key:"destroy",value:function(){this.unbind(),this.handler.destroy()}},{key:"getFlagForKeyCode",value:function(t){switch(t){case"W".charCodeAt(0):return"moveForward";case"S".charCodeAt(0):return"moveBackward";case"D".charCodeAt(0):return"moveRight";case"A".charCodeAt(0):return"moveLeft";case"Q".charCodeAt(0):return"moveUp";case"E".charCodeAt(0):return"moveDown";case 38:this.rotateCamera(o.TOP_ROTATE);break;case 37:this.rotateCamera(o.LEFT_ROTATE);break;case 39:this.rotateCamera(o.RIGHT_ROTATE);break;case 40:this.rotateCamera(o.BOTTOM_ROTATE);break;case"I".charCodeAt(0):case 104:this.moveCamera(o.ENLARGE);break;case"K".charCodeAt(0):case 101:this.moveCamera(o.NARROW);break;case"J".charCodeAt(0):case 100:this.moveCamera(o.LEFT_ROTATE);break;case"L".charCodeAt(0):case 102:this.moveCamera(o.RIGHT_ROTATE);break;case"U".charCodeAt(0):case 103:this.moveCamera(o.TOP_ROTATE);break;case"O".charCodeAt(0):case 105:this.moveCamera(o.BOTTOM_ROTATE)}}},{key:"moveForward",value:function(t){this.viewer.camera.moveForward(t)}},{key:"cameraFunc",value:function(t){var e=this.viewer.camera,n=this.viewer.scene.globe.ellipsoid.cartesianToCartographic(e.position).height,i=Math.abs(n/this.l);this.flags.moveForward&&this.moveForward(i),this.flags.moveBackward&&this.moveForward(-i),this.flags.moveUp&&e.moveUp(i),this.flags.moveDown&&e.moveDown(i),this.flags.moveLeft&&e.moveLeft(i),this.flags.moveRight&&e.moveRight(i)}},{key:"resetCameraPos",value:function(t){t&&(this.viewer.scene.camera.position=t.position,this.viewer.scene.camera.direction=t.direction,this.viewer.scene.camera.right=t.right,this.viewer.scene.camera.up=t.up)}},{key:"limitAngle",value:function(t,e,n){var i=Cesium.Cartesian3.dot(t,Cesium.Cartesian3.normalize(e,new Cesium.Cartesian3));return!("up"==n&&i<this.h||"down"==n&&i>this.d)}},{key:"getCenter1",value:function(){var t=this.viewer.scene,e=this.viewer.camera,n=new Cesium.Cartesian2,i=new Cesium.Cartesian3;n.x=t.canvas.clientWidth/2,n.y=t.canvas.clientHeight/2;var r=e.pickEllipsoid(n,t.globe.ellipsoid,i);return r}},{key:"getCenter",value:function(t,e){var n=t.scene,i=this.m(n),r=i;if(!Cesium.defined(r)){var o=n.globe,a=n.camera.positionCartographic.clone(),s=o.getHeight(a);a.height=s||0,r=Cesium.Ellipsoid.WGS84.cartographicToCartesian(a)}var u=this.o(r);return u}},{key:"m",value:function(t){var e=t.canvas,n=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2),i=t.camera.getPickRay(n);return t.globe.pick(i,t)||t.camera.pickEllipsoid(n)}},{key:"o",value:function(t){var e=Cesium.Cartographic.fromCartesian(t),n={};return n.y=this.n(Cesium.Math.toDegrees(e.latitude),6),n.x=this.n(Cesium.Math.toDegrees(e.longitude),6),n.z=this.n(e.height,2),n}},{key:"n",value:function(t,e){return Number(t.toFixed(e||0))}},{key:"computedNewPos",value:function(t,e,n){var i=t.position,r=this.getCenter(this.viewer);if(r){var o=Cesium.Cartesian3.fromDegrees(r.x,r.y,r.z);if(o){var a=Cesium.Cartesian3.distance(o,i),s=a/100;s=n?s*this.c:s;var u={},l=new Cesium.Ray(i,e);if(u.position=Cesium.Ray.getPoint(l,s),u.direction=t.direction,u.right=t.right,u.up=t.up,n){var c=Cesium.Cartesian3.normalize(Cesium.Cartesian3.subtract(u.position,o,new Cesium.Cartesian3),new Cesium.Cartesian3);l=new Cesium.Ray(o,c),u.position=Cesium.Ray.getPoint(l,a),u.direction=Cesium.Cartesian3.negate(c,new Cesium.Cartesian3),u.up=Cesium.Cartesian3.normalize(u.position,new Cesium.Cartesian3),u.right=Cesium.Cartesian3.cross(u.direction,u.up,new Cesium.Cartesian3)}return u}}}},{key:"moveCamera",value:function(t){var e,n=this.viewer.scene.camera;switch(t){case o.ENLARGE:e=this.computedNewPos(n,n.direction);break;case o.NARROW:e=this.computedNewPos(n,Cesium.Cartesian3.negate(n.direction,new Cesium.Cartesian3));break;case o.LEFT_ROTATE:e=this.computedNewPos(n,Cesium.Cartesian3.negate(n.right,new Cesium.Cartesian3),!0);break;case o.RIGHT_ROTATE:e=this.computedNewPos(n,n.right,!0);break;case o.TOP_ROTATE:var i=this.limitAngle(Cesium.clone(n.up),Cesium.clone(n.position),"up");if(!i)return;e=this.computedNewPos(n,Cesium.clone(n.up),!0);break;case o.BOTTOM_ROTATE:var i=this.limitAngle(Cesium.clone(n.up),Cesium.clone(n.position),"down");if(!i)return;e=this.computedNewPos(n,Cesium.Cartesian3.negate(n.up,new Cesium.Cartesian3),!0)}e&&this.resetCameraPos(e)}},{key:"rotateCamera",value:function(t){var e=[0,0],n=this.viewer.scene.canvas.clientWidth,i=this.viewer.scene.canvas.clientHeight,r=(n+i)/this.u;switch(t){case o.LEFT_ROTATE:e=[-r*n/i,0];break;case o.RIGHT_ROTATE:e=[r*n/i,0];break;case o.TOP_ROTATE:e=[0,r];break;case o.BOTTOM_ROTATE:e=[0,-r];break;default:return}var a=e[0]/n,s=e[1]/i,u=this.viewer.camera;u.lookRight(.05*a),u.lookUp(.05*s);var l=u.direction,c=Cesium.Cartesian3.normalize(u.position,new Cesium.Cartesian3),h=Cesium.Cartesian3.cross(l,c,new Cesium.Cartesian3);c=Cesium.Cartesian3.cross(h,l,new Cesium.Cartesian3),u.up=c,u.right=h}},{key:"enable",get:function(){return this._enable},set:function(t){t?this.bind():this.unbind()}}]),e}();n.default=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.HeatMapOpt=e.HeatMapLayer=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(119),s=i(a);e.HeatMapLayer=function(){function t(e){r(this,t),this._heatMapOption=e,this._heatMapLayer=null,this._zAxisHeight=null,this._zoomLevel=[0,25e3,5e4,1e5,225e3,3e5,5e5,75e4,1e6,25e5,375e4,5e6,75e5,1e7,2e7,5e7,1e8,25e7,5e8],this._zoomRadius=[1,1.25,1.5,2,2.25,3,5,7.5,10,12.5,13.75,15,17.5,20,25,27.5,35,50]}return o(t,[{key:"_calcBound",value:function(t){for(var e=[],n=[],i=void 0,r=void 0,o=void 0,a=void 0,s=0;s<t.length;s++)e.push(t[s].lon),n.push(t[s].lat);return i=Math.min.apply(null,e),r=Math.min.apply(null,n),o=Math.max.apply(null,e)>=178.5?178.5:Math.max.apply(null,e),a=Math.max.apply(null,n),{west:i,south:r,east:o,north:a}}},{key:"_formatPoints",value:function(t){return t.map(function(t){return{x:t.lon,y:t.lat,value:t.value}})}},{key:"_updateFllowCamera",value:function(){var t=this;this.destroyItem();var e=this._viewer.camera,n=e.positionCartographic.height/1,i=JSON.parse(JSON.stringify(this._heatMapParams));this._zAxisHeight=n;for(var r=0;r<this._zoomLevel.length;r++)this._zoomLevel[r]<n&&n<this._zoomLevel[r+1]&&(i.heatmapoptions.radius=this._zoomRadius[r]*this._heatMapParams.heatmapoptions.radius/1);var o=new s.default(i);this._heatMapLayer=this._viewer.imageryLayers.addImageryProvider(o),this._heatMapLayer.show=!0,e.moveEnd.addEventListener(this._moveEnd=function(){var n=e.positionCartographic.height/1;if(n>16293756)return t.destroyItem(),void t._create();for(var i=0;i<t._zoomLevel.length;i++)null===t._zAxisHeight||void 0===t._zAxisHeight||0===t._zAxisHeight?(t._zAxisHeight=n,t._updateFllowCamera()):t._zoomLevel[i]<t._zAxisHeight&&t._zAxisHeight<t._zoomLevel[i+1]&&(n<t._zoomLevel[i]||n>t._zoomLevel[i+1])&&(t._zAxisHeight=n,t._updateFllowCamera())})}},{key:"addToMap",value:function(t){this._viewer=t,this._create()}},{key:"getHeatMapOpt",value:function(){return this._heatMapOption}},{key:"update",value:function(t){this.destroyItem(),this._heatMapOption=t,this._create()}},{key:"_create",value:function(){this.destroyItem();var t=this._calcBound(this._heatMapOption.points),e={min:this._heatMapOption.limitMin,max:this._heatMapOption.limitMax,points:this._formatPoints(this._heatMapOption.points)};this._heatMapParams={heatmapoptions:{backgroundColor:"rgba(0,0,0,0)",radius:this._heatMapOption.radius,blur:this._heatMapOption.blur,gradient:this._heatMapOption.gradient,maxOpacity:this._heatMapOption.opacity},bounds:t,data:e},this._updateFllowCamera()}},{key:"destroyItem",value:function(){null!==this._heatMapLayer&&(this._heatMapLayer.show=!1,this._viewer.imageryLayers.remove(this._heatMapLayer),this._viewer.camera.moveEnd.removeEventListener(this._moveEnd),this._heatMapLayer=null)}}]),t}(),e.HeatMapOpt=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments[2],o=arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.8,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.85;r(this,t),this.points=e,this.radius=n,this.limitMin=i,this.limitMax=o,this.gradient=a,this.opacity=s,this.blur=u}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(120),s=i(a),u=(Cesium.Credit,Cesium.defaultValue),l=Cesium.defined,c=Cesium.DeveloperError,h=function(){function t(e){r(this,t),this.fun(e)}return o(t,[{key:"fun",value:function(t){function e(t){t instanceof HTMLVideoElement&&(h._dynamic=!0,h._dynamicTime=t.currentTime),h._ready=!0,h._readyPromise.resolve(!0),Cesium.TileProviderError.handleSuccess(h._errorEvent)}function n(t){var e="";"string"==typeof o&&(e=" "+o);var n="Failed to load image "+e+".";a=Cesium.TileProviderError.handleError(a,h,h._errorEvent,n,0,0,0,doRequest,t),h._readyPromise.reject(new RuntimeError(n))}t=u(t,{});var i=t.bounds,r=t.data;if(!l(i))throw new c("options.bounds is required.");if(!(l(i.north)&&l(i.south)&&l(i.east)&&l(i.west)))throw new c("options.bounds.north, options.bounds.south, options.bounds.east and options.bounds.west are required.");if(!l(r))throw new c("data is required.");if(!l(r.min)||!l(r.max)||!l(r.points))throw new c("options.bounds.north, bounds.south, bounds.east and bounds.west are required.");this._wmp=new Cesium.WebMercatorProjection,this._mbounds=this.wgs84ToMercatorBB(i),this._options=u(t.heatmapoptions,{}),this._options.gradient=u(this._options.gradient,{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"}),this.setWidthAndHeight(this._mbounds),this._options.radius=Math.round(u(this._options.radius,this.width>this.height?this.width/60:this.height/60)),this._spacing=1.5*this._options.radius,this._xoffset=this._mbounds.west,this._yoffset=this._mbounds.south,this.width=Math.round(this.width+2*this._spacing),this.height=Math.round(this.height+2*this._spacing),this._mbounds.west-=this._spacing*this._factor,this._mbounds.east+=this._spacing*this._factor,this._mbounds.south-=this._spacing*this._factor,this._mbounds.north+=this._spacing*this._factor,this.bounds=this.mercatorToWgs84BB(this._mbounds),this._container=this.getContainer(this.width,this.height),this._options.container=this._container,this._heatmap=s.default.create(this._options),this._canvas=this._container.children[0],this._tilingScheme=new Cesium.WebMercatorTilingScheme({rectangleSouthwestInMeters:new Cesium.Cartesian2(this._mbounds.west,this._mbounds.south),rectangleNortheastInMeters:new Cesium.Cartesian2(this._mbounds.east,this._mbounds.north)});var o=this._image=this._canvas;this._originalImage=this._canvas,this._texture=void 0,this._tileWidth=this.width,this._tileHeight=this.height,this._ready=!1,t.data&&(this._ready=this.setWGS84Data(t.data.min,t.data.max,t.data.points));var a,h=this;this.getImage(h,o).then(e).otherwise(n)}},{key:"getImage",value:function(t,e){function n(e){t._image=e,t._tileWidth=e.width,t._tileHeight=e.height}return n(e),Cesium.when(e)}},{key:"setWidthAndHeight",value:function(t){var e=2e3,n=700;this.width=t.east>0&&t.west<0?t.east+Math.abs(t.west):Math.abs(t.east-t.west),this.height=t.north>0&&t.south<0?t.north+Math.abs(t.south):Math.abs(t.north-t.south),this._factor=1,this.width>this.height&&this.width>e?(this._factor=this.width/e,this.height/this._factor<n&&(this._factor=this.height/n)):this.height>this.width&&this.height>e?(this._factor=this.height/e,this.width/this._factor<n&&(this._factor=this.width/n)):this.width<this.height&&this.width<n?(this._factor=this.width/n,this.height/this._factor>e&&(this._factor=this.height/e)):this.height<this.width&&this.height<n&&(this._factor=this.height/n,this.width/this._factor>e&&(this._factor=this.width/e)),this.width=this.width/this._factor,this.height=this.height/this._factor}},{key:"getContainer",value:function(t,e,n){var i=document.createElement("div");return n&&i.setAttribute("id",n),i.setAttribute("style","width: "+t+"px; height: "+e+"px; margin: 0px; display: none;"),document.body.appendChild(i),i}},{key:"wgs84ToMercator",value:function(t){return this._wmp.project(Cesium.Cartographic.fromDegrees(t.x,t.y))}},{key:"wgs84ToMercatorBB",value:function(t){var e=this._wmp.project(Cesium.Cartographic.fromDegrees(t.east,t.north)),n=this._wmp.project(Cesium.Cartographic.fromDegrees(t.west,t.south));return{north:e.y,south:n.y,east:e.x,west:n.x}}},{key:"mercatorToWgs84",value:function(t){var e=this._wmp.unproject(new Cesium.Cartesian3(t.x,t.y));return{x:e.longitude,y:e.latitude}}},{key:"mercatorToWgs84BB",value:function(t){var e=this._wmp.unproject(new Cesium.Cartesian3(t.west,t.south)),n=this._wmp.unproject(new Cesium.Cartesian3(t.east,t.north));return{north:this.rad2deg(n.latitude),east:this.rad2deg(n.longitude),south:this.rad2deg(e.latitude),west:this.rad2deg(e.longitude)}}},{key:"deg2rad",value:function(t){return t*(Math.PI/180)}},{key:"rad2deg",value:function(t){return t/(Math.PI/180)}},{key:"wgs84PointToHeatmapPoint",value:function(t){return this.mercatorPointToHeatmapPoint(this.wgs84ToMercator(t))}},{key:"mercatorPointToHeatmapPoint",value:function(t){var e={};return e.x=Math.round((t.x-this._xoffset)/this._factor+this._spacing),e.y=Math.round((t.y-this._yoffset)/this._factor+this._spacing),e.y=this.height-e.y,e}},{key:"setData",value:function(t,e,n){return!!(n&&n.length>0&&null!==t&&t!==!1&&null!==e&&e!==!1)&&(this._heatmap.setData({min:t,max:e,data:n}),!0)}},{key:"setWGS84Data",value:function(t,e,n){if(n&&n.length>0&&null!==t&&t!==!1&&null!==e&&e!==!1){for(var i=[],r=0;r<n.length;r++){var o=n[r],a=this.wgs84PointToHeatmapPoint(o);(o.value||0===o.value)&&(a.value=o.value),i.push(a)}var s=this.setData(t,e,i);return this.reload(),s}return!1}},{key:"reload",value:function(){if(l(this._reload)){if(this._dynamic){var t=this._image.currentTime;if(Math.abs(this._dynamicTime-t)<frameDiff)return;this._dynamicTime=t}this.getImage(this,this._originalImage).then(this._reload)}}},{key:"getTileCredits",value:function(t,e,n){}},{key:"requestImage",value:function(t,e,n){if(!this._ready)throw new c("requestImage must not be called before the imagery provider is ready.");return this._image}},{key:"pickFeatures",value:function(){}},{key:"url",get:function(){return this._url}},{key:"tileWidth",get:function(){if(!this._ready)throw new c("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},{key:"tileHeight",get:function(){if(!this._ready)throw new c("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},{key:"maximumLevel",get:function(){if(!this._ready)throw new c("maximumLevel must not be called before the imagery provider is ready.");return 0}},{key:"minimumLevel",get:function(){if(!this._ready)throw new c("minimumLevel must not be called before the imagery provider is ready.");return 0}},{key:"tilingScheme",get:function(){if(!this._ready)throw new c("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},{key:"rectangle",get:function(){return this._tilingScheme.rectangle}},{key:"tileDiscardPolicy",get:function(){if(!this._ready)throw new c("tileDiscardPolicy must not be called before the imagery provider is ready.")}},{key:"errorEvent",get:function(){return this._errorEvent}},{key:"ready",get:function(){return this._ready}},{key:"credit",get:function(){return this._credit}},{key:"hasAlphaChannel",get:function(){return!0}}]),t}();e.default=h},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},i=function(){var t=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},e=n.defaultRadius;return t.prototype={_organiseData:function(t,n){var i=t[this._xField],r=t[this._yField],o=this._radi,a=this._data,s=this._max,u=this._min,l=t[this._valueField]||1,c=t.radius||this._cfgRadius||e;a[i]||(a[i]=[],o[i]=[]),a[i][r]?a[i][r]+=l:(a[i][r]=l,o[i][r]=c);var h=a[i][r];return h>s?(n?this.setDataMax(h):this._max=h,!1):h<u?(n?this.setDataMin(h):this._min=h,!1):{x:i,y:r,value:l,radius:c,min:u,max:s}},_unOrganizeData:function(){var t=[],e=this._data,n=this._radi;for(var i in e)for(var r in e[i])t.push({x:i,y:r,radius:n[i][r],value:e[i][r]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],e=t.length;e--;)this.addData.call(this,t[e]);else{var n=this._organiseData(arguments[0],!0);n&&(0===this._data.length&&(this._min=this._max=n.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]}))}return this},setData:function(t){var e=t.data,n=e.length;this._data=[],this._radi=[];for(var i=0;i<n;i++)this._organiseData(e[i],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),r=function(){function t(t){var n=t.container,i=this.shadowCanvas=document.createElement("canvas"),r=this.canvas=t.canvas||document.createElement("canvas"),o=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});r.className="heatmap-canvas",this._width=r.width=i.width=t.width||+o.width.replace(/px/,""),this._height=r.height=i.height=t.height||+o.height.replace(/px/,""),this.shadowCtx=i.getContext("2d"),this.ctx=r.getContext("2d"),r.style.cssText=i.style.cssText="position:absolute;left:0;top:0;",n.style.position="relative",n.appendChild(r),this._palette=e(t),this._templates={},this._setStyles(t)}var e=function(t){var e=t.gradient||t.defaultGradient,n=document.createElement("canvas"),i=n.getContext("2d");n.width=256,n.height=1;var r=i.createLinearGradient(0,0,256,1);for(var o in e)r.addColorStop(o,e[o]);return i.fillStyle=r,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data},n=function(t,e){var n=document.createElement("canvas"),i=n.getContext("2d"),r=t,o=t;if(n.width=n.height=2*t,1==e)i.beginPath(),i.arc(r,o,t,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{var a=i.createRadialGradient(r,o,t*e,r,o,t);a.addColorStop(0,"rgba(0,0,0,1)"),a.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=a,i.fillRect(0,0,2*t,2*t)}return n},i=function(t){for(var e=[],n=t.min,i=t.max,r=t.radi,t=t.data,o=Object.keys(t),a=o.length;a--;)for(var s=o[a],u=Object.keys(t[s]),l=u.length;l--;){var c=u[l],h=t[s][c],f=r[s][c];e.push({x:s,y:c,value:h,radius:f})}return{min:n,max:i,data:e}};return t.prototype={renderPartial:function(t){t.data.length>0&&(this._drawAlpha(t),this._colorize())},renderAll:function(t){this._clear(),t.data.length>0&&(this._drawAlpha(i(t)),this._colorize())},_updateGradient:function(t){this._palette=e(t)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=t.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=t.height||this._height,this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var e=this._min=t.min,i=this._max=t.max,t=t.data||[],r=t.length,o=1-this._blur;r--;){var a,s=t[r],u=s.x,l=s.y,c=s.radius,h=Math.min(s.value,i),f=u-c,p=l-c,d=this.shadowCtx;this._templates[c]?a=this._templates[c]:this._templates[c]=a=n(c,o);var g=(h-e)/(i-e);d.globalAlpha=g<.01?.01:g,d.drawImage(a,f,p),f<this._renderBoundaries[0]&&(this._renderBoundaries[0]=f),p<this._renderBoundaries[1]&&(this._renderBoundaries[1]=p),f+2*c>this._renderBoundaries[2]&&(this._renderBoundaries[2]=f+2*c),p+2*c>this._renderBoundaries[3]&&(this._renderBoundaries[3]=p+2*c)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],n=this._renderBoundaries[2]-t,i=this._renderBoundaries[3]-e,r=this._width,o=this._height,a=this._opacity,s=this._maxOpacity,u=this._minOpacity,l=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),t+n>r&&(n=r-t),e+i>o&&(i=o-e);for(var c=this.shadowCtx.getImageData(t,e,n,i),h=c.data,f=h.length,p=this._palette,d=3;d<f;d+=4){var g=h[d],y=4*g;if(y){var m;m=a>0?a:g<s?g<u?u:g:s,h[d-3]=p[y],h[d-2]=p[y+1],h[d-1]=p[y+2],h[d]=l?p[y+3]:m}}this.ctx.putImageData(c,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e,n=this.shadowCtx,i=n.getImageData(t.x,t.y,1,1),r=i.data[3],o=this._max,a=this._min;return e=Math.abs(o-a)*(r/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},t}(),o=function(){var t=!1;return"canvas2d"===n.defaultRenderer&&(t=r),t}(),a={merge:function(){for(var t={},e=arguments.length,n=0;n<e;n++){var i=arguments[n];for(var r in i)t[r]=i[r]}return t}},s=function(){function t(){var t=this._config=a.merge(n,arguments[0]||{});if(this._coordinator=new e,t.plugin){var s=t.plugin;if(!n.plugins[s])throw new Error("Plugin '"+s+"' not found. Maybe it was not registered.");var u=n.plugins[s];this._renderer=new u.renderer(t),this._store=new u.store(t)}else this._renderer=new o(t),this._store=new i(t);r(this)}var e=function(){function t(){this.cStore={}}return t.prototype={on:function(t,e,n){var i=this.cStore;i[t]||(i[t]=[]),i[t].push(function(t){return e.call(n,t)})},emit:function(t,e){var n=this.cStore;if(n[t])for(var i=n[t].length,r=0;r<i;r++){var o=n[t][r];o(e)}}},t}(),r=function(t){var e=t._renderer,n=t._coordinator,i=t._store;n.on("renderpartial",e.renderPartial,e),n.on("renderall",e.renderAll,e),n.on("extremachange",function(e){t._config.onExtremaChange&&t._config.onExtremaChange({min:e.min,max:e.max,gradient:t._config.gradient||t._config.defaultGradient})}),i.setCoordinator(n)};return t.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=a.merge(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},t}(),u={create:function(t){return new s(t)},register:function(t,e){n.plugins[t]=e}};e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.MapVOpt=e.MapVLayer=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(122),s=i(a),u=n(123);e.MapVLayer=function(){function t(e){r(this,t),this._id=Cesium.createGuid(),this._MapV=null,this._show=!0,this._MapVOptions=e}return o(t,[{key:"addToMap",value:function(t){this._viewer=t,console.log(t),this._initMapv()}},{key:"destroyItem",value:function(){this._MapV.destroy()}},{key:"getMapVOpt",value:function(){return this._MapVOptions}},{key:"update",value:function(t){this._MapVOptions=t,this._MapV&&this.destroyItem(),this._initMapv()}},{key:"create",value:function(t){this._MapVOptions=t;var e=this.createDataSet(this._MapVOptions.data);return this._MapV=new s.default(this._viewer,e,this._MapVOptions.options)}},{key:"createDataSet",value:function(t){return new u.DataSet(t)}},{key:"_initMapv",value:function(){this._MapVOptions&&this.create(this._MapVOptions)}},{key:"_DataSetAdd",value:function(t,e){return new u.DataSet.add(t,e)}},{key:"_DataSetReset",value:function(){return new u.DataSet.reset}},{key:"_DataSetGet",value:function(t){return new u.DataSet.get(t)}},{key:"_DataSetSet",value:function(t){return new u.DataSet.set(t)}},{key:"_DataSetClear",value:function(t){return new u.DataSet.clear(t)}},{key:"_DataSetRemove",value:function(t){return new u.DataSet.remove(t)}},{key:"_DataSetUpdate",value:function(t,e){return new u.DataSet.update(t,e)}},{key:"_DataSetTransferCoordinate",value:function(t,e,n,i){return new u.DataSet.transferCoordinate(t,e,n,i)}},{key:"_DataSetinitGeometry",value:function(t){return new u.DataSet.initGeometry(t)}},{key:"_DataSetGetMax",value:function(t){return new u.DataSet.getMax(t)}},{key:"_DataSetGetSum",value:function(t){return new u.DataSet.getSum(t)}},{key:"_DataSetGetMin",value:function(t){return new u.DataSet.getMin(t)}},{key:"_DataSetUnique",value:function(t){return new u.DataSet.getUnique(t)}},{key:"_getDataSet",value:function(t){return new u.geojson.getDataSet(t)}},{key:"_getCurvePoints",value:function(t){return new u.utilCurve.getPoints(t)}},{key:"_getCenterByCityName",value:function(t){var e=new u.utilCityCenter.getCenterByCityName(t);return void 0===e.lng?void 0:e}},{key:"_getProvinceNameByCityName",value:function(t){return new u.utilCityCenter.getProvinceNameByCityName(t)}},{key:"show",get:function(){return this._show},set:function(t){t?this._MapV.show():this._MapV.hide(),this._show=t}},{key:"utilCurve",get:function(){return{getPoints:this._getCurvePoints}}},{key:"utilCityCenter",get:function(){return{getCenterByCityName:this._getCenterByCityName,getProvinceNameByCityName:this._getProvinceNameByCityName}}},{key:"geojson",get:function(){return{getDataSet:this._getDataSet}}},{key:"DataSet",get:function(){return{add:this._DataSetAdd,Reset:this._DataSetReset,get:this._DataSetGet,set:this._DataSetSet,clear:this._DataSetClear,remove:this._DataSetRemove,update:this._DataSetUpdate,transferCoordinate:this._DataSetTransferCoordinate,initGeometry:this._DataSetinitGeometry,getMax:this._DataSetGetMax,getSum:this._DataSetGetSum,getMin:this._DataSetGetMin,getUnique:this._DataSetUnique}}}]),t}(),e.MapVOpt=function t(e,n){r(this,t),this.data=e,this.options=n}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=function t(e,n,i){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},u=n(123),l=u?u.baiduMapLayer:null,c=l?l.__proto__:Function,h=Cesium.Math.toRadians(95),f=0,p=function(t){function e(t,n,o,a){i(this,e);var s=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return c?(s.map=t,s.scene=t.scene,s.dataSet=n,o=o||{},s.init(o),s.argCheck(o),s.initDevicePixelRatio(),s.canvasLayer=a,s.stopAniamation=!1,s.animation=o.animation,s.clickEvent=s.clickEvent.bind(s),s.mousemoveEvent=s.mousemoveEvent.bind(s),s.bindEvent(),s):r(s)}return o(e,t),a(e,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"clickEvent",value:function(t){var n=t.point;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,n,t)}},{key:"mousemoveEvent",value:function(t){var n=t.point;s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,n,t)}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start)}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator}},{key:"bindEvent",value:function(){this.map,this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}},{key:"unbindEvent",
value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"init",value:function(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"_canvasUpdate",value:function(t){this.map;var e=this.scene;if(this.canvasLayer&&!this.stopAniamation){var n=this.options.animation,i=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void this.clear(i);"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else this.clear(i);if("2d"===this.context)for(var r in this.options)i[r]=this.options[r];else i.clear(i.COLOR_BUFFER_BIT);var o=(this.canvasLayer,{transferCoordinate:function(t){var n=[99999,99999],i=Cesium.Cartesian3.fromDegrees(t[0],t[1]);if(!i)return n;var r=e.cartesianToCanvasCoordinates(i);if(!r)return n;if(e.mode===Cesium.SceneMode.SCENE3D){var o=Cesium.Cartesian3.angleBetween(e.camera.position,i);if(o>h)return n}return[r.x,r.y]}});void 0!==t&&(o.filter=function(e){var i=n.trails||10;return!!(t&&e.time>t-i&&e.time<t)});var a=this.dataSet.get(o);this.processData(a),"m"==this.options.unit&&this.options.size,this.options._size=this.options.size;var s=Cesium.SceneTransforms.wgs84ToWindowCoordinates(e,Cesium.Cartesian3.fromDegrees(0,0));this.drawContext(i,new u.DataSet(a),this.options,s),this.options.updateCallback&&this.options.updateCallback(t)}}},{key:"updateData",value:function(t,n){var i=t;i&&i.get&&(i=i.get()),void 0!=i&&this.dataSet.set(i),s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,{options:n})}},{key:"addData",value:function(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!=typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"destroy",value:function(){this.unbindEvent(),this.clear(this.getContext()),this.clearData(),this.animator&&this.animator.stop(),this.animator=null,this.canvasLayer=null}}]),e}(c),d=function(){function t(e,n,r,o){i(this,t),this.map=e,this.scene=e.scene,this.MapVBaseLayer=new p(e,n,r,this),this.MapVOptions=r,this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.render=this.render.bind(this),void 0!=o?(this.container=o,o.appendChild(this.canvas)):(this.container=e.container,this.addInnerContainer()),this.bindEvent(),this._reset()}return a(t,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"addInnerContainer",value:function(){this.container.appendChild(this.canvas)}},{key:"bindEvent",value:function(){var t=this;this.innerMoveStart=this.moveStartEvent.bind(this),this.innerMoveEnd=this.moveEndEvent.bind(this),this.scene.camera.moveStart.addEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.addEventListener(this.innerMoveEnd,this);var e=new Cesium.ScreenSpaceEventHandler(this.canvas);e.setInputAction(function(e){t.innerMoveEnd()},Cesium.ScreenSpaceEventType.LEFT_UP),e.setInputAction(function(e){t.innerMoveEnd()},Cesium.ScreenSpaceEventType.MIDDLE_UP),this.handler=e}},{key:"unbindEvent",value:function(){this.scene.camera.moveStart.removeEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.removeEventListener(this.innerMoveEnd,this),this.scene.postRender.removeEventListener(this._reset,this),this.handler&&(this.handler.destroy(),this.handler=null)}},{key:"moveStartEvent",value:function(){this.MapVBaseLayer&&this.MapVBaseLayer.animatorMovestartEvent(),this.scene.postRender.addEventListener(this._reset,this)}},{key:"moveEndEvent",value:function(){this.scene.postRender.removeEventListener(this._reset,this),this.MapVBaseLayer&&this.MapVBaseLayer.animatorMoveendEvent(),this._reset()}},{key:"zoomStartEvent",value:function(){this._unvisiable()}},{key:"zoomEndEvent",value:function(){this._unvisiable()}},{key:"addData",value:function(t,e){void 0!=this.MapVBaseLayer&&this.MapVBaseLayer.addData(t,e)}},{key:"updateData",value:function(t,e){void 0!=this.MapVBaseLayer&&this.MapVBaseLayer.updateData(t,e)}},{key:"getData",value:function(){return this.MapVBaseLayer&&(this.dataSet=this.MapVBaseLayer.getData()),this.dataSet}},{key:"removeData",value:function(t){void 0!=this.MapVBaseLayer&&this.MapVBaseLayer&&this.MapVBaseLayer.removeData(t)}},{key:"removeAllData",value:function(){void 0!=this.MapVBaseLayer&&this.MapVBaseLayer.clearData()}},{key:"_visiable",value:function(){return this.canvas.style.display="block"}},{key:"_unvisiable",value:function(){return this.canvas.style.display="none"}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");t.id=this.MapVOptions.layerid||"MapV"+f++,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.MapVOptions.zIndex||100,t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height;var e=this.devicePixelRatio;return"2d"==this.MapVOptions.context&&t.getContext(this.MapVOptions.context).scale(e,e),t}},{key:"_reset",value:function(){this.resizeCanvas(),this.fixPosition(),this.onResize(),this.render()}},{key:"draw",value:function(){this._reset()}},{key:"show",value:function(){this._visiable()}},{key:"hide",value:function(){this._unvisiable()}},{key:"destroy",value:function(){this.unbindEvent(),this.remove()}},{key:"remove",value:function(){void 0!=this.MapVBaseLayer&&(this.removeAllData(),this.MapVBaseLayer.destroy(),this.MapVBaseLayer=void 0,this.canvas.parentElement.removeChild(this.canvas))}},{key:"update",value:function(t){void 0!=t&&this.updateData(t.data,t.options)}},{key:"resizeCanvas",value:function(){if(void 0!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}},{key:"fixPosition",value:function(){}},{key:"onResize",value:function(){}},{key:"render",value:function(){void 0!=this.MapVBaseLayer&&this.MapVBaseLayer._canvasUpdate()}}]),t}();e.default=d},function(t,e,n){var i,r,o;(function(n){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(n,s){"object"==a(e)&&"undefined"!=typeof t?s(e):(r=[e],i=s,o="function"==typeof i?i.apply(e,r):i,!(void 0!==o&&(t.exports=o)))}(void 0,function(t){function e(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}function i(){this._subscribers={}}function r(t){var e=t.split("|");return e[0]=e[0].split(","),{lng:parseFloat(e[0][0]),lat:parseFloat(e[0][1])}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:u(r,e,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":a(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=("undefined"==typeof e?"undefined":a(e))&&"function"!=typeof e?t:e}function h(t,e){i.bind(this)(),this._options=e||{},this._data=[],t&&this.add(t)}function f(t,e){if("undefined"!=typeof document){var n=document.createElement("canvas");t&&(n.width=t),e&&(n.height=e)}return n}function p(t){t=t||{},this.gradient=t.gradient||{.25:"rgba(0, 0, 255, 1)",.55:"rgba(0, 255, 0, 1)",.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=t.maxSize||35,this.minSize=t.minSize||0,this.max=t.max||100,this.min=t.min||0,this.initPalette()}function d(t){return t.max||100}function g(t){return t.min||0}function y(t,e,n){var i=d(n),r=g(n),o=n._size;null==o&&null==(o=n.size)&&(o=13);var a,s,u,l,c,h=new p({gradient:n.gradient,max:i,min:r}),y=(l=new f(2*(u=(a=o)+(s=a/2)),2*u),(c=l.getContext("2d")).shadowBlur=s,c.shadowColor="black",c.shadowOffsetX=c.shadowOffsetY=1e4,c.beginPath(),c.arc(u-1e4,u-1e4,a,0,2*Math.PI,!0),c.closePath(),c.fill(),l),m=y.width/2,v=y.height/2,_=e,w={};for(var b in _.forEach(function(t,e){var n=void 0===t.count?1:t.count,r=Math.min(1,n/i).toFixed(2);w[r]=w[r]||[],w[r].push(t)}),w)if(!isNaN(b)){var C=w[b];t.beginPath(),n.withoutAlpha||(t.globalAlpha=b),t.strokeStyle=h.getColor(b*i),C.forEach(function(e,r){if(e.geometry){var o=e.geometry._coordinates||e.geometry.coordinates,a=e.geometry.type;if("Point"===a){var s=void 0===e.count?1:e.count;t.globalAlpha=s/i,t.drawImage(y,o[0]-m,o[1]-v)}else"LineString"===a&&(s=void 0===e.count?1:e.count,t.globalAlpha=s/i,t.beginPath(),It.draw(t,e,n),t.stroke())}})}}function m(t,e,n){var i=t.createShader(n);return t.shaderSource(i,e),t.compileShader(i),i}function v(t,e,n){var i=m(t,e,t.VERTEX_SHADER),r=m(t,n,t.FRAGMENT_SHADER),o=t.createProgram();return t.attachShader(o,i),t.attachShader(o,r),t.linkProgram(o),t.useProgram(o),o}function _(t){var e=document.createElement("canvas"),n=e.getContext("2d");return e.width=1,e.height=1,n.fillStyle=t,n.fillRect(0,0,1,1),n.getImageData(0,0,1,1).data}function w(t,e,n){n=n||2;var i,r,o,a,s,u,l,c=e&&e.length,h=c?e[0]*n:t.length,f=b(t,0,h,n,!0),p=[];if(!f)return p;if(c&&(f=function(t,e,n,i){var r,o,a,s,u,l=[];for(r=0,o=e.length;r<o;r++)a=e[r]*i,s=r<o-1?e[r+1]*i:t.length,(u=b(t,a,s,i,!1))===u.next&&(u.steiner=!0),l.push(O(u));for(l.sort(T),r=0;r<l.length;r++)N(l[r],n),n=C(n,n.next);return n}(t,e,f,n)),t.length>80*n){i=o=t[0],r=a=t[1];for(var d=n;d<h;d+=n)(s=t[d])<i&&(i=s),(u=t[d+1])<r&&(r=u),o<s&&(o=s),a<u&&(a=u);l=Math.max(o-i,a-r)}return x(f,p,n,i,r,l),p}function b(t,e,n,i,r){var o,a;if(r===0<H(t,e,n,i))for(o=e;o<n;o+=i)a=B(o,t[o],t[o+1],a);else for(o=n-i;e<=o;o-=i)a=B(o,t[o],t[o+1],a);return a&&R(a,a.next)&&(G(a),a=a.next),a}function C(t,e){if(!t)return t;e=e||t;var n,i=t;do if(n=!1,i.steiner||!R(i,i.next)&&0!==A(i.prev,i,i.next))i=i.next;else{if(G(i),(i=e=i.prev)===i.next)return null;n=!0}while(n||i!==e);return e}function x(t,e,n,i,r,o,a){if(t){!a&&o&&function(t,e,n,i){for(var r=t;null===r.z&&(r.z=k(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next,r!==t;);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,u,l=1;do{for(n=t,o=t=null,a=0;n;){for(a++,i=n,e=s=0;e<l&&(s++,i=i.nextZ);e++);for(u=l;0<s||0<u&&i;)0===s?(i=(r=i).nextZ,u--):0!==u&&i?n.z<=i.z?(n=(r=n).nextZ,s--):(i=(r=i).nextZ,u--):(n=(r=n).nextZ,s--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(1<a)}(r)}(t,i,r,o);for(var s,u,l=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?S(t,i,r,o):E(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),G(t),t=u.next,l=u.next;else if((t=u)===l){a?1===a?x(t=M(t,e,n),e,n,i,r,o,2):2===a&&I(t,e,n,i,r,o):x(C(t),e,n,i,r,o,1);break}}}function E(t){var e=t.prev,n=t,i=t.next;if(0<=A(e,n,i))return!1;for(var r=t.next.next;r!==t.prev;){if(D(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=A(r.prev,r,r.next))return!1;r=r.next}return!0}function S(t,e,n,i){var r=t.prev,o=t,a=t.next;if(0<=A(r,o,a))return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,u=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,c=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=k(s,u,e,n,i),f=k(l,c,e,n,i),p=t.nextZ;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&D(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=A(p.prev,p,p.next))return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&D(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=A(p.prev,p,p.next))return!1;p=p.prevZ}return!0}function M(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!R(r,o)&&F(r,i,i.next,o)&&j(r,o)&&j(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),G(i),G(i.next),i=t=o),i=i.next}while(i!==t);return i}function I(t,e,n,i,r,o){var a,s,u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&(s=l,(a=u).next.i!==s.i&&a.prev.i!==s.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&F(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(a,s)&&j(a,s)&&j(s,a)&&function(t,e){for(var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;n.y>o!=n.next.y>o&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next,n!==t;);return i}(a,s))){var c=z(u,l);return u=C(u,u.next),c=C(c,c.next),x(u,e,n,i,r,o),void x(c,e,n,i,r,o)}l=l.next}u=u.next}while(u!==t)}function T(t,e){return t.x-e.x}function N(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&a<s){if((a=s)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n.prev;var u,l=n,c=n.x,h=n.y,f=1/0;for(i=n.next;i!==l;)r>=i.x&&i.x>=c&&D(o<h?r:a,o,c,h,o<h?a:r,o,i.x,i.y)&&((u=Math.abs(o-i.y)/(r-i.x))<f||u===f&&i.x>n.x)&&j(i,t)&&(n=i,f=u),i=i.next;return n}(t,e)){var n=z(e,t);C(n,n.next)}}function k(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)/r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)/r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function O(t){for(var e=t,n=t;e.x<n.x&&(n=e),(e=e.next)!==t;);return n}function D(t,e,n,i,r,o,a,s){return 0<=(r-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(i-s)-(n-a)*(e-s)&&0<=(n-a)*(o-s)-(r-a)*(i-s)}function A(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function R(t,e){return t.x===e.x&&t.y===e.y}function F(t,e,n,i){return!!(R(t,e)&&R(n,i)||R(t,i)&&R(n,e))||0<A(t,e,n)!=0<A(t,e,i)&&0<A(n,i,t)!=0<A(n,i,e)}function j(t,e){return A(t.prev,t,t.next)<0?0<=A(t,e,t.next)&&0<=A(t,t.prev,e):A(t,e,t.prev)<0||A(t,t.next,e)<0}function z(t,e){var n=new U(t.i,t.x,t.y),i=new U(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function B(t,e,n,i){var r=new U(t,e,n);return i?(r.next=i.next,(r.prev=i).next.prev=r,i.next=r):(r.prev=r).next=r,r}function G(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function U(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function H(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}function q(t,e,n){function i(t){return 1-2*t+t*t}function r(t){return 2*t-2*t*t}function o(t){return t*t}if(!t||!e)return null;var a,s,u,l,c,h,f=[],p=(n=n||40,0),d=0;if(void 0!==e){var g=parseFloat(t.lat),y=parseFloat(e.lat),m=parseFloat(t.lng),v=parseFloat(e.lng);for(m<v&&180<parseFloat(v-m)&&m<0&&(m=parseFloat(360+m),v=parseFloat(360+v)),h=0,s=y==g?(a=0,m-v):v==m?(a=Math.PI/2,g-y):(a=Math.atan((y-g)/(v-m)),(y-g)/Math.sin(a)),0==h&&(h=a+Math.PI/5),c=(u=s/2)*Math.cos(h)+m,l=u*Math.sin(h)+g,p=0;p<n+1;p++){var _=m*i(d)+c*r(d)+v*o(d),w=g*i(d)+l*r(d)+y*o(d),b=t.lng,C=e.lng;f.push([b<0&&0<C?_-360:_,w]),d+=1/n}return f}void 0!==f&&(f=[])}function V(t){this.splitList=t||{other:1}}function W(t){this.splitList=t||[{start:0,value:"red"}]}function Y(t,e,n){if(o(this,Y),!t||!e)return console.warn("id 和 type 为必填项"),!1;if("baidu"==e){if(!BMap)return console.warn("请先引入百度地图JS API"),!1}else console.warn("暂不支持你的地图类型");this.type=e;var i=n&&n.center?n.center:[106.962497,38.208726],r=n&&n.zoom?n.zoom:5,a=this.map=new BMap.Map(t,{enableMapClick:!1});a.centerAndZoom(new BMap.Point(i[0],i[1]),r),a.enableScrollWheelZoom(!0),a.setMapStyle({style:"light"})}function X(t){this.options=t||{},this.paneName=this.options.paneName||"mapPane",this.context=this.options.context||"2d",this.zIndex=this.options.zIndex||0,this.mixBlendMode=this.options.mixBlendMode||null,this.enableMassClear=this.options.enableMassClear,this._map=t.map,this._lastDrawTime=null,this.show()}function Z(t,e){for(var n=0;n<t.length;n++)if(J(t[n],e))return!0;return!1}function J(t,e){var n=Math.min(t.ne.x,e.ne.x),i=Math.min(t.sw.y,e.sw.y),r=Math.max(t.sw.x,e.sw.x),o=Math.max(t.ne.y,e.ne.y);return r<n&&o<i}function K(t,e,n,i){n.save();var r=i.geometry._coordinates||i.geometry.coordinates,o=r[0],a=r[1],s=e.offset||{x:0,y:0},u=i.width||e._width||e.width,l=i.height||e._height||e.height;if(o=o-~~u/2+s.x,a=a-~~l/2+s.y,"string"==typeof t)return n.beginPath(),n.arc(o,a,e.size||5,0,2*Math.PI),n.fillStyle=e.fillStyle||"red",void n.fill();var c=i.deg||e.deg;c&&(n.translate(o,a),n.rotate(c*Math.PI/180),n.translate(-o,-a)),e.sx&&e.sy&&e.swidth&&e.sheight&&e.width&&e.height?n.drawImage(t,e.sx,e.sy,e.swidth,e.sheight,o,a,u,l):u&&l?n.drawImage(t,o,a,u,l):n.drawImage(t,o,a),n.restore()}function $(t,e,n,i,r,o){if(!(r-i<=n)){var a=i+r>>1;!function t(e,n,i,r,o,a){for(;r<o;){if(600<o-r){var s=o-r+1,u=i-r+1,l=Math.log(s),c=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*c*(s-c)/s)*(u-s/2<0?-1:1),f=Math.max(r,Math.floor(i-u*c/s+h)),p=Math.min(o,Math.floor(i+(s-u)*c/s+h));t(e,n,i,f,p,a)}var d=n[2*i+a],g=r,y=o;for(Q(e,n,r,i),n[2*o+a]>d&&Q(e,n,r,o);g<y;){for(Q(e,n,g,y),g++,y--;n[2*g+a]<d;)g++;for(;n[2*y+a]>d;)y--}n[2*r+a]===d?Q(e,n,r,y):Q(e,n,++y,o),y<=i&&(r=y+1),i<=y&&(o=y-1)}}(t,e,a,i,r,o%2),$(t,e,n,i,a-1,o+1),$(t,e,n,1+a,r,o+1)}}function Q(t,e,n,i){tt(t,n,i),tt(e,2*n,2*i),tt(e,2*n+1,2*i+1)}function tt(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function et(t,e,n,i){var r=t-n,o=e-i;return r*r+o*o}function nt(t){return t[0]}function it(t){return t[1]}function rt(t,e,n,i,r){void 0===e&&(e=nt),void 0===n&&(n=it),void 0===i&&(i=64),void 0===r&&(r=Float64Array),this.nodeSize=i;for(var o=(this.points=t).length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new r(2*t.length),u=0;u<t.length;u++)s[2*(a[u]=u)]=e(t[u]),s[2*u+1]=n(t[u]);$(a,s,i,0,a.length-1,0)}function ot(t){this.options=ct(Object.create(ue),t),this.trees=new Array(this.options.maxZoom+1)}function at(t){return{type:"Feature",id:t.id,properties:st(t),geometry:{type:"Point",coordinates:[360*(t.x-.5),(e=t.y,n=(180-360*e)*Math.PI/180,360*Math.atan(Math.exp(n))/Math.PI-90)]}};var e,n}function st(t){var e=t.numPoints,n=1e4<=e?Math.round(e/1e3)+"k":1e3<=e?Math.round(e/100)/10+"k":e;return ct(ct({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function ut(t){return t/360+.5}function lt(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:1<n?1:n}function ct(t,e){for(var n in e)t[n]=e[n];return t}function ht(t){return t.x}function ft(t){return t.y}function pt(t,e,n){o(this,pt),e instanceof h||(e=new h(e)),this.dataSet=e,this.map=t,"cluster"===n.draw&&this.refreshCluster(n)}function dt(t,e,n){o(this,dt);var i=c(this,(dt.__proto__||Object.getPrototypeOf(dt)).call(this,t,e,n));i.map=t,i.options=n||{},i.dataSet=e;var r=new X({map:t,zIndex:i.options.zIndex,update:i._canvasUpdate.bind(i)});i.init(i.options),i.canvasLayer=r,i.transferToMercator();var a=i;return e.on("change",function(){a.transferToMercator(),r.draw()}),i.ctx=r.canvas.getContext("2d"),i.start(),i}function gt(t,e,n){o(this,gt);var i=c(this,(gt.__proto__||Object.getPrototypeOf(gt)).call(this,t,e,n)),r=i;n=n||{},i.clickEvent=i.clickEvent.bind(i),i.mousemoveEvent=i.mousemoveEvent.bind(i),i.tapEvent=i.tapEvent.bind(i),r.init(n),r.argCheck(n),r.transferToMercator();var a=i.canvasLayer=new X({map:t,context:i.context,updateImmediate:n.updateImmediate,paneName:n.paneName,mixBlendMode:n.mixBlendMode,enableMassClear:n.enableMassClear,zIndex:n.zIndex,update:function(){r._canvasUpdate()}});return e.on("change",function(){r.transferToMercator(),"cluster"===n.draw&&r.refreshCluster(),a.draw()}),i}function yt(t){function e(t,e){return function(){e.apply(t)}}this.isAdded_=!1,this.isAnimated_=!1,this.paneName_=yt.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var n=document.createElement("canvas");n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.pointerEvents="none",this.canvas=n,this.canvasCssWidth_=300,this.canvasCssHeight_=150,this.resolutionScale_=1,this.repositionFunction_=e(this,this.repositionCanvas_),this.resizeFunction_=e(this,this.resize_),this.requestUpdateFunction_=e(this,this.update_),t&&this.setOptions(t)}function mt(t,e,n){o(this,mt);var i=c(this,(mt.__proto__||Object.getPrototypeOf(mt)).call(this,t,e,n)),r=i;n=n||{},r.init(n),r.argCheck(n);var a={map:t,animate:!1,updateHandler:function(){r._canvasUpdate()},resolutionScale:resolutionScale};return i.canvasLayer=new yt(a),i.clickEvent=i.clickEvent.bind(i),i.mousemoveEvent=i.mousemoveEvent.bind(i),i.bindEvent(),i}function vt(){return o(this,vt),c(this,(vt.__proto__||Object.getPrototypeOf(vt)).apply(this,arguments))}function _t(t,e,n){o(this,_t);var i=c(this,(_t.__proto__||Object.getPrototypeOf(_t)).call(this,t,n));return i.options_=n,i.dataSet=e,i._initBaseLayer(n),i}function wt(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=arguments[1],n=arguments[2];o(this,wt);var i=c(this,(wt.__proto__||Object.getPrototypeOf(wt)).call(this,t,e,n));return i.options=n,i.canvasLayer={canvas:null,devicePixelRatio:window.devicePixelRatio},i.layer_=null,i.initDataRange(n),i.initAnimator(),i.onEvents(),t.on("complete",function(){this.init(t,n),this.argCheck(n)},i),i}function bt(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=arguments[1],n=arguments[2];o(this,bt);var i=c(this,(bt.__proto__||Object.getPrototypeOf(bt)).call(this,t,e,n));return i.options=n,i.canvasLayer={canvas:null,devicePixelRatio:window.devicePixelRatio},i.layer_=null,i.previousCursor_=void 0,i.init(t,n),i.argCheck(n),i}function Ct(t,e,n,i){o(this,Ct);var r=c(this,(Ct.__proto__||Object.getPrototypeOf(Ct)).call(this,t,n,i));if(!le)return c(r);var a=r;return i=i||{},a.init(i),a.argCheck(i),r.canvasLayer=e,r.clickEvent=r.clickEvent.bind(r),r.mousemoveEvent=r.mousemoveEvent.bind(r),r._moveStartEvent=r.moveStartEvent.bind(r),r._moveEndEvent=r.moveEndEvent.bind(r),r._zoomStartEvent=r.zoomStartEvent.bind(r),r.bindEvent(),r}function xt(t,e,n,i){o(this,xt);var r=c(this,(xt.__proto__||Object.getPrototypeOf(xt)).call(this,t,e,n));return le?(r.map=t,r.scene=t.scene,r.dataSet=e,n=n||{},r.init(n),r.argCheck(n),r.initDevicePixelRatio(),r.canvasLayer=i,r.stopAniamation=!1,r.animation=n.animation,r.clickEvent=r.clickEvent.bind(r),r.mousemoveEvent=r.mousemoveEvent.bind(r),r.bindEvent(),r):c(r)}function Et(t,e,n,i){if(o(this,Et),this.map=t,this.scene=t.scene,this.mapvBaseLayer=new Te(t,e,n,this),this.mapVOptions=n,this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.render=this.render.bind(this),i)this.container=i;else{var r=t.container.querySelector(".cesium-viewer-cesiumWidgetContainer");this.container=r||t.container}this.addInnerContainer(),this.bindEvent(),this._reset()}i.prototype.on=function(t,e){var n=this._subscribers[t];n||(n=[],this._subscribers[t]=n),n.push({callback:e})},i.prototype.off=function(t,e){var n=this._subscribers[t];if(n)for(var i=0;i<n.length;i++)n[i].callback==e&&(n.splice(i,1),i--)},i.prototype._trigger=function(t,e,n){if("*"==t)throw new Error("Cannot trigger event *");var i=[];t in this._subscribers&&(i=i.concat(this._subscribers[t])),"*"in this._subscribers&&(i=i.concat(this._subscribers["*"]));for(var r=0,o=i.length;r<o;r++){var a=i[r];a.callback&&a.callback(t,e,n||null)}};var St={municipalities:[{n:"北京",g:"116.395645,39.929986|12"},{n:"上海",g:"121.487899,31.249162|12"},{n:"天津",g:"117.210813,39.14393|12"},{n:"重庆",g:"106.530635,29.544606|12"}],provinces:[{n:"安徽",g:"117.216005,31.859252|8",cities:[{n:"合肥",g:"117.282699,31.866942|12"},{n:"安庆",g:"117.058739,30.537898|13"},{n:"蚌埠",g:"117.35708,32.929499|13"},{n:"亳州",g:"115.787928,33.871211|13"},{n:"巢湖",g:"117.88049,31.608733|13"},{n:"池州",g:"117.494477,30.660019|14"},{n:"滁州",g:"118.32457,32.317351|13"},{n:"阜阳",g:"115.820932,32.901211|13"},{n:"淮北",g:"116.791447,33.960023|13"},{n:"淮南",g:"117.018639,32.642812|13"},{n:"黄山",g:"118.29357,29.734435|13"},{n:"六安",g:"116.505253,31.755558|13"},{n:"马鞍山",g:"118.515882,31.688528|13"},{n:"宿州",g:"116.988692,33.636772|13"},{n:"铜陵",g:"117.819429,30.94093|14"},{n:"芜湖",g:"118.384108,31.36602|12"},{n:"宣城",g:"118.752096,30.951642|13"}]},{n:"福建",g:"117.984943,26.050118|8",cities:[{n:"福州",g:"119.330221,26.047125|12"},{n:"龙岩",g:"117.017997,25.078685|13"},{n:"南平",g:"118.181883,26.643626|13"},{n:"宁德",g:"119.542082,26.656527|14"},{n:"莆田",g:"119.077731,25.44845|13"},{n:"泉州",g:"118.600362,24.901652|12"},{n:"三明",g:"117.642194,26.270835|14"},{n:"厦门",g:"118.103886,24.489231|12"},{n:"漳州",g:"117.676205,24.517065|12"}]},{n:"甘肃",g:"102.457625,38.103267|6",cities:[{n:"兰州",g:"103.823305,36.064226|12"},{n:"白银",g:"104.171241,36.546682|13"},{n:"定西",g:"104.626638,35.586056|13"},{n:"甘南州",g:"102.917442,34.992211|14"},{n:"嘉峪关",g:"98.281635,39.802397|13"},{n:"金昌",g:"102.208126,38.516072|13"},{n:"酒泉",g:"98.508415,39.741474|13"},{n:"临夏州",g:"103.215249,35.598514|13"},{n:"陇南",g:"104.934573,33.39448|14"},{n:"平凉",g:"106.688911,35.55011|13"},{n:"庆阳",g:"107.644227,35.726801|13"},{n:"天水",g:"105.736932,34.584319|13"},{n:"武威",g:"102.640147,37.933172|13"},{n:"张掖",g:"100.459892,38.93932|13"}]},{n:"广东",g:"113.394818,23.408004|8",cities:[{n:"广州",g:"113.30765,23.120049|12"},{n:"潮州",g:"116.630076,23.661812|13"},{n:"东莞",g:"113.763434,23.043024|12"},{n:"佛山",g:"113.134026,23.035095|13"},{n:"河源",g:"114.713721,23.757251|12"},{n:"惠州",g:"114.410658,23.11354|12"},{n:"江门",g:"113.078125,22.575117|13"},{n:"揭阳",g:"116.379501,23.547999|13"},{n:"茂名",g:"110.931245,21.668226|13"},{n:"梅州",g:"116.126403,24.304571|13"},{n:"清远",g:"113.040773,23.698469|13"},{n:"汕头",g:"116.72865,23.383908|13"},{n:"汕尾",g:"115.372924,22.778731|14"},{n:"韶关",g:"113.594461,24.80296|13"},{n:"深圳",g:"114.025974,22.546054|12"},{n:"阳江",g:"111.97701,21.871517|14"},{n:"云浮",g:"112.050946,22.937976|13"},{n:"湛江",g:"110.365067,21.257463|13"},{n:"肇庆",g:"112.479653,23.078663|13"},{n:"中山",g:"113.42206,22.545178|12"},{n:"珠海",g:"113.562447,22.256915|13"}]},{n:"广西",g:"108.924274,23.552255|7",cities:[{n:"南宁",g:"108.297234,22.806493|12"},{n:"百色",g:"106.631821,23.901512|13"},{n:"北海",g:"109.122628,21.472718|13"},{n:"崇左",g:"107.357322,22.415455|14"},{n:"防城港",g:"108.351791,21.617398|15"},{n:"桂林",g:"110.26092,25.262901|12"},{n:"贵港",g:"109.613708,23.103373|13"},{n:"河池",g:"108.069948,24.699521|14"},{n:"贺州",g:"111.552594,24.411054|14"},{n:"来宾",g:"109.231817,23.741166|14"},{n:"柳州",g:"109.422402,24.329053|12"},{n:"钦州",g:"108.638798,21.97335|13"},{n:"梧州",g:"111.305472,23.485395|13"},{n:"玉林",g:"110.151676,22.643974|14"}]},{n:"贵州",g:"106.734996,26.902826|8",cities:[{n:"贵阳",g:"106.709177,26.629907|12"},{n:"安顺",g:"105.92827,26.228595|13"},{n:"毕节地区",g:"105.300492,27.302612|14"},{n:"六盘水",g:"104.852087,26.591866|13"},{n:"铜仁地区",g:"109.196161,27.726271|14"},{n:"遵义",g:"106.93126,27.699961|13"},{n:"黔西南州",g:"104.900558,25.095148|11"},{n:"黔东南州",g:"107.985353,26.583992|11"},{n:"黔南州",g:"107.523205,26.264536|11"}]},{n:"海南",g:"109.733755,19.180501|9",cities:[{n:"海口",g:"110.330802,20.022071|13"},{n:"白沙",g:"109.358586,19.216056|12"},{n:"保亭",g:"109.656113,18.597592|12"},{n:"昌江",g:"109.0113,19.222483|12"},{n:"儋州",g:"109.413973,19.571153|13"},{n:"澄迈",g:"109.996736,19.693135|13"},{n:"东方",g:"108.85101,18.998161|13"},{n:"定安",g:"110.32009,19.490991|13"},{n:"琼海",g:"110.414359,19.21483|13"},{n:"琼中",g:"109.861849,19.039771|12"},{n:"乐东",g:"109.062698,18.658614|12"},{n:"临高",g:"109.724101,19.805922|13"},{n:"陵水",g:"109.948661,18.575985|12"},{n:"三亚",g:"109.522771,18.257776|12"},{n:"屯昌",g:"110.063364,19.347749|13"},{n:"万宁",g:"110.292505,18.839886|13"},{n:"文昌",g:"110.780909,19.750947|13"},{n:"五指山",g:"109.51775,18.831306|13"}]},{n:"河北",g:"115.661434,38.61384|7",cities:[{n:"石家庄",g:"114.522082,38.048958|12"},{n:"保定",g:"115.49481,38.886565|13"},{n:"沧州",g:"116.863806,38.297615|13"},{n:"承德",g:"117.933822,40.992521|14"},{n:"邯郸",g:"114.482694,36.609308|13"},{n:"衡水",g:"115.686229,37.746929|13"},{n:"廊坊",g:"116.703602,39.518611|13"},{n:"秦皇岛",g:"119.604368,39.945462|12"},{n:"唐山",g:"118.183451,39.650531|13"},{n:"邢台",g:"114.520487,37.069531|13"},{n:"张家口",g:"114.893782,40.811188|13"}]},{n:"河南",g:"113.486804,34.157184|7",cities:[{n:"郑州",g:"113.649644,34.75661|12"},{n:"安阳",g:"114.351807,36.110267|12"},{n:"鹤壁",g:"114.29777,35.755426|13"},{n:"焦作",g:"113.211836,35.234608|13"},{n:"开封",g:"114.351642,34.801854|13"},{n:"洛阳",g:"112.447525,34.657368|12"},{n:"漯河",g:"114.046061,33.576279|13"},{n:"南阳",g:"112.542842,33.01142|13"},{n:"平顶山",g:"113.300849,33.745301|13"},{n:"濮阳",g:"115.026627,35.753298|12"},{n:"三门峡",g:"111.181262,34.78332|13"},{n:"商丘",g:"115.641886,34.438589|13"},{n:"新乡",g:"113.91269,35.307258|13"},{n:"信阳",g:"114.085491,32.128582|13"},{n:"许昌",g:"113.835312,34.02674|13"},{n:"周口",g:"114.654102,33.623741|13"},{n:"驻马店",g:"114.049154,32.983158|13"}]},{n:"黑龙江",g:"128.047414,47.356592|6",cities:[{n:"哈尔滨",g:"126.657717,45.773225|12"},{n:"大庆",g:"125.02184,46.596709|12"},{n:"大兴安岭地区",g:"124.196104,51.991789|10"},{n:"鹤岗",g:"130.292472,47.338666|13"},{n:"黑河",g:"127.50083,50.25069|14"},{n:"鸡西",g:"130.941767,45.32154|13"},{n:"佳木斯",g:"130.284735,46.81378|12"},{n:"牡丹江",g:"129.608035,44.588521|13"},{n:"七台河",g:"131.019048,45.775005|14"},{n:"齐齐哈尔",g:"123.987289,47.3477|13"},{n:"双鸭山",g:"131.171402,46.655102|13"},{n:"绥化",g:"126.989095,46.646064|13"},{n:"伊春",g:"128.910766,47.734685|14"}]},{n:"湖北",g:"112.410562,31.209316|8",cities:[{n:"武汉",g:"114.3162,30.581084|12"},{n:"鄂州",g:"114.895594,30.384439|14"},{n:"恩施",g:"109.517433,30.308978|14"},{n:"黄冈",g:"114.906618,30.446109|14"},{n:"黄石",g:"115.050683,30.216127|13"},{n:"荆门",g:"112.21733,31.042611|13"},{n:"荆州",g:"112.241866,30.332591|12"},{n:"潜江",g:"112.768768,30.343116|13"},{n:"神农架林区",g:"110.487231,31.595768|13"},{n:"十堰",g:"110.801229,32.636994|13"},{n:"随州",g:"113.379358,31.717858|13"},{n:"天门",g:"113.12623,30.649047|13"},{n:"仙桃",g:"113.387448,30.293966|13"},{n:"咸宁",g:"114.300061,29.880657|13"},{n:"襄阳",g:"112.176326,32.094934|12"},{n:"孝感",g:"113.935734,30.927955|13"},{n:"宜昌",g:"111.310981,30.732758|13"}]},{n:"湖南",g:"111.720664,27.695864|7",cities:[{n:"长沙",g:"112.979353,28.213478|12"},{n:"常德",g:"111.653718,29.012149|12"},{n:"郴州",g:"113.037704,25.782264|13"},{n:"衡阳",g:"112.583819,26.898164|13"},{n:"怀化",g:"109.986959,27.557483|13"},{n:"娄底",g:"111.996396,27.741073|13"},{n:"邵阳",g:"111.461525,27.236811|13"},{n:"湘潭",g:"112.935556,27.835095|13"},{n:"湘西州",g:"109.745746,28.317951|14"},{n:"益阳",g:"112.366547,28.588088|13"},{n:"永州",g:"111.614648,26.435972|13"},{n:"岳阳",g:"113.146196,29.378007|13"},{n:"张家界",g:"110.48162,29.124889|13"},{n:"株洲",g:"113.131695,27.827433|13"}]},{n:"江苏",g:"119.368489,33.013797|8",cities:[{n:"南京",g:"118.778074,32.057236|12"},{n:"常州",g:"119.981861,31.771397|12"},{n:"淮安",g:"119.030186,33.606513|12"},{n:"连云港",g:"119.173872,34.601549|12"},{n:"南通",g:"120.873801,32.014665|12"},{n:"苏州",g:"120.619907,31.317987|12"},{n:"宿迁",g:"118.296893,33.95205|13"},{n:"泰州",g:"119.919606,32.476053|13"
},{n:"无锡",g:"120.305456,31.570037|12"},{n:"徐州",g:"117.188107,34.271553|12"},{n:"盐城",g:"120.148872,33.379862|12"},{n:"扬州",g:"119.427778,32.408505|13"},{n:"镇江",g:"119.455835,32.204409|13"}]},{n:"江西",g:"115.676082,27.757258|7",cities:[{n:"南昌",g:"115.893528,28.689578|12"},{n:"抚州",g:"116.360919,27.954545|13"},{n:"赣州",g:"114.935909,25.845296|13"},{n:"吉安",g:"114.992039,27.113848|13"},{n:"景德镇",g:"117.186523,29.303563|12"},{n:"九江",g:"115.999848,29.71964|13"},{n:"萍乡",g:"113.859917,27.639544|13"},{n:"上饶",g:"117.955464,28.457623|13"},{n:"新余",g:"114.947117,27.822322|13"},{n:"宜春",g:"114.400039,27.81113|13"},{n:"鹰潭",g:"117.03545,28.24131|13"}]},{n:"吉林",g:"126.262876,43.678846|7",cities:[{n:"长春",g:"125.313642,43.898338|12"},{n:"白城",g:"122.840777,45.621086|13"},{n:"白山",g:"126.435798,41.945859|13"},{n:"吉林",g:"126.564544,43.871988|12"},{n:"辽源",g:"125.133686,42.923303|13"},{n:"四平",g:"124.391382,43.175525|12"},{n:"松原",g:"124.832995,45.136049|13"},{n:"通化",g:"125.94265,41.736397|13"},{n:"延边",g:"129.485902,42.896414|13"}]},{n:"辽宁",g:"122.753592,41.6216|8",cities:[{n:"沈阳",g:"123.432791,41.808645|12"},{n:"鞍山",g:"123.007763,41.118744|13"},{n:"本溪",g:"123.778062,41.325838|12"},{n:"朝阳",g:"120.446163,41.571828|13"},{n:"大连",g:"121.593478,38.94871|12"},{n:"丹东",g:"124.338543,40.129023|12"},{n:"抚顺",g:"123.92982,41.877304|12"},{n:"阜新",g:"121.660822,42.01925|14"},{n:"葫芦岛",g:"120.860758,40.74303|13"},{n:"锦州",g:"121.147749,41.130879|13"},{n:"辽阳",g:"123.172451,41.273339|14"},{n:"盘锦",g:"122.073228,41.141248|13"},{n:"铁岭",g:"123.85485,42.299757|13"},{n:"营口",g:"122.233391,40.668651|13"}]},{n:"内蒙古",g:"114.415868,43.468238|5",cities:[{n:"呼和浩特",g:"111.660351,40.828319|12"},{n:"阿拉善盟",g:"105.695683,38.843075|14"},{n:"包头",g:"109.846239,40.647119|12"},{n:"巴彦淖尔",g:"107.423807,40.76918|12"},{n:"赤峰",g:"118.930761,42.297112|12"},{n:"鄂尔多斯",g:"109.993706,39.81649|12"},{n:"呼伦贝尔",g:"119.760822,49.201636|12"},{n:"通辽",g:"122.260363,43.633756|12"},{n:"乌海",g:"106.831999,39.683177|13"},{n:"乌兰察布",g:"113.112846,41.022363|12"},{n:"锡林郭勒盟",g:"116.02734,43.939705|11"},{n:"兴安盟",g:"122.048167,46.083757|11"}]},{n:"宁夏",g:"106.155481,37.321323|8",cities:[{n:"银川",g:"106.206479,38.502621|12"},{n:"固原",g:"106.285268,36.021523|13"},{n:"石嘴山",g:"106.379337,39.020223|13"},{n:"吴忠",g:"106.208254,37.993561|14"},{n:"中卫",g:"105.196754,37.521124|14"}]},{n:"青海",g:"96.202544,35.499761|7",cities:[{n:"西宁",g:"101.767921,36.640739|12"},{n:"果洛州",g:"100.223723,34.480485|11"},{n:"海东地区",g:"102.085207,36.51761|11"},{n:"海北州",g:"100.879802,36.960654|11"},{n:"海南州",g:"100.624066,36.284364|11"},{n:"海西州",g:"97.342625,37.373799|11"},{n:"黄南州",g:"102.0076,35.522852|11"},{n:"玉树州",g:"97.013316,33.00624|14"}]},{n:"山东",g:"118.527663,36.09929|8",cities:[{n:"济南",g:"117.024967,36.682785|12"},{n:"滨州",g:"117.968292,37.405314|12"},{n:"东营",g:"118.583926,37.487121|12"},{n:"德州",g:"116.328161,37.460826|12"},{n:"菏泽",g:"115.46336,35.26244|13"},{n:"济宁",g:"116.600798,35.402122|13"},{n:"莱芜",g:"117.684667,36.233654|13"},{n:"聊城",g:"115.986869,36.455829|12"},{n:"临沂",g:"118.340768,35.072409|12"},{n:"青岛",g:"120.384428,36.105215|12"},{n:"日照",g:"119.50718,35.420225|12"},{n:"泰安",g:"117.089415,36.188078|13"},{n:"威海",g:"122.093958,37.528787|13"},{n:"潍坊",g:"119.142634,36.716115|12"},{n:"烟台",g:"121.309555,37.536562|12"},{n:"枣庄",g:"117.279305,34.807883|13"},{n:"淄博",g:"118.059134,36.804685|12"}]},{n:"山西",g:"112.515496,37.866566|7",cities:[{n:"太原",g:"112.550864,37.890277|12"},{n:"长治",g:"113.120292,36.201664|12"},{n:"大同",g:"113.290509,40.113744|12"},{n:"晋城",g:"112.867333,35.499834|13"},{n:"晋中",g:"112.738514,37.693362|13"},{n:"临汾",g:"111.538788,36.099745|13"},{n:"吕梁",g:"111.143157,37.527316|14"},{n:"朔州",g:"112.479928,39.337672|13"},{n:"忻州",g:"112.727939,38.461031|12"},{n:"阳泉",g:"113.569238,37.869529|13"},{n:"运城",g:"111.006854,35.038859|13"}]},{n:"陕西",g:"109.503789,35.860026|7",cities:[{n:"西安",g:"108.953098,34.2778|12"},{n:"安康",g:"109.038045,32.70437|13"},{n:"宝鸡",g:"107.170645,34.364081|12"},{n:"汉中",g:"107.045478,33.081569|13"},{n:"商洛",g:"109.934208,33.873907|13"},{n:"铜川",g:"108.968067,34.908368|13"},{n:"渭南",g:"109.483933,34.502358|13"},{n:"咸阳",g:"108.707509,34.345373|13"},{n:"延安",g:"109.50051,36.60332|13"},{n:"榆林",g:"109.745926,38.279439|12"}]},{n:"四川",g:"102.89916,30.367481|7",cities:[{n:"成都",g:"104.067923,30.679943|12"},{n:"阿坝州",g:"102.228565,31.905763|15"},{n:"巴中",g:"106.757916,31.869189|14"},{n:"达州",g:"107.494973,31.214199|14"},{n:"德阳",g:"104.402398,31.13114|13"},{n:"甘孜州",g:"101.969232,30.055144|15"},{n:"广安",g:"106.63572,30.463984|13"},{n:"广元",g:"105.819687,32.44104|13"},{n:"乐山",g:"103.760824,29.600958|13"},{n:"凉山州",g:"102.259591,27.892393|14"},{n:"泸州",g:"105.44397,28.89593|14"},{n:"南充",g:"106.105554,30.800965|13"},{n:"眉山",g:"103.84143,30.061115|13"},{n:"绵阳",g:"104.705519,31.504701|12"},{n:"内江",g:"105.073056,29.599462|13"},{n:"攀枝花",g:"101.722423,26.587571|14"},{n:"遂宁",g:"105.564888,30.557491|12"},{n:"雅安",g:"103.009356,29.999716|13"},{n:"宜宾",g:"104.633019,28.769675|13"},{n:"资阳",g:"104.63593,30.132191|13"},{n:"自贡",g:"104.776071,29.359157|13"}]},{n:"西藏",g:"89.137982,31.367315|6",cities:[{n:"拉萨",g:"91.111891,29.662557|13"},{n:"阿里地区",g:"81.107669,30.404557|11"},{n:"昌都地区",g:"97.185582,31.140576|15"},{n:"林芝地区",g:"94.349985,29.666941|11"},{n:"那曲地区",g:"92.067018,31.48068|14"},{n:"日喀则地区",g:"88.891486,29.269023|14"},{n:"山南地区",g:"91.750644,29.229027|11"}]},{n:"新疆",g:"85.614899,42.127001|6",cities:[{n:"乌鲁木齐",g:"87.564988,43.84038|12"},{n:"阿拉尔",g:"81.291737,40.61568|13"},{n:"阿克苏地区",g:"80.269846,41.171731|12"},{n:"阿勒泰地区",g:"88.137915,47.839744|13"},{n:"巴音郭楞",g:"86.121688,41.771362|12"},{n:"博尔塔拉州",g:"82.052436,44.913651|11"},{n:"昌吉州",g:"87.296038,44.007058|13"},{n:"哈密地区",g:"93.528355,42.858596|13"},{n:"和田地区",g:"79.930239,37.116774|13"},{n:"喀什地区",g:"75.992973,39.470627|12"},{n:"克拉玛依",g:"84.88118,45.594331|13"},{n:"克孜勒苏州",g:"76.137564,39.750346|11"},{n:"石河子",g:"86.041865,44.308259|13"},{n:"塔城地区",g:"82.974881,46.758684|12"},{n:"图木舒克",g:"79.198155,39.889223|13"},{n:"吐鲁番地区",g:"89.181595,42.96047|13"},{n:"五家渠",g:"87.565449,44.368899|13"},{n:"伊犁州",g:"81.297854,43.922248|11"}]},{n:"云南",g:"101.592952,24.864213|7",cities:[{n:"昆明",g:"102.714601,25.049153|12"},{n:"保山",g:"99.177996,25.120489|13"},{n:"楚雄州",g:"101.529382,25.066356|13"},{n:"大理州",g:"100.223675,25.5969|14"},{n:"德宏州",g:"98.589434,24.44124|14"},{n:"迪庆州",g:"99.713682,27.831029|14"},{n:"红河州",g:"103.384065,23.367718|11"},{n:"丽江",g:"100.229628,26.875351|13"},{n:"临沧",g:"100.092613,23.887806|14"},{n:"怒江州",g:"98.859932,25.860677|14"},{n:"普洱",g:"100.980058,22.788778|14"},{n:"曲靖",g:"103.782539,25.520758|12"},{n:"昭通",g:"103.725021,27.340633|13"},{n:"文山",g:"104.089112,23.401781|14"},{n:"西双版纳",g:"100.803038,22.009433|13"},{n:"玉溪",g:"102.545068,24.370447|13"}]},{n:"浙江",g:"119.957202,29.159494|8",cities:[{n:"杭州",g:"120.219375,30.259244|12"},{n:"湖州",g:"120.137243,30.877925|12"},{n:"嘉兴",g:"120.760428,30.773992|13"},{n:"金华",g:"119.652576,29.102899|12"},{n:"丽水",g:"119.929576,28.4563|13"},{n:"宁波",g:"121.579006,29.885259|12"},{n:"衢州",g:"118.875842,28.95691|12"},{n:"绍兴",g:"120.592467,30.002365|13"},{n:"台州",g:"121.440613,28.668283|13"},{n:"温州",g:"120.690635,28.002838|12"},{n:"舟山",g:"122.169872,30.03601|13"}]}],other:[{n:"香港",g:"114.186124,22.293586|11"},{n:"澳门",g:"113.557519,22.204118|13"},{n:"台湾",g:"120.961454,23.80406|8"}]},Pt={getProvinceNameByCityName:function(t){for(var e=St.provinces,n=0;n<e.length;n++)for(var i=e[n].n,r=e[n].cities,o=0;o<r.length;o++)if(r[o].n==t)return i;return null},getCenterByCityName:function(t){t=t.replace("市","");for(var e=0;e<St.municipalities.length;e++)if(St.municipalities[e].n==t)return r(St.municipalities[e].g);for(e=0;e<St.other.length;e++)if(St.other[e].n==t)return r(St.other[e].g);var n=St.provinces;for(e=0;e<n.length;e++){if(n[e].n==t)return r(n[e].g);for(var i=n[e].cities,o=0;o<i.length;o++)if(i[o].n==t)return r(i[o].g)}return null}},Mt=function(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t},Lt=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};(h.prototype=Object.create(i.prototype)).add=function(t,e){if(Array.isArray(t)){for(var n=0,i=t.length;n<i;n++)if(t[n]){if(t[n].time&&14==t[n].time.length&&"20"==t[n].time.substr(0,2)){var r=t[n].time;t[n].time=new Date(r.substr(0,4)+"-"+r.substr(4,2)+"-"+r.substr(6,2)+" "+r.substr(8,2)+":"+r.substr(10,2)+":"+r.substr(12,2)).getTime()}this._data.push(t[n])}}else{if(!(t instanceof Object))throw new Error("Unknown dataType");this._data.push(t)}this._dataCache=JSON.parse(JSON.stringify(this._data))},h.prototype.reset=function(){this._data=JSON.parse(JSON.stringify(this._dataCache))},h.prototype.get=function(t){t=t||{},new Date;var e=this._data;if(new Date,t.filter){for(var n=[],i=0;i<e.length;i++)t.filter(e[i])&&n.push(e[i]);e=n}return t.transferCoordinate&&(e=this.transferCoordinate(e,t.transferCoordinate,t.fromColumn,t.toColumn)),e},h.prototype.set=function(t){this._set(t),this._trigger("change")},h.prototype._set=function(t){this.clear(),this.add(t)},h.prototype.clear=function(t){this._data=[]},h.prototype.remove=function(t){},h.prototype.update=function(t,e){for(var n=this._data,i=0;i<n.length;i++)if(e){var r=!0;for(var o in e)n[i][o]!=e[o]&&(r=!1);r&&t&&t(n[i])}else t&&t(n[i]);this._dataCache=JSON.parse(JSON.stringify(this._data)),this._trigger("change")},h.prototype.transferCoordinate=function(t,e,n,i){function r(t){for(var n=[],i=0;i<t.length;i++){for(var r=t[i],o=[],a=0;a<r.length;a++)o.push(e(r[a]));n.push(o)}return n}i=i||"_coordinates",n=n||"coordinates";for(var o=0;o<t.length;o++){var a=t[o].geometry,s=a[n];switch(a.type){case"Point":a[i]=e(s);break;case"LineString":for(var u=[],l=0;l<s.length;l++)u.push(e(s[l]));a[i]=u;break;case"MultiLineString":case"Polygon":u=r(s),a[i]=u;break;case"MultiPolygon":u=[];for(var c=0;c<s.length;c++){var h=r(h=s[c]);u.push(h)}a[i]=u}}return t},h.prototype.initGeometry=function(t){t?this._data.forEach(function(e){e.geometry=t(e)}):this._data.forEach(function(t){if(!t.geometry)if(t.lng&&t.lat)t.geometry={type:"Point",coordinates:[t.lng,t.lat]};else if(t.city){var e=Pt.getCenterByCityName(t.city);e&&(t.geometry={type:"Point",coordinates:[e.lng,e.lat]})}})},h.prototype.getMax=function(t){var e=this._data;if(e&&!(e.length<=0)){for(var n=parseFloat(e[0][t]),i=1;i<e.length;i++){var r=parseFloat(e[i][t]);n<r&&(n=r)}return n}},h.prototype.getSum=function(t){var e=this._data;if(e&&!(e.length<=0)){for(var n=0,i=0;i<e.length;i++)e[i][t]&&(n+=parseFloat(e[i][t]));return n}},h.prototype.getMin=function(t){var e=this._data;if(e&&!(e.length<=0)){for(var n=parseFloat(e[0][t]),i=1;i<e.length;i++){var r=parseFloat(e[i][t]);r<n&&(n=r)}return n}},h.prototype.getUnique=function(t){if((i=this._data)&&!(i.length<=0)){for(var e={},n=1;n<i.length;n++)e[i[n][t]]=!0;var i=[];for(var r in e)i.push(r);return i}};var It={drawDataSet:function(t,e,n){for(var i=e instanceof h?e.get():e,r=0,o=i.length;r<o;r++){var a=i[r];this.draw(t,a,n)}},draw:function(t,e,n){var i=e.geometry.type,r=e.geometry._coordinates||e.geometry.coordinates,o=e.symbol||n.symbol||"circle";switch(i){case"Point":var a=e._size||e.size||n._size||n.size||5;"circle"===o?("Point"===n.bigData&&t.moveTo(r[0],r[1]),t.arc(r[0],r[1],a,0,2*Math.PI)):"rect"===o?t.rect(r[0]-a/2,r[1]-a/2,a,a):"honeycomb"===o&&function(t,e,n,i){for(var r=0;r<6;r++){var o=(a={x:e,y:n},s=i,u=60*r+30,l=Math.PI/180*u,[a.x+s*Math.cos(l),a.y+s*Math.sin(l)]);t.lineTo(o[0],o[1])}var a,s,u,l}(t,r[0],r[1],a);break;case"LineString":this.drawLineString(t,r);break;case"MultiLineString":for(var s=0;s<r.length;s++){var u=r[s];this.drawLineString(t,u)}break;case"Polygon":this.drawPolygon(t,r);break;case"MultiPolygon":for(s=0;s<r.length;s++){var l=r[s];if(this.drawPolygon(t,l),n.multiPolygonDraw){var c=n.multiPolygonDraw();if(c)return c}}break;default:console.error("type"+i+"is not support now!")}},drawLineString:function(t,e){for(var n=0;n<e.length;n++){var i=e[n][0],r=e[n][1];0==n?t.moveTo(i,r):t.lineTo(i,r)}},drawPolygon:function(t,e){t.beginPath();for(var n=0;n<e.length;n++){var i=e[n];t.moveTo(i[0][0],i[0][1]);for(var r=1;r<i.length;r++)t.lineTo(i[r][0],i[r][1]);t.lineTo(i[0][0],i[0][1]),t.closePath()}}},Tt={draw:function(t,e,n){var i=e instanceof h?e.get():e;for(var r in t.save(),n)t[r]=n[r];if(n.bigData){t.save(),t.beginPath();for(var o=0,a=i.length;o<a;o++){var s=i[o];It.draw(t,s,n)}"Point"==(u=n.bigData)||"Polygon"==u||"MultiPolygon"==u?(t.fill(),t.lineDash&&t.setLineDash(t.lineDash),s.lineDash&&t.setLineDash(s.lineDash),(s.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()):"LineString"!=u&&"MultiLineString"!=u||t.stroke(),t.restore()}else for(o=0,a=i.length;o<a;o++){s=i[o],t.save(),(s.fillStyle||s._fillStyle)&&(t.fillStyle=s.fillStyle||s._fillStyle),(s.strokeStyle||s._strokeStyle)&&(t.strokeStyle=s.strokeStyle||s._strokeStyle),t.lineDash&&t.setLineDash(t.lineDash),s.lineDash&&t.setLineDash(s.lineDash);var u=s.geometry.type;t.beginPath(),n.multiPolygonDraw=function(){t.fill(),(s.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()},It.draw(t,s,n),"Point"==u||"Polygon"==u||"MultiPolygon"==u?(t.fill(),(s.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()):"LineString"!=u&&"MultiLineString"!=u||((s.lineWidth||s._lineWidth)&&(t.lineWidth=s.lineWidth||s._lineWidth),t.stroke()),t.restore()}t.restore()}};p.prototype.setMax=function(t){this.max=t||100},p.prototype.setMin=function(t){this.min=t||0},p.prototype.setMaxSize=function(t){this.maxSize=t||35},p.prototype.setMinSize=function(t){this.minSize=t||0},p.prototype.initPalette=function(){var t=this.gradient,e=new f(256,1),n=this.paletteCtx=e.getContext("2d"),i=n.createLinearGradient(0,0,256,1);for(var r in t)i.addColorStop(parseFloat(r),t[r]);n.fillStyle=i,n.fillRect(0,0,256,1)},p.prototype.getColor=function(t){var e=this.getImageData(t);return"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]/256+")"},p.prototype.getImageData=function(t){var e=this.paletteCtx.getImageData(0,0,256,1).data;if(void 0===t)return e;var n=this.max,i=this.min;n<t&&(t=n),t<i&&(t=i);var r=4*Math.floor((t-i)/(n-i)*255);return[e[r],e[1+r],e[2+r],e[3+r]]},p.prototype.getSize=function(t){var e=this.max,n=this.min,i=this.maxSize,r=this.minSize;return e<t&&(t=e),t<n&&(t=n),n<e?r+(t-n)/(e-n)*(i-r):i},p.prototype.getLegend=function(t){var e=this.gradient,n=t.width||20,i=t.height||180,r=new f(n,i),o=r.getContext("2d"),a=o.createLinearGradient(0,i,0,0);for(var s in e)a.addColorStop(parseFloat(s),e[s]);return o.fillStyle=a,o.fillRect(0,0,n,i),r};var Nt=("undefined"==typeof window?{}:window).devicePixelRatio||1,kt={draw:function(t,e,n){if(!(t.canvas.width<=0||t.canvas.height<=0)){var i=n.strength||.3;t.strokeStyle="rgba(0,0,0,"+i+")";var r=new f(t.canvas.width,t.canvas.height),o=r.getContext("2d");o.scale(Nt,Nt),n=n||{};var a=e instanceof h?e.get():e;t.save();var s=new p({gradient:n.gradient});if(y(o,a,n),!n.absolute){var u=o.getImageData(0,0,t.canvas.width,t.canvas.height);!function(t,e,n){var i=d(n),r=g(n),o=i-r,a=0,s=1024;(h=n.range||null)&&2===h.length&&(a=(h[0]-r)/o*1024),h&&2===h.length&&(s=(h[1]-r)/o*1024);for(var u,l=n.maxOpacity||.8,c=n.minOpacity||0,h=n.range,f=3,p=t.length;f<p;f+=4)u=4*t[f],t[f]/256>l&&(t[f]=256*l),t[f]/256<c&&(t[f]=256*c),u&&a<=u&&u<=s?(t[f-3]=e[u],t[f-2]=e[1+u],t[f-1]=e[2+u]):t[f]=0}(u.data,s.getImageData(),n),t.putImageData(u,0,0),t.restore()}r=s=null}}},Ot={draw:function(t,e,n){t.save();var i=e instanceof h?e.get():e,r={},o=n._size||n.size||50,a=!("enableCluster"in n)||n.enableCluster,s=n.offset||{x:0,y:0},u=new p({min:n.min||0,max:n.max||100,gradient:n.gradient});if(a){for(var l=0;l<i.length;l++)d=i[l].geometry._coordinates||i[l].geometry.coordinates,r[y=Math.floor((d[0]-s.x)/o)+","+Math.floor((d[1]-s.y)/o)]||(r[y]=0),r[y]+=~~(i[l].count||1);for(var c in r)c=c.split(","),t.beginPath(),t.rect(c[0]*o+.5+s.x,c[1]*o+.5+s.y,o,o),t.fillStyle=u.getColor(r[c]),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}else{for(var f=0;f<i.length;f++){var d;r[y=(d=i[f].geometry._coordinates||i[f].geometry.coordinates).join(",")]=i[f].count||1}for(var g in r)g=g.split(","),t.beginPath(),t.rect(g[0]-o/2,g[1]-o/2,o,o),t.fillStyle=u.getColor(r[g]),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}if(n.label&&!1!==n.label.show)for(var y in t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur),r){var m=r[y=y.split(",")],v=t.measureText(m).width;a?t.fillText(m,y[0]*o+.5+s.x+o/2-v/2,y[1]*o+.5+s.y+o/2+5):t.fillText(m,y[0]-v/2,+y[1]+5)}t.restore()}},Dt={draw:function(t,e,n){t.save();var i=e instanceof h?e.get():e;for(var r in n)t[r]=n[r];for(var o=n.offset||{x:10,y:10},a=n._size||n.size||40,s=2*(a=a/2/Math.sin(Math.PI/3))*Math.sin(Math.PI/3),u=1.5*a,l={},c=0;c<i.length;c++){var f=i[c].geometry._coordinates||i[c].geometry.coordinates,d=(f[1]-o.y)/u,g=Math.round(d),y=(f[0]-o.x)/s-(1&g?.5:0),m=Math.round(y),v=d-g;if(1<3*Math.abs(v)){var _=y-m,w=m+(y<m?-1:1)/2,b=g+(d<g?-1:1),C=y-w,x=d-b;C*C+x*x<_*_+v*v&&(m=w+(1&g?1:-1)/2,g=b)}var E=m+"-"+g,S=l[E];S?S.push(i[c]):((S=l[E]=[i[c]]).i=m,S.j=g,S.x=(m+(1&g?.5:0))*s,S.y=g*u)}var P,M,L,I,T=new p({max:n.max||100,maxSize:a,gradient:n.gradient});for(var r in l){var N=l[r];t.beginPath();for(var k=0;k<6;k++){var O=(P={x:N.x+o.x,y:N.y+o.y},M=a,L=60*k+30,I=Math.PI/180*L,[P.x+M*Math.cos(I),P.y+M*Math.sin(I)]);t.lineTo(O[0],O[1])}t.closePath();var D=0;for(c=0;c<N.length;c++)D+=N[c].count||1;N.count=D,t.fillStyle=T.getColor(D),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}if(n.label&&!1!==n.label.show)for(var r in t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur),l){var A=(N=l[r]).count;A=A<0?A.toFixed(2):~~A;var R=t.measureText(A).width;t.fillText(A,N.x+o.x-R/2,N.y+o.y+5)}t.restore()}},At=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),Rt=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join(""),Ft={draw:function(t,e,n){if(e){var i=v(t,At,Rt);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),t.clear(t.COLOR_BUFFER_BIT);var r=t.canvas.width/2,o=t.canvas.height/2,a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a);var s=t.getAttribLocation(i,"a_Position");t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(s);var u=t.getUniformLocation(i,"u_FragColor"),l=_(n.strokeStyle||"red");t.uniform4f(u,l[0]/255,l[1]/255,l[2]/255,l[3]/255),t.lineWidth(n.lineWidth||1);for(var c=0,h=e.length;c<h;c++){for(var f=e[c].geometry._coordinates,p=[],d=0;d<f.length;d++){var g=f[d],y=(g[0]-r)/r,m=(o-g[1])/o;p.push(y,m)}var w=new Float32Array(p);t.bufferData(t.ARRAY_BUFFER,w,t.STATIC_DRAW),t.drawArrays(t.LINE_STRIP,0,f.length)}}}},jt=["attribute vec4 a_Position;","attribute float a_PointSize;","void main() {","gl_Position = a_Position;","gl_PointSize = a_PointSize;","}"].join(""),zt=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join(""),Bt={draw:function(t,e,n){if(e){var i=v(t,jt,zt),r=t.getAttribLocation(i,"a_Position"),o=t.getAttribLocation(i,"a_PointSize"),a=t.getUniformLocation(i,"u_FragColor");t.clear(t.COLOR_BUFFER_BIT);for(var s=t.canvas.width/2,u=t.canvas.height/2,l=[],c=0,h=0;h<e.length;h++){var f=e[h].geometry._coordinates,p=(f[0]-s)/s,d=(u-f[1])/u;p<-1||1<p||d<-1||1<d||(l.push(p,d),c++)}var g=new Float32Array(l),y=c,m=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,g,t.STATIC_DRAW),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r),t.vertexAttrib1f(o,n._size);var w=_(n.fillStyle||"red");t.uniform4f(a,w[0]/255,w[1]/255,w[2]/255,w[3]/255),t.drawArrays(t.POINTS,0,y)}}};w.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(H(t,0,o,n));if(r)for(var s=0,u=e.length;s<u;s++){var l=e[s]*n,c=s<u-1?e[s+1]*n:t.length;a-=Math.abs(H(t,l,c,n))}var h=0;for(s=0;s<i.length;s+=3){var f=i[s]*n,p=i[s+1]*n,d=i[s+2]*n;h+=Math.abs((t[f]-t[d])*(t[1+p]-t[1+f])-(t[f]-t[p])*(t[1+d]-t[1+f]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},w.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);0<r&&(i+=t[r-1].length,n.holes.push(i))}return n};var Gt=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),Ut=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join(""),Ht={draw:function(t,e,n){if(e){t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,t.canvas.width,t.canvas.height);var i=v(t,Gt,Ut);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE);var r=t.canvas.width/2,o=t.canvas.height/2;t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,t.createBuffer());var a=t.getAttribLocation(i,"a_Position");t.vertexAttribPointer(a,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(a);var s=t.getUniformLocation(i,"u_FragColor"),u=_(n.fillStyle||"red");t.uniform4f(s,u[0]/255,u[1]/255,u[2]/255,u[3]/255),t.lineWidth(n.lineWidth||1);for(var l=[],c=[],h=0,f=0,p=e.length;f<p;f++){var d=w.flatten(e[f].geometry._coordinates||e[f].geometry.coordinates),g=d.vertices;h=l.length/2;for(var y=0;y<g.length;y+=2)g[y]=(g[y]-r)/r,g[y+1]=(o-g[y+1])/o;for(65536<(l.length+g.length)/2&&(t.bufferData(t.ARRAY_BUFFER,new Float32Array(l),t.STATIC_DRAW),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,c.length,t.UNSIGNED_SHORT,0),l.length=0,h=c.length=0),y=0;y<g.length;y++)l.push(g[y]);var m=w(g,d.holes,d.dimensions);for(y=0;y<m.length;y++)c.push(m[y]+h)}t.bufferData(t.ARRAY_BUFFER,new Float32Array(l),t.STATIC_DRAW),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,c.length,t.UNSIGNED_SHORT,0),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}},qt={draw:function(t,e,n){var i=e instanceof h?e.get():e;0<i.length&&("LineString"==i[0].geometry.type?Ft.draw(t,i,n):"Polygon"==i[0].geometry.type||"MultiPolygon"==i[0].geometry.type?Ht.draw(t,i,n):Bt.draw(t,i,n))}},Vt={getPoints:function(t,e){e=e||{};for(var n=[],i=0;i<t.length-1;i++){var r=q(t[i],t[i+1],e.count);r&&0<r.length&&(n=n.concat(r))}return n}};V.prototype.get=function(t){var e=this.splitList,n=e.other;for(var i in e)if(t==i){n=e[i];break}return n},V.prototype.generateByDataSet=function(t,e){var n=e||["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],i=t.get();this.splitList={};for(var r=0,o=0;o<i.length&&(void 0===this.splitList[i[o].count]&&(this.splitList[i[o].count]=n[r],r++),!(n.length-1<=r));o++);this.splitList.other=n[n.length-1]},V.prototype.getLegend=function(t){var e=this.splitList,n=document.createElement("div");n.style.cssText="background:#fff; padding: 5px; border: 1px solid #ccc;";var i="";for(var r in e)i+='<div style="line-height: 19px;" value="'+r+'"><span style="vertical-align: -2px; display: inline-block; width: 30px;height: 19px;background:'+e[r]+';"></span><span style="margin-left: 3px;">'+r+"<span></div>";return n.innerHTML=i,n},W.prototype.get=function(t){for(var e=this.splitList,n=!1,i=0;i<e.length;i++)if((void 0===e[i].start||void 0!==e[i].start&&t>=e[i].start)&&(void 0===e[i].end||void 0!==e[i].end&&t<e[i].end)){n=e[i].value;break}return n},W.prototype.generateByDataSet=function(t){var e=t.getMin("count"),n=t.getMax("count");this.generateByMinMax(e,n)},W.prototype.generateByMinMax=function(t,e){var n=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],i=Number((e-t)/7);e=Number(e);var r=Number(t);this.splitList=[];for(var o=0;r<e;)this.splitList.push({start:r,end:r+i,value:n[o]}),o++,r+=i},W.prototype.getLegend=function(t){this.splitList};var Wt=(Mt(Y,[{key:"addLayer",value:function(t,e){if("baidu"==this.type)return new mapv.baiduMapLayer(this.map,dataSet,e)}},{key:"getMap",value:function(){return this.map}}]),Y),Yt="undefined"==typeof window?{}:window,Xt=Yt.BMap||Yt.BMapGL;Xt&&((X.prototype=new Xt.Overlay).initialize=function(t){this._map=t;var e=this.canvas=document.createElement("canvas");e.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";user-select:none;",e.style.mixBlendMode=this.mixBlendMode,this.adjustSize();var n=t.getPanes()[this.paneName];(n=n||t.getPanes().floatShadow).appendChild(e);var i=this;return t.addEventListener("resize",function(){i.adjustSize(),i._draw()}),t.addEventListener("update",function(){i._draw()}),this.options.updateImmediate&&setTimeout(function(){i._draw()},100),this.canvas},X.prototype.adjustSize=function(){var t=this._map.getSize(),e=this.canvas,n=this.devicePixelRatio=Yt.devicePixelRatio||1;e.width=t.width*n,e.height=t.height*n,"2d"==this.context&&e.getContext(this.context).scale(n,n),e.style.width=t.width+"px",e.style.height=t.height+"px"},X.prototype.draw=function(){var t=this;this.options.updateImmediate?t._draw():(clearTimeout(t.timeoutID),t.timeoutID=setTimeout(function(){t._draw()},15))},X.prototype._draw=function(){var t=this._map,e=t.getSize(),n=t.getCenter();if(n){var i=t.pointToOverlayPixel(n);this.canvas.style.left=i.x-e.width/2+"px",this.canvas.style.top=i.y-e.height/2+"px",this.dispatchEvent("draw"),this.options.update&&this.options.update.call(this)}},X.prototype.getContainer=function(){return this.canvas},X.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},X.prototype.hide=function(){this.canvas.style.display="none"},X.prototype.setZIndex=function(t){this.zIndex=t,this.canvas.style.zIndex=this.zIndex},X.prototype.getZIndex=function(){return this.zIndex});var Zt,Jt,Kt=Kt||(Zt=[],{getAll:function(){return Zt},removeAll:function(){Zt=[]},add:function(t){Zt.push(t)},remove:function(t){var e=Zt.indexOf(t);-1!==e&&Zt.splice(e,1)},update:function(t,e){if(0===Zt.length)return!1;var n=0;for(t=void 0!==t?t:Kt.now();n<Zt.length;)Zt[n].update(t)||e?n++:Zt.splice(n,1);return!0}});"undefined"==typeof window&&"undefined"!=typeof n?Kt.now=function(){var t=n.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?Kt.now=window.performance.now.bind(window.performance):void 0!==Date.now?Kt.now=Date.now:Kt.now=function(){return(new Date).getTime()},Kt.Tween=function(t){var e,n=t,i={},r={},o={},a=1e3,s=0,u=!1,l=!1,c=!1,h=0,f=null,p=Kt.Easing.Linear.None,d=Kt.Interpolation.Linear,g=[],y=null,m=!1,v=null,_=null,w=null;this.to=function(t,e){return r=t,void 0!==e&&(a=e),this},this.start=function(t){for(var e in Kt.add(this),m=!(l=!0),f=void 0!==t?t:Kt.now(),f+=h,r){if(r[e]instanceof Array){if(0===r[e].length)continue;r[e]=[n[e]].concat(r[e])}void 0!==n[e]&&(i[e]=n[e],i[e]instanceof Array==0&&(i[e]*=1),o[e]=i[e]||0)}return this},this.stop=function(){return l&&(Kt.remove(this),l=!1,null!==w&&w.call(n,n),this.stopChainedTweens()),this},this.end=function(){return this.update(f+a),this},this.stopChainedTweens=function(){for(var t=0,e=g.length;t<e;t++)g[t].stop()},this.delay=function(t){return h=t,this},this.repeat=function(t){return s=t,this},this.repeatDelay=function(t){return e=t,this},this.yoyo=function(t){return u=t,this},this.easing=function(t){return p=t,this},this.interpolation=function(t){return d=t,this},this.chain=function(){return g=arguments,this},this.onStart=function(t){return y=t,this},this.onUpdate=function(t){return v=t,this},this.onComplete=function(t){return _=t,this},this.onStop=function(t){return w=t,this},this.update=function(t){var l,w,b;if(t<f)return!0;for(l in!1===m&&(null!==y&&y.call(n,n),m=!0),b=p(w=1<(w=(t-f)/a)?1:w),r)if(void 0!==i[l]){var C=i[l]||0,x=r[l];x instanceof Array?n[l]=d(x,b):("string"==typeof x&&(x="+"===x.charAt(0)||"-"===x.charAt(0)?C+parseFloat(x):parseFloat(x)),"number"==typeof x&&(n[l]=C+(x-C)*b))}if(null!==v&&v.call(n,b),1!==w)return!0;if(0<s){for(l in isFinite(s)&&s--,o){if("string"==typeof r[l]&&(o[l]=o[l]+parseFloat(r[l])),u){var E=o[l];o[l]=r[l],r[l]=E}i[l]=o[l]}return u&&(c=!c),f=void 0!==e?t+e:t+h,!0}null!==_&&_.call(n,n);for(var S=0,P=g.length;S<P;S++)g[S].start(f+a);return!1}},Kt.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-Kt.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Kt.Easing.Bounce.In(2*t):.5*Kt.Easing.Bounce.Out(2*t-1)+.5}}},Kt.Interpolation={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=Kt.Interpolation.Utils.Linear;return e<0?o(t[0],t[1],i):1<e?o(t[n],t[n-1],n-i):o(t[r],t[n<r+1?n:r+1],i-r)},Bezier:function(t,e){for(var n=0,i=t.length-1,r=Math.pow,o=Kt.Interpolation.Utils.Bernstein,a=0;a<=i;a++)n+=r(1-e,i-a)*r(e,a)*t[a]*o(i,a);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=Kt.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),o(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-i)-t[0]):1<e?t[n]-(o(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):o(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=Kt.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(Jt=[1],function(t){var e=1;if(Jt[t])return Jt[t];for(var n=t;1<n;n--)e*=n;return Jt[t]=e}),CatmullRom:function(t,e,n,i,r){var o=.5*(n-t),a=.5*(i-e),s=r*r;return(2*e-2*n+o+a)*(r*s)+(-3*e+3*n-2*o-a)*s+o*r+e}}};var $t={},Qt={draw:function(t,e,n){var i="http://huiyan.baidu.com/github/tools/gis-drawing/static/images/direction.png";n.arrow&&n.arrow.url&&(i=n.arrow.url),$t[i]||($t[i]=null);var r=$t[i];if(!r){var o=Array.prototype.slice.call(arguments),a=new Image;return a.onload=function(){$t[i]=a,Qt.draw.apply(null,o);
},void(a.src=i)}var s=e instanceof h?e.get():e;for(var u in t.save(),n)t[u]=n[u];for(var l,c,f,p,d,g,y,m=[],v=null,_=0,w=s.length;_<w;_++){var b=s[_];t.save(),(b.fillStyle||b._fillStyle)&&(t.fillStyle=b.fillStyle||b._fillStyle),(b.strokeStyle||b._strokeStyle)&&(t.strokeStyle=b.strokeStyle||b._strokeStyle);var C=b.geometry.type;if(t.beginPath(),"LineString"===C)for(var x=b.geometry._coordinates||b.geometry.coordinates,E=void 0!==n.arrow.interval?n.arrow.interval:1,S=0;S<x.length;S+=E)if(x[S]&&x[S+1]){var P=x[S];if(v&&(g=P,y=v,Math.sqrt(Math.pow(g[0]-y[0],2)+Math.pow(g[1]-y[1],2))<30))continue;t.save();var M=(l=x[S],c=x[S+1],d=void 0,f=c[0]-l[0],p=c[1]-l[1],d=360*Math.atan(p/f)/(2*Math.PI),c[0]<l[0]&&(d+=180),d);t.translate(P[0],P[1]),t.rotate(M*Math.PI/180),t.drawImage(r,-r.width/2/2,-r.height/2/2,r.width/2,r.height/2),t.restore(),m.push(P),v=P}t.restore()}t.restore()}},te=function(t,n,i){var r=n instanceof h?n.get():n;t.save(),t.fillStyle=i.fillStyle||"rgba(0, 0, 0, 0.5)",t.fillRect(0,0,t.canvas.width,t.canvas.height),i.multiPolygonDraw=function(){t.save(),t.clip(),e(t),t.restore()};for(var o=0,a=r.length;o<a;o++)t.beginPath(),It.drawDataSet(t,[r[o]],i),t.save(),t.clip(),e(t),t.restore();t.restore()},ee={},ne={},ie={draw:function(t,e,n){t.save();for(var i=e instanceof h?e.get():e,r=0;r<i.length;r++){var o=i[r],a=o.geometry._coordinates||o.geometry.coordinates;if(t.beginPath(),o.properties&&o.properties.cluster){if(t.arc(a[0],a[1],o.size,0,2*Math.PI),t.fillStyle=o.fillStyle,t.fill(),n.label&&!1!==n.label.show){t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur);var s=o.properties.point_count,u=t.measureText(s).width;t.fillText(s,a[0]+.5-u/2,a[1]+.5+3)}}else this.drawIcon(o,n,t)}t.restore()},drawIcon:function(t,e,n){function i(){n.beginPath(),n.arc(a,s,e.size||5,0,2*Math.PI),n.fillStyle=e.fillStyle||"red",n.fill()}var r=t.geometry._coordinates||t.geometry.coordinates,o=Lt(r,2),a=o[0],s=o[1],u=Object.assign({},e.iconOptions,t.iconOptions);if(u.url){var l=u.width,c=u.height,h=u.offset||{x:0,y:0};a=a-~~l/2+h.x,s=s-~~c/2+h.y;var f,p,d,g,y,m,v,_,w=window.encodeURIComponent(u.url),b=ee[w];b?"error"===b?i():l&&c?n.drawImage(b,a,s,l,c):n.drawImage(b,a,s):(ne[w]||(ne[w]=[],y=w,m=function(t,e){ne[e]&&ne[e].forEach(function(e){return e(t)}),ne[e]=null,ee[e]=t},v=function(t){ne[t]&&ne[t].forEach(function(e){return e("error",t)}),ne[t]=null,ee[t]="error",i()},(_=new Image).onload=function(){m&&m(_,y)},_.onerror=function(){v&&v(y)},_.src=window.decodeURIComponent(y)),ne[w].push((f=a,p=s,d=l,g=c,function(t){"error"===t?i():d&&g?n.drawImage(t,f,p,d,g):n.drawImage(t,f,p)})))}else i()}},re=function(t,e,n){var i=e instanceof h?e.get():e;for(var r in t.save(),n)t[r]=n[r];var o=[],a=n._size||n.size;a?t.font="bold "+a+"px Arial":a=12;var s=n.textKey||"text";if(n.textAlign||(t.textAlign="center"),n.textBaseline||(t.textBaseline="middle"),n.avoid)for(var u=0,l=i.length;u<l;u++){var c=i[u].offset||n.offset||{x:0,y:0},f=(_=i[u].geometry._coordinates||i[u].geometry.coordinates)[0]+c.x,p=_[1]+c.y,d=i[u][s],g=t.measureText(d).width,y=f-g/2,m=p-a/2,v={sw:{x:y,y:m+a},ne:{x:y+g,y:m}};Z(o,v)||(o.push(v),y+=g/2,m+=a/2,t.fillText(d,y,m))}else for(u=0,l=i.length;u<l;u++){var _;c=i[u].offset||n.offset||{x:0,y:0},f=(_=i[u].geometry._coordinates||i[u].geometry.coordinates)[0]+c.x,p=_[1]+c.y,d=i[u][s],t.fillText(d,f,p)}t.restore()},oe={},ae={},se=function(t,e,n){for(var i=e instanceof h?e.get():e,r=function e(){var r,e,a,u,l=i[o];if(l.geometry)if("string"==typeof(s=l.icon||n.icon)){var c=window.encodeURIComponent(s),h=oe[c];h?K(h,n,t,l):(ae[c]||(ae[c]=[],r=c,e=function(t,e){ae[e]&&ae[e].forEach(function(e){return e(t)}),ae[e]=null,oe[e]=t},a=function(t){ae[t]&&ae[t].forEach(function(t){return t("error")}),ae[t]=null,oe[t]="error"},(u=new Image).onload=function(){e&&e(u,r)},u.onerror=function(){a&&a(r)},u.src=window.decodeURIComponent(r)),ae[c].push(function(e){K(e,n,t,l)}))}else K(s,n,t,l)},o=0,a=i.length;o<a;o++){var s;r()}};rt.prototype.range=function(t,e,n,i){return function(t,e,n,i,r,o,a){for(var s,u,l=[0,t.length-1,0],c=[];l.length;){var h=l.pop(),f=l.pop(),p=l.pop();if(f-p<=a)for(var d=p;d<=f;d++)s=e[2*d],u=e[2*d+1],n<=s&&s<=r&&i<=u&&u<=o&&c.push(t[d]);else{var g=Math.floor((p+f)/2);s=e[2*g],u=e[2*g+1],n<=s&&s<=r&&i<=u&&u<=o&&c.push(t[g]);var y=(h+1)%2;(0===h?n<=s:i<=u)&&(l.push(p),l.push(g-1),l.push(y)),(0===h?s<=r:u<=o)&&(l.push(g+1),l.push(f),l.push(y))}}return c}(this.ids,this.coords,t,e,n,i,this.nodeSize)};var ue={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!(rt.prototype.within=function(t,e,n){return function(t,e,n,i,r,o){for(var a=[0,t.length-1,0],s=[],u=r*r;a.length;){var l=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o)for(var f=h;f<=c;f++)et(e[2*f],e[2*f+1],n,i)<=u&&s.push(t[f]);else{var p=Math.floor((h+c)/2),d=e[2*p],g=e[2*p+1];et(d,g,n,i)<=u&&s.push(t[p]);var y=(l+1)%2;(0===l?n-r<=d:i-r<=g)&&(a.push(h),a.push(p-1),a.push(y)),(0===l?d<=n+r:g<=i+r)&&(a.push(p+1),a.push(c),a.push(y))}}return s}(this.ids,this.coords,t,e,n,this.nodeSize)}),generateId:!1,reduce:null,map:function(t){return t}};ot.prototype.load=function(t){var e=this.options,n=(e.log,e.minZoom),i=e.maxZoom,r=e.nodeSize;t.length,this.points=t;for(var o,a,s,u,l,c=[],h=0;h<t.length;h++)t[h].geometry&&c.push((o=t[h],a=h,s=o.geometry.coordinates,u=s[0],l=s[1],{x:ut(u),y:lt(l),zoom:1/0,index:a,parentId:-1}));this.trees[i+1]=new rt(c,ht,ft,r,Float32Array);for(var f=i;n<=f;f--)Date.now(),c=this._cluster(c,f),this.trees[f]=new rt(c,ht,ft,r,Float32Array);return this},ot.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),r=180===t[2]?180:((t[2]+180)%360+360)%360-180,o=Math.max(-90,Math.min(90,t[3]));if(360<=t[2]-t[0])n=-180,r=180;else if(r<n){var a=this.getClusters([n,i,180,o],e),s=this.getClusters([-180,i,r,o],e);return a.concat(s)}for(var u=this.trees[this._limitZoom(e)],l=[],c=0,h=u.range(ut(n),lt(o),ut(r),lt(i));c<h.length;c+=1){var f=h[c],p=u.points[f];l.push(p.numPoints?at(p):this.points[p.index])}return l},ot.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);var o=r.points[e];if(!o)throw new Error(i);for(var a=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=[],u=0,l=r.within(o.x,o.y,a);u<l.length;u+=1){var c=l[u],h=r.points[c];h.parentId===t&&s.push(h.numPoints?at(h):this.points[h.index])}if(0===s.length)throw new Error(i);return s},ot.prototype.getLeaves=function(t,e,n){e=e||10,n=n||0;var i=[];return this._appendLeaves(i,t,e,n,0),i},ot.prototype.getTile=function(t,e,n){var i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),o=this.options,a=o.extent,s=o.radius/a,u=(n-s)/r,l=(n+1+s)/r,c={features:[]};return this._addTileFeatures(i.range((e-s)/r,u,(e+1+s)/r,l),i.points,e,n,r,c),0===e&&this._addTileFeatures(i.range(1-s/r,u,1,l),i.points,r,n,r,c),e===r-1&&this._addTileFeatures(i.range(0,u,s/r,l),i.points,-1,n,r,c),c.features.length?c:null},ot.prototype.getClusterExpansionZoom=function(t){for(var e=this._getOriginZoom(t)-1;e<=this.options.maxZoom;){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},ot.prototype._appendLeaves=function(t,e,n,i,r){for(var o=0,a=this.getChildren(e);o<a.length;o+=1){var s=a[o],u=s.properties;if(u&&u.cluster?r+u.point_count<=i?r+=u.point_count:r=this._appendLeaves(t,u.cluster_id,n,i,r):r<i?r++:t.push(s),t.length===n)break}return r},ot.prototype._addTileFeatures=function(t,e,n,i,r,o){for(var a=0,s=t;a<s.length;a+=1){var u=e[s[a]],l=u.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(u.x*r-n)),Math.round(this.options.extent*(u.y*r-i))]],tags:l?st(u):this.points[u.index].properties},h=void 0;l?h=u.id:this.options.generateId?h=u.index:this.points[u.index].id&&(h=this.points[u.index].id),void 0!==h&&(c.id=h),o.features.push(c)}},ot.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},ot.prototype._cluster=function(t,e){for(var n=[],i=this.options,r=i.radius,o=i.extent,a=i.reduce,s=i.minPoints,u=r/(o*Math.pow(2,e)),l=0;l<t.length;l++){var c=t[l];if(!(c.zoom<=e)){c.zoom=e;for(var h=this.trees[e+1],f=h.within(c.x,c.y,u),p=c.numPoints||1,d=p,g=0,y=f;g<y.length;g+=1){var m=y[g],v=h.points[m];v.zoom>e&&(d+=v.numPoints||1)}if(s<=d){for(var _=c.x*p,w=c.y*p,b=a&&1<p?this._map(c,!0):null,C=(l<<5)+(e+1)+this.points.length,x=0,E=f;x<E.length;x+=1){var S=E[x],P=h.points[S];if(!(P.zoom<=e)){P.zoom=e;var M=P.numPoints||1;_+=P.x*M,w+=P.y*M,P.parentId=C,a&&a(b=b||this._map(c,!0),this._map(P))}}c.parentId=C,n.push({x:_/d,y:w/d,zoom:1/0,id:C,parentId:-1,numPoints:d,properties:b})}else if(n.push(c),1<d)for(var L=0,I=f;L<I.length;L+=1){var T=I[L],N=h.points[T];N.zoom<=e||(N.zoom=e,n.push(N))}}}return n},ot.prototype._getOriginId=function(t){return t-this.points.length>>5},ot.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},ot.prototype._map=function(t,e){if(t.numPoints)return e?ct({},t.properties):t.properties;var n=this.points[t.index].properties,i=this.options.map(n);return e&&i===n?ct({},i):i},"undefined"!=typeof window&&requestAnimationFrame(function t(e){requestAnimationFrame(t),Kt.update(e)});var le=(Mt(pt,[{key:"refreshCluster",value:function(t){t=t||this.options,this.supercluster=new ot({maxZoom:t.maxZoom||19,radius:t.clusterRadius||100,minPoints:t.minPoints||2,extent:t.extent||512}),this.supercluster.load(this.dataSet.get()),this.supercluster.trees.forEach(function(t){var e=0,n=1/0;t.points.forEach(function(t){e=Math.max(t.numPoints||0,e),n=Math.min(t.numPoints||1/0,n)}),t.max=e,t.min=n}),this.clusterDataSet=new h}},{key:"getDefaultContextConfig",value:function(){return{globalAlpha:1,globalCompositeOperation:"source-over",imageSmoothingEnabled:!0,strokeStyle:"#000000",fillStyle:"#000000",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,lineDashOffset:0,font:"10px sans-serif",textAlign:"start",textBaseline:"alphabetic"}}},{key:"initDataRange",value:function(){var t=this;if(t.intensity=new p({maxSize:t.options.maxSize,minSize:t.options.minSize,gradient:t.options.gradient,max:t.options.max||this.dataSet.getMax("count")}),t.category=new V(t.options.splitList),t.choropleth=new W(t.options.splitList),void 0===t.options.splitList&&t.category.generateByDataSet(this.dataSet,t.options.color),void 0===t.options.splitList){var e=t.options.min||this.dataSet.getMin("count"),n=t.options.max||this.dataSet.getMax("count");t.choropleth.generateByMinMax(e,n)}}},{key:"getLegend",value:function(t){return this.options.draw,"intensity"==this.options.draw||"heatmap"==this.options.draw?this.intensity.getLegend(t):"category"==this.options.draw?this.category.getLegend(t):void 0}},{key:"processData",value:function(t){var e=this,n=e.options.draw;if("bubble"==n||"intensity"==n||"category"==n||"choropleth"==n||"simple"==n)for(var i=0;i<t.length;i++){var r=t[i];"bubble"==e.options.draw?t[i]._size=e.intensity.getSize(r.count):t[i]._size=void 0;var o="_fillStyle";"LineString"!==t[i].geometry.type&&"stroke"!==e.options.styleType||(o="_strokeStyle"),"intensity"==e.options.draw?t[i][o]=e.intensity.getColor(r.count):"category"==e.options.draw?t[i][o]=e.category.get(r.count):"choropleth"==e.options.draw&&(t[i][o]=e.choropleth.get(r.count))}}},{key:"isEnabledTime",value:function(){var t=this.options.animation;return t&&!(!1===t.enabled)}},{key:"argCheck",value:function(t){"heatmap"==t.draw&&t.strokeStyle&&console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")}},{key:"drawContext",value:function(t,e,n,i){var r=this;switch(r.options.draw){case"heatmap":kt.draw(t,e,r.options);break;case"grid":case"cluster":case"honeycomb":r.options.offset={x:i.x,y:i.y},"grid"===r.options.draw?Ot.draw(t,e,r.options):"cluster"===r.options.draw?ie.draw(t,e,r.options):Dt.draw(t,e,r.options);break;case"text":re(t,e,r.options);break;case"icon":se(t,e,r.options);break;case"clip":te(t,e,r.options);break;default:"webgl"==r.options.context?qt.draw(r.canvasLayer.canvas.getContext("webgl"),e,r.options):Tt.draw(t,e,r.options)}r.options.arrow&&!1!==r.options.arrow.show&&Qt.draw(t,e,r.options)}},{key:"isPointInPath",value:function(t,e){var n;t=this.canvasLayer.canvas.getContext(this.context),n="cluster"===this.options.draw&&(!this.options.maxClusterZoom||this.options.maxClusterZoom>=this.getZoom())?this.clusterDataSet.get():this.dataSet.get();for(var i=0;i<n.length;i++){t.beginPath();var r=this.options,o=e.x*this.canvasLayer.devicePixelRatio,a=e.y*this.canvasLayer.devicePixelRatio;if(r.multiPolygonDraw=function(){if(t.isPointInPath(o,a))return n[i]},It.draw(t,n[i],r),-1<(n[i].geometry&&n[i].geometry.type).indexOf("LineString")){if(t.isPointInStroke&&t.isPointInStroke(o,a))return n[i]}else if(t.isPointInPath(o,a))return n[i]}}},{key:"getClusterPoints",value:function(t){var e=this;return"Feature"!==t.type?[]:this.supercluster.getChildren(t.id).map(function(t){return"Feature"===t.type?e.getClusterPoints(t):t}).flat()}},{key:"clickEvent",value:function(t,e){if(this.options.methods){var n=this.isPointInPath(this.getContext(),t);if(n){if("cluster"===this.options.draw){var i=this.getClusterPoints(n);n.children=i}this.options.methods.click(n,e)}else this.options.methods.click(null,e)}}},{key:"mousemoveEvent",value:function(t,e){if(this.options.methods){var n=this.isPointInPath(this.getContext(),t);if(n){if("cluster"===this.options.draw){var i=this.getClusterPoints(n);n.children=i}this.options.methods.mousemove(n,e)}else this.options.methods.mousemove(null,e)}}},{key:"tapEvent",value:function(t,e){if(this.options.methods){var n=this.isPointInPath(this.getContext(),t);if(n){if("cluster"===this.options.draw){var i=this.getClusterPoints(n);n.children=i}this.options.methods.tap(n,e)}else this.options.methods.tap(null,e)}}},{key:"update",value:function(t,e){var n=t.options,i=this.options;for(var r in n)i[r]=n[r];this.init(i),!1!==e&&this.draw()}},{key:"setOptions",value:function(t){this.dataSet.reset(),this.init(t),this.draw()}},{key:"set",value:function(t){var e=this.getContext(),n=this.getDefaultContextConfig();for(var i in n)e[i]=n[i];this.init(t.options),this.draw()}},{key:"destroy",value:function(){this.unbindEvent(),this.hide()}},{key:"initAnimator",value:function(){var t=this,e=t.options.animation;if("time"==t.options.draw||t.isEnabledTime()){e.stepsRange||(e.stepsRange={start:this.dataSet.getMin("time")||0,end:this.dataSet.getMax("time")||0}),this.steps={step:e.stepsRange.start},t.animator=new Kt.Tween(this.steps).onUpdate(function(){t._canvasUpdate(this.step)}).repeat(1/0),this.addAnimatorEvent();var n=1e3*e.duration||5e3;t.animator.to({step:e.stepsRange.end},n),t.animator.start()}else t.animator&&t.animator.stop()}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start,this.animator.stop())}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator&&this.animator.start()}}]),pt),ce="undefined"==typeof window?{}:window,he=ce.BMap||ce.BMapGL,fe=(l(dt,le),Mt(dt,[{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),e.options.max&&this.intensity.setMax(e.options.max),e.options.min&&this.intensity.setMin(e.options.min),this.initAnimator()}},{key:"transferToMercator",value:function(){var t,e=this.map,n=e.getMapType();if(t=n.getProjection?n.getProjection():{lngLatToPoint:function(t){var n=e.lnglatToMercator(t.lng,t.lat);return{x:n[0],y:n[1]}}},"bd09mc"!==this.options.coordType){var i=this.dataSet.get();i=this.dataSet.transferCoordinate(i,function(e){var n=t.lngLatToPoint({lng:e[0],lat:e[1]});return[n.x,n.y]},"coordinates","coordinates_mercator"),this.dataSet._set(i)}}},{key:"_canvasUpdate",value:function(){var t=this.ctx;if(t){var n,i,r,o=this.map;o.getMapType().getProjection?i=(n=o.getMapType().getProjection()).lngLatToPoint(o.getCenter()):(-180<(i={x:o.getCenter().lng,y:o.getCenter().lat}).x&&i.x<180&&(i={x:(i=o.lnglatToMercator(i.x,i.y))[0],y:i[1]}),n={lngLatToPoint:function(t){var e=o.lnglatToMercator(t.lng,t.lat);return{x:e[0],y:e[1]}}}),r=n.getZoomUnits?n.getZoomUnits(o.getZoom()):Math.pow(2,18-o.getZoom());var a=new he.Pixel(i.x-o.getSize().width/2*r,i.y+o.getSize().height/2*r);e(t);var s={fromColumn:"bd09mc"==this.options.coordType?"coordinates":"coordinates_mercator",transferCoordinate:function(t){if(t)return[(t[0]-a.x)/r,(a.y-t[1])/r]}};this.data=this.dataSet.get(s),this.processData(this.data),this.drawAnimation()}}},{key:"drawAnimation",value:function(){var t=this.ctx,e=this.data;if(e){t.save(),t.globalCompositeOperation="destination-out",t.fillStyle="rgba(0, 0, 0, .1)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.restore(),t.save(),this.options.shadowColor&&(t.shadowColor=this.options.shadowColor),this.options.shadowBlur&&(t.shadowBlur=this.options.shadowBlur),this.options.globalAlpha&&(t.globalAlpha=this.options.globalAlpha),this.options.globalCompositeOperation&&(t.globalCompositeOperation=this.options.globalCompositeOperation);for(var n=this.options,i=0;i<e.length;i++)if("Point"===e[i].geometry.type){t.beginPath();var r=e[i].size||this.options.size,o=e[i].minSize||this.options.minSize||0;void 0===e[i]._size&&(e[i]._size=o),t.arc(e[i].geometry._coordinates[0],e[i].geometry._coordinates[1],e[i]._size,0,2*Math.PI,!0),t.closePath(),e[i]._size++,e[i]._size>r&&(e[i]._size=o),t.lineWidth=1,t.strokeStyle=e[i].strokeStyle||e[i]._strokeStyle||n.strokeStyle||"yellow",t.stroke(),(l=e[i].fillStyle||e[i]._fillStyle||n.fillStyle)&&(t.fillStyle=l,t.fill())}else if("LineString"===e[i].geometry.type){t.beginPath();var a=e[i].size||this.options.size||5;o=e[i].minSize||this.options.minSize||0,void 0===e[i]._index&&(e[i]._index=0);var s=e[i]._index;t.arc(e[i].geometry._coordinates[s][0],e[i].geometry._coordinates[s][1],a,0,2*Math.PI,!0),t.closePath(),e[i]._index++,e[i]._index>=e[i].geometry._coordinates.length&&(e[i]._index=0);var u=e[i].strokeStyle||n.strokeStyle,l=e[i].fillStyle||n.fillStyle||"yellow";t.fillStyle=l,t.fill(),u&&n.lineWidth&&(t.lineWidth=n.lineWidth||1,t.strokeStyle=u,t.stroke())}t.restore()}}},{key:"animate",value:function(){this.drawAnimation();var t=this.options.animateTime||100;this.timeout=setTimeout(this.animate.bind(this),t)}},{key:"start",value:function(){this.stop(),this.animate()}},{key:"stop",value:function(){clearTimeout(this.timeout)}},{key:"unbindEvent",value:function(){}},{key:"hide",value:function(){this.canvasLayer.hide(),this.stop()}},{key:"show",value:function(){this.start()}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"destroy",value:function(){this.stop(),this.unbindEvent(),this.clearData(),this.map.removeOverlay(this.canvasLayer),this.canvasLayer=null}}]),dt),pe="undefined"==typeof window?{}:window,de=pe.BMap||pe.BMapGL,ge=(l(gt,le),Mt(gt,[{key:"clickEvent",value:function(t){var e=t.pixel;u(gt.prototype.__proto__||Object.getPrototypeOf(gt.prototype),"clickEvent",this).call(this,e,t)}},{key:"mousemoveEvent",value:function(t){var e=t.pixel;u(gt.prototype.__proto__||Object.getPrototypeOf(gt.prototype),"mousemoveEvent",this).call(this,e,t)}},{key:"tapEvent",value:function(t){var e=t.pixel;u(gt.prototype.__proto__||Object.getPrototypeOf(gt.prototype),"tapEvent",this).call(this,e,t)}},{key:"bindEvent",value:function(){this.unbindEvent();var t=this.map,e=0,n=this;this.options.methods&&(this.options.methods.click&&(t.setDefaultCursor("default"),t.addEventListener("click",this.clickEvent)),this.options.methods.mousemove&&t.addEventListener("mousemove",this.mousemoveEvent),"ontouchend"in window.document&&this.options.methods.tap&&(t.addEventListener("touchstart",function(t){e=new Date}),t.addEventListener("touchend",function(t){new Date-e<300&&n.tapEvent(t)})))}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.removeEventListener("click",this.clickEvent),this.options.methods.mousemove&&t.removeEventListener("mousemove",this.mousemoveEvent))}},{key:"transferToMercator",value:function(t){t=t||this.dataSet;var e,n=this.map,i=n.getMapType();if(e=i.getProjection?i.getProjection():{lngLatToPoint:function(t){var e=n.lnglatToMercator(t.lng,t.lat);return{x:e[0],y:e[1]}}},"bd09mc"!==this.options.coordType){var r=t.get();r=t.transferCoordinate(r,function(t){if(t[0]<-180||180<t[0]||t[1]<-90||90<t[1])return t;var n=e.lngLatToPoint({lng:t[0],lat:t[1]});return[n.x,n.y]},"coordinates","coordinates_mercator"),t._set(r)}}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(t){if(this.canvasLayer){var n,i,r,o=this,a=this.options.animation,s=this.canvasLayer._map;s.getMapType().getProjection?i=(n=s.getMapType().getProjection()).lngLatToPoint(s.getCenter()):(-180<(i={x:s.getCenter().lng,y:s.getCenter().lat}).x&&i.x<180&&(i={x:(i=s.lnglatToMercator(i.x,i.y))[0],y:i[1]}),n={lngLatToPoint:function(t){var e=s.lnglatToMercator(t.lng,t.lat);return{x:e[0],y:e[1]}}}),r=n.getZoomUnits?n.getZoomUnits(s.getZoom()):Math.pow(2,18-s.getZoom());var u=new de.Pixel(i.x-s.getSize().width/2*r,i.y+s.getSize().height/2*r),l=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void e(l);"2d"==this.context&&(l.save(),l.globalCompositeOperation="destination-out",l.fillStyle="rgba(0, 0, 0, .1)",l.fillRect(0,0,l.canvas.width,l.canvas.height),l.restore())}else e(l);if("2d"==this.context)for(var c in this.options)l[c]=this.options[c];else l.clear(l.COLOR_BUFFER_BIT);if(!(this.options.minZoom&&s.getZoom()<this.options.minZoom||this.options.maxZoom&&s.getZoom()>this.options.maxZoom)){var h=1;"2d"!=this.context&&(h=this.canvasLayer.devicePixelRatio);var f,d={fromColumn:"bd09mc"==this.options.coordType?"coordinates":"coordinates_mercator",transferCoordinate:function(t){return[(t[0]-u.x)/r*h,(u.y-t[1])/r*h]}};void 0!==t&&(d.filter=function(e){var n=a.trails||10;return!!(t&&e.time>t-n&&e.time<t)});var g=this.getZoom();if("cluster"===this.options.draw&&(!this.options.maxClusterZoom||this.options.maxClusterZoom>=g)){var y=this.map.getBounds(),m=y.getNorthEast(),v=y.getSouthWest(),_=this.supercluster.getClusters([v.lng,v.lat,m.lng,m.lat],g);this.pointCountMax=this.supercluster.trees[g].max,this.pointCountMin=this.supercluster.trees[g].min;var w={},b=null,C=null;this.pointCountMax===this.pointCountMin?(b=this.options.fillStyle,C=this.options.minSize||8):w=new p({min:this.pointCountMin,max:this.pointCountMax,minSize:this.options.minSize||8,maxSize:this.options.maxSize||30,gradient:this.options.gradient});for(var x=0;x<_.length;x++){var E=_[x];E.properties&&E.properties.cluster_id?(_[x].size=C||w.getSize(E.properties.point_count),_[x].fillStyle=b||w.getColor(E.properties.point_count)):_[x].size=o.options.size}this.clusterDataSet.set(_),this.transferToMercator(this.clusterDataSet),f=o.clusterDataSet.get(d)}else f=o.dataSet.get(d);this.processData(f);var S=s.pointToPixel(new de.Point(0,0));"m"==o.options.unit?(o.options.size&&(o.options._size=o.options.size/r),o.options.width&&(o.options._width=o.options.width/r),o.options.height&&(o.options._height=o.options.height/r)):(o.options._size=o.options.size,o.options._height=o.options.height,o.options._width=o.options.width),this.drawContext(l,f,o.options,S),o.options.updateCallback&&o.options.updateCallback(t)}}}},{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),e.options.max&&this.intensity.setMax(e.options.max),e.options.min&&this.intensity.setMin(e.options.min),this.initAnimator(),this.bindEvent()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"addAnimatorEvent",value:function(){this.map.addEventListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addEventListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer),this.bindEvent()}},{key:"hide",value:function(){this.unbindEvent(),this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){this.canvasLayer&&this.canvasLayer.draw()}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"destroy",value:function(){this.unbindEvent(),this.clearData(),this.map.removeOverlay(this.canvasLayer),this.canvasLayer=null}}]),gt),ye="undefined"==typeof window?{}:window;ye.google&&ye.google.maps&&(yt.prototype=new google.maps.OverlayView,yt.DEFAULT_PANE_NAME_="overlayLayer",yt.CSS_TRANSFORM_=function(){for(var t=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],n=0;n<e.length;n++){var i=e[n];if(void 0!==t.style[i])return i}return e[0]}(),yt.prototype.requestAnimFrame_=ye.requestAnimationFrame||ye.webkitRequestAnimationFrame||ye.mozRequestAnimationFrame||ye.oRequestAnimationFrame||ye.msRequestAnimationFrame||function(t){return ye.setTimeout(t,1e3/60)},yt.prototype.cancelAnimFrame_=ye.cancelAnimationFrame||ye.webkitCancelAnimationFrame||ye.mozCancelAnimationFrame||ye.oCancelAnimationFrame||ye.msCancelAnimationFrame||function(t){},yt.prototype.setOptions=function(t){void 0!==t.animate&&this.setAnimate(t.animate),void 0!==t.paneName&&this.setPaneName(t.paneName),void 0!==t.updateHandler&&this.setUpdateHandler(t.updateHandler),void 0!==t.resizeHandler&&this.setResizeHandler(t.resizeHandler),void 0!==t.resolutionScale&&this.setResolutionScale(t.resolutionScale),void 0!==t.map&&this.setMap(t.map)},yt.prototype.setAnimate=function(t){this.isAnimated_=!!t,this.isAnimated_&&this.scheduleUpdate()},yt.prototype.isAnimated=function(){return this.isAnimated_},yt.prototype.setPaneName=function(t){this.paneName_=t,this.setPane_()},yt.prototype.getPaneName=function(){return this.paneName_},yt.prototype.setPane_=function(){if(this.isAdded_){var t=this.getPanes();if(!t[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');t[this.paneName_].appendChild(this.canvas)}},yt.prototype.setResizeHandler=function(t){this.resizeHandler_=t},yt.prototype.setResolutionScale=function(t){"number"==typeof t&&(this.resolutionScale_=t,this.resize_())},yt.prototype.setUpdateHandler=function(t){this.updateHandler_=t},yt.prototype.onAdd=function(){this.isAdded_||(this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_())},yt.prototype.onRemove=function(){this.isAdded_&&(this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(ye,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null))},yt.prototype.resize_=function(){if(this.isAdded_){var t=this.getMap(),e=t.getDiv().offsetWidth,n=t.getDiv().offsetHeight,i=e*this.resolutionScale_,r=n*this.resolutionScale_,o=this.canvas.width,a=this.canvas.height;o===i&&a===r||(this.canvas.width=i,this.canvas.height=r,this.needsResize_=!0,this.scheduleUpdate()),this.canvasCssWidth_===e&&this.canvasCssHeight_===n||(this.canvasCssWidth_=e,this.canvasCssHeight_=n,this.canvas.style.width=e+"px",this.canvas.style.height=n+"px")}},yt.prototype.draw=function(){this.repositionCanvas_()},yt.prototype.repositionCanvas_=function(){var t=this.getMap(),e=t.getBounds().getNorthEast().lat(),n=t.getCenter(),i=Math.pow(2,t.getZoom()),r=n.lng()-180*this.canvasCssWidth_/(256*i);this.topLeft_=new google.maps.LatLng(e,r);var o=this.getProjection().fromLatLngToDivPixel(n),a=-Math.round(this.canvasCssWidth_/2-o.x),s=-Math.round(this.canvasCssHeight_/2-o.y);this.canvas.style[yt.CSS_TRANSFORM_]="translate("+a+"px,"+s+"px)",this.scheduleUpdate()},yt.prototype.update_=function(){this.requestAnimationFrameId_=null,this.isAdded_&&(this.isAnimated_&&this.scheduleUpdate(),this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_())},yt.prototype.getTopLeft=function(){return this.topLeft_},yt.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(ye,this.requestUpdateFunction_))});var me,ve,_e=(l(mt,le),Mt(mt,[{key:"clickEvent",value:function(t){var e=t.pixel;u(mt.prototype.__proto__||Object.getPrototypeOf(mt.prototype),"clickEvent",this).call(this,e,t)}},{key:"mousemoveEvent",value:function(t){var e=t.pixel;u(mt.prototype.__proto__||Object.getPrototypeOf(mt.prototype),"mousemoveEvent",this).call(this,e,t)}},{key:"bindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&(t.setDefaultCursor("default"),t.addListener("click",this.clickEvent)),this.options.methods.mousemove&&t.addListener("mousemove",this.mousemoveEvent))}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.removeListener("click",this.clickEvent),this.options.methods.mousemove&&t.removeListener("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(t){if(this.canvasLayer){var n=this,i=n.options.animation,r=this.getContext();if(n.isEnabledTime()){if(void 0===t)return void e(r);"2d"==this.context&&(r.save(),r.globalCompositeOperation="destination-out",r.fillStyle="rgba(0, 0, 0, .1)",r.fillRect(0,0,r.canvas.width,r.canvas.height),r.restore())}else e(r);if("2d"==this.context)for(var o in n.options)r[o]=n.options[o];else r.clear(r.COLOR_BUFFER_BIT);if(!(n.options.minZoom&&s.getZoom()<n.options.minZoom||n.options.maxZoom&&s.getZoom()>n.options.maxZoom)){var a=1;"2d"!=this.context&&(a=this.canvasLayer.devicePixelRatio);var s=this.map,u=s.getProjection(),l=(a=Math.pow(2,s.zoom)*resolutionScale,u.fromLatLngToPoint(this.canvasLayer.getTopLeft())),c={transferCoordinate:function(t){var e=new google.maps.LatLng(t[1],t[0]),n=u.fromLatLngToPoint(e),i={x:(n.x-l.x)*a,y:(n.y-l.y)*a};return[i.x,i.y]}};void 0!==t&&(c.filter=function(e){var n=i.trails||10;return!!(t&&e.time>t-n&&e.time<t)});var f=n.dataSet.get(c);this.processData(f);var p=new google.maps.LatLng(0,0),d=u.fromLatLngToPoint(p),g={x:(d.x-l.x)*a,y:(d.y-l.y)*a};"m"==n.options.unit&&n.options.size?n.options._size=n.options.size/zoomUnit:n.options._size=n.options.size,this.drawContext(r,new h(f),n.options,g),n.options.updateCallback&&n.options.updateCallback(t)}}}},{key:"init",value:function(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer)}},{key:"hide",value:function(){this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){self.canvasLayer.draw()}}]),mt),we=void 0;if("undefined"!=typeof maptalks){ve=maptalks.Layer,l(_t,ve),Mt(_t,[{key:"_initBaseLayer",value:function(t){var e=this.baseLayer=new le(null,this.dataSet,t);
this.init(t),e.argCheck(t)}},{key:"clickEvent",value:function(t){if(this.baseLayer){var e=t.containerPoint;this.baseLayer.clickEvent(e,t.domEvent)}}},{key:"mousemoveEvent",value:function(t){if(this.baseLayer){var e=t.containerPoint;this.baseLayer.mousemoveEvent(e,t.domEvent)}}},{key:"getEvents",value:function(){return{click:this.clickEvent,mousemove:this.mousemoveEvent}}},{key:"init",value:function(t){var e=this.baseLayer;e.options=t,e.initDataRange(t),e.context=e.options.context||"2d",e.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}}]),we=_t;var be=(me=maptalks.renderer.CanvasRenderer,l(vt,me),Mt(vt,[{key:"needToRedraw",value:function(){return!!this.layer.baseLayer.isEnabledTime()||u(vt.prototype.__proto__||Object.getPrototypeOf(vt.prototype),"needToRedraw",this).call(this)}},{key:"draw",value:function(){var t=this.layer.baseLayer;this.canvas&&t.isEnabledTime()&&!this._shouldClear||(this.prepareCanvas(),this._shouldClear=!1),this._update(this.gl||this.context,this._mapvFrameTime),delete this._mapvFrameTime,this.completeRender()}},{key:"drawOnInteracting",value:function(){this.draw(),this._shouldClear=!1}},{key:"onSkipDrawOnInteracting",value:function(){this._shouldClear=!0}},{key:"_canvasUpdate",value:function(t){this.setToRedraw(),this._mapvFrameTime=t}},{key:"_update",value:function(t,n){if(this.canvas){var i=this.layer.baseLayer,r=i.options.animation,o=this.getMap();if(i.isEnabledTime()){if(void 0===n)return void e(t);"2d"==i.context&&(t.save(),t.globalCompositeOperation="destination-out",t.fillStyle="rgba(0, 0, 0, .1)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.restore())}else e(t);if("2d"==i.context)for(var a in i.options)t[a]=i.options[a];else t.clear(t.COLOR_BUFFER_BIT);var s=new maptalks.Coordinate(0,0),u={fromColumn:"bd09mc"===i.options.coordType?"coordinates_mercator":"coordinates",transferCoordinate:function(t){return s.x=t[0],s.y=t[1],o.coordToContainerPoint(s)._multi(1).toArray()}};void 0!==n&&(u.filter=function(t){var e=r.trails||10;return!!(n&&t.time>n-e&&t.time<n)});var l=i.dataSet.get(u);i.processData(l),"m"==i.options.unit?(i.options.size&&(i.options._size=i.options.size/zoomUnit),i.options.width&&(i.options._width=i.options.width/zoomUnit),i.options.height&&(i.options._height=i.options.height/zoomUnit)):(i.options._size=i.options.size,i.options._height=i.options.height,i.options._width=i.options.width);var c=new maptalks.Point(0,0),h=o._pointToContainerPoint(c)._multi(1);i.drawContext(t,l,i.options,h),i.options.updateCallback&&i.options.updateCallback(n)}}},{key:"createCanvas",value:function(){if(!this.canvas){var t=this.getMap(),e=t.getSize(),n=t.getDevicePixelRatio?t.getDevicePixelRatio():maptalks.Browser.retina?2:1,i=n*e.width,r=n*e.height;this.canvas=maptalks.Canvas.createCanvas(i,r,t.CanvasClass),"2d"===this.layer.baseLayer.context?(this.context=this.canvas.getContext("2d"),this.layer.options.globalCompositeOperation&&(this.context.globalCompositeOperation=this.layer.options.globalCompositeOperation),"heatmap"!==this.layer.baseLayer.options.draw&&1!==n&&this.context.scale(n,n)):this.gl=this.canvas.getContext("webgl",{alpha:!0,preserveDrawingBuffer:!0,antialias:!1}),this.onCanvasCreate(),this._bindToMapv(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})}}},{key:"_bindToMapv",value:function(){var t=this.layer.baseLayer,e=this.getMap();this.devicePixelRatio=e.getDevicePixelRatio?e.getDevicePixelRatio():maptalks.Browser.retina?2:1,t.canvasLayer=this,t._canvasUpdate=this._canvasUpdate.bind(this),t.getContext=function(){var t=self.getRenderer();return t.gl||t.context}}}]),vt);we.registerRenderer("canvas",be)}var Ce,xe=we,Ee=(l(wt,le),Mt(wt,[{key:"init",value:function(t){if(!t)throw new Error("not map object");this.map=t,this.context=this.options.context||"2d",this.getCanvasLayer()}},{key:"_canvasUpdate",value:function(t){this.render(this.canvasLayer.canvas,t)}},{key:"render",value:function(t,n){if(t){var i=this.map,r=t.getContext(this.context),o=this.options.animation;if(this.isEnabledTime()){if(void 0===n)return e(r),this;"2d"===this.context&&(r.save(),r.globalCompositeOperation="destination-out",r.fillStyle="rgba(0, 0, 0, .1)",r.fillRect(0,0,r.canvas.width,r.canvas.height),r.restore())}else e(r);if("2d"===this.context)for(var a in this.options)r[a]=this.options[a];else r.clear(r.COLOR_BUFFER_BIT);var s={transferCoordinate:function(t){var e=i.lngLatToContainer(new AMap.LngLat(t[0],t[1]));return[e.x,e.y]}};void 0!==n&&(s.filter=function(t){var e=o.trails||10;return!!(n&&t.time>n-e&&t.time<n)});var u=this.dataSet.get(s);return this.processData(u),"m"===this.options.unit?(this.options.size&&(this.options._size=this.options.size/zoomUnit),this.options.width&&(this.options._width=this.options.width/zoomUnit),this.options.height&&(this.options._height=this.options.height/zoomUnit)):(this.options._size=this.options.size,this.options._height=this.options.height,this.options._width=this.options.width),this.drawContext(r,new h(u),this.options,{x:0,y:0}),this.options.updateCallback&&this.options.updateCallback(n),this}}},{key:"getCanvasLayer",value:function(){if(!this.canvasLayer.canvas&&!this.layer_){var t=this.canvasFunction(),e=this.map.getBounds();this.layer_=new AMap.CanvasLayer({canvas:t,bounds:this.options.bounds||e,zooms:this.options.zooms||[0,22]}),this.layer_.setMap(this.map),this.map.on("mapmove",this.canvasFunction,this),this.map.on("zoomchange",this.canvasFunction,this)}}},{key:"canvasFunction",value:function(){var t=[this.map.getSize().width,this.map.getSize().height],e=t[0],n=t[1];if(this.canvasLayer.canvas){this.canvasLayer.canvas.width=e,this.canvasLayer.canvas.height=n;var i=this.map.getBounds();this.layer_&&this.layer_.setBounds(this.options.bounds||i)}else this.canvasLayer.canvas=function(t,e,n){if("undefined"==typeof document)return new n(t,e);var i=document.createElement("canvas");return i.width=t,i.height=e,i}(e,n);return this.render(this.canvasLayer.canvas),this.canvasLayer.canvas}},{key:"removeLayer",value:function(){this.map&&(this.unEvents(),this.map.removeLayer(this.layer_),delete this.map,delete this.layer_,delete this.canvasLayer.canvas)}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"clickEvent",value:function(t){var e=t.pixel;u(wt.prototype.__proto__||Object.getPrototypeOf(wt.prototype),"clickEvent",this).call(this,e,t)}},{key:"mousemoveEvent",value:function(t){var e=t.pixel;u(wt.prototype.__proto__||Object.getPrototypeOf(wt.prototype),"mousemoveEvent",this).call(this,e,t)}},{key:"addAnimatorEvent",value:function(){this.map.on("movestart",this.animatorMovestartEvent,this),this.map.on("moveend",this.animatorMoveendEvent,this)}},{key:"onEvents",value:function(){var t=this.map;this.unEvents(),this.options.methods&&(this.options.methods.click&&t.on("click",this.clickEvent,this),this.options.methods.mousemove&&t.on("mousemove",this.mousemoveEvent,this))}},{key:"unEvents",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent,this),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent,this))}}]),wt),Se=(l(bt,le),Mt(bt,[{key:"init",value:function(t,e){if(!(t&&t instanceof ol.Map))throw new Error("not map object");this.$Map=t,this.context=this.options.context||"2d",this.getCanvasLayer(),this.initDataRange(e),this.initAnimator(),this.onEvents()}},{key:"_canvasUpdate",value:function(t){this.render(this.canvasLayer.canvas,t)}},{key:"render",value:function(t,n){var i=this.$Map,r=t.getContext(this.context),o=this.options.animation,a=this.options.hasOwnProperty("projection")?this.options.projection:"EPSG:4326",s=this.$Map.getView().getProjection().getCode();if(this.isEnabledTime()){if(void 0===n)return e(r),this;"2d"===this.context&&(r.save(),r.globalCompositeOperation="destination-out",r.fillStyle="rgba(0, 0, 0, .1)",r.fillRect(0,0,r.canvas.width,r.canvas.height),r.restore())}else e(r);if("2d"===this.context)for(var u in this.options)r[u]=this.options[u];else r.clear(r.COLOR_BUFFER_BIT);var l={};l.transferCoordinate=a===s?function(t){return i.getPixelFromCoordinate(t)}:function(t){return i.getPixelFromCoordinate(ol.proj.transform(t,a,s))},void 0!==n&&(l.filter=function(t){var e=o.trails||10;return!!(n&&t.time>n-e&&t.time<n)});var c=this.dataSet.get(l);return this.processData(c),"m"===this.options.unit?(this.options.size&&(this.options._size=this.options.size/zoomUnit),this.options.width&&(this.options._width=this.options.width/zoomUnit),this.options.height&&(this.options._height=this.options.height/zoomUnit)):(this.options._size=this.options.size,this.options._height=this.options.height,this.options._width=this.options.width),this.drawContext(r,new h(c),this.options,{x:0,y:0}),this.options.updateCallback&&this.options.updateCallback(n),this}},{key:"getCanvasLayer",value:function(){if(!this.canvasLayer.canvas&&!this.layer_){var t=this.getMapExtent();this.layer_=new ol.layer.Image({layerName:this.options.layerName,minResolution:this.options.minResolution,maxResolution:this.options.maxResolution,zIndex:this.options.zIndex,extent:t,source:new ol.source.ImageCanvas({canvasFunction:this.canvasFunction.bind(this),projection:this.$Map.getView().getProjection().getCode(),ratio:this.options.hasOwnProperty("ratio")?this.options.ratio:1})}),this.$Map.addLayer(this.layer_),this.$Map.un("precompose",this.reRender,this),this.$Map.on("precompose",this.reRender,this)}}},{key:"reRender",value:function(){if(this.layer_){var t=this.getMapExtent();this.layer_.setExtent(t)}}},{key:"canvasFunction",value:function(t,e,n,i){return this.canvasLayer.canvas?(this.canvasLayer.canvas.width=i[0],this.canvasLayer.canvas.height=i[1]):this.canvasLayer.canvas=function(t,e){if("undefined"!=typeof document){var n=document.createElement("canvas");return n.width=t,n.height=e,n}}(i[0],i[1]),this.render(this.canvasLayer.canvas),this.canvasLayer.canvas}},{key:"getMapExtent",value:function(){var t=this.$Map.getSize();return this.$Map.getView().calculateExtent(t)}},{key:"addTo",value:function(t){this.init(t,this.options)}},{key:"removeLayer",value:function(){this.$Map&&(this.unEvents(),this.$Map.un("precompose",this.reRender,this),this.$Map.removeLayer(this.layer_),delete this.$Map,delete this.layer_,delete this.canvasLayer.canvas)}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"clickEvent",value:function(t){var e=t.pixel;u(bt.prototype.__proto__||Object.getPrototypeOf(bt.prototype),"clickEvent",this).call(this,{x:e[0],y:e[1]},t)}},{key:"mousemoveEvent",value:function(t){var e=t.pixel;u(bt.prototype.__proto__||Object.getPrototypeOf(bt.prototype),"mousemoveEvent",this).call(this,{x:e[0],y:e[1]},t)}},{key:"addAnimatorEvent",value:function(){this.$Map.on("movestart",this.animatorMovestartEvent,this),this.$Map.on("moveend",this.animatorMoveendEvent,this)}},{key:"onEvents",value:function(){var t=this.$Map;this.unEvents(),this.options.methods&&(this.options.methods.click&&t.on("click",this.clickEvent,this),this.options.methods.mousemove&&t.on("pointermove",this.mousemoveEvent,this))}},{key:"unEvents",value:function(){var t=this.$Map;this.options.methods&&(this.options.methods.click&&t.un("click",this.clickEvent,this),this.options.methods.pointermove&&t.un("pointermove",this.mousemoveEvent,this))}},{key:"setDefaultCursor",value:function(t,e){if(this.$Map){var n=this.$Map.getTargetElement();e?n.style.cursor!==t&&(this.previousCursor_=n.style.cursor,n.style.cursor=t):void 0!==this.previousCursor_&&(n.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}}},{key:"show",value:function(){this.$Map.addLayer(this.layer_)}},{key:"hide",value:function(){this.$Map.removeLayer(this.layer_)}}]),bt),Pe=(l(Ct,le),Mt(Ct,[{key:"clickEvent",value:function(t){var e=this.map.containerPointToLayerPoint([0,0]),n=this.devicePixelRatio=this.canvasLayer.devicePixelRatio=window.devicePixelRatio,i=t.layerPoint;u(Ct.prototype.__proto__||Object.getPrototypeOf(Ct.prototype),"clickEvent",this).call(this,L.point((i.x-e.x)/n,(i.y-e.y)/n),t)}},{key:"mousemoveEvent",value:function(t){var e=t.layerPoint;u(Ct.prototype.__proto__||Object.getPrototypeOf(Ct.prototype),"mousemoveEvent",this).call(this,e,t)}},{key:"bindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.on("click",this.clickEvent),this.options.methods.mousemove&&t.on("mousemove",this.mousemoveEvent)),this.map.on("movestart",this._moveStartEvent),this.map.on("moveend",this._moveEndEvent),this.map.on("zoomstart",this._zoomStartEvent)}},{key:"destroy",value:function(){this.unbindEvent(),this.clearData(),this.animator&&this.animator.stop(),this.animator=null,this.canvasLayer=null}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent)),this.map.off("movestart",this._moveStartEvent),this.map.off("moveend",this._moveEndEvent),this.map.off("zoomstart",this._zoomStartEvent)}},{key:"getContext",value:function(){return this.canvasLayer.getCanvas().getContext(this.context)}},{key:"addData",value:function(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}},{key:"update",value:function(t){var e=t||{},n=e.data;n&&n.get&&(n=n.get()),null!=n&&this.dataSet.set(n),u(Ct.prototype.__proto__||Object.getPrototypeOf(Ct.prototype),"update",this).call(this,{options:e.options})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!=typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"_canvasUpdate",value:function(t){if(this.canvasLayer){var e=this,n=e.options.animation,i=this.getContext(),r=this.map;if(e.isEnabledTime()){if(void 0===t)return void this.clear(i);"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else this.clear(i);if("2d"===this.context)for(var o in e.options)i[o]=e.options[o];else i.clear(i.COLOR_BUFFER_BIT);if(!(e.options.minZoom&&r.getZoom()<e.options.minZoom||e.options.maxZoom&&r.getZoom()>e.options.maxZoom)){var a=r.getBounds(),s=a.getEast()-a.getWest(),u=a.getNorth()-a.getSouth(),l=r.getSize(),c=s/l.x,h=u/l.y,f=this.canvasLayer.getTopLeft(),p=r.latLngToContainerPoint(f),d={transferCoordinate:function(t){var n,i={x:(n="2d"===e.context?r.latLngToContainerPoint(L.latLng(t[1],t[0])):{x:(t[0]-f.lng)/c,y:(f.lat-t[1])/h}).x-p.x,y:n.y-p.y};return[i.x,i.y]}};void 0!==t&&(d.filter=function(e){var i=n.trails||10;return t&&e.time>t-i&&e.time<t});var g=e.dataSet.get(d);this.processData(g),e.options._size=e.options.size;var y=r.latLngToContainerPoint(L.latLng(0,0)),m={x:y.x-p.x,y:y.y-p.y};this.drawContext(i,g,e.options,m),e.options.updateCallback&&e.options.updateCallback(t)}}}},{key:"init",value:function(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){}},{key:"moveStartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start,this._hide())}},{key:"moveEndEvent",value:function(){this.canvasLayer.draw(),this._show()}},{key:"zoomStartEvent",value:function(){this._hide()}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"_hide",value:function(){this.canvasLayer.canvas.style.display="none"}},{key:"_show",value:function(){this.canvasLayer.canvas.style.display="block"}},{key:"draw",value:function(){this.canvasLayer.draw()}}]),Ct);if("undefined"!=typeof L){var Me=L.Layer.extend({options:{attributionPrefix:null,attribution:""},initialize:function(t,e,n){n=n||{},this.dataSet=t||{},this.mapVOptions=e||{},this.render=this.render.bind(this),L.Util.setOptions(this,n),this.options.attributionPrefix&&(this.options.attribution=this.options.attributionPrefix+this.options.attribution),this.canvas=this._createCanvas(),L.stamp(this)},onAdd:function(t){this._map=t;var e=this.getPane(),n=this.container=L.DomUtil.create("div","leaflet-layer leaflet-zoom-animated",e);n.appendChild(this.canvas);var i=t.getSize();n.style.width=i.x+"px",n.style.height=i.y+"px",this.renderer=new Pe(t,this,this.dataSet,this.mapVOptions),this.draw(),this.fire("loaded")},onRemove:function(){L.DomUtil.remove(this.container),this.renderer.destroy()},addData:function(t,e){this.renderer.addData(t,e)},update:function(t){this.renderer.update(t)},getData:function(){return this.renderer&&(this.dataSet=this.renderer.getData()),this.dataSet},removeData:function(t){this.renderer&&this.renderer.removeData(t)},clearData:function(){this.renderer.clearData()},draw:function(){return this._reset()},setZIndex:function(t){this.canvas.style.zIndex=t},render:function(){this.renderer._canvasUpdate()},getCanvas:function(){return this.canvas},getContainer:function(){return this.container},getTopLeft:function(){var t,e=this._map;return e&&(t=e.getBounds().getNorthWest()),t},_createCanvas:function(){var t=document.createElement("canvas");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.options.zIndex||600;var e="undefined"==typeof window?{}:window,n=this.devicePixelRatio=e.devicePixelRatio;return this.mapVOptions.context&&"2d"!==this.mapVOptions.context||t.getContext("2d").scale(n,n),t},_resize:function(){var t=this.canvas;if(t){var e=this._map,n=e.getSize();t.width=n.x,t.height=n.y,t.style.width=n.x+"px",t.style.height=n.y+"px";var i=e.getBounds(),r=e.latLngToLayerPoint(i.getNorthWest());L.DomUtil.setPosition(t,r)}},_reset:function(){this._resize(),this._render()},redraw:function(){this._resize(),this._render()},_render:function(){this.render()}});Ce=function(t,e,n){return new Me(t,e,n)}}var Le,Ie=Ce,Te=(l(xt,le),Mt(xt,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"clickEvent",value:function(t){var e=t.point;u(xt.prototype.__proto__||Object.getPrototypeOf(xt.prototype),"clickEvent",this).call(this,e,t)}},{key:"mousemoveEvent",value:function(t){var e=t.point;u(xt.prototype.__proto__||Object.getPrototypeOf(xt.prototype),"mousemoveEvent",this).call(this,e,t)}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start)}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator}},{key:"bindEvent",value:function(){this.map,this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"init",value:function(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"_canvasUpdate",value:function(t){this.map;var e=this.scene;if(this.canvasLayer&&!this.stopAniamation){var n=this.options.animation,i=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void this.clear(i);"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else this.clear(i);if("2d"===this.context)for(var r in this.options)i[r]=this.options[r];else i.clear(i.COLOR_BUFFER_BIT);var o={transferCoordinate:function(t){var n=Cesium.Cartesian3.fromDegrees(t[0],t[1]),i=Cesium.SceneTransforms.wgs84ToWindowCoordinates(e,n);return null==i?[-1,-1]:[i.x,i.y]}};void 0!==t&&(o.filter=function(e){var i=n.trails||10;return!!(t&&e.time>t-i&&e.time<t)});var a=this.dataSet.get(o);this.processData(a),"m"==this.options.unit&&this.options.size,this.options._size=this.options.size;var s=Cesium.SceneTransforms.wgs84ToWindowCoordinates(e,Cesium.Cartesian3.fromDegrees(0,0));this.drawContext(i,new h(a),this.options,s),this.options.updateCallback&&this.options.updateCallback(t)}}},{key:"updateData",value:function(t,e){var n=t;n&&n.get&&(n=n.get()),null!=n&&this.dataSet.set(n),u(xt.prototype.__proto__||Object.getPrototypeOf(xt.prototype),"update",this).call(this,{options:e})}},{key:"addData",value:function(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!=typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}}]),xt);if("undefined"!=typeof Cesium){var Ne=0,ke=(Mt(Et,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"addInnerContainer",value:function(){this.container.appendChild(this.canvas)}},{key:"bindEvent",value:function(){var t=this;this.innerMoveStart=this.moveStartEvent.bind(this),this.innerMoveEnd=this.moveEndEvent.bind(this),this.scene.camera.moveStart.addEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.addEventListener(this.innerMoveEnd,this);var e=new Cesium.ScreenSpaceEventHandler(this.scene.canvas);e.setInputAction(function(e){t.innerMoveEnd()},Cesium.ScreenSpaceEventType.LEFT_UP),e.setInputAction(function(e){t.innerMoveEnd()},Cesium.ScreenSpaceEventType.MIDDLE_UP),this.handler=e}},{key:"unbindEvent",value:function(){this.scene.camera.moveStart.removeEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.removeEventListener(this.innerMoveEnd,this),this.scene.postRender.removeEventListener(this._reset,this),this.handler&&(this.handler.destroy(),this.handler=null)}},{key:"moveStartEvent",value:function(){this.mapvBaseLayer&&(this.mapvBaseLayer.animatorMovestartEvent(),this.scene.postRender.addEventListener(this._reset,this))}},{key:"moveEndEvent",value:function(){this.mapvBaseLayer&&(this.scene.postRender.removeEventListener(this._reset,this),this.mapvBaseLayer.animatorMoveendEvent(),this._reset())}},{key:"zoomStartEvent",value:function(){this._unvisiable()}},{key:"zoomEndEvent",value:function(){this._unvisiable()}},{key:"addData",value:function(t,e){null!=this.mapvBaseLayer&&this.mapvBaseLayer.addData(t,e)}},{key:"updateData",value:function(t,e){null!=this.mapvBaseLayer&&this.mapvBaseLayer.updateData(t,e)}},{key:"getData",value:function(){return this.mapvBaseLayer&&(this.dataSet=this.mapvBaseLayer.getData()),this.dataSet}},{key:"removeData",value:function(t){null!=this.mapvBaseLayer&&this.mapvBaseLayer&&this.mapvBaseLayer.removeData(t)}},{key:"removeAllData",value:function(){null!=this.mapvBaseLayer&&this.mapvBaseLayer.clearData()}},{key:"_visiable",value:function(){return this.canvas.style.display="block",this}},{key:"_unvisiable",value:function(){return this.canvas.style.display="none",this}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");t.id=this.mapVOptions.layerid||"mapv"+Ne++,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.mapVOptions.zIndex||0,t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height;var e=this.devicePixelRatio;return"2d"==this.mapVOptions.context&&t.getContext(this.mapVOptions.context).scale(e,e),t}},{key:"_reset",value:function(){this.resizeCanvas(),this.fixPosition(),this.onResize(),this.render()}},{key:"draw",value:function(){this._reset()}},{key:"show",value:function(){this._visiable()}},{key:"hide",value:function(){this._unvisiable()}},{key:"destroy",value:function(){this.remove()}},{key:"remove",value:function(){null!=this.mapvBaseLayer&&(this.removeAllData(),this.mapvBaseLayer.clear(this.mapvBaseLayer.getContext()),this.mapvBaseLayer=void 0,this.canvas.parentElement.removeChild(this.canvas))}},{key:"update",value:function(t){null!=t&&this.updateData(t.data,t.options)}},{key:"resizeCanvas",value:function(){if(null!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}},{key:"fixPosition",value:function(){}},{key:"onResize",value:function(){}},{key:"render",value:function(){null!=this.mapvBaseLayer&&this.mapvBaseLayer._canvasUpdate()}}]),Et);Le=function(t,e,n,i){return new ke(t,e,n,i)}}var Oe=Le,De={getDataSet:function(t){var e=[],n=t.features;if(n)for(var i=0;i<n.length;i++){var r=n[i],o=r.geometry,a=r.properties,s={};for(var u in a)s[u]=a[u];s.geometry=o,e.push(s)}return new h(e)}},Ae={CSVToArray:function(t,e){e=e||",";for(var n=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),i=[[]],r=null;r=n.exec(t);){var o,a=r[1];a.length&&a!==e&&i.push([]),o=r[2]?r[2].replace(new RegExp('""',"g"),'"'):r[3],i[i.length-1].push(o)}return i},getDataSet:function(t,e){for(var n=this.CSVToArray(t,e||","),i=[],r=n[0],o=1;o<n.length-1;o++){for(var a=n[o],s={},u=0;u<a.length;u++){var l=a[u];"geometry"==r[u]&&(l=JSON.parse(l)),s[r[u]]=l}i.push(s)}return new h(i)}};t.version="2.0.62",t.canvasClear=e,t.canvasResolutionScale=function(t){var e=window.devicePixelRatio||1;t.canvas.width=t.canvas.width*e,t.canvas.height=t.canvas.height*e,t.canvas.style.width=t.canvas.width/e+"px",t.canvas.style.height=t.canvas.height/e+"px",t.scale(e,e)},t.canvasDrawSimple=Tt,t.canvasDrawHeatmap=kt,t.canvasDrawGrid=Ot,t.canvasDrawHoneycomb=Dt,t.webglDrawSimple=qt,t.webglDrawPoint=Bt,t.webglDrawLine=Ft,t.webglDrawPolygon=Ht,t.utilCityCenter=Pt,t.utilCurve=Vt,t.utilForceEdgeBundling=function(){function t(t){return{x:h[t.target].x-h[t.source].x,y:h[t.target].y-h[t.source].y}}function e(t){return Math.sqrt(Math.pow(h[t.source].x-h[t.target].x,2)+Math.pow(h[t.source].y-h[t.target].y,2))}function n(t){for(var e=0,n=1;n<d[t].length;n++)e+=i(d[t][n],d[t][n-1]);return e}function i(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function r(t,e){var n=Math.sqrt((e.target.x-e.source.x)*(e.target.x-e.source.x)+(e.target.y-e.source.y)*(e.target.y-e.source.y)),i=((e.source.y-t.y)*(e.source.y-e.target.y)-(e.source.x-t.x)*(e.target.x-e.source.x))/(n*n);return{x:e.source.x+i*(e.target.x-e.source.x),y:e.source.y+i*(e.target.y-e.source.y)}}function o(t,e){for(var n,i={x:0,y:0},r=p[t],o=0;o<r.length;o++){var a={x:d[r[o]][e].x-d[t][e].x,y:d[r[o]][e].y-d[t][e].y};if(Math.abs(a.x)>C||Math.abs(a.y)>C){var s=1/Math.pow((n={source:d[r[o]][e],target:d[t][e]},Math.sqrt(Math.pow(n.source.x-n.target.x,2)+Math.pow(n.source.y-n.target.y,2))),1);i.x+=a.x*s,i.y+=a.y*s}}return i}function a(t,n,i){for(var r,a,s,u,l,c,h,p,y=g/(e(f[t])*(n+1)),m=[{x:0,y:0}],v=1;v<n+1;v++){var _={x:0,y:0},w=(a=v,s=y,p=h=void 0,u=d[r=t][a-1],l=d[r][a+1],c=d[r][a],h=u.x-c.x+l.x-c.x,p=u.y-c.y+l.y-c.y,{x:h*=s,y:p*=s}),b=o(t,v);_.x=i*(w.x+b.x),_.y=i*(w.y+b.y),m.push(_)}return m.push({x:0,y:0}),m}function s(t){for(var e=0;e<f.length;e++)if(1==t)d[e].push(h[f[e].source]),d[e].push((g=f[e],{x:(h[g.source].x+h[g.target].x)/2,y:(h[g.source].y+h[g.target].y)/2})),d[e].push(h[f[e].target]);else{var r=n(e)/(t+1),o=r,a=[];a.push(h[f[e].source]);for(var s=1;s<d[e].length;s++){for(var u=i(d[e][s],d[e][s-1]);o<u;){var l=o/u,c=d[e][s-1].x,p=d[e][s-1].y;c+=l*(d[e][s].x-d[e][s-1].x),p+=l*(d[e][s].y-d[e][s-1].y),a.push({x:c,y:p}),u-=o,o=r}o-=u}a.push(h[f[e].target]),d[e]=a}var g}function u(t,e){var n=r(h[e.source],{source:h[t.source],target:h[t.target]}),o=r(h[e.target],{source:h[t.source],target:h[t.target]}),a={x:(n.x+o.x)/2,y:(n.y+o.y)/2},s={x:(h[t.source].x+h[t.target].x)/2,y:(h[t.source].y+h[t.target].y)/2};return Math.max(0,1-2*i(s,a)/i(n,o))}function l(n,r){var o,a,s,l,c,f,p,d,g,y,m,v;return g=n,y=r,Math.abs((m=t(g),v=t(y),(m.x*v.x+m.y*v.y)/(e(g)*e(y))))*(p=r,2/((d=(e(f=n)+e(p))/2)/Math.min(e(f),e(p))+Math.max(e(f),e(p))/d))*(l=r,(c=(e(s=n)+e(l))/2)/(c+i({x:(h[s.source].x+h[s.target].x)/2,y:(h[s.source].y+h[s.target].y)/2},{x:(h[l.source].x+h[l.target].x)/2,y:(h[l.source].y+h[l.target].y)/2})))*(o=n,a=r,Math.min(u(o,a),u(a,o)))}function c(){var t=y,e=_,n=1;!function(){for(var t=0;t<f.length;t++)d[t]=[]}(),function(){for(var t=0;t<f.length;t++)p[t]=[]}(),s(n),function(){for(var t=0;t<f.length-1;t++)for(var e=t+1;e<f.length;e++)t!=e&&(n=f[t],i=f[e],l(n,i)>=b&&(p[t].push(e),p[e].push(t)));var n,i}();for(var i=0;i<v;i++){for(var r=0;r<e;r++){for(var o=[],u=0;u<f.length;u++)o[u]=a(u,n,t);for(var c=0;c<f.length;c++)for(var h=0;h<n+1;h++)d[c][h].x+=o[c][h].x,d[c][h].y+=o[c][h].y}t/=2,e*=w,s(n*=2)}return d}var h={},f=[],p=[],d=[],g=.1,y=.1,m=2,v=6,_=70,w=.6666667,b=.6,C=1e-8;return c.nodes=function(t){return 0==arguments.length?h:(h=t,c)},c.edges=function(t){return 0==arguments.length?f:(f=function(t){for(var e=[],n=0;n<t.length;n++)h[t[n].source].x!=h[t[n].target].x&&h[t[n].source].y!=h[t[n].target].y&&e.push(t[n]);return e}(t),c)},c.bundling_stiffness=function(t){return 0==arguments.length?g:(g=t,c)},c.step_size=function(t){return 0==arguments.length?y:(y=t,c)},c.cycles=function(t){return 0==arguments.length?v:(v=t,c)},c.iterations=function(t){return 0==arguments.length?_:(_=t,c)},c.iterations_rate=function(t){return 0==arguments.length?w:(w=t,c)},c.subdivision_points_seed=function(t){return 0==arguments.length?P:(P=t,c)},c.subdivision_rate=function(t){return 0==arguments.length?m:(m=t,c)},c.compatbility_threshold=function(t){return 0==arguments.length?compatbility_threshold:(b=t,c)},c},t.utilDataRangeIntensity=p,t.utilDataRangeCategory=V,t.utilDataRangeChoropleth=W,t.Map=Wt,t.baiduMapCanvasLayer=X,t.baiduMapAnimationLayer=fe,t.baiduMapLayer=ge,t.googleMapCanvasLayer=yt,t.googleMapLayer=_e,t.MaptalksLayer=xe,t.AMapLayer=Ee,t.OpenlayersLayer=Se,t.leafletMapLayer=Ie,t.cesiumMapLayer=Oe,t.DataSet=h,t.geojson=De,t.csv=Ae,Object.defineProperty(t,"__esModule",{value:!0})})}).call(e,n(124))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===i||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function a(){g&&p&&(g=!1,p.length?d=p.concat(d):y=-1,d.length&&s())}function s(){if(!g){var t=r(a);g=!0;for(var e=d.length;e;){for(p=d,d=[];++y<e;)p&&p[y].run();y=-1,e=d.length}p=null,g=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,h,f=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{h="function"==typeof clearTimeout?clearTimeout:i}catch(t){h=i}}();var p,d=[],g=!1,y=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new u(t,e)),
1!==d.length||g||r(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t),this.options={dataOrUrl:"",pixelRange:15,enabled:!0,style:[{num:1,size:48,color:"#e6a23cbb"}],img:""},this.options=Object.assign(this.options,e),this.viewer=e.viewer,this.dataSources=null,this.clustericon={},this.options.dataOrUrl&&""!=this.options.dataOrUrl&&this.loadjson()}return i(t,[{key:"loadjson",value:function(){var t=this;(new Cesium.GeoJsonDataSource).load(t.options.dataOrUrl).then(function(e){t.showcluster(e)})}},{key:"showcluster",value:function(t){function e(){Cesium.defined(a)?(a(),a=void 0):a=n.dataSources.clustering.clusterEvent.addEventListener(function(t,e){e.billboard.show=!0,e.billboard.id=e.label.id,e.billboard.eyeOffset=new Cesium.Cartesian3(0,0,-10),e.billboard.disableDepthTestDistance=Number.POSITIVE_INFINITY,e.billboard.verticalOrigin=Cesium.VerticalOrigin.CENTER;for(var i=-1,r=0;r<n.options.style.length;r++)t.length>n.options.style[r].num&&(i=r);if(i==-1?e.billboard.image=n.options.img:e.billboard.image=n.drawImage(n.options.style[i].size,n.options.style[i].color),i!==-1){if(e.label.show=!0,e.label.style=Cesium.LabelStyle.FILL,e.label.fillColor=Cesium.Color.WHITE,e.label.font="normal 16px MicroSoft YaHei",e.label.outlineWidth=4,e.label.horizontalOrigin=Cesium.HorizontalOrigin.CENTER,e.label.verticalOrigin=Cesium.VerticalOrigin.CENTER,e.label.disableDepthTestDistance=Number.POSITIVE_INFINITY,e.label.pixelOffset=new Cesium.Cartesian2(0,0),e.label.eyeOffset=new Cesium.Cartesian3(0,0,-10),n.options.style[i].textstyle)for(var o in n.options.style[i].textstyle)e.label[o]=n.options.style[i].textstyle[o]}else e.label.show=!1});var t=n.dataSources.clustering.pixelRange;n.dataSources.clustering.pixelRange=0,n.dataSources.clustering.pixelRange=t}var n=this;this.dataSources=t,this.viewer.dataSources.add(this.dataSources);var i=this.options.pixelRange,r=1,o=this.options.enabled;this.dataSources.clustering.enabled=o,this.dataSources.clustering.pixelRange=i,this.dataSources.clustering.minimumClusterSize=r;var a;e()}},{key:"drawImage",value:function(t,e){if(this.clustericon[t+"_"+e])return this.clustericon[t+"_"+e];var n=document.createElement("canvas");n.height=t,n.width=t;var i=n.getContext("2d");i.beginPath(),i.arc(t/2,t/2,t/2,0,2*Math.PI,!0),i.fillStyle=e,i.closePath(),i.fill();var r=n.toDataURL();return this.clustericon[t+"_"+e]=r,r}},{key:"remove",value:function(){this.viewer.dataSources.remove(this.dataSources),this.dataSources=null,this.clustericon={}}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(){n(this,t)}return i(t,null,[{key:"greeting",value:function(){var t="%c",e="color:#00a1ff;font-weight:bolder;font-size:22px;font-family:'Microsoft YaHei',微软雅黑,'MicrosoftJhengHei',华文细黑,STHeiti,MingLiu ",n="color:#00a1ff;font-size:8px;font-family:'Microsoft YaHei',微软雅黑,'MicrosoftJhengHei',华文细黑,STHeiti,MingLiu ",i="欢迎使用CTMap SDK",r="版本号：1.1.0414",o="编译日期：2020-4-14 16:39:53",a="授权信息：授权-永久使用此软件当前版本。";console.info(t+i,e),console.info(t+r,n),console.info(t+o,n),console.info(t+a,n)}}]),t}();e.default=r},function(t,e){"use strict";function n(t,e){t=t||{},this._tilingScheme=t.tilingScheme||new Cesium.GeographicTilingScheme,this._color=t.color||new Cesium.Color(1,1,1,.4),this._tileWidth=t.tileWidth||256,this._tileHeight=t.tileHeight||256,this._ready=!0,this._sexagesimal=t.sexagesimal||!1,this._numLines=t.numLines||50,this._scene=e,this._labels=new Cesium.LabelCollection,e.primitives.add(this._labels),this._polylines=new Cesium.PolylineCollection,e.primitives.add(this._polylines),this._ellipsoid=e.globe.ellipsoid;var n=document.createElement("canvas");n.width=256,n.height=256,this._canvas=n;var i=this;e.camera.moveEnd.addEventListener(function(){i._show&&(i._polylines.removeAll(),i._labels.removeAll(),i._currentExtent=null,i._drawGrid(i._getExtentView()))}),e.imageryLayers.addImageryProvider(this)}function i(t){return t<.01?2:t<.1?1:0}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(t){return!1}}(),o=Object.defineProperties;r&&o||(o=function(t){return t}),o(n.prototype,{url:{get:function(){}},proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),n.prototype.makeLabel=function(t,e,n,i,r){this._labels.add({position:this._ellipsoid.cartographicToCartesian(new Cesium.Cartographic(t,e,10)),text:n,font:"16px Helvetica",style:Cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:Cesium.Color.AZURE,outlineColor:Cesium.Color.BLACK,outlineWidth:2,pixelOffset:new Cesium.Cartesian2(5,i?18:-18),eyeOffset:Cesium.Cartesian3.ZERO,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:i?Cesium.VerticalOrigin.BOTTOM:Cesium.VerticalOrigin.TOP,scale:1})},n.prototype._drawGrid=function(t){if(!this._currentExtent||!this._currentExtent.equals(t)){this._currentExtent=t,this._polylines.removeAll(),this._labels.removeAll();var e,n=(this._canvasSize,0),r=0;for(e=0;e<a.length&&n<(t.north-t.south)/10;e++)n=a[e];for(e=0;e<a.length&&r<(t.east-t.west)/10;e++)r=a[e];var o=(t.west<0?Math.ceil(t.west/r):Math.floor(t.west/r))*r,s=(t.south<0?Math.ceil(t.south/n):Math.floor(t.south/n))*n,u=(t.east<0?Math.ceil(t.east/n):Math.floor(t.east/n))*n,l=(t.north<0?Math.ceil(t.north/r):Math.floor(t.north/r))*r;o=Math.max(o-2*r,-Math.PI),u=Math.min(u+2*r,Math.PI),s=Math.max(s-2*n,-Math.PI/2),l=Math.min(l+2*r,Math.PI/2);var c,h,f=this._ellipsoid,p=Cesium.Math.toRadians(1),d=s+Math.floor((l-s)/n/2)*n;for(h=o;h<u;h+=r){var g=[];for(c=s;c<l;c+=p)g.push(new Cesium.Cartographic(h,c));g.push(new Cesium.Cartographic(h,l)),this._polylines.add({positions:f.cartographicArrayToCartesianArray(g),width:1});var y=Cesium.Math.toDegrees(h);this.makeLabel(h,d,this._sexagesimal?this._decToSex(y):y.toFixed(i(r)),!1)}var m=o+Math.floor((u-o)/r/2)*r;for(c=s;c<l;c+=n){var g=[];for(h=o;h<u;h+=p)g.push(new Cesium.Cartographic(h,c));g.push(new Cesium.Cartographic(u,c)),this._polylines.add({positions:f.cartographicArrayToCartesianArray(g),width:1});var v=Cesium.Math.toDegrees(c);this.makeLabel(m,c,this._sexagesimal?this._decToSex(v):v.toFixed(i(n)),!0)}}},n.prototype.requestImage=function(t,e,n){return this._show&&this._drawGrid(this._getExtentView()),this._canvas},n.prototype.setVisible=function(t){this._show=t,t?(this._currentExtent=null,this._drawGrid(this._getExtentView())):(this._polylines.removeAll(),this._labels.removeAll())},n.prototype.isVisible=function(){return this._show},n.prototype._decToSex=function(t){var e=Math.floor(t),n=(60*(Math.abs(t)-e)).toFixed(2);return"60.00"==n&&(e+=1,n="0.00"),[e,":",n].join("")},n.prototype._getExtentView=function(){for(var t=this._scene.camera,e=this._scene.canvas,n=[t.pickEllipsoid(new Cesium.Cartesian2(0,0),this._ellipsoid),t.pickEllipsoid(new Cesium.Cartesian2(e.width,0),this._ellipsoid),t.pickEllipsoid(new Cesium.Cartesian2(0,e.height),this._ellipsoid),t.pickEllipsoid(new Cesium.Cartesian2(e.width,e.height),this._ellipsoid)],i=0;i<4;i++)if(void 0===n[i])return Cesium.Rectangle.MAX_VALUE;return Cesium.Rectangle.fromCartographicArray(this._ellipsoid.cartesianArrayToCartographicArray(n))};var a=[Cesium.Math.toRadians(.05),Cesium.Math.toRadians(.1),Cesium.Math.toRadians(.2),Cesium.Math.toRadians(.5),Cesium.Math.toRadians(1),Cesium.Math.toRadians(2),Cesium.Math.toRadians(5),Cesium.Math.toRadians(10)];e.default=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){if(u=t.viewer,o=i(),a=t.normalMapUrl,r=t.DegreesArrayHeights&&t.DegreesArrayHeights.length>=3?t.DegreesArrayHeights:[116.04437,30.10932,-100,116.04537,30.10932,-120,116.04537,30.11032,-100,116.04437,30.11032,-120,116.04437,30.10932,-100],s=t.extrudedHeight?e(r,t.startH||0,t.extrudedHeight):e(r,t.startH||0),t.fillcolor||(l=n(o,a,t)),t.ClassificationPrimitive){var c=new Cesium.ClassificationPrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:s,attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(t.fillcolor||Cesium.Color.WHITE.withAlpha(1)),show:new Cesium.ShowGeometryInstanceAttribute(!0)}}),classificationType:Cesium.ClassificationType.CESIUM_3D_TILE,appearance:l});l?this.primitive=u.scene.primitives.add(new Cesium.Primitive(c)):(console.log(l),this.primitive=new Cesium.PrimitiveCollection,u.scene.primitives.add(this.primitive),this.primitive.add(c))}else this.primitive=u.scene.primitives.add(new Cesium.Primitive({allowPicking:!1,geometryInstances:new Cesium.GeometryInstance({geometry:s}),appearance:l,asynchronous:!1}))}function e(t,e,n){return n||e?new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(t)),height:e||0,extrudedHeight:n?n:0}):new Cesium.PolygonGeometry({polygonHierarchy:new Cesium.PolygonHierarchy(Cesium.Cartesian3.fromDegreesArrayHeights(t)),perPositionHeight:!0})}function n(t,e,n){return new Cesium.EllipsoidSurfaceAppearance({material:new Cesium.Material({fabric:{type:"Water",uniforms:{baseWaterColor:new Cesium.Color.fromCssColorString(n.waterColor||"#006ab4").withAlpha(.5),normalMap:e,frequency:400,animationSpeed:.02,amplitude:5}}}),fragmentShaderSource:t})}function i(){return"\n            varying vec3 v_positionMC;\n            varying vec3 v_positionEC;\n            varying vec2 v_st;\n            void main()\n            {\n                czm_materialInput materialInput;\n                vec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n                #ifdef FACE_FORWARD\n                    normalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n                #endif\n                materialInput.s = v_st.s;\n                materialInput.st = v_st;\n                materialInput.str = vec3(v_st, 0.0);\n                materialInput.normalEC = normalEC;\n                materialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\n                vec3 positionToEyeEC = -v_positionEC;\n                materialInput.positionToEyeEC = positionToEyeEC;\n                czm_material material = czm_getMaterial(materialInput);\n                #ifdef FLAT\n                    gl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n                #else\n                    gl_FragColor = czm_phong(normalize(positionToEyeEC), material, czm_lightDirectionEC);\n                #endif\n                gl_FragColor.a=0.7;\n            }\n"}var r,o,a,s,u,l=null;return t.prototype.remove=function(){null!=this.primitive&&(u.scene.primitives.remove(this.primitive),this.primitive=null)},t.prototype.updateDegreesPosition=function(t,n){null!=this.primitive&&(u.scene.primitives.remove(this.primitive),t&&t.length<3||(s=e(t,n?n:0),this.primitive=u.scene.primitives.add(new Cesium.Primitive({allowPicking:!1,geometryInstances:new Cesium.GeometryInstance({geometry:s}),appearance:l,asynchronous:!1}))))},t}();e.default=n}]);